(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendors~file-upload"],{

/***/ "./node_modules/plupload/js/moxie.js":
/*!*******************************************!*\
  !*** ./node_modules/plupload/js/moxie.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;;var MXI_DEBUG = true;\n/**\n * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill\n * v1.5.7\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n *\n * Date: 2017-11-03\n */\n;(function (global, factory) {\n\tvar extract = function() {\n\t\tvar ctx = {};\n\t\tfactory.apply(ctx, arguments);\n\t\treturn ctx.moxie;\n\t};\n\t\n\tif (true) {\n\t\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (extract),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t} else {}\n}(this || window, function() {\n/**\n * Compiled inline version. (Library mode)\n */\n\n/*jshint smarttabs:true, undef:true, latedef:true, curly:true, bitwise:true, camelcase:true */\n/*globals $code */\n\n(function(exports, undefined) {\n\t\"use strict\";\n\n\tvar modules = {};\n\n\tfunction require(ids, callback) {\n\t\tvar module, defs = [];\n\n\t\tfor (var i = 0; i < ids.length; ++i) {\n\t\t\tmodule = modules[ids[i]] || resolve(ids[i]);\n\t\t\tif (!module) {\n\t\t\t\tthrow 'module definition dependecy not found: ' + ids[i];\n\t\t\t}\n\n\t\t\tdefs.push(module);\n\t\t}\n\n\t\tcallback.apply(null, defs);\n\t}\n\n\tfunction define(id, dependencies, definition) {\n\t\tif (typeof id !== 'string') {\n\t\t\tthrow 'invalid module definition, module id must be defined and be a string';\n\t\t}\n\n\t\tif (dependencies === undefined) {\n\t\t\tthrow 'invalid module definition, dependencies must be specified';\n\t\t}\n\n\t\tif (definition === undefined) {\n\t\t\tthrow 'invalid module definition, definition function must be specified';\n\t\t}\n\n\t\trequire(dependencies, function() {\n\t\t\tmodules[id] = definition.apply(null, arguments);\n\t\t});\n\t}\n\n\tfunction defined(id) {\n\t\treturn !!modules[id];\n\t}\n\n\tfunction resolve(id) {\n\t\tvar target = exports;\n\t\tvar fragments = id.split(/[.\\/]/);\n\n\t\tfor (var fi = 0; fi < fragments.length; ++fi) {\n\t\t\tif (!target[fragments[fi]]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttarget = target[fragments[fi]];\n\t\t}\n\n\t\treturn target;\n\t}\n\n\tfunction expose(ids) {\n\t\tfor (var i = 0; i < ids.length; i++) {\n\t\t\tvar target = exports;\n\t\t\tvar id = ids[i];\n\t\t\tvar fragments = id.split(/[.\\/]/);\n\n\t\t\tfor (var fi = 0; fi < fragments.length - 1; ++fi) {\n\t\t\t\tif (target[fragments[fi]] === undefined) {\n\t\t\t\t\ttarget[fragments[fi]] = {};\n\t\t\t\t}\n\n\t\t\t\ttarget = target[fragments[fi]];\n\t\t\t}\n\n\t\t\ttarget[fragments[fragments.length - 1]] = modules[id];\n\t\t}\n\t}\n\n// Included from: src/javascript/core/utils/Basic.js\n\n/**\n * Basic.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/core/utils/Basic\n@public\n@static\n*/\n\ndefine('moxie/core/utils/Basic', [], function() {\n\t/**\n\tGets the true type of the built-in object (better version of typeof).\n\t@author Angus Croll (http://javascriptweblog.wordpress.com/)\n\n\t@method typeOf\n\t@static\n\t@param {Object} o Object to check.\n\t@return {String} Object [[Class]]\n\t*/\n\tfunction typeOf(o) {\n\t\tvar undef;\n\n\t\tif (o === undef) {\n\t\t\treturn 'undefined';\n\t\t} else if (o === null) {\n\t\t\treturn 'null';\n\t\t} else if (o.nodeType) {\n\t\t\treturn 'node';\n\t\t}\n\n\t\t// the snippet below is awesome, however it fails to detect null, undefined and arguments types in IE lte 8\n\t\treturn ({}).toString.call(o).match(/\\s([a-z|A-Z]+)/)[1].toLowerCase();\n\t}\n\n\t/**\n\tExtends the specified object with another object(s).\n\n\t@method extend\n\t@static\n\t@param {Object} target Object to extend.\n\t@param {Object} [obj]* Multiple objects to extend with.\n\t@return {Object} Same as target, the extended object.\n\t*/\n\tfunction extend() {\n\t\treturn merge(false, false, arguments);\n\t}\n\n\n\t/**\n\tExtends the specified object with another object(s), but only if the property exists in the target.\n\n\t@method extendIf\n\t@static\n\t@param {Object} target Object to extend.\n\t@param {Object} [obj]* Multiple objects to extend with.\n\t@return {Object} Same as target, the extended object.\n\t*/\n\tfunction extendIf() {\n\t\treturn merge(true, false, arguments);\n\t}\n\n\n\tfunction extendImmutable() {\n\t\treturn merge(false, true, arguments);\n\t}\n\n\n\tfunction extendImmutableIf() {\n\t\treturn merge(true, true, arguments);\n\t}\n\n\n\tfunction clone(value) {\n\t\tswitch (typeOf(value)) {\n\t\t\tcase 'array':\n\t\t\t\treturn merge(false, true, [[], value]);\n\n\t\t\tcase 'object':\n\t\t\t\treturn merge(false, true, [{}, value]);\n\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t}\n\n\n\tfunction shallowCopy(obj) {\n\t\tswitch (typeOf(obj)) {\n\t\t\tcase 'array':\n\t\t\t\treturn Array.prototype.slice.call(obj);\n\n\t\t\tcase 'object':\n\t\t\t\treturn extend({}, obj);\n\t\t}\n\t\treturn obj;\n\t}\n\n\n\tfunction merge(strict, immutable, args) {\n\t\tvar undef;\n\t\tvar target = args[0];\n\n\t\teach(args, function(arg, i) {\n\t\t\tif (i > 0) {\n\t\t\t\teach(arg, function(value, key) {\n\t\t\t\t\tvar isComplex = inArray(typeOf(value), ['array', 'object']) !== -1;\n\n\t\t\t\t\tif (value === undef || strict && target[key] === undef) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isComplex && immutable) {\n\t\t\t\t\t\tvalue = shallowCopy(value);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeOf(target[key]) === typeOf(value) && isComplex) {\n\t\t\t\t\t\tmerge(strict, immutable, [target[key], value]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget[key] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn target;\n\t}\n\n\n\t/**\n\tA way to inherit one `class` from another in a consisstent way (more or less)\n\n\t@method inherit\n\t@static\n\t@since >1.4.1\n\t@param {Function} child\n\t@param {Function} parent\n\t@return {Function} Prepared constructor\n\t*/\n\tfunction inherit(child, parent) {\n\t\t// copy over all parent properties\n\t\tfor (var key in parent) {\n\t\t\tif ({}.hasOwnProperty.call(parent, key)) {\n\t\t\t\tchild[key] = parent[key];\n\t\t\t}\n\t\t}\n\n\t\t// give child `class` a place to define its own methods\n\t\tfunction ctor() {\n\t\t\tthis.constructor = child;\n\n\t\t\tif (MXI_DEBUG) {\n\t\t\t\tvar getCtorName = function(fn) {\n\t\t\t\t\tvar m = fn.toString().match(/^function\\s([^\\(\\s]+)/);\n\t\t\t\t\treturn m ? m[1] : false;\n\t\t\t\t};\n\n\t\t\t\tthis.ctorName = getCtorName(child);\n\t\t\t}\n\t\t}\n\t\tctor.prototype = parent.prototype;\n\t\tchild.prototype = new ctor();\n\n\t\t// keep a way to reference parent methods\n\t\tchild.parent = parent.prototype;\n\t\treturn child;\n\t}\n\n\n\t/**\n\tExecutes the callback function for each item in array/object. If you return false in the\n\tcallback it will break the loop.\n\n\t@method each\n\t@static\n\t@param {Object} obj Object to iterate.\n\t@param {function} callback Callback function to execute for each item.\n\t*/\n\tfunction each(obj, callback) {\n\t\tvar length, key, i, undef;\n\n\t\tif (obj) {\n\t\t\ttry {\n\t\t\t\tlength = obj.length;\n\t\t\t} catch(ex) {\n\t\t\t\tlength = undef;\n\t\t\t}\n\n\t\t\tif (length === undef || typeof(length) !== 'number') {\n\t\t\t\t// Loop object items\n\t\t\t\tfor (key in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (callback(obj[key], key) === false) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Loop array items\n\t\t\t\tfor (i = 0; i < length; i++) {\n\t\t\t\t\tif (callback(obj[i], i) === false) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\tChecks if object is empty.\n\n\t@method isEmptyObj\n\t@static\n\t@param {Object} o Object to check.\n\t@return {Boolean}\n\t*/\n\tfunction isEmptyObj(obj) {\n\t\tvar prop;\n\n\t\tif (!obj || typeOf(obj) !== 'object') {\n\t\t\treturn true;\n\t\t}\n\n\t\tfor (prop in obj) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\tRecieve an array of functions (usually async) to call in sequence, each  function\n\treceives a callback as first argument that it should call, when it completes. Finally,\n\tafter everything is complete, main callback is called. Passing truthy value to the\n\tcallback as a first argument will interrupt the sequence and invoke main callback\n\timmediately.\n\n\t@method inSeries\n\t@static\n\t@param {Array} queue Array of functions to call in sequence\n\t@param {Function} cb Main callback that is called in the end, or in case of error\n\t*/\n\tfunction inSeries(queue, cb) {\n\t\tvar i = 0, length = queue.length;\n\n\t\tif (typeOf(cb) !== 'function') {\n\t\t\tcb = function() {};\n\t\t}\n\n\t\tif (!queue || !queue.length) {\n\t\t\tcb();\n\t\t}\n\n\t\tfunction callNext(i) {\n\t\t\tif (typeOf(queue[i]) === 'function') {\n\t\t\t\tqueue[i](function(error) {\n\t\t\t\t\t/*jshint expr:true */\n\t\t\t\t\t++i < length && !error ? callNext(i) : cb(error);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tcallNext(i);\n\t}\n\n\n\t/**\n\tRecieve an array of functions (usually async) to call in parallel, each  function\n\treceives a callback as first argument that it should call, when it completes. After\n\teverything is complete, main callback is called. Passing truthy value to the\n\tcallback as a first argument will interrupt the process and invoke main callback\n\timmediately.\n\n\t@method inParallel\n\t@static\n\t@param {Array} queue Array of functions to call in sequence\n\t@param {Function} cb Main callback that is called in the end, or in case of erro\n\t*/\n\tfunction inParallel(queue, cb) {\n\t\tvar count = 0, num = queue.length, cbArgs = new Array(num);\n\n\t\teach(queue, function(fn, i) {\n\t\t\tfn(function(error) {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn cb(error);\n\t\t\t\t}\n\n\t\t\t\tvar args = [].slice.call(arguments);\n\t\t\t\targs.shift(); // strip error - undefined or not\n\n\t\t\t\tcbArgs[i] = args;\n\t\t\t\tcount++;\n\n\t\t\t\tif (count === num) {\n\t\t\t\t\tcbArgs.unshift(null);\n\t\t\t\t\tcb.apply(this, cbArgs);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\n\t/**\n\tFind an element in array and return it's index if present, otherwise return -1.\n\n\t@method inArray\n\t@static\n\t@param {Mixed} needle Element to find\n\t@param {Array} array\n\t@return {Int} Index of the element, or -1 if not found\n\t*/\n\tfunction inArray(needle, array) {\n\t\tif (array) {\n\t\t\tif (Array.prototype.indexOf) {\n\t\t\t\treturn Array.prototype.indexOf.call(array, needle);\n\t\t\t}\n\n\t\t\tfor (var i = 0, length = array.length; i < length; i++) {\n\t\t\t\tif (array[i] === needle) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\n\t/**\n\tReturns elements of first array if they are not present in second. And false - otherwise.\n\n\t@private\n\t@method arrayDiff\n\t@param {Array} needles\n\t@param {Array} array\n\t@return {Array|Boolean}\n\t*/\n\tfunction arrayDiff(needles, array) {\n\t\tvar diff = [];\n\n\t\tif (typeOf(needles) !== 'array') {\n\t\t\tneedles = [needles];\n\t\t}\n\n\t\tif (typeOf(array) !== 'array') {\n\t\t\tarray = [array];\n\t\t}\n\n\t\tfor (var i in needles) {\n\t\t\tif (inArray(needles[i], array) === -1) {\n\t\t\t\tdiff.push(needles[i]);\n\t\t\t}\n\t\t}\n\t\treturn diff.length ? diff : false;\n\t}\n\n\n\t/**\n\tFind intersection of two arrays.\n\n\t@private\n\t@method arrayIntersect\n\t@param {Array} array1\n\t@param {Array} array2\n\t@return {Array} Intersection of two arrays or null if there is none\n\t*/\n\tfunction arrayIntersect(array1, array2) {\n\t\tvar result = [];\n\t\teach(array1, function(item) {\n\t\t\tif (inArray(item, array2) !== -1) {\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t});\n\t\treturn result.length ? result : null;\n\t}\n\n\n\t/**\n\tForces anything into an array.\n\n\t@method toArray\n\t@static\n\t@param {Object} obj Object with length field.\n\t@return {Array} Array object containing all items.\n\t*/\n\tfunction toArray(obj) {\n\t\tvar i, arr = [];\n\n\t\tfor (i = 0; i < obj.length; i++) {\n\t\t\tarr[i] = obj[i];\n\t\t}\n\n\t\treturn arr;\n\t}\n\n\n\t/**\n\tGenerates an unique ID. The only way a user would be able to get the same ID is if the two persons\n\tat the same exact millisecond manage to get the same 5 random numbers between 0-65535; it also uses\n\ta counter so each ID is guaranteed to be unique for the given page. It is more probable for the earth\n\tto be hit with an asteroid.\n\n\t@method guid\n\t@static\n\t@param {String} prefix to prepend (by default 'o' will be prepended).\n\t@method guid\n\t@return {String} Virtually unique id.\n\t*/\n\tvar guid = (function() {\n\t\tvar counter = 0;\n\n\t\treturn function(prefix) {\n\t\t\tvar guid = new Date().getTime().toString(32), i;\n\n\t\t\tfor (i = 0; i < 5; i++) {\n\t\t\t\tguid += Math.floor(Math.random() * 65535).toString(32);\n\t\t\t}\n\n\t\t\treturn (prefix || 'o_') + guid + (counter++).toString(32);\n\t\t};\n\t}());\n\n\n\t/**\n\tTrims white spaces around the string\n\n\t@method trim\n\t@static\n\t@param {String} str\n\t@return {String}\n\t*/\n\tfunction trim(str) {\n\t\tif (!str) {\n\t\t\treturn str;\n\t\t}\n\t\treturn String.prototype.trim ? String.prototype.trim.call(str) : str.toString().replace(/^\\s*/, '').replace(/\\s*$/, '');\n\t}\n\n\n\t/**\n\tParses the specified size string into a byte value. For example 10kb becomes 10240.\n\n\t@method parseSizeStr\n\t@static\n\t@param {String/Number} size String to parse or number to just pass through.\n\t@return {Number} Size in bytes.\n\t*/\n\tfunction parseSizeStr(size) {\n\t\tif (typeof(size) !== 'string') {\n\t\t\treturn size;\n\t\t}\n\n\t\tvar muls = {\n\t\t\t\tt: 1099511627776,\n\t\t\t\tg: 1073741824,\n\t\t\t\tm: 1048576,\n\t\t\t\tk: 1024\n\t\t\t},\n\t\t\tmul;\n\n\t\tsize = /^([0-9\\.]+)([tmgk]?)$/.exec(size.toLowerCase().replace(/[^0-9\\.tmkg]/g, ''));\n\t\tmul = size[2];\n\t\tsize = +size[1];\n\n\t\tif (muls.hasOwnProperty(mul)) {\n\t\t\tsize *= muls[mul];\n\t\t}\n\t\treturn Math.floor(size);\n\t}\n\n\n\t/**\n\t * Pseudo sprintf implementation - simple way to replace tokens with specified values.\n\t *\n\t * @param {String} str String with tokens\n\t * @return {String} String with replaced tokens\n\t */\n\tfunction sprintf(str) {\n\t\tvar args = [].slice.call(arguments, 1);\n\n\t\treturn str.replace(/%([a-z])/g, function($0, $1) {\n\t\t\tvar value = args.shift();\n\n\t\t\tswitch ($1) {\n\t\t\t\tcase 's':\n\t\t\t\t\treturn value + '';\n\n\t\t\t\tcase 'd':\n\t\t\t\t\treturn parseInt(value, 10);\n\n\t\t\t\tcase 'f':\n\t\t\t\t\treturn parseFloat(value);\n\n\t\t\t\tcase 'c':\n\t\t\t\t\treturn '';\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn value;\n\t\t\t}\n\t\t});\n\t}\n\n\n\n\tfunction delay(cb, timeout) {\n\t\tvar self = this;\n\t\tsetTimeout(function() {\n\t\t\tcb.call(self);\n\t\t}, timeout || 1);\n\t}\n\n\n\treturn {\n\t\tguid: guid,\n\t\ttypeOf: typeOf,\n\t\textend: extend,\n\t\textendIf: extendIf,\n\t\textendImmutable: extendImmutable,\n\t\textendImmutableIf: extendImmutableIf,\n\t\tclone: clone,\n\t\tinherit: inherit,\n\t\teach: each,\n\t\tisEmptyObj: isEmptyObj,\n\t\tinSeries: inSeries,\n\t\tinParallel: inParallel,\n\t\tinArray: inArray,\n\t\tarrayDiff: arrayDiff,\n\t\tarrayIntersect: arrayIntersect,\n\t\ttoArray: toArray,\n\t\ttrim: trim,\n\t\tsprintf: sprintf,\n\t\tparseSizeStr: parseSizeStr,\n\t\tdelay: delay\n\t};\n});\n\n// Included from: src/javascript/core/utils/Encode.js\n\n/**\n * Encode.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/core/utils/Encode\n@public\n@static\n*/\n\ndefine('moxie/core/utils/Encode', [], function() {\n\n\t/**\n\tEncode string with UTF-8\n\n\t@method utf8_encode\n\t@static\n\t@param {String} str String to encode\n\t@return {String} UTF-8 encoded string\n\t*/\n\tvar utf8_encode = function(str) {\n\t\treturn unescape(encodeURIComponent(str));\n\t};\n\t\n\t/**\n\tDecode UTF-8 encoded string\n\n\t@method utf8_decode\n\t@static\n\t@param {String} str String to decode\n\t@return {String} Decoded string\n\t*/\n\tvar utf8_decode = function(str_data) {\n\t\treturn decodeURIComponent(escape(str_data));\n\t};\n\t\n\t/**\n\tDecode Base64 encoded string (uses browser's default method if available),\n\tfrom: https://raw.github.com/kvz/phpjs/master/functions/url/base64_decode.js\n\n\t@method atob\n\t@static\n\t@param {String} data String to decode\n\t@return {String} Decoded string\n\t*/\n\tvar atob = function(data, utf8) {\n\t\tif (typeof(window.atob) === 'function') {\n\t\t\treturn utf8 ? utf8_decode(window.atob(data)) : window.atob(data);\n\t\t}\n\n\t\t// http://kevin.vanzonneveld.net\n\t\t// +   original by: Tyler Akins (http://rumkin.com)\n\t\t// +   improved by: Thunder.m\n\t\t// +      input by: Aman Gupta\n\t\t// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n\t\t// +   bugfixed by: Onno Marsman\n\t\t// +   bugfixed by: Pellentesque Malesuada\n\t\t// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n\t\t// +      input by: Brett Zamir (http://brett-zamir.me)\n\t\t// +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n\t\t// *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');\n\t\t// *     returns 1: 'Kevin van Zonneveld'\n\t\t// mozilla has this native\n\t\t// - but breaks in 2.0.0.12!\n\t\t//if (typeof this.window.atob == 'function') {\n\t\t//    return atob(data);\n\t\t//}\n\t\tvar b64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\t\tvar o1, o2, o3, h1, h2, h3, h4, bits, i = 0,\n\t\t\tac = 0,\n\t\t\tdec = \"\",\n\t\t\ttmp_arr = [];\n\n\t\tif (!data) {\n\t\t\treturn data;\n\t\t}\n\n\t\tdata += '';\n\n\t\tdo { // unpack four hexets into three octets using index points in b64\n\t\t\th1 = b64.indexOf(data.charAt(i++));\n\t\t\th2 = b64.indexOf(data.charAt(i++));\n\t\t\th3 = b64.indexOf(data.charAt(i++));\n\t\t\th4 = b64.indexOf(data.charAt(i++));\n\n\t\t\tbits = h1 << 18 | h2 << 12 | h3 << 6 | h4;\n\n\t\t\to1 = bits >> 16 & 0xff;\n\t\t\to2 = bits >> 8 & 0xff;\n\t\t\to3 = bits & 0xff;\n\n\t\t\tif (h3 == 64) {\n\t\t\t\ttmp_arr[ac++] = String.fromCharCode(o1);\n\t\t\t} else if (h4 == 64) {\n\t\t\t\ttmp_arr[ac++] = String.fromCharCode(o1, o2);\n\t\t\t} else {\n\t\t\t\ttmp_arr[ac++] = String.fromCharCode(o1, o2, o3);\n\t\t\t}\n\t\t} while (i < data.length);\n\n\t\tdec = tmp_arr.join('');\n\n\t\treturn utf8 ? utf8_decode(dec) : dec;\n\t};\n\t\n\t/**\n\tBase64 encode string (uses browser's default method if available),\n\tfrom: https://raw.github.com/kvz/phpjs/master/functions/url/base64_encode.js\n\n\t@method btoa\n\t@static\n\t@param {String} data String to encode\n\t@return {String} Base64 encoded string\n\t*/\n\tvar btoa = function(data, utf8) {\n\t\tif (utf8) {\n\t\t\tdata = utf8_encode(data);\n\t\t}\n\n\t\tif (typeof(window.btoa) === 'function') {\n\t\t\treturn window.btoa(data);\n\t\t}\n\n\t\t// http://kevin.vanzonneveld.net\n\t\t// +   original by: Tyler Akins (http://rumkin.com)\n\t\t// +   improved by: Bayron Guevara\n\t\t// +   improved by: Thunder.m\n\t\t// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n\t\t// +   bugfixed by: Pellentesque Malesuada\n\t\t// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n\t\t// +   improved by: Rafał Kukawski (http://kukawski.pl)\n\t\t// *     example 1: base64_encode('Kevin van Zonneveld');\n\t\t// *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='\n\t\t// mozilla has this native\n\t\t// - but breaks in 2.0.0.12!\n\t\tvar b64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\t\tvar o1, o2, o3, h1, h2, h3, h4, bits, i = 0,\n\t\t\tac = 0,\n\t\t\tenc = \"\",\n\t\t\ttmp_arr = [];\n\n\t\tif (!data) {\n\t\t\treturn data;\n\t\t}\n\n\t\tdo { // pack three octets into four hexets\n\t\t\to1 = data.charCodeAt(i++);\n\t\t\to2 = data.charCodeAt(i++);\n\t\t\to3 = data.charCodeAt(i++);\n\n\t\t\tbits = o1 << 16 | o2 << 8 | o3;\n\n\t\t\th1 = bits >> 18 & 0x3f;\n\t\t\th2 = bits >> 12 & 0x3f;\n\t\t\th3 = bits >> 6 & 0x3f;\n\t\t\th4 = bits & 0x3f;\n\n\t\t\t// use hexets to index into b64, and append result to encoded string\n\t\t\ttmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);\n\t\t} while (i < data.length);\n\n\t\tenc = tmp_arr.join('');\n\n\t\tvar r = data.length % 3;\n\n\t\treturn (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);\n\t};\n\n\n\treturn {\n\t\tutf8_encode: utf8_encode,\n\t\tutf8_decode: utf8_decode,\n\t\tatob: atob,\n\t\tbtoa: btoa\n\t};\n});\n\n// Included from: src/javascript/core/utils/Env.js\n\n/**\n * Env.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/core/utils/Env\n@public\n@static\n*/\n\ndefine(\"moxie/core/utils/Env\", [\n\t\"moxie/core/utils/Basic\"\n], function(Basic) {\n\n\t/**\n\t * UAParser.js v0.7.7\n\t * Lightweight JavaScript-based User-Agent string parser\n\t * https://github.com/faisalman/ua-parser-js\n\t *\n\t * Copyright © 2012-2015 Faisal Salman <fyzlman@gmail.com>\n\t * Dual licensed under GPLv2 & MIT\n\t */\n\tvar UAParser = (function (undefined) {\n\n\t    //////////////\n\t    // Constants\n\t    /////////////\n\n\n\t    var EMPTY       = '',\n\t        UNKNOWN     = '?',\n\t        FUNC_TYPE   = 'function',\n\t        UNDEF_TYPE  = 'undefined',\n\t        OBJ_TYPE    = 'object',\n\t        MAJOR       = 'major',\n\t        MODEL       = 'model',\n\t        NAME        = 'name',\n\t        TYPE        = 'type',\n\t        VENDOR      = 'vendor',\n\t        VERSION     = 'version',\n\t        ARCHITECTURE= 'architecture',\n\t        CONSOLE     = 'console',\n\t        MOBILE      = 'mobile',\n\t        TABLET      = 'tablet';\n\n\n\t    ///////////\n\t    // Helper\n\t    //////////\n\n\n\t    var util = {\n\t        has : function (str1, str2) {\n\t            return str2.toLowerCase().indexOf(str1.toLowerCase()) !== -1;\n\t        },\n\t        lowerize : function (str) {\n\t            return str.toLowerCase();\n\t        }\n\t    };\n\n\n\t    ///////////////\n\t    // Map helper\n\t    //////////////\n\n\n\t    var mapper = {\n\n\t        rgx : function () {\n\n\t            // loop through all regexes maps\n\t            for (var result, i = 0, j, k, p, q, matches, match, args = arguments; i < args.length; i += 2) {\n\n\t                var regex = args[i],       // even sequence (0,2,4,..)\n\t                    props = args[i + 1];   // odd sequence (1,3,5,..)\n\n\t                // construct object barebones\n\t                if (typeof(result) === UNDEF_TYPE) {\n\t                    result = {};\n\t                    for (p in props) {\n\t                        q = props[p];\n\t                        if (typeof(q) === OBJ_TYPE) {\n\t                            result[q[0]] = undefined;\n\t                        } else {\n\t                            result[q] = undefined;\n\t                        }\n\t                    }\n\t                }\n\n\t                // try matching uastring with regexes\n\t                for (j = k = 0; j < regex.length; j++) {\n\t                    matches = regex[j].exec(this.getUA());\n\t                    if (!!matches) {\n\t                        for (p = 0; p < props.length; p++) {\n\t                            match = matches[++k];\n\t                            q = props[p];\n\t                            // check if given property is actually array\n\t                            if (typeof(q) === OBJ_TYPE && q.length > 0) {\n\t                                if (q.length == 2) {\n\t                                    if (typeof(q[1]) == FUNC_TYPE) {\n\t                                        // assign modified match\n\t                                        result[q[0]] = q[1].call(this, match);\n\t                                    } else {\n\t                                        // assign given value, ignore regex match\n\t                                        result[q[0]] = q[1];\n\t                                    }\n\t                                } else if (q.length == 3) {\n\t                                    // check whether function or regex\n\t                                    if (typeof(q[1]) === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n\t                                        // call function (usually string mapper)\n\t                                        result[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;\n\t                                    } else {\n\t                                        // sanitize match using given regex\n\t                                        result[q[0]] = match ? match.replace(q[1], q[2]) : undefined;\n\t                                    }\n\t                                } else if (q.length == 4) {\n\t                                        result[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;\n\t                                }\n\t                            } else {\n\t                                result[q] = match ? match : undefined;\n\t                            }\n\t                        }\n\t                        break;\n\t                    }\n\t                }\n\n\t                if(!!matches) break; // break the loop immediately if match found\n\t            }\n\t            return result;\n\t        },\n\n\t        str : function (str, map) {\n\n\t            for (var i in map) {\n\t                // check if array\n\t                if (typeof(map[i]) === OBJ_TYPE && map[i].length > 0) {\n\t                    for (var j = 0; j < map[i].length; j++) {\n\t                        if (util.has(map[i][j], str)) {\n\t                            return (i === UNKNOWN) ? undefined : i;\n\t                        }\n\t                    }\n\t                } else if (util.has(map[i], str)) {\n\t                    return (i === UNKNOWN) ? undefined : i;\n\t                }\n\t            }\n\t            return str;\n\t        }\n\t    };\n\n\n\t    ///////////////\n\t    // String map\n\t    //////////////\n\n\n\t    var maps = {\n\n\t        browser : {\n\t            oldsafari : {\n\t                major : {\n\t                    '1' : ['/8', '/1', '/3'],\n\t                    '2' : '/4',\n\t                    '?' : '/'\n\t                },\n\t                version : {\n\t                    '1.0'   : '/8',\n\t                    '1.2'   : '/1',\n\t                    '1.3'   : '/3',\n\t                    '2.0'   : '/412',\n\t                    '2.0.2' : '/416',\n\t                    '2.0.3' : '/417',\n\t                    '2.0.4' : '/419',\n\t                    '?'     : '/'\n\t                }\n\t            }\n\t        },\n\n\t        device : {\n\t            sprint : {\n\t                model : {\n\t                    'Evo Shift 4G' : '7373KT'\n\t                },\n\t                vendor : {\n\t                    'HTC'       : 'APA',\n\t                    'Sprint'    : 'Sprint'\n\t                }\n\t            }\n\t        },\n\n\t        os : {\n\t            windows : {\n\t                version : {\n\t                    'ME'        : '4.90',\n\t                    'NT 3.11'   : 'NT3.51',\n\t                    'NT 4.0'    : 'NT4.0',\n\t                    '2000'      : 'NT 5.0',\n\t                    'XP'        : ['NT 5.1', 'NT 5.2'],\n\t                    'Vista'     : 'NT 6.0',\n\t                    '7'         : 'NT 6.1',\n\t                    '8'         : 'NT 6.2',\n\t                    '8.1'       : 'NT 6.3',\n\t                    'RT'        : 'ARM'\n\t                }\n\t            }\n\t        }\n\t    };\n\n\n\t    //////////////\n\t    // Regex map\n\t    /////////////\n\n\n\t    var regexes = {\n\n\t        browser : [[\n\n\t            // Presto based\n\t            /(opera\\smini)\\/([\\w\\.-]+)/i,                                       // Opera Mini\n\t            /(opera\\s[mobiletab]+).+version\\/([\\w\\.-]+)/i,                      // Opera Mobi/Tablet\n\t            /(opera).+version\\/([\\w\\.]+)/i,                                     // Opera > 9.80\n\t            /(opera)[\\/\\s]+([\\w\\.]+)/i                                          // Opera < 9.80\n\n\t            ], [NAME, VERSION], [\n\n\t            /\\s(opr)\\/([\\w\\.]+)/i                                               // Opera Webkit\n\t            ], [[NAME, 'Opera'], VERSION], [\n\n\t            // Mixed\n\t            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n\t            /(lunascape|maxthon|netfront|jasmine|blazer)[\\/\\s]?([\\w\\.]+)*/i,\n\t                                                                                // Lunascape/Maxthon/Netfront/Jasmine/Blazer\n\n\t            // Trident based\n\t            /(avant\\s|iemobile|slim|baidu)(?:browser)?[\\/\\s]?([\\w\\.]*)/i,\n\t                                                                                // Avant/IEMobile/SlimBrowser/Baidu\n\t            /(?:ms|\\()(ie)\\s([\\w\\.]+)/i,                                        // Internet Explorer\n\n\t            // Webkit/KHTML based\n\t            /(rekonq)\\/([\\w\\.]+)*/i,                                            // Rekonq\n\t            /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\\/([\\w\\.-]+)/i\n\t                                                                                // Chromium/Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron\n\t            ], [NAME, VERSION], [\n\n\t            /(trident).+rv[:\\s]([\\w\\.]+).+like\\sgecko/i                         // IE11\n\t            ], [[NAME, 'IE'], VERSION], [\n\n\t            /(edge)\\/((\\d+)?[\\w\\.]+)/i                                          // Microsoft Edge\n\t            ], [NAME, VERSION], [\n\n\t            /(yabrowser)\\/([\\w\\.]+)/i                                           // Yandex\n\t            ], [[NAME, 'Yandex'], VERSION], [\n\n\t            /(comodo_dragon)\\/([\\w\\.]+)/i                                       // Comodo Dragon\n\t            ], [[NAME, /_/g, ' '], VERSION], [\n\n\t            /(chrome|omniweb|arora|[tizenoka]{5}\\s?browser)\\/v?([\\w\\.]+)/i,\n\t                                                                                // Chrome/OmniWeb/Arora/Tizen/Nokia\n\t            /(uc\\s?browser|qqbrowser)[\\/\\s]?([\\w\\.]+)/i\n\t                                                                                // UCBrowser/QQBrowser\n\t            ], [NAME, VERSION], [\n\n\t            /(dolfin)\\/([\\w\\.]+)/i                                              // Dolphin\n\t            ], [[NAME, 'Dolphin'], VERSION], [\n\n\t            /((?:android.+)crmo|crios)\\/([\\w\\.]+)/i                             // Chrome for Android/iOS\n\t            ], [[NAME, 'Chrome'], VERSION], [\n\n\t            /XiaoMi\\/MiuiBrowser\\/([\\w\\.]+)/i                                   // MIUI Browser\n\t            ], [VERSION, [NAME, 'MIUI Browser']], [\n\n\t            /android.+version\\/([\\w\\.]+)\\s+(?:mobile\\s?safari|safari)/i         // Android Browser\n\t            ], [VERSION, [NAME, 'Android Browser']], [\n\n\t            /FBAV\\/([\\w\\.]+);/i                                                 // Facebook App for iOS\n\t            ], [VERSION, [NAME, 'Facebook']], [\n\n\t            /version\\/([\\w\\.]+).+?mobile\\/\\w+\\s(safari)/i                       // Mobile Safari\n\t            ], [VERSION, [NAME, 'Mobile Safari']], [\n\n\t            /version\\/([\\w\\.]+).+?(mobile\\s?safari|safari)/i                    // Safari & Safari Mobile\n\t            ], [VERSION, NAME], [\n\n\t            /webkit.+?(mobile\\s?safari|safari)(\\/[\\w\\.]+)/i                     // Safari < 3.0\n\t            ], [NAME, [VERSION, mapper.str, maps.browser.oldsafari.version]], [\n\n\t            /(konqueror)\\/([\\w\\.]+)/i,                                          // Konqueror\n\t            /(webkit|khtml)\\/([\\w\\.]+)/i\n\t            ], [NAME, VERSION], [\n\n\t            // Gecko based\n\t            /(navigator|netscape)\\/([\\w\\.-]+)/i                                 // Netscape\n\t            ], [[NAME, 'Netscape'], VERSION], [\n\t            /(swiftfox)/i,                                                      // Swiftfox\n\t            /(icedragon|iceweasel|camino|chimera|fennec|maemo\\sbrowser|minimo|conkeror)[\\/\\s]?([\\w\\.\\+]+)/i,\n\t                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror\n\t            /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\\/([\\w\\.-]+)/i,\n\t                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n\t            /(mozilla)\\/([\\w\\.]+).+rv\\:.+gecko\\/\\d+/i,                          // Mozilla\n\n\t            // Other\n\t            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\\/\\s]?([\\w\\.]+)/i,\n\t                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf\n\t            /(links)\\s\\(([\\w\\.]+)/i,                                            // Links\n\t            /(gobrowser)\\/?([\\w\\.]+)*/i,                                        // GoBrowser\n\t            /(ice\\s?browser)\\/v?([\\w\\._]+)/i,                                   // ICE Browser\n\t            /(mosaic)[\\/\\s]([\\w\\.]+)/i                                          // Mosaic\n\t            ], [NAME, VERSION]\n\t        ],\n\n\t        engine : [[\n\n\t            /windows.+\\sedge\\/([\\w\\.]+)/i                                       // EdgeHTML\n\t            ], [VERSION, [NAME, 'EdgeHTML']], [\n\n\t            /(presto)\\/([\\w\\.]+)/i,                                             // Presto\n\t            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\\/([\\w\\.]+)/i,     // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m\n\t            /(khtml|tasman|links)[\\/\\s]\\(?([\\w\\.]+)/i,                          // KHTML/Tasman/Links\n\t            /(icab)[\\/\\s]([23]\\.[\\d\\.]+)/i                                      // iCab\n\t            ], [NAME, VERSION], [\n\n\t            /rv\\:([\\w\\.]+).*(gecko)/i                                           // Gecko\n\t            ], [VERSION, NAME]\n\t        ],\n\n\t        os : [[\n\n\t            // Windows based\n\t            /microsoft\\s(windows)\\s(vista|xp)/i                                 // Windows (iTunes)\n\t            ], [NAME, VERSION], [\n\t            /(windows)\\snt\\s6\\.2;\\s(arm)/i,                                     // Windows RT\n\t            /(windows\\sphone(?:\\sos)*|windows\\smobile|windows)[\\s\\/]?([ntce\\d\\.\\s]+\\w)/i\n\t            ], [NAME, [VERSION, mapper.str, maps.os.windows.version]], [\n\t            /(win(?=3|9|n)|win\\s9x\\s)([nt\\d\\.]+)/i\n\t            ], [[NAME, 'Windows'], [VERSION, mapper.str, maps.os.windows.version]], [\n\n\t            // Mobile/Embedded OS\n\t            /\\((bb)(10);/i                                                      // BlackBerry 10\n\t            ], [[NAME, 'BlackBerry'], VERSION], [\n\t            /(blackberry)\\w*\\/?([\\w\\.]+)*/i,                                    // Blackberry\n\t            /(tizen)[\\/\\s]([\\w\\.]+)/i,                                          // Tizen\n\t            /(android|webos|palm\\os|qnx|bada|rim\\stablet\\sos|meego|contiki)[\\/\\s-]?([\\w\\.]+)*/i,\n\t                                                                                // Android/WebOS/Palm/QNX/Bada/RIM/MeeGo/Contiki\n\t            /linux;.+(sailfish);/i                                              // Sailfish OS\n\t            ], [NAME, VERSION], [\n\t            /(symbian\\s?os|symbos|s60(?=;))[\\/\\s-]?([\\w\\.]+)*/i                 // Symbian\n\t            ], [[NAME, 'Symbian'], VERSION], [\n\t            /\\((series40);/i                                                    // Series 40\n\t            ], [NAME], [\n\t            /mozilla.+\\(mobile;.+gecko.+firefox/i                               // Firefox OS\n\t            ], [[NAME, 'Firefox OS'], VERSION], [\n\n\t            // Console\n\t            /(nintendo|playstation)\\s([wids3portablevu]+)/i,                    // Nintendo/Playstation\n\n\t            // GNU/Linux based\n\t            /(mint)[\\/\\s\\(]?(\\w+)*/i,                                           // Mint\n\t            /(mageia|vectorlinux)[;\\s]/i,                                       // Mageia/VectorLinux\n\t            /(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\\/\\s-]?([\\w\\.-]+)*/i,\n\t                                                                                // Joli/Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware\n\t                                                                                // Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus\n\t            /(hurd|linux)\\s?([\\w\\.]+)*/i,                                       // Hurd/Linux\n\t            /(gnu)\\s?([\\w\\.]+)*/i                                               // GNU\n\t            ], [NAME, VERSION], [\n\n\t            /(cros)\\s[\\w]+\\s([\\w\\.]+\\w)/i                                       // Chromium OS\n\t            ], [[NAME, 'Chromium OS'], VERSION],[\n\n\t            // Solaris\n\t            /(sunos)\\s?([\\w\\.]+\\d)*/i                                           // Solaris\n\t            ], [[NAME, 'Solaris'], VERSION], [\n\n\t            // BSD based\n\t            /\\s([frentopc-]{0,4}bsd|dragonfly)\\s?([\\w\\.]+)*/i                   // FreeBSD/NetBSD/OpenBSD/PC-BSD/DragonFly\n\t            ], [NAME, VERSION],[\n\n\t            /(ip[honead]+)(?:.*os\\s*([\\w]+)*\\slike\\smac|;\\sopera)/i             // iOS\n\t            ], [[NAME, 'iOS'], [VERSION, /_/g, '.']], [\n\n\t            /(mac\\sos\\sx)\\s?([\\w\\s\\.]+\\w)*/i,\n\t            /(macintosh|mac(?=_powerpc)\\s)/i                                    // Mac OS\n\t            ], [[NAME, 'Mac OS'], [VERSION, /_/g, '.']], [\n\n\t            // Other\n\t            /((?:open)?solaris)[\\/\\s-]?([\\w\\.]+)*/i,                            // Solaris\n\t            /(haiku)\\s(\\w+)/i,                                                  // Haiku\n\t            /(aix)\\s((\\d)(?=\\.|\\)|\\s)[\\w\\.]*)*/i,                               // AIX\n\t            /(plan\\s9|minix|beos|os\\/2|amigaos|morphos|risc\\sos|openvms)/i,\n\t                                                                                // Plan9/Minix/BeOS/OS2/AmigaOS/MorphOS/RISCOS/OpenVMS\n\t            /(unix)\\s?([\\w\\.]+)*/i                                              // UNIX\n\t            ], [NAME, VERSION]\n\t        ]\n\t    };\n\n\n\t    /////////////////\n\t    // Constructor\n\t    ////////////////\n\n\n\t    var UAParser = function (uastring) {\n\n\t        var ua = uastring || ((window && window.navigator && window.navigator.userAgent) ? window.navigator.userAgent : EMPTY);\n\n\t        this.getBrowser = function () {\n\t            return mapper.rgx.apply(this, regexes.browser);\n\t        };\n\t        this.getEngine = function () {\n\t            return mapper.rgx.apply(this, regexes.engine);\n\t        };\n\t        this.getOS = function () {\n\t            return mapper.rgx.apply(this, regexes.os);\n\t        };\n\t        this.getResult = function() {\n\t            return {\n\t                ua      : this.getUA(),\n\t                browser : this.getBrowser(),\n\t                engine  : this.getEngine(),\n\t                os      : this.getOS()\n\t            };\n\t        };\n\t        this.getUA = function () {\n\t            return ua;\n\t        };\n\t        this.setUA = function (uastring) {\n\t            ua = uastring;\n\t            return this;\n\t        };\n\t        this.setUA(ua);\n\t    };\n\n\t    return UAParser;\n\t})();\n\n\n\tfunction version_compare(v1, v2, operator) {\n\t  // From: http://phpjs.org/functions\n\t  // +      original by: Philippe Jausions (http://pear.php.net/user/jausions)\n\t  // +      original by: Aidan Lister (http://aidanlister.com/)\n\t  // + reimplemented by: Kankrelune (http://www.webfaktory.info/)\n\t  // +      improved by: Brett Zamir (http://brett-zamir.me)\n\t  // +      improved by: Scott Baker\n\t  // +      improved by: Theriault\n\t  // *        example 1: version_compare('8.2.5rc', '8.2.5a');\n\t  // *        returns 1: 1\n\t  // *        example 2: version_compare('8.2.50', '8.2.52', '<');\n\t  // *        returns 2: true\n\t  // *        example 3: version_compare('5.3.0-dev', '5.3.0');\n\t  // *        returns 3: -1\n\t  // *        example 4: version_compare('4.1.0.52','4.01.0.51');\n\t  // *        returns 4: 1\n\n\t  // Important: compare must be initialized at 0.\n\t  var i = 0,\n\t    x = 0,\n\t    compare = 0,\n\t    // vm maps textual PHP versions to negatives so they're less than 0.\n\t    // PHP currently defines these as CASE-SENSITIVE. It is important to\n\t    // leave these as negatives so that they can come before numerical versions\n\t    // and as if no letters were there to begin with.\n\t    // (1alpha is < 1 and < 1.1 but > 1dev1)\n\t    // If a non-numerical value can't be mapped to this table, it receives\n\t    // -7 as its value.\n\t    vm = {\n\t      'dev': -6,\n\t      'alpha': -5,\n\t      'a': -5,\n\t      'beta': -4,\n\t      'b': -4,\n\t      'RC': -3,\n\t      'rc': -3,\n\t      '#': -2,\n\t      'p': 1,\n\t      'pl': 1\n\t    },\n\t    // This function will be called to prepare each version argument.\n\t    // It replaces every _, -, and + with a dot.\n\t    // It surrounds any nonsequence of numbers/dots with dots.\n\t    // It replaces sequences of dots with a single dot.\n\t    //    version_compare('4..0', '4.0') == 0\n\t    // Important: A string of 0 length needs to be converted into a value\n\t    // even less than an unexisting value in vm (-7), hence [-8].\n\t    // It's also important to not strip spaces because of this.\n\t    //   version_compare('', ' ') == 1\n\t    prepVersion = function (v) {\n\t      v = ('' + v).replace(/[_\\-+]/g, '.');\n\t      v = v.replace(/([^.\\d]+)/g, '.$1.').replace(/\\.{2,}/g, '.');\n\t      return (!v.length ? [-8] : v.split('.'));\n\t    },\n\t    // This converts a version component to a number.\n\t    // Empty component becomes 0.\n\t    // Non-numerical component becomes a negative number.\n\t    // Numerical component becomes itself as an integer.\n\t    numVersion = function (v) {\n\t      return !v ? 0 : (isNaN(v) ? vm[v] || -7 : parseInt(v, 10));\n\t    };\n\n\t  v1 = prepVersion(v1);\n\t  v2 = prepVersion(v2);\n\t  x = Math.max(v1.length, v2.length);\n\t  for (i = 0; i < x; i++) {\n\t    if (v1[i] == v2[i]) {\n\t      continue;\n\t    }\n\t    v1[i] = numVersion(v1[i]);\n\t    v2[i] = numVersion(v2[i]);\n\t    if (v1[i] < v2[i]) {\n\t      compare = -1;\n\t      break;\n\t    } else if (v1[i] > v2[i]) {\n\t      compare = 1;\n\t      break;\n\t    }\n\t  }\n\t  if (!operator) {\n\t    return compare;\n\t  }\n\n\t  // Important: operator is CASE-SENSITIVE.\n\t  // \"No operator\" seems to be treated as \"<.\"\n\t  // Any other values seem to make the function return null.\n\t  switch (operator) {\n\t  case '>':\n\t  case 'gt':\n\t    return (compare > 0);\n\t  case '>=':\n\t  case 'ge':\n\t    return (compare >= 0);\n\t  case '<=':\n\t  case 'le':\n\t    return (compare <= 0);\n\t  case '==':\n\t  case '=':\n\t  case 'eq':\n\t    return (compare === 0);\n\t  case '<>':\n\t  case '!=':\n\t  case 'ne':\n\t    return (compare !== 0);\n\t  case '':\n\t  case '<':\n\t  case 'lt':\n\t    return (compare < 0);\n\t  default:\n\t    return null;\n\t  }\n\t}\n\n\n\tvar can = (function() {\n\t\tvar caps = {\n\t\t\taccess_global_ns: function () {\n\t\t\t\treturn !!window.moxie;\n\t\t\t},\n\n\t\t\tdefine_property: (function() {\n\t\t\t\t/* // currently too much extra code required, not exactly worth it\n\t\t\t\ttry { // as of IE8, getters/setters are supported only on DOM elements\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tif (Object.defineProperty) {\n\t\t\t\t\t\tObject.defineProperty(obj, 'prop', {\n\t\t\t\t\t\t\tenumerable: true,\n\t\t\t\t\t\t\tconfigurable: true\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} catch(ex) {}\n\n\t\t\t\tif (Object.prototype.__defineGetter__ && Object.prototype.__defineSetter__) {\n\t\t\t\t\treturn true;\n\t\t\t\t}*/\n\t\t\t\treturn false;\n\t\t\t}()),\n\n\t\t\tcreate_canvas: function() {\n\t\t\t\t// On the S60 and BB Storm, getContext exists, but always returns undefined\n\t\t\t\t// so we actually have to call getContext() to verify\n\t\t\t\t// github.com/Modernizr/Modernizr/issues/issue/97/\n\t\t\t\tvar el = document.createElement('canvas');\n\t\t\t\tvar isSupported = !!(el.getContext && el.getContext('2d'));\n\t\t\t\tcaps.create_canvas = isSupported;\n\t\t\t\treturn isSupported;\n\t\t\t},\n\n\t\t\treturn_response_type: function(responseType) {\n\t\t\t\ttry {\n\t\t\t\t\tif (Basic.inArray(responseType, ['', 'text', 'document']) !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (window.XMLHttpRequest) {\n\t\t\t\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\t\t\t\txhr.open('get', '/'); // otherwise Gecko throws an exception\n\t\t\t\t\t\tif ('responseType' in xhr) {\n\t\t\t\t\t\t\txhr.responseType = responseType;\n\t\t\t\t\t\t\t// as of 23.0.1271.64, Chrome switched from throwing exception to merely logging it to the console (why? o why?)\n\t\t\t\t\t\t\tif (xhr.responseType !== responseType) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (ex) {}\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tuse_blob_uri: function() {\n\t\t\t\tvar URL = window.URL;\n\t\t\t\tcaps.use_blob_uri = (URL &&\n\t\t\t\t\t'createObjectURL' in URL &&\n\t\t\t\t\t'revokeObjectURL' in URL &&\n\t\t\t\t\t(Env.browser !== 'IE' || Env.verComp(Env.version, '11.0.46', '>=')) // IE supports createObjectURL, but not fully, for example it fails to use it as a src for the image\n\t\t\t\t);\n\t\t\t\treturn caps.use_blob_uri;\n\t\t\t},\n\n\t\t\t// ideas for this heavily come from Modernizr (http://modernizr.com/)\n\t\t\tuse_data_uri: (function() {\n\t\t\t\tvar du = new Image();\n\n\t\t\t\tdu.onload = function() {\n\t\t\t\t\tcaps.use_data_uri = (du.width === 1 && du.height === 1);\n\t\t\t\t};\n\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tdu.src = \"data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==\";\n\t\t\t\t}, 1);\n\t\t\t\treturn false;\n\t\t\t}()),\n\n\t\t\tuse_data_uri_over32kb: function() { // IE8\n\t\t\t\treturn caps.use_data_uri && (Env.browser !== 'IE' || Env.version >= 9);\n\t\t\t},\n\n\t\t\tuse_data_uri_of: function(bytes) {\n\t\t\t\treturn (caps.use_data_uri && bytes < 33000 || caps.use_data_uri_over32kb());\n\t\t\t},\n\n\t\t\tuse_fileinput: function() {\n\t\t\t\tif (navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\\/(1.0|2.0|2.5|3.0))/)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar el = document.createElement('input');\n\t\t\t\tel.setAttribute('type', 'file');\n\t\t\t\treturn caps.use_fileinput = !el.disabled;\n\t\t\t},\n\n\t\t\tuse_webgl: function() {\n\t\t\t\tvar canvas = document.createElement('canvas');\n\t\t\t\tvar gl = null, isSupported;\n\t\t\t\ttry {\n\t\t\t\t\tgl = canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\n\t\t\t\t}\n\t\t\t\tcatch(e) {}\n\n\t\t\t\tif (!gl) { // it seems that sometimes it doesn't throw exception, but still fails to get context\n\t\t\t\t\tgl = null;\n\t\t\t\t}\n\n\t\t\t\tisSupported = !!gl;\n\t\t\t\tcaps.use_webgl = isSupported; // save result of our check\n\t\t\t\tcanvas = undefined;\n\t\t\t\treturn isSupported;\n\t\t\t}\n\t\t};\n\n\t\treturn function(cap) {\n\t\t\tvar args = [].slice.call(arguments);\n\t\t\targs.shift(); // shift of cap\n\t\t\treturn Basic.typeOf(caps[cap]) === 'function' ? caps[cap].apply(this, args) : !!caps[cap];\n\t\t};\n\t}());\n\n\n\tvar uaResult = new UAParser().getResult();\n\n\n\tvar Env = {\n\t\tcan: can,\n\n\t\tuaParser: UAParser,\n\n\t\tbrowser: uaResult.browser.name,\n\t\tversion: uaResult.browser.version,\n\t\tos: uaResult.os.name, // everybody intuitively types it in a lowercase for some reason\n\t\tosVersion: uaResult.os.version,\n\n\t\tverComp: version_compare,\n\n\t\tswf_url: \"../flash/Moxie.swf\",\n\t\txap_url: \"../silverlight/Moxie.xap\",\n\t\tglobal_event_dispatcher: \"moxie.core.EventTarget.instance.dispatchEvent\"\n\t};\n\n\t// for backward compatibility\n\t// @deprecated Use `Env.os` instead\n\tEnv.OS = Env.os;\n\n\tif (MXI_DEBUG) {\n\t\tEnv.debug = {\n\t\t\truntime: true,\n\t\t\tevents: false\n\t\t};\n\n\t\tEnv.log = function() {\n\n\t\t\tfunction logObj(data) {\n\t\t\t\t// TODO: this should recursively print out the object in a pretty way\n\t\t\t\tconsole.appendChild(document.createTextNode(data + \"\\n\"));\n\t\t\t}\n\n\t\t\t// if debugger present, IE8 might have window.console.log method, but not be able to apply on it (why...)\n\t\t\tif (window && window.console && window.console.log && window.console.log.apply) {\n\t\t\t\twindow.console.log.apply(window.console, arguments);\n\t\t\t} else if (document) {\n\t\t\t\tvar console = document.getElementById('moxie-console');\n\t\t\t\tif (!console) {\n\t\t\t\t\tconsole = document.createElement('pre');\n\t\t\t\t\tconsole.id = 'moxie-console';\n\t\t\t\t\t//console.style.display = 'none';\n\t\t\t\t\tdocument.body.appendChild(console);\n\t\t\t\t}\n\n\t\t\t\tvar data = arguments[0];\n\t\t\t\tif (Basic.typeOf(data) === 'string') {\n\t\t\t\t\tdata = Basic.sprintf.apply(this, arguments);\n\t\t\t\t} else if (Basic.inArray(Basic.typeOf(data), ['object', 'array']) !== -1) {\n\t\t\t\t\tlogObj(data);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconsole.appendChild(document.createTextNode(data + \"\\n\"));\n\t\t\t}\n\t\t};\n\t}\n\n\treturn Env;\n});\n\n// Included from: src/javascript/core/Exceptions.js\n\n/**\n * Exceptions.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/core/Exceptions', [\n\t'moxie/core/utils/Basic'\n], function(Basic) {\n\t\n\tfunction _findKey(obj, value) {\n\t\tvar key;\n\t\tfor (key in obj) {\n\t\t\tif (obj[key] === value) {\n\t\t\t\treturn key;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t@class moxie/core/Exception\n\t*/\n\treturn {\n\t\tRuntimeError: (function() {\n\t\t\tvar namecodes = {\n\t\t\t\tNOT_INIT_ERR: 1,\n\t\t\t\tEXCEPTION_ERR: 3,\n\t\t\t\tNOT_SUPPORTED_ERR: 9,\n\t\t\t\tJS_ERR: 4\n\t\t\t};\n\n\t\t\tfunction RuntimeError(code, message) {\n\t\t\t\tthis.code = code;\n\t\t\t\tthis.name = _findKey(namecodes, code);\n\t\t\t\tthis.message = this.name + (message || \": RuntimeError \" + this.code);\n\t\t\t}\n\t\t\t\n\t\t\tBasic.extend(RuntimeError, namecodes);\n\t\t\tRuntimeError.prototype = Error.prototype;\n\t\t\treturn RuntimeError;\n\t\t}()),\n\t\t\n\t\tOperationNotAllowedException: (function() {\n\t\t\t\n\t\t\tfunction OperationNotAllowedException(code) {\n\t\t\t\tthis.code = code;\n\t\t\t\tthis.name = 'OperationNotAllowedException';\n\t\t\t}\n\t\t\t\n\t\t\tBasic.extend(OperationNotAllowedException, {\n\t\t\t\tNOT_ALLOWED_ERR: 1\n\t\t\t});\n\t\t\t\n\t\t\tOperationNotAllowedException.prototype = Error.prototype;\n\t\t\t\n\t\t\treturn OperationNotAllowedException;\n\t\t}()),\n\n\t\tImageError: (function() {\n\t\t\tvar namecodes = {\n\t\t\t\tWRONG_FORMAT: 1,\n\t\t\t\tMAX_RESOLUTION_ERR: 2,\n\t\t\t\tINVALID_META_ERR: 3\n\t\t\t};\n\n\t\t\tfunction ImageError(code) {\n\t\t\t\tthis.code = code;\n\t\t\t\tthis.name = _findKey(namecodes, code);\n\t\t\t\tthis.message = this.name + \": ImageError \" + this.code;\n\t\t\t}\n\t\t\t\n\t\t\tBasic.extend(ImageError, namecodes);\n\t\t\tImageError.prototype = Error.prototype;\n\n\t\t\treturn ImageError;\n\t\t}()),\n\n\t\tFileException: (function() {\n\t\t\tvar namecodes = {\n\t\t\t\tNOT_FOUND_ERR: 1,\n\t\t\t\tSECURITY_ERR: 2,\n\t\t\t\tABORT_ERR: 3,\n\t\t\t\tNOT_READABLE_ERR: 4,\n\t\t\t\tENCODING_ERR: 5,\n\t\t\t\tNO_MODIFICATION_ALLOWED_ERR: 6,\n\t\t\t\tINVALID_STATE_ERR: 7,\n\t\t\t\tSYNTAX_ERR: 8\n\t\t\t};\n\n\t\t\tfunction FileException(code) {\n\t\t\t\tthis.code = code;\n\t\t\t\tthis.name = _findKey(namecodes, code);\n\t\t\t\tthis.message = this.name + \": FileException \" + this.code;\n\t\t\t}\n\t\t\t\n\t\t\tBasic.extend(FileException, namecodes);\n\t\t\tFileException.prototype = Error.prototype;\n\t\t\treturn FileException;\n\t\t}()),\n\t\t\n\t\tDOMException: (function() {\n\t\t\tvar namecodes = {\n\t\t\t\tINDEX_SIZE_ERR: 1,\n\t\t\t\tDOMSTRING_SIZE_ERR: 2,\n\t\t\t\tHIERARCHY_REQUEST_ERR: 3,\n\t\t\t\tWRONG_DOCUMENT_ERR: 4,\n\t\t\t\tINVALID_CHARACTER_ERR: 5,\n\t\t\t\tNO_DATA_ALLOWED_ERR: 6,\n\t\t\t\tNO_MODIFICATION_ALLOWED_ERR: 7,\n\t\t\t\tNOT_FOUND_ERR: 8,\n\t\t\t\tNOT_SUPPORTED_ERR: 9,\n\t\t\t\tINUSE_ATTRIBUTE_ERR: 10,\n\t\t\t\tINVALID_STATE_ERR: 11,\n\t\t\t\tSYNTAX_ERR: 12,\n\t\t\t\tINVALID_MODIFICATION_ERR: 13,\n\t\t\t\tNAMESPACE_ERR: 14,\n\t\t\t\tINVALID_ACCESS_ERR: 15,\n\t\t\t\tVALIDATION_ERR: 16,\n\t\t\t\tTYPE_MISMATCH_ERR: 17,\n\t\t\t\tSECURITY_ERR: 18,\n\t\t\t\tNETWORK_ERR: 19,\n\t\t\t\tABORT_ERR: 20,\n\t\t\t\tURL_MISMATCH_ERR: 21,\n\t\t\t\tQUOTA_EXCEEDED_ERR: 22,\n\t\t\t\tTIMEOUT_ERR: 23,\n\t\t\t\tINVALID_NODE_TYPE_ERR: 24,\n\t\t\t\tDATA_CLONE_ERR: 25\n\t\t\t};\n\n\t\t\tfunction DOMException(code) {\n\t\t\t\tthis.code = code;\n\t\t\t\tthis.name = _findKey(namecodes, code);\n\t\t\t\tthis.message = this.name + \": DOMException \" + this.code;\n\t\t\t}\n\t\t\t\n\t\t\tBasic.extend(DOMException, namecodes);\n\t\t\tDOMException.prototype = Error.prototype;\n\t\t\treturn DOMException;\n\t\t}()),\n\t\t\n\t\tEventException: (function() {\n\t\t\tfunction EventException(code) {\n\t\t\t\tthis.code = code;\n\t\t\t\tthis.name = 'EventException';\n\t\t\t}\n\t\t\t\n\t\t\tBasic.extend(EventException, {\n\t\t\t\tUNSPECIFIED_EVENT_TYPE_ERR: 0\n\t\t\t});\n\t\t\t\n\t\t\tEventException.prototype = Error.prototype;\n\t\t\t\n\t\t\treturn EventException;\n\t\t}())\n\t};\n});\n\n// Included from: src/javascript/core/utils/Dom.js\n\n/**\n * Dom.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/core/utils/Dom\n@public\n@static\n*/\n\ndefine('moxie/core/utils/Dom', ['moxie/core/utils/Env'], function(Env) {\n\n\t/**\n\tGet DOM Element by it's id.\n\n\t@method get\n\t@param {String} id Identifier of the DOM Element\n\t@return {DOMElement}\n\t*/\n\tvar get = function(id) {\n\t\tif (typeof id !== 'string') {\n\t\t\treturn id;\n\t\t}\n\t\treturn document.getElementById(id);\n\t};\n\n\t/**\n\tChecks if specified DOM element has specified class.\n\n\t@method hasClass\n\t@static\n\t@param {Object} obj DOM element like object to add handler to.\n\t@param {String} name Class name\n\t*/\n\tvar hasClass = function(obj, name) {\n\t\tif (!obj.className) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar regExp = new RegExp(\"(^|\\\\s+)\"+name+\"(\\\\s+|$)\");\n\t\treturn regExp.test(obj.className);\n\t};\n\n\t/**\n\tAdds specified className to specified DOM element.\n\n\t@method addClass\n\t@static\n\t@param {Object} obj DOM element like object to add handler to.\n\t@param {String} name Class name\n\t*/\n\tvar addClass = function(obj, name) {\n\t\tif (!hasClass(obj, name)) {\n\t\t\tobj.className = !obj.className ? name : obj.className.replace(/\\s+$/, '') + ' ' + name;\n\t\t}\n\t};\n\n\t/**\n\tRemoves specified className from specified DOM element.\n\n\t@method removeClass\n\t@static\n\t@param {Object} obj DOM element like object to add handler to.\n\t@param {String} name Class name\n\t*/\n\tvar removeClass = function(obj, name) {\n\t\tif (obj.className) {\n\t\t\tvar regExp = new RegExp(\"(^|\\\\s+)\"+name+\"(\\\\s+|$)\");\n\t\t\tobj.className = obj.className.replace(regExp, function($0, $1, $2) {\n\t\t\t\treturn $1 === ' ' && $2 === ' ' ? ' ' : '';\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n\tReturns a given computed style of a DOM element.\n\n\t@method getStyle\n\t@static\n\t@param {Object} obj DOM element like object.\n\t@param {String} name Style you want to get from the DOM element\n\t*/\n\tvar getStyle = function(obj, name) {\n\t\tif (obj.currentStyle) {\n\t\t\treturn obj.currentStyle[name];\n\t\t} else if (window.getComputedStyle) {\n\t\t\treturn window.getComputedStyle(obj, null)[name];\n\t\t}\n\t};\n\n\n\t/**\n\tReturns the absolute x, y position of an Element. The position will be returned in a object with x, y fields.\n\n\t@method getPos\n\t@static\n\t@param {Element} node HTML element or element id to get x, y position from.\n\t@param {Element} root Optional root element to stop calculations at.\n\t@return {object} Absolute position of the specified element object with x, y fields.\n\t*/\n\tvar getPos = function(node, root) {\n\t\tvar x = 0, y = 0, parent, doc = document, nodeRect, rootRect;\n\n\t\tnode = node;\n\t\troot = root || doc.body;\n\n\t\t// Returns the x, y cordinate for an element on IE 6 and IE 7\n\t\tfunction getIEPos(node) {\n\t\t\tvar bodyElm, rect, x = 0, y = 0;\n\n\t\t\tif (node) {\n\t\t\t\trect = node.getBoundingClientRect();\n\t\t\t\tbodyElm = doc.compatMode === \"CSS1Compat\" ? doc.documentElement : doc.body;\n\t\t\t\tx = rect.left + bodyElm.scrollLeft;\n\t\t\t\ty = rect.top + bodyElm.scrollTop;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tx : x,\n\t\t\t\ty : y\n\t\t\t};\n\t\t}\n\n\t\t// Use getBoundingClientRect on IE 6 and IE 7 but not on IE 8 in standards mode\n\t\tif (node && node.getBoundingClientRect && Env.browser === 'IE' && (!doc.documentMode || doc.documentMode < 8)) {\n\t\t\tnodeRect = getIEPos(node);\n\t\t\trootRect = getIEPos(root);\n\n\t\t\treturn {\n\t\t\t\tx : nodeRect.x - rootRect.x,\n\t\t\t\ty : nodeRect.y - rootRect.y\n\t\t\t};\n\t\t}\n\n\t\tparent = node;\n\t\twhile (parent && parent != root && parent.nodeType) {\n\t\t\tx += parent.offsetLeft || 0;\n\t\t\ty += parent.offsetTop || 0;\n\t\t\tparent = parent.offsetParent;\n\t\t}\n\n\t\tparent = node.parentNode;\n\t\twhile (parent && parent != root && parent.nodeType) {\n\t\t\tx -= parent.scrollLeft || 0;\n\t\t\ty -= parent.scrollTop || 0;\n\t\t\tparent = parent.parentNode;\n\t\t}\n\n\t\treturn {\n\t\t\tx : x,\n\t\t\ty : y\n\t\t};\n\t};\n\n\t/**\n\tReturns the size of the specified node in pixels.\n\n\t@method getSize\n\t@static\n\t@param {Node} node Node to get the size of.\n\t@return {Object} Object with a w and h property.\n\t*/\n\tvar getSize = function(node) {\n\t\treturn {\n\t\t\tw : node.offsetWidth || node.clientWidth,\n\t\t\th : node.offsetHeight || node.clientHeight\n\t\t};\n\t};\n\n\treturn {\n\t\tget: get,\n\t\thasClass: hasClass,\n\t\taddClass: addClass,\n\t\tremoveClass: removeClass,\n\t\tgetStyle: getStyle,\n\t\tgetPos: getPos,\n\t\tgetSize: getSize\n\t};\n});\n\n// Included from: src/javascript/core/EventTarget.js\n\n/**\n * EventTarget.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/core/EventTarget', [\n\t'moxie/core/utils/Env',\n\t'moxie/core/Exceptions',\n\t'moxie/core/utils/Basic'\n], function(Env, x, Basic) {\n\n\t// hash of event listeners by object uid\n\tvar eventpool = {};\n\n\t/**\n\tParent object for all event dispatching components and objects\n\n\t@class moxie/core/EventTarget\n\t@constructor EventTarget\n\t*/\n\tfunction EventTarget() {\n\t\t/**\n\t\tUnique id of the event dispatcher, usually overriden by children\n\n\t\t@property uid\n\t\t@type String\n\t\t*/\n\t\tthis.uid = Basic.guid();\n\t}\n\n\n\tBasic.extend(EventTarget.prototype, {\n\n\t\t/**\n\t\tCan be called from within a child  in order to acquire uniqie id in automated manner\n\n\t\t@method init\n\t\t*/\n\t\tinit: function() {\n\t\t\tif (!this.uid) {\n\t\t\t\tthis.uid = Basic.guid('uid_');\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\tRegister a handler to a specific event dispatched by the object\n\n\t\t@method addEventListener\n\t\t@param {String} type Type or basically a name of the event to subscribe to\n\t\t@param {Function} fn Callback function that will be called when event happens\n\t\t@param {Number} [priority=0] Priority of the event handler - handlers with higher priorities will be called first\n\t\t@param {Object} [scope=this] A scope to invoke event handler in\n\t\t*/\n\t\taddEventListener: function(type, fn, priority, scope) {\n\t\t\tvar self = this, list;\n\n\t\t\t// without uid no event handlers can be added, so make sure we got one\n\t\t\tif (!this.hasOwnProperty('uid')) {\n\t\t\t\tthis.uid = Basic.guid('uid_');\n\t\t\t}\n\n\t\t\ttype = Basic.trim(type);\n\n\t\t\tif (/\\s/.test(type)) {\n\t\t\t\t// multiple event types were passed for one handler\n\t\t\t\tBasic.each(type.split(/\\s+/), function(type) {\n\t\t\t\t\tself.addEventListener(type, fn, priority, scope);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttype = type.toLowerCase();\n\t\t\tpriority = parseInt(priority, 10) || 0;\n\n\t\t\tlist = eventpool[this.uid] && eventpool[this.uid][type] || [];\n\t\t\tlist.push({fn : fn, priority : priority, scope : scope || this});\n\n\t\t\tif (!eventpool[this.uid]) {\n\t\t\t\teventpool[this.uid] = {};\n\t\t\t}\n\t\t\teventpool[this.uid][type] = list;\n\t\t},\n\n\t\t/**\n\t\tCheck if any handlers were registered to the specified event\n\n\t\t@method hasEventListener\n\t\t@param {String} [type] Type or basically a name of the event to check\n\t\t@return {Mixed} Returns a handler if it was found and false, if - not\n\t\t*/\n\t\thasEventListener: function(type) {\n\t\t\tvar list;\n\t\t\tif (type) {\n\t\t\t\ttype = type.toLowerCase();\n\t\t\t\tlist = eventpool[this.uid] && eventpool[this.uid][type];\n\t\t\t} else {\n\t\t\t\tlist = eventpool[this.uid];\n\t\t\t}\n\t\t\treturn list ? list : false;\n\t\t},\n\n\t\t/**\n\t\tUnregister the handler from the event, or if former was not specified - unregister all handlers\n\n\t\t@method removeEventListener\n\t\t@param {String} type Type or basically a name of the event\n\t\t@param {Function} [fn] Handler to unregister\n\t\t*/\n\t\tremoveEventListener: function(type, fn) {\n\t\t\tvar self = this, list, i;\n\n\t\t\ttype = type.toLowerCase();\n\n\t\t\tif (/\\s/.test(type)) {\n\t\t\t\t// multiple event types were passed for one handler\n\t\t\t\tBasic.each(type.split(/\\s+/), function(type) {\n\t\t\t\t\tself.removeEventListener(type, fn);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlist = eventpool[this.uid] && eventpool[this.uid][type];\n\n\t\t\tif (list) {\n\t\t\t\tif (fn) {\n\t\t\t\t\tfor (i = list.length - 1; i >= 0; i--) {\n\t\t\t\t\t\tif (list[i].fn === fn) {\n\t\t\t\t\t\t\tlist.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlist = [];\n\t\t\t\t}\n\n\t\t\t\t// delete event list if it has become empty\n\t\t\t\tif (!list.length) {\n\t\t\t\t\tdelete eventpool[this.uid][type];\n\n\t\t\t\t\t// and object specific entry in a hash if it has no more listeners attached\n\t\t\t\t\tif (Basic.isEmptyObj(eventpool[this.uid])) {\n\t\t\t\t\t\tdelete eventpool[this.uid];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\tRemove all event handlers from the object\n\n\t\t@method removeAllEventListeners\n\t\t*/\n\t\tremoveAllEventListeners: function() {\n\t\t\tif (eventpool[this.uid]) {\n\t\t\t\tdelete eventpool[this.uid];\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\tDispatch the event\n\n\t\t@method dispatchEvent\n\t\t@param {String/Object} Type of event or event object to dispatch\n\t\t@param {Mixed} [...] Variable number of arguments to be passed to a handlers\n\t\t@return {Boolean} true by default and false if any handler returned false\n\t\t*/\n\t\tdispatchEvent: function(type) {\n\t\t\tvar uid, list, args, tmpEvt, evt = {}, result = true, undef;\n\n\t\t\tif (Basic.typeOf(type) !== 'string') {\n\t\t\t\t// we can't use original object directly (because of Silverlight)\n\t\t\t\ttmpEvt = type;\n\n\t\t\t\tif (Basic.typeOf(tmpEvt.type) === 'string') {\n\t\t\t\t\ttype = tmpEvt.type;\n\n\t\t\t\t\tif (tmpEvt.total !== undef && tmpEvt.loaded !== undef) { // progress event\n\t\t\t\t\t\tevt.total = tmpEvt.total;\n\t\t\t\t\t\tevt.loaded = tmpEvt.loaded;\n\t\t\t\t\t}\n\t\t\t\t\tevt.async = tmpEvt.async || false;\n\t\t\t\t} else {\n\t\t\t\t\tthrow new x.EventException(x.EventException.UNSPECIFIED_EVENT_TYPE_ERR);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// check if event is meant to be dispatched on an object having specific uid\n\t\t\tif (type.indexOf('::') !== -1) {\n\t\t\t\t(function(arr) {\n\t\t\t\t\tuid = arr[0];\n\t\t\t\t\ttype = arr[1];\n\t\t\t\t}(type.split('::')));\n\t\t\t} else {\n\t\t\t\tuid = this.uid;\n\t\t\t}\n\n\t\t\ttype = type.toLowerCase();\n\n\t\t\tlist = eventpool[uid] && eventpool[uid][type];\n\n\t\t\tif (list) {\n\t\t\t\t// sort event list by prority\n\t\t\t\tlist.sort(function(a, b) { return b.priority - a.priority; });\n\n\t\t\t\targs = [].slice.call(arguments);\n\n\t\t\t\t// first argument will be pseudo-event object\n\t\t\t\targs.shift();\n\t\t\t\tevt.type = type;\n\t\t\t\targs.unshift(evt);\n\n\t\t\t\tif (MXI_DEBUG && Env.debug.events) {\n\t\t\t\t\tEnv.log(\"%cEvent '%s' fired on %s\", 'color: #999;', evt.type, (this.ctorName ? this.ctorName + '::' : '') + uid);\n\t\t\t\t}\n\n\t\t\t\t// Dispatch event to all listeners\n\t\t\t\tvar queue = [];\n\t\t\t\tBasic.each(list, function(handler) {\n\t\t\t\t\t// explicitly set the target, otherwise events fired from shims do not get it\n\t\t\t\t\targs[0].target = handler.scope;\n\t\t\t\t\t// if event is marked as async, detach the handler\n\t\t\t\t\tif (evt.async) {\n\t\t\t\t\t\tqueue.push(function(cb) {\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tcb(handler.fn.apply(handler.scope, args) === false);\n\t\t\t\t\t\t\t}, 1);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tqueue.push(function(cb) {\n\t\t\t\t\t\t\tcb(handler.fn.apply(handler.scope, args) === false); // if handler returns false stop propagation\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (queue.length) {\n\t\t\t\t\tBasic.inSeries(queue, function(err) {\n\t\t\t\t\t\tresult = !err;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\n\t\t/**\n\t\tRegister a handler to the event type that will run only once\n\n\t\t@method bindOnce\n\t\t@since >1.4.1\n\t\t@param {String} type Type or basically a name of the event to subscribe to\n\t\t@param {Function} fn Callback function that will be called when event happens\n\t\t@param {Number} [priority=0] Priority of the event handler - handlers with higher priorities will be called first\n\t\t@param {Object} [scope=this] A scope to invoke event handler in\n\t\t*/\n\t\tbindOnce: function(type, fn, priority, scope) {\n\t\t\tvar self = this;\n\t\t\tself.bind.call(this, type, function cb() {\n\t\t\t\tself.unbind(type, cb);\n\t\t\t\treturn fn.apply(this, arguments);\n\t\t\t}, priority, scope);\n\t\t},\n\n\t\t/**\n\t\tAlias for addEventListener\n\n\t\t@method bind\n\t\t@protected\n\t\t*/\n\t\tbind: function() {\n\t\t\tthis.addEventListener.apply(this, arguments);\n\t\t},\n\n\t\t/**\n\t\tAlias for removeEventListener\n\n\t\t@method unbind\n\t\t@protected\n\t\t*/\n\t\tunbind: function() {\n\t\t\tthis.removeEventListener.apply(this, arguments);\n\t\t},\n\n\t\t/**\n\t\tAlias for removeAllEventListeners\n\n\t\t@method unbindAll\n\t\t@protected\n\t\t*/\n\t\tunbindAll: function() {\n\t\t\tthis.removeAllEventListeners.apply(this, arguments);\n\t\t},\n\n\t\t/**\n\t\tAlias for dispatchEvent\n\n\t\t@method trigger\n\t\t@protected\n\t\t*/\n\t\ttrigger: function() {\n\t\t\treturn this.dispatchEvent.apply(this, arguments);\n\t\t},\n\n\n\t\t/**\n\t\tHandle properties of on[event] type.\n\n\t\t@method handleEventProps\n\t\t@private\n\t\t*/\n\t\thandleEventProps: function(dispatches) {\n\t\t\tvar self = this;\n\n\t\t\tthis.bind(dispatches.join(' '), function(e) {\n\t\t\t\tvar prop = 'on' + e.type.toLowerCase();\n\t\t\t\tif (Basic.typeOf(this[prop]) === 'function') {\n\t\t\t\t\tthis[prop].apply(this, arguments);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// object must have defined event properties, even if it doesn't make use of them\n\t\t\tBasic.each(dispatches, function(prop) {\n\t\t\t\tprop = 'on' + prop.toLowerCase(prop);\n\t\t\t\tif (Basic.typeOf(self[prop]) === 'undefined') {\n\t\t\t\t\tself[prop] = null;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t});\n\n\n\tEventTarget.instance = new EventTarget();\n\n\treturn EventTarget;\n});\n\n// Included from: src/javascript/runtime/Runtime.js\n\n/**\n * Runtime.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/runtime/Runtime', [\n\t\"moxie/core/utils/Env\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/EventTarget\"\n], function(Env, Basic, Dom, EventTarget) {\n\tvar runtimeConstructors = {}, runtimes = {};\n\n\t/**\n\tCommon set of methods and properties for every runtime instance\n\n\t@class moxie/runtime/Runtime\n\n\t@param {Object} options\n\t@param {String} type Sanitized name of the runtime\n\t@param {Object} [caps] Set of capabilities that differentiate specified runtime\n\t@param {Object} [modeCaps] Set of capabilities that do require specific operational mode\n\t@param {String} [preferredMode='browser'] Preferred operational mode to choose if no required capabilities were requested\n\t*/\n\tfunction Runtime(options, type, caps, modeCaps, preferredMode) {\n\t\t/**\n\t\tDispatched when runtime is initialized and ready.\n\t\tResults in RuntimeInit on a connected component.\n\n\t\t@event Init\n\t\t*/\n\n\t\t/**\n\t\tDispatched when runtime fails to initialize.\n\t\tResults in RuntimeError on a connected component.\n\n\t\t@event Error\n\t\t*/\n\n\t\tvar self = this\n\t\t, _shim\n\t\t, _uid = Basic.guid(type + '_')\n\t\t, defaultMode = preferredMode || 'browser'\n\t\t;\n\n\t\toptions = options || {};\n\n\t\t// register runtime in private hash\n\t\truntimes[_uid] = this;\n\n\t\t/**\n\t\tDefault set of capabilities, which can be redifined later by specific runtime\n\n\t\t@private\n\t\t@property caps\n\t\t@type Object\n\t\t*/\n\t\tcaps = Basic.extend({\n\t\t\t// Runtime can: \n\t\t\t// provide access to raw binary data of the file\n\t\t\taccess_binary: false,\n\t\t\t// provide access to raw binary data of the image (image extension is optional) \n\t\t\taccess_image_binary: false,\n\t\t\t// display binary data as thumbs for example\n\t\t\tdisplay_media: false,\n\t\t\t// make cross-domain requests\n\t\t\tdo_cors: false,\n\t\t\t// accept files dragged and dropped from the desktop\n\t\t\tdrag_and_drop: false,\n\t\t\t// filter files in selection dialog by their extensions\n\t\t\tfilter_by_extension: true,\n\t\t\t// resize image (and manipulate it raw data of any file in general)\n\t\t\tresize_image: false,\n\t\t\t// periodically report how many bytes of total in the file were uploaded (loaded)\n\t\t\treport_upload_progress: false,\n\t\t\t// provide access to the headers of http response \n\t\t\treturn_response_headers: false,\n\t\t\t// support response of specific type, which should be passed as an argument\n\t\t\t// e.g. runtime.can('return_response_type', 'blob')\n\t\t\treturn_response_type: false,\n\t\t\t// return http status code of the response\n\t\t\treturn_status_code: true,\n\t\t\t// send custom http header with the request\n\t\t\tsend_custom_headers: false,\n\t\t\t// pick up the files from a dialog\n\t\t\tselect_file: false,\n\t\t\t// select whole folder in file browse dialog\n\t\t\tselect_folder: false,\n\t\t\t// select multiple files at once in file browse dialog\n\t\t\tselect_multiple: true,\n\t\t\t// send raw binary data, that is generated after image resizing or manipulation of other kind\n\t\t\tsend_binary_string: false,\n\t\t\t// send cookies with http request and therefore retain session\n\t\t\tsend_browser_cookies: true,\n\t\t\t// send data formatted as multipart/form-data\n\t\t\tsend_multipart: true,\n\t\t\t// slice the file or blob to smaller parts\n\t\t\tslice_blob: false,\n\t\t\t// upload file without preloading it to memory, stream it out directly from disk\n\t\t\tstream_upload: false,\n\t\t\t// programmatically trigger file browse dialog\n\t\t\tsummon_file_dialog: false,\n\t\t\t// upload file of specific size, size should be passed as argument\n\t\t\t// e.g. runtime.can('upload_filesize', '500mb')\n\t\t\tupload_filesize: true,\n\t\t\t// initiate http request with specific http method, method should be passed as argument\n\t\t\t// e.g. runtime.can('use_http_method', 'put')\n\t\t\tuse_http_method: true\n\t\t}, caps);\n\t\t\t\n\t\n\t\t// default to the mode that is compatible with preferred caps\n\t\tif (options.preferred_caps) {\n\t\t\tdefaultMode = Runtime.getMode(modeCaps, options.preferred_caps, defaultMode);\n\t\t}\n\n\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\tEnv.log(\"\\tdefault mode: %s\", defaultMode);\t\n\t\t}\n\t\t\n\t\t// small extension factory here (is meant to be extended with actual extensions constructors)\n\t\t_shim = (function() {\n\t\t\tvar objpool = {};\n\t\t\treturn {\n\t\t\t\texec: function(uid, comp, fn, args) {\n\t\t\t\t\tif (_shim[comp]) {\n\t\t\t\t\t\tif (!objpool[uid]) {\n\t\t\t\t\t\t\tobjpool[uid] = {\n\t\t\t\t\t\t\t\tcontext: this,\n\t\t\t\t\t\t\t\tinstance: new _shim[comp]()\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (objpool[uid].instance[fn]) {\n\t\t\t\t\t\t\treturn objpool[uid].instance[fn].apply(this, args);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tremoveInstance: function(uid) {\n\t\t\t\t\tdelete objpool[uid];\n\t\t\t\t},\n\n\t\t\t\tremoveAllInstances: function() {\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tBasic.each(objpool, function(obj, uid) {\n\t\t\t\t\t\tif (Basic.typeOf(obj.instance.destroy) === 'function') {\n\t\t\t\t\t\t\tobj.instance.destroy.call(obj.context);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.removeInstance(uid);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}());\n\n\n\t\t// public methods\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tSpecifies whether runtime instance was initialized or not\n\n\t\t\t@property initialized\n\t\t\t@type {Boolean}\n\t\t\t@default false\n\t\t\t*/\n\t\t\tinitialized: false, // shims require this flag to stop initialization retries\n\n\t\t\t/**\n\t\t\tUnique ID of the runtime\n\n\t\t\t@property uid\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\tuid: _uid,\n\n\t\t\t/**\n\t\t\tRuntime type (e.g. flash, html5, etc)\n\n\t\t\t@property type\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\ttype: type,\n\n\t\t\t/**\n\t\t\tRuntime (not native one) may operate in browser or client mode.\n\n\t\t\t@property mode\n\t\t\t@private\n\t\t\t@type {String|Boolean} current mode or false, if none possible\n\t\t\t*/\n\t\t\tmode: Runtime.getMode(modeCaps, (options.required_caps), defaultMode),\n\n\t\t\t/**\n\t\t\tid of the DOM container for the runtime (if available)\n\n\t\t\t@property shimid\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\tshimid: _uid + '_container',\n\n\t\t\t/**\n\t\t\tNumber of connected clients. If equal to zero, runtime can be destroyed\n\n\t\t\t@property clients\n\t\t\t@type {Number}\n\t\t\t*/\n\t\t\tclients: 0,\n\n\t\t\t/**\n\t\t\tRuntime initialization options\n\n\t\t\t@property options\n\t\t\t@type {Object}\n\t\t\t*/\n\t\t\toptions: options,\n\n\t\t\t/**\n\t\t\tChecks if the runtime has specific capability\n\n\t\t\t@method can\n\t\t\t@param {String} cap Name of capability to check\n\t\t\t@param {Mixed} [value] If passed, capability should somehow correlate to the value\n\t\t\t@param {Object} [refCaps] Set of capabilities to check the specified cap against (defaults to internal set)\n\t\t\t@return {Boolean} true if runtime has such capability and false, if - not\n\t\t\t*/\n\t\t\tcan: function(cap, value) {\n\t\t\t\tvar refCaps = arguments[2] || caps;\n\n\t\t\t\t// if cap var is a comma-separated list of caps, convert it to object (key/value)\n\t\t\t\tif (Basic.typeOf(cap) === 'string' && Basic.typeOf(value) === 'undefined') {\n\t\t\t\t\tcap = Runtime.parseCaps(cap);\n\t\t\t\t}\n\n\t\t\t\tif (Basic.typeOf(cap) === 'object') {\n\t\t\t\t\tfor (var key in cap) {\n\t\t\t\t\t\tif (!this.can(key, cap[key], refCaps)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t// check the individual cap\n\t\t\t\tif (Basic.typeOf(refCaps[cap]) === 'function') {\n\t\t\t\t\treturn refCaps[cap].call(this, value);\n\t\t\t\t} else {\n\t\t\t\t\treturn (value === refCaps[cap]);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\tReturns container for the runtime as DOM element\n\n\t\t\t@method getShimContainer\n\t\t\t@return {DOMElement}\n\t\t\t*/\n\t\t\tgetShimContainer: function() {\n\t\t\t\tvar container, shimContainer = Dom.get(this.shimid);\n\n\t\t\t\t// if no container for shim, create one\n\t\t\t\tif (!shimContainer) {\n\t\t\t\t\tcontainer = Dom.get(this.options.container) || document.body;\n\n\t\t\t\t\t// create shim container and insert it at an absolute position into the outer container\n\t\t\t\t\tshimContainer = document.createElement('div');\n\t\t\t\t\tshimContainer.id = this.shimid;\n\t\t\t\t\tshimContainer.className = 'moxie-shim moxie-shim-' + this.type;\n\n\t\t\t\t\tBasic.extend(shimContainer.style, {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: '0px',\n\t\t\t\t\t\tleft: '0px',\n\t\t\t\t\t\twidth: '1px',\n\t\t\t\t\t\theight: '1px',\n\t\t\t\t\t\toverflow: 'hidden'\n\t\t\t\t\t});\n\n\t\t\t\t\tcontainer.appendChild(shimContainer);\n\t\t\t\t\tcontainer = null;\n\t\t\t\t}\n\n\t\t\t\treturn shimContainer;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tReturns runtime as DOM element (if appropriate)\n\n\t\t\t@method getShim\n\t\t\t@return {DOMElement}\n\t\t\t*/\n\t\t\tgetShim: function() {\n\t\t\t\treturn _shim;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tInvokes a method within the runtime itself (might differ across the runtimes)\n\n\t\t\t@method shimExec\n\t\t\t@param {Mixed} []\n\t\t\t@protected\n\t\t\t@return {Mixed} Depends on the action and component\n\t\t\t*/\n\t\t\tshimExec: function(component, action) {\n\t\t\t\tvar args = [].slice.call(arguments, 2);\n\t\t\t\treturn self.getShim().exec.call(this, this.uid, component, action, args);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tOperaional interface that is used by components to invoke specific actions on the runtime\n\t\t\t(is invoked in the scope of component)\n\n\t\t\t@method exec\n\t\t\t@param {Mixed} []*\n\t\t\t@protected\n\t\t\t@return {Mixed} Depends on the action and component\n\t\t\t*/\n\t\t\texec: function(component, action) { // this is called in the context of component, not runtime\n\t\t\t\tvar args = [].slice.call(arguments, 2);\n\n\t\t\t\tif (self[component] && self[component][action]) {\n\t\t\t\t\treturn self[component][action].apply(this, args);\n\t\t\t\t}\n\t\t\t\treturn self.shimExec.apply(this, arguments);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tDestroys the runtime (removes all events and deletes DOM structures)\n\n\t\t\t@method destroy\n\t\t\t*/\n\t\t\tdestroy: function() {\n\t\t\t\tif (!self) {\n\t\t\t\t\treturn; // obviously already destroyed\n\t\t\t\t}\n\n\t\t\t\tvar shimContainer = Dom.get(this.shimid);\n\t\t\t\tif (shimContainer) {\n\t\t\t\t\tshimContainer.parentNode.removeChild(shimContainer);\n\t\t\t\t}\n\n\t\t\t\tif (_shim) {\n\t\t\t\t\t_shim.removeAllInstances();\n\t\t\t\t}\n\n\t\t\t\tthis.unbindAll();\n\t\t\t\tdelete runtimes[this.uid];\n\t\t\t\tthis.uid = null; // mark this runtime as destroyed\n\t\t\t\t_uid = self = _shim = shimContainer = null;\n\t\t\t}\n\t\t});\n\n\t\t// once we got the mode, test against all caps\n\t\tif (this.mode && options.required_caps && !this.can(options.required_caps)) {\n\t\t\tthis.mode = false;\n\t\t}\t\n\t}\n\n\n\t/**\n\tDefault order to try different runtime types\n\n\t@property order\n\t@type String\n\t@static\n\t*/\n\tRuntime.order = 'html5,flash,silverlight,html4';\n\n\n\t/**\n\tRetrieves runtime from private hash by it's uid\n\n\t@method getRuntime\n\t@private\n\t@static\n\t@param {String} uid Unique identifier of the runtime\n\t@return {Runtime|Boolean} Returns runtime, if it exists and false, if - not\n\t*/\n\tRuntime.getRuntime = function(uid) {\n\t\treturn runtimes[uid] ? runtimes[uid] : false;\n\t};\n\n\n\t/**\n\tRegister constructor for the Runtime of new (or perhaps modified) type\n\n\t@method addConstructor\n\t@static\n\t@param {String} type Runtime type (e.g. flash, html5, etc)\n\t@param {Function} construct Constructor for the Runtime type\n\t*/\n\tRuntime.addConstructor = function(type, constructor) {\n\t\tconstructor.prototype = EventTarget.instance;\n\t\truntimeConstructors[type] = constructor;\n\t};\n\n\n\t/**\n\tGet the constructor for the specified type.\n\n\tmethod getConstructor\n\t@static\n\t@param {String} type Runtime type (e.g. flash, html5, etc)\n\t@return {Function} Constructor for the Runtime type\n\t*/\n\tRuntime.getConstructor = function(type) {\n\t\treturn runtimeConstructors[type] || null;\n\t};\n\n\n\t/**\n\tGet info about the runtime (uid, type, capabilities)\n\n\t@method getInfo\n\t@static\n\t@param {String} uid Unique identifier of the runtime\n\t@return {Mixed} Info object or null if runtime doesn't exist\n\t*/\n\tRuntime.getInfo = function(uid) {\n\t\tvar runtime = Runtime.getRuntime(uid);\n\n\t\tif (runtime) {\n\t\t\treturn {\n\t\t\t\tuid: runtime.uid,\n\t\t\t\ttype: runtime.type,\n\t\t\t\tmode: runtime.mode,\n\t\t\t\tcan: function() {\n\t\t\t\t\treturn runtime.can.apply(runtime, arguments);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\treturn null;\n\t};\n\n\n\t/**\n\tConvert caps represented by a comma-separated string to the object representation.\n\n\t@method parseCaps\n\t@static\n\t@param {String} capStr Comma-separated list of capabilities\n\t@return {Object}\n\t*/\n\tRuntime.parseCaps = function(capStr) {\n\t\tvar capObj = {};\n\n\t\tif (Basic.typeOf(capStr) !== 'string') {\n\t\t\treturn capStr || {};\n\t\t}\n\n\t\tBasic.each(capStr.split(','), function(key) {\n\t\t\tcapObj[key] = true; // we assume it to be - true\n\t\t});\n\n\t\treturn capObj;\n\t};\n\n\t/**\n\tTest the specified runtime for specific capabilities.\n\n\t@method can\n\t@static\n\t@param {String} type Runtime type (e.g. flash, html5, etc)\n\t@param {String|Object} caps Set of capabilities to check\n\t@return {Boolean} Result of the test\n\t*/\n\tRuntime.can = function(type, caps) {\n\t\tvar runtime\n\t\t, constructor = Runtime.getConstructor(type)\n\t\t, mode\n\t\t;\n\t\tif (constructor) {\n\t\t\truntime = new constructor({\n\t\t\t\trequired_caps: caps\n\t\t\t});\n\t\t\tmode = runtime.mode;\n\t\t\truntime.destroy();\n\t\t\treturn !!mode;\n\t\t}\n\t\treturn false;\n\t};\n\n\n\t/**\n\tFigure out a runtime that supports specified capabilities.\n\n\t@method thatCan\n\t@static\n\t@param {String|Object} caps Set of capabilities to check\n\t@param {String} [runtimeOrder] Comma-separated list of runtimes to check against\n\t@return {String} Usable runtime identifier or null\n\t*/\n\tRuntime.thatCan = function(caps, runtimeOrder) {\n\t\tvar types = (runtimeOrder || Runtime.order).split(/\\s*,\\s*/);\n\t\tfor (var i in types) {\n\t\t\tif (Runtime.can(types[i], caps)) {\n\t\t\t\treturn types[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\n\t/**\n\tFigure out an operational mode for the specified set of capabilities.\n\n\t@method getMode\n\t@static\n\t@param {Object} modeCaps Set of capabilities that depend on particular runtime mode\n\t@param {Object} [requiredCaps] Supplied set of capabilities to find operational mode for\n\t@param {String|Boolean} [defaultMode='browser'] Default mode to use \n\t@return {String|Boolean} Compatible operational mode\n\t*/\n\tRuntime.getMode = function(modeCaps, requiredCaps, defaultMode) {\n\t\tvar mode = null;\n\n\t\tif (Basic.typeOf(defaultMode) === 'undefined') { // only if not specified\n\t\t\tdefaultMode = 'browser';\n\t\t}\n\n\t\tif (requiredCaps && !Basic.isEmptyObj(modeCaps)) {\n\t\t\t// loop over required caps and check if they do require the same mode\n\t\t\tBasic.each(requiredCaps, function(value, cap) {\n\t\t\t\tif (modeCaps.hasOwnProperty(cap)) {\n\t\t\t\t\tvar capMode = modeCaps[cap](value);\n\n\t\t\t\t\t// make sure we always have an array\n\t\t\t\t\tif (typeof(capMode) === 'string') {\n\t\t\t\t\t\tcapMode = [capMode];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!mode) {\n\t\t\t\t\t\tmode = capMode;\t\t\t\t\t\t\n\t\t\t\t\t} else if (!(mode = Basic.arrayIntersect(mode, capMode))) {\n\t\t\t\t\t\t// if cap requires conflicting mode - runtime cannot fulfill required caps\n\n\t\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\t\tEnv.log(\"\\t\\t%s: %s (conflicting mode requested: %s)\", cap, value, capMode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn (mode = false);\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\tEnv.log(\"\\t\\t%s: %s (compatible modes: %s)\", cap, value, mode);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (mode) {\n\t\t\t\treturn Basic.inArray(defaultMode, mode) !== -1 ? defaultMode : mode[0];\n\t\t\t} else if (mode === false) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn defaultMode; \n\t};\n\n\n\t/**\n\t * Third party shims (Flash and Silverlight) require global event target against which they\n\t * will fire their events. However when moxie is not loaded to global namespace, default\n\t * event target is not accessible and we have to create artificial ones.\n\t *\n\t * @method getGlobalEventTarget\n\t * @static\n\t * @return {String} Name of the global event target\n\t */\n\tRuntime.getGlobalEventTarget = function() {\n\t\tif (/^moxie\\./.test(Env.global_event_dispatcher) && !Env.can('access_global_ns')) {\n\t\t\tvar uniqueCallbackName = Basic.guid('moxie_event_target_');\n\n\t\t\twindow[uniqueCallbackName] = function(e, data) {\n\t\t\t\tEventTarget.instance.dispatchEvent(e, data);\n\t\t\t};\n\n\t\t\tEnv.global_event_dispatcher = uniqueCallbackName;\n\t\t}\n\n\t\treturn Env.global_event_dispatcher;\n\t};\n\n\n\t/**\n\tCapability check that always returns true\n\n\t@private\n\t@static\n\t@return {True}\n\t*/\n\tRuntime.capTrue = function() {\n\t\treturn true;\n\t};\n\n\t/**\n\tCapability check that always returns false\n\n\t@private\n\t@static\n\t@return {False}\n\t*/\n\tRuntime.capFalse = function() {\n\t\treturn false;\n\t};\n\n\t/**\n\tEvaluate the expression to boolean value and create a function that always returns it.\n\n\t@private\n\t@static\n\t@param {Mixed} expr Expression to evaluate\n\t@return {Function} Function returning the result of evaluation\n\t*/\n\tRuntime.capTest = function(expr) {\n\t\treturn function() {\n\t\t\treturn !!expr;\n\t\t};\n\t};\n\n\treturn Runtime;\n});\n\n// Included from: src/javascript/runtime/RuntimeClient.js\n\n/**\n * RuntimeClient.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/runtime/RuntimeClient', [\n\t'moxie/core/utils/Env',\n\t'moxie/core/Exceptions',\n\t'moxie/core/utils/Basic',\n\t'moxie/runtime/Runtime'\n], function(Env, x, Basic, Runtime) {\n\t/**\n\tSet of methods and properties, required by a component to acquire ability to connect to a runtime\n\n\t@class moxie/runtime/RuntimeClient\n\t*/\n\treturn function RuntimeClient() {\n\t\tvar runtime;\n\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tConnects to the runtime specified by the options. Will either connect to existing runtime or create a new one.\n\t\t\tIncrements number of clients connected to the specified runtime.\n\n\t\t\t@private\n\t\t\t@method connectRuntime\n\t\t\t@param {Mixed} options Can be a runtme uid or a set of key-value pairs defining requirements and pre-requisites\n\t\t\t*/\n\t\t\tconnectRuntime: function(options) {\n\t\t\t\tvar comp = this, ruid;\n\n\t\t\t\tfunction initialize(items) {\n\t\t\t\t\tvar type, constructor;\n\n\t\t\t\t\t// if we ran out of runtimes\n\t\t\t\t\tif (!items.length) {\n\t\t\t\t\t\tcomp.trigger('RuntimeError', new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR));\n\t\t\t\t\t\truntime = null;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\ttype = items.shift().toLowerCase();\n\t\t\t\t\tconstructor = Runtime.getConstructor(type);\n\t\t\t\t\tif (!constructor) {\n\t\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\t\tEnv.log(\"Constructor for '%s' runtime is not available.\", type);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinitialize(items);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\tEnv.log(\"Trying runtime: %s\", type);\n\t\t\t\t\t\tEnv.log(options);\n\t\t\t\t\t}\n\n\t\t\t\t\t// try initializing the runtime\n\t\t\t\t\truntime = new constructor(options);\n\n\t\t\t\t\truntime.bind('Init', function() {\n\t\t\t\t\t\t// mark runtime as initialized\n\t\t\t\t\t\truntime.initialized = true;\n\n\t\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\t\tEnv.log(\"Runtime '%s' initialized\", runtime.type);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// jailbreak ...\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\truntime.clients++;\n\t\t\t\t\t\t\tcomp.ruid = runtime.uid;\n\t\t\t\t\t\t\t// this will be triggered on component\n\t\t\t\t\t\t\tcomp.trigger('RuntimeInit', runtime);\n\t\t\t\t\t\t}, 1);\n\t\t\t\t\t});\n\n\t\t\t\t\truntime.bind('Error', function() {\n\t\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\t\tEnv.log(\"Runtime '%s' failed to initialize\", runtime.type);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\truntime.destroy(); // runtime cannot destroy itself from inside at a right moment, thus we do it here\n\t\t\t\t\t\tinitialize(items);\n\t\t\t\t\t});\n\n\t\t\t\t\truntime.bind('Exception', function(e, err) {\n\t\t\t\t\t\tvar message = err.name + \"(#\" + err.code + \")\" + (err.message ? \", from: \" + err.message : '');\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\t\tEnv.log(\"Runtime '%s' has thrown an exception: %s\", this.type, message);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcomp.trigger('RuntimeError', new x.RuntimeError(x.RuntimeError.EXCEPTION_ERR, message));\n\t\t\t\t\t});\n\n\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\tEnv.log(\"\\tselected mode: %s\", runtime.mode);\t\n\t\t\t\t\t}\n\n\t\t\t\t\t// check if runtime managed to pick-up operational mode\n\t\t\t\t\tif (!runtime.mode) {\n\t\t\t\t\t\truntime.trigger('Error');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\truntime.init();\n\t\t\t\t}\n\n\t\t\t\t// check if a particular runtime was requested\n\t\t\t\tif (Basic.typeOf(options) === 'string') {\n\t\t\t\t\truid = options;\n\t\t\t\t} else if (Basic.typeOf(options.ruid) === 'string') {\n\t\t\t\t\truid = options.ruid;\n\t\t\t\t}\n\n\t\t\t\tif (ruid) {\n\t\t\t\t\truntime = Runtime.getRuntime(ruid);\n\t\t\t\t\tif (runtime) {\n\t\t\t\t\t\tcomp.ruid = ruid;\n\t\t\t\t\t\truntime.clients++;\n\t\t\t\t\t\treturn runtime;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// there should be a runtime and there's none - weird case\n\t\t\t\t\t\tthrow new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// initialize a fresh one, that fits runtime list and required features best\n\t\t\t\tinitialize((options.runtime_order || Runtime.order).split(/\\s*,\\s*/));\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\tDisconnects from the runtime. Decrements number of clients connected to the specified runtime.\n\n\t\t\t@private\n\t\t\t@method disconnectRuntime\n\t\t\t*/\n\t\t\tdisconnectRuntime: function() {\n\t\t\t\tif (runtime && --runtime.clients <= 0) {\n\t\t\t\t\truntime.destroy();\n\t\t\t\t}\n\n\t\t\t\t// once the component is disconnected, it shouldn't have access to the runtime\n\t\t\t\truntime = null;\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\tReturns the runtime to which the client is currently connected.\n\n\t\t\t@method getRuntime\n\t\t\t@return {Runtime} Runtime or null if client is not connected\n\t\t\t*/\n\t\t\tgetRuntime: function() {\n\t\t\t\tif (runtime && runtime.uid) {\n\t\t\t\t\treturn runtime;\n\t\t\t\t}\n\t\t\t\treturn runtime = null; // make sure we do not leave zombies rambling around\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\tHandy shortcut to safely invoke runtime extension methods.\n\t\t\t\n\t\t\t@private\n\t\t\t@method exec\n\t\t\t@return {Mixed} Whatever runtime extension method returns\n\t\t\t*/\n\t\t\texec: function() {\n\t\t\t\treturn runtime ? runtime.exec.apply(this, arguments) : null;\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\tTest runtime client for specific capability\n\t\t\t\n\t\t\t@method can\n\t\t\t@param {String} cap\n\t\t\t@return {Bool}\n\t\t\t*/\n\t\t\tcan: function(cap) {\n\t\t\t\treturn runtime ? runtime.can(cap) : false;\n\t\t\t}\n\n\t\t});\n\t};\n\n\n});\n\n// Included from: src/javascript/file/Blob.js\n\n/**\n * Blob.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/file/Blob', [\n\t'moxie/core/utils/Basic',\n\t'moxie/core/utils/Encode',\n\t'moxie/runtime/RuntimeClient'\n], function(Basic, Encode, RuntimeClient) {\n\t\n\tvar blobpool = {};\n\n\t/**\n\t@class moxie/file/Blob\n\t@constructor\n\t@param {String} ruid Unique id of the runtime, to which this blob belongs to\n\t@param {Object} blob Object \"Native\" blob object, as it is represented in the runtime\n\t*/\n\tfunction Blob(ruid, blob) {\n\n\t\tfunction _sliceDetached(start, end, type) {\n\t\t\tvar blob, data = blobpool[this.uid];\n\n\t\t\tif (Basic.typeOf(data) !== 'string' || !data.length) {\n\t\t\t\treturn null; // or throw exception\n\t\t\t}\n\n\t\t\tblob = new Blob(null, {\n\t\t\t\ttype: type,\n\t\t\t\tsize: end - start\n\t\t\t});\n\t\t\tblob.detach(data.substr(start, blob.size));\n\n\t\t\treturn blob;\n\t\t}\n\n\t\tRuntimeClient.call(this);\n\n\t\tif (ruid) {\t\n\t\t\tthis.connectRuntime(ruid);\n\t\t}\n\n\t\tif (!blob) {\n\t\t\tblob = {};\n\t\t} else if (Basic.typeOf(blob) === 'string') { // dataUrl or binary string\n\t\t\tblob = { data: blob };\n\t\t}\n\n\t\tBasic.extend(this, {\n\t\t\t\n\t\t\t/**\n\t\t\tUnique id of the component\n\n\t\t\t@property uid\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\tuid: blob.uid || Basic.guid('uid_'),\n\t\t\t\n\t\t\t/**\n\t\t\tUnique id of the connected runtime, if falsy, then runtime will have to be initialized \n\t\t\tbefore this Blob can be used, modified or sent\n\n\t\t\t@property ruid\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\truid: ruid,\n\t\n\t\t\t/**\n\t\t\tSize of blob\n\n\t\t\t@property size\n\t\t\t@type {Number}\n\t\t\t@default 0\n\t\t\t*/\n\t\t\tsize: blob.size || 0,\n\t\t\t\n\t\t\t/**\n\t\t\tMime type of blob\n\n\t\t\t@property type\n\t\t\t@type {String}\n\t\t\t@default ''\n\t\t\t*/\n\t\t\ttype: blob.type || '',\n\t\t\t\n\t\t\t/**\n\t\t\t@method slice\n\t\t\t@param {Number} [start=0]\n\t\t\t*/\n\t\t\tslice: function(start, end, type) {\t\t\n\t\t\t\tif (this.isDetached()) {\n\t\t\t\t\treturn _sliceDetached.apply(this, arguments);\n\t\t\t\t}\n\t\t\t\treturn this.getRuntime().exec.call(this, 'Blob', 'slice', this.getSource(), start, end, type);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tReturns \"native\" blob object (as it is represented in connected runtime) or null if not found\n\n\t\t\t@method getSource\n\t\t\t@return {Blob} Returns \"native\" blob object or null if not found\n\t\t\t*/\n\t\t\tgetSource: function() {\n\t\t\t\tif (!blobpool[this.uid]) {\n\t\t\t\t\treturn null;\t\n\t\t\t\t}\n\t\t\t\treturn blobpool[this.uid];\n\t\t\t},\n\n\t\t\t/** \n\t\t\tDetaches blob from any runtime that it depends on and initialize with standalone value\n\n\t\t\t@method detach\n\t\t\t@protected\n\t\t\t@param {DOMString} [data=''] Standalone value\n\t\t\t*/\n\t\t\tdetach: function(data) {\n\t\t\t\tif (this.ruid) {\n\t\t\t\t\tthis.getRuntime().exec.call(this, 'Blob', 'destroy');\n\t\t\t\t\tthis.disconnectRuntime();\n\t\t\t\t\tthis.ruid = null;\n\t\t\t\t}\n\n\t\t\t\tdata = data || '';\n\n\t\t\t\t// if dataUrl, convert to binary string\n\t\t\t\tif (data.substr(0, 5) == 'data:') {\n\t\t\t\t\tvar base64Offset = data.indexOf(';base64,');\n\t\t\t\t\tthis.type = data.substring(5, base64Offset);\n\t\t\t\t\tdata = Encode.atob(data.substring(base64Offset + 8));\n\t\t\t\t}\n\n\t\t\t\tthis.size = data.length;\n\n\t\t\t\tblobpool[this.uid] = data;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tChecks if blob is standalone (detached of any runtime)\n\t\t\t\n\t\t\t@method isDetached\n\t\t\t@protected\n\t\t\t@return {Boolean}\n\t\t\t*/\n\t\t\tisDetached: function() {\n\t\t\t\treturn !this.ruid && Basic.typeOf(blobpool[this.uid]) === 'string';\n\t\t\t},\n\t\t\t\n\t\t\t/** \n\t\t\tDestroy Blob and free any resources it was using\n\n\t\t\t@method destroy\n\t\t\t*/\n\t\t\tdestroy: function() {\n\t\t\t\tthis.detach();\n\t\t\t\tdelete blobpool[this.uid];\n\t\t\t}\n\t\t});\n\n\t\t\n\t\tif (blob.data) {\n\t\t\tthis.detach(blob.data); // auto-detach if payload has been passed\n\t\t} else {\n\t\t\tblobpool[this.uid] = blob;\t\n\t\t}\n\t}\n\t\n\treturn Blob;\n});\n\n// Included from: src/javascript/core/I18n.js\n\n/**\n * I18n.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine(\"moxie/core/I18n\", [\n\t\"moxie/core/utils/Basic\"\n], function(Basic) {\n\tvar i18n = {};\n\n\t/**\n\t@class moxie/core/I18n\n\t*/\n\treturn {\n\t\t/**\n\t\t * Extends the language pack object with new items.\n\t\t *\n\t\t * @param {Object} pack Language pack items to add.\n\t\t * @return {Object} Extended language pack object.\n\t\t */\n\t\taddI18n: function(pack) {\n\t\t\treturn Basic.extend(i18n, pack);\n\t\t},\n\n\t\t/**\n\t\t * Translates the specified string by checking for the english string in the language pack lookup.\n\t\t *\n\t\t * @param {String} str String to look for.\n\t\t * @return {String} Translated string or the input string if it wasn't found.\n\t\t */\n\t\ttranslate: function(str) {\n\t\t\treturn i18n[str] || str;\n\t\t},\n\n\t\t/**\n\t\t * Shortcut for translate function\n\t\t *\n\t\t * @param {String} str String to look for.\n\t\t * @return {String} Translated string or the input string if it wasn't found.\n\t\t */\n\t\t_: function(str) {\n\t\t\treturn this.translate(str);\n\t\t},\n\n\t\t/**\n\t\t * Pseudo sprintf implementation - simple way to replace tokens with specified values.\n\t\t *\n\t\t * @param {String} str String with tokens\n\t\t * @return {String} String with replaced tokens\n\t\t */\n\t\tsprintf: function(str) {\n\t\t\tvar args = [].slice.call(arguments, 1);\n\n\t\t\treturn str.replace(/%[a-z]/g, function() {\n\t\t\t\tvar value = args.shift();\n\t\t\t\treturn Basic.typeOf(value) !== 'undefined' ? value : '';\n\t\t\t});\n\t\t}\n\t};\n});\n\n// Included from: src/javascript/core/utils/Mime.js\n\n/**\n * Mime.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/core/utils/Mime\n@public\n@static\n*/\n\ndefine(\"moxie/core/utils/Mime\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/I18n\"\n], function(Basic, I18n) {\n\n\tvar mimeData = \"\" +\n\t\t\"application/msword,doc dot,\" +\n\t\t\"application/pdf,pdf,\" +\n\t\t\"application/pgp-signature,pgp,\" +\n\t\t\"application/postscript,ps ai eps,\" +\n\t\t\"application/rtf,rtf,\" +\n\t\t\"application/vnd.ms-excel,xls xlb xlt xla,\" +\n\t\t\"application/vnd.ms-powerpoint,ppt pps pot ppa,\" +\n\t\t\"application/zip,zip,\" +\n\t\t\"application/x-shockwave-flash,swf swfl,\" +\n\t\t\"application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,\" +\n\t\t\"application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,\" +\n\t\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,\" +\n\t\t\"application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,\" +\n\t\t\"application/vnd.openxmlformats-officedocument.presentationml.template,potx,\" +\n\t\t\"application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,\" +\n\t\t\"application/x-javascript,js,\" +\n\t\t\"application/json,json,\" +\n\t\t\"audio/mpeg,mp3 mpga mpega mp2,\" +\n\t\t\"audio/x-wav,wav,\" +\n\t\t\"audio/x-m4a,m4a,\" +\n\t\t\"audio/ogg,oga ogg,\" +\n\t\t\"audio/aiff,aiff aif,\" +\n\t\t\"audio/flac,flac,\" +\n\t\t\"audio/aac,aac,\" +\n\t\t\"audio/ac3,ac3,\" +\n\t\t\"audio/x-ms-wma,wma,\" +\n\t\t\"image/bmp,bmp,\" +\n\t\t\"image/gif,gif,\" +\n\t\t\"image/jpeg,jpg jpeg jpe,\" +\n\t\t\"image/photoshop,psd,\" +\n\t\t\"image/png,png,\" +\n\t\t\"image/svg+xml,svg svgz,\" +\n\t\t\"image/tiff,tiff tif,\" +\n\t\t\"text/plain,asc txt text diff log,\" +\n\t\t\"text/html,htm html xhtml,\" +\n\t\t\"text/css,css,\" +\n\t\t\"text/csv,csv,\" +\n\t\t\"text/rtf,rtf,\" +\n\t\t\"video/mpeg,mpeg mpg mpe m2v,\" +\n\t\t\"video/quicktime,qt mov,\" +\n\t\t\"video/mp4,mp4,\" +\n\t\t\"video/x-m4v,m4v,\" +\n\t\t\"video/x-flv,flv,\" +\n\t\t\"video/x-ms-wmv,wmv,\" +\n\t\t\"video/avi,avi,\" +\n\t\t\"video/webm,webm,\" +\n\t\t\"video/3gpp,3gpp 3gp,\" +\n\t\t\"video/3gpp2,3g2,\" +\n\t\t\"video/vnd.rn-realvideo,rv,\" +\n\t\t\"video/ogg,ogv,\" +\n\t\t\"video/x-matroska,mkv,\" +\n\t\t\"application/vnd.oasis.opendocument.formula-template,otf,\" +\n\t\t\"application/octet-stream,exe\";\n\n\n\t/**\n\t * Map of mimes to extensions\n\t *\n\t * @property mimes\n\t * @type {Object}\n\t */\n\tvar mimes = {};\n\n\t/**\n\t * Map of extensions to mimes\n\t *\n\t * @property extensions\n\t * @type {Object}\n\t */\n\tvar extensions = {};\n\n\n\t/**\n\t* Parses mimeData string into a mimes and extensions lookup maps. String should have the\n\t* following format:\n\t*\n\t* application/msword,doc dot,application/pdf,pdf, ...\n\t*\n\t* so mime-type followed by comma and followed by space-separated list of associated extensions,\n\t* then comma again and then another mime-type, etc.\n\t*\n\t* If invoked externally will replace override internal lookup maps with user-provided data.\n\t*\n\t* @method addMimeType\n\t* @param {String} mimeData\n\t*/\n\tvar addMimeType = function (mimeData) {\n\t\tvar items = mimeData.split(/,/), i, ii, ext;\n\n\t\tfor (i = 0; i < items.length; i += 2) {\n\t\t\text = items[i + 1].split(/ /);\n\n\t\t\t// extension to mime lookup\n\t\t\tfor (ii = 0; ii < ext.length; ii++) {\n\t\t\t\tmimes[ext[ii]] = items[i];\n\t\t\t}\n\t\t\t// mime to extension lookup\n\t\t\textensions[items[i]] = ext;\n\t\t}\n\t};\n\n\n\tvar extList2mimes = function (filters, addMissingExtensions) {\n\t\tvar ext, i, ii, type, mimes = [];\n\n\t\t// convert extensions to mime types list\n\t\tfor (i = 0; i < filters.length; i++) {\n\t\t\text = filters[i].extensions.toLowerCase().split(/\\s*,\\s*/);\n\n\t\t\tfor (ii = 0; ii < ext.length; ii++) {\n\n\t\t\t\t// if there's an asterisk in the list, then accept attribute is not required\n\t\t\t\tif (ext[ii] === '*') {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\ttype = mimes[ext[ii]];\n\n\t\t\t\t// future browsers should filter by extension, finally\n\t\t\t\tif (addMissingExtensions && /^\\w+$/.test(ext[ii])) {\n\t\t\t\t\tmimes.push('.' + ext[ii]);\n\t\t\t\t} else if (type && Basic.inArray(type, mimes) === -1) {\n\t\t\t\t\tmimes.push(type);\n\t\t\t\t} else if (!type) {\n\t\t\t\t\t// if we have no type in our map, then accept all\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn mimes;\n\t};\n\n\n\tvar mimes2exts = function(mimes) {\n\t\tvar exts = [];\n\n\t\tBasic.each(mimes, function(mime) {\n\t\t\tmime = mime.toLowerCase();\n\n\t\t\tif (mime === '*') {\n\t\t\t\texts = [];\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// check if this thing looks like mime type\n\t\t\tvar m = mime.match(/^(\\w+)\\/(\\*|\\w+)$/);\n\t\t\tif (m) {\n\t\t\t\tif (m[2] === '*') {\n\t\t\t\t\t// wildcard mime type detected\n\t\t\t\t\tBasic.each(extensions, function(arr, mime) {\n\t\t\t\t\t\tif ((new RegExp('^' + m[1] + '/')).test(mime)) {\n\t\t\t\t\t\t\t[].push.apply(exts, extensions[mime]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (extensions[mime]) {\n\t\t\t\t\t[].push.apply(exts, extensions[mime]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn exts;\n\t};\n\n\n\tvar mimes2extList = function(mimes) {\n\t\tvar accept = [], exts = [];\n\n\t\tif (Basic.typeOf(mimes) === 'string') {\n\t\t\tmimes = Basic.trim(mimes).split(/\\s*,\\s*/);\n\t\t}\n\n\t\texts = mimes2exts(mimes);\n\n\t\taccept.push({\n\t\t\ttitle: I18n.translate('Files'),\n\t\t\textensions: exts.length ? exts.join(',') : '*'\n\t\t});\n\n\t\treturn accept;\n\t};\n\n\t/**\n\t * Extract extension from the given filename\n\t *\n\t * @method getFileExtension\n\t * @param {String} fileName\n\t * @return {String} File extension\n\t */\n\tvar getFileExtension = function(fileName) {\n\t\tvar matches = fileName && fileName.match(/\\.([^.]+)$/);\n\t\tif (matches) {\n\t\t\treturn matches[1].toLowerCase();\n\t\t}\n\t\treturn '';\n\t};\n\n\n\t/**\n\t * Get file mime-type from it's filename - will try to match the extension\n\t * against internal mime-type lookup map\n\t *\n\t * @method getFileMime\n\t * @param {String} fileName\n\t * @return File mime-type if found or an empty string if not\n\t */\n\tvar getFileMime = function(fileName) {\n\t\treturn mimes[getFileExtension(fileName)] || '';\n\t};\n\n\n\taddMimeType(mimeData);\n\n\treturn {\n\t\tmimes: mimes,\n\t\textensions: extensions,\n\t\taddMimeType: addMimeType,\n\t\textList2mimes: extList2mimes,\n\t\tmimes2exts: mimes2exts,\n\t\tmimes2extList: mimes2extList,\n\t\tgetFileExtension: getFileExtension,\n\t\tgetFileMime: getFileMime\n\t}\n});\n\n// Included from: src/javascript/file/FileInput.js\n\n/**\n * FileInput.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/file/FileInput', [\n\t'moxie/core/utils/Basic',\n\t'moxie/core/utils/Env',\n\t'moxie/core/utils/Mime',\n\t'moxie/core/utils/Dom',\n\t'moxie/core/Exceptions',\n\t'moxie/core/EventTarget',\n\t'moxie/core/I18n',\n\t'moxie/runtime/Runtime',\n\t'moxie/runtime/RuntimeClient'\n], function(Basic, Env, Mime, Dom, x, EventTarget, I18n, Runtime, RuntimeClient) {\n\t/**\n\tProvides a convenient way to create cross-browser file-picker. Generates file selection dialog on click,\n\tconverts selected files to _File_ objects, to be used in conjunction with _Image_, preloaded in memory\n\twith _FileReader_ or uploaded to a server through _XMLHttpRequest_.\n\n\t@class moxie/file/FileInput\n\t@constructor\n\t@extends EventTarget\n\t@uses RuntimeClient\n\t@param {Object|String|DOMElement} options If options is string or node, argument is considered as _browse\\_button_.\n\t\t@param {String|DOMElement} options.browse_button DOM Element to turn into file picker.\n\t\t@param {Array} [options.accept] Array of mime types to accept. By default accepts all.\n\t\t@param {Boolean} [options.multiple=false] Enable selection of multiple files.\n\t\t@param {Boolean} [options.directory=false] Turn file input into the folder input (cannot be both at the same time).\n\t\t@param {String|DOMElement} [options.container] DOM Element to use as a container for file-picker. Defaults to parentNode\n\t\tfor _browse\\_button_.\n\t\t@param {Object|String} [options.required_caps] Set of required capabilities, that chosen runtime must support.\n\n\t@example\n\t\t<div id=\"container\">\n\t\t\t<a id=\"file-picker\" href=\"javascript:;\">Browse...</a>\n\t\t</div>\n\n\t\t<script>\n\t\t\tvar fileInput = new moxie.file.FileInput({\n\t\t\t\tbrowse_button: 'file-picker', // or document.getElementById('file-picker')\n\t\t\t\tcontainer: 'container',\n\t\t\t\taccept: [\n\t\t\t\t\t{title: \"Image files\", extensions: \"jpg,gif,png\"} // accept only images\n\t\t\t\t],\n\t\t\t\tmultiple: true // allow multiple file selection\n\t\t\t});\n\n\t\t\tfileInput.onchange = function(e) {\n\t\t\t\t// do something to files array\n\t\t\t\tconsole.info(e.target.files); // or this.files or fileInput.files\n\t\t\t};\n\n\t\t\tfileInput.init(); // initialize\n\t\t</script>\n\t*/\n\tvar dispatches = [\n\t\t/**\n\t\tDispatched when runtime is connected and file-picker is ready to be used.\n\n\t\t@event ready\n\t\t@param {Object} event\n\t\t*/\n\t\t'ready',\n\n\t\t/**\n\t\tDispatched right after [ready](#event_ready) event, and whenever [refresh()](#method_refresh) is invoked.\n\t\tCheck [corresponding documentation entry](#method_refresh) for more info.\n\n\t\t@event refresh\n\t\t@param {Object} event\n\t\t*/\n\n\t\t/**\n\t\tDispatched when selection of files in the dialog is complete.\n\n\t\t@event change\n\t\t@param {Object} event\n\t\t*/\n\t\t'change',\n\n\t\t'cancel', // TODO: might be useful\n\n\t\t/**\n\t\tDispatched when mouse cursor enters file-picker area. Can be used to style element\n\t\taccordingly.\n\n\t\t@event mouseenter\n\t\t@param {Object} event\n\t\t*/\n\t\t'mouseenter',\n\n\t\t/**\n\t\tDispatched when mouse cursor leaves file-picker area. Can be used to style element\n\t\taccordingly.\n\n\t\t@event mouseleave\n\t\t@param {Object} event\n\t\t*/\n\t\t'mouseleave',\n\n\t\t/**\n\t\tDispatched when functional mouse button is pressed on top of file-picker area.\n\n\t\t@event mousedown\n\t\t@param {Object} event\n\t\t*/\n\t\t'mousedown',\n\n\t\t/**\n\t\tDispatched when functional mouse button is released on top of file-picker area.\n\n\t\t@event mouseup\n\t\t@param {Object} event\n\t\t*/\n\t\t'mouseup'\n\t];\n\n\tfunction FileInput(options) {\n\t\tif (MXI_DEBUG) {\n\t\t\tEnv.log(\"Instantiating FileInput...\");\n\t\t}\n\n\t\tvar container, browseButton, defaults;\n\n\t\t// if flat argument passed it should be browse_button id\n\t\tif (Basic.inArray(Basic.typeOf(options), ['string', 'node']) !== -1) {\n\t\t\toptions = { browse_button : options };\n\t\t}\n\n\t\t// this will help us to find proper default container\n\t\tbrowseButton = Dom.get(options.browse_button);\n\t\tif (!browseButton) {\n\t\t\t// browse button is required\n\t\t\tthrow new x.DOMException(x.DOMException.NOT_FOUND_ERR);\n\t\t}\n\n\t\t// figure out the options\n\t\tdefaults = {\n\t\t\taccept: [{\n\t\t\t\ttitle: I18n.translate('All Files'),\n\t\t\t\textensions: '*'\n\t\t\t}],\n\t\t\tmultiple: false,\n\t\t\trequired_caps: false,\n\t\t\tcontainer: browseButton.parentNode || document.body\n\t\t};\n\n\t\toptions = Basic.extend({}, defaults, options);\n\n\t\t// convert to object representation\n\t\tif (typeof(options.required_caps) === 'string') {\n\t\t\toptions.required_caps = Runtime.parseCaps(options.required_caps);\n\t\t}\n\n\t\t// normalize accept option (could be list of mime types or array of title/extensions pairs)\n\t\tif (typeof(options.accept) === 'string') {\n\t\t\toptions.accept = Mime.mimes2extList(options.accept);\n\t\t}\n\n\t\tcontainer = Dom.get(options.container);\n\t\t// make sure we have container\n\t\tif (!container) {\n\t\t\tcontainer = document.body;\n\t\t}\n\n\t\t// make container relative, if it's not\n\t\tif (Dom.getStyle(container, 'position') === 'static') {\n\t\t\tcontainer.style.position = 'relative';\n\t\t}\n\n\t\tcontainer = browseButton = null; // IE\n\n\t\tRuntimeClient.call(this);\n\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tUnique id of the component\n\n\t\t\t@property uid\n\t\t\t@protected\n\t\t\t@readOnly\n\t\t\t@type {String}\n\t\t\t@default UID\n\t\t\t*/\n\t\t\tuid: Basic.guid('uid_'),\n\n\t\t\t/**\n\t\t\tUnique id of the connected runtime, if any.\n\n\t\t\t@property ruid\n\t\t\t@protected\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\truid: null,\n\n\t\t\t/**\n\t\t\tUnique id of the runtime container. Useful to get hold of it for various manipulations.\n\n\t\t\t@property shimid\n\t\t\t@protected\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\tshimid: null,\n\n\t\t\t/**\n\t\t\tArray of selected moxie.file.File objects\n\n\t\t\t@property files\n\t\t\t@type {Array}\n\t\t\t@default null\n\t\t\t*/\n\t\t\tfiles: null,\n\n\t\t\t/**\n\t\t\tInitializes the file-picker, connects it to runtime and dispatches event ready when done.\n\n\t\t\t@method init\n\t\t\t*/\n\t\t\tinit: function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tself.bind('RuntimeInit', function(e, runtime) {\n\t\t\t\t\tself.ruid = runtime.uid;\n\t\t\t\t\tself.shimid = runtime.shimid;\n\n\t\t\t\t\tself.bind(\"Ready\", function() {\n\t\t\t\t\t\tself.trigger(\"Refresh\");\n\t\t\t\t\t}, 999);\n\n\t\t\t\t\t// re-position and resize shim container\n\t\t\t\t\tself.bind('Refresh', function() {\n\t\t\t\t\t\tvar pos, size, browseButton, shimContainer, zIndex;\n\n\t\t\t\t\t\tbrowseButton = Dom.get(options.browse_button);\n\t\t\t\t\t\tshimContainer = Dom.get(runtime.shimid); // do not use runtime.getShimContainer(), since it will create container if it doesn't exist\n\n\t\t\t\t\t\tif (browseButton) {\n\t\t\t\t\t\t\tpos = Dom.getPos(browseButton, Dom.get(options.container));\n\t\t\t\t\t\t\tsize = Dom.getSize(browseButton);\n\t\t\t\t\t\t\tzIndex = parseInt(Dom.getStyle(browseButton, 'z-index'), 10) || 0;\n\n\t\t\t\t\t\t\tif (shimContainer) {\n\t\t\t\t\t\t\t\tBasic.extend(shimContainer.style, {\n\t\t\t\t\t\t\t\t\ttop: pos.y + 'px',\n\t\t\t\t\t\t\t\t\tleft: pos.x + 'px',\n\t\t\t\t\t\t\t\t\twidth: size.w + 'px',\n\t\t\t\t\t\t\t\t\theight: size.h + 'px',\n\t\t\t\t\t\t\t\t\tzIndex: zIndex + 1\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tshimContainer = browseButton = null;\n\t\t\t\t\t});\n\n\t\t\t\t\truntime.exec.call(self, 'FileInput', 'init', options);\n\t\t\t\t});\n\n\t\t\t\t// runtime needs: options.required_features, options.runtime_order and options.container\n\t\t\t\tself.connectRuntime(Basic.extend({}, options, {\n\t\t\t\t\trequired_caps: {\n\t\t\t\t\t\tselect_file: true\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Get current option value by its name\n\t\t\t *\n\t\t\t * @method getOption\n\t\t\t * @param name\n\t\t\t * @return {Mixed}\n\t\t\t */\n\t\t\tgetOption: function(name) {\n\t\t\t\treturn options[name];\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Sets a new value for the option specified by name\n\t\t\t *\n\t\t\t * @method setOption\n\t\t\t * @param name\n\t\t\t * @param value\n\t\t\t */\n\t\t\tsetOption: function(name, value) {\n\t\t\t\tif (!options.hasOwnProperty(name)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar oldValue = options[name];\n\n\t\t\t\tswitch (name) {\n\t\t\t\t\tcase 'accept':\n\t\t\t\t\t\tif (typeof(value) === 'string') {\n\t\t\t\t\t\t\tvalue = Mime.mimes2extList(value);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'container':\n\t\t\t\t\tcase 'required_caps':\n\t\t\t\t\t\tthrow new x.FileException(x.FileException.NO_MODIFICATION_ALLOWED_ERR);\n\t\t\t\t}\n\n\t\t\t\toptions[name] = value;\n\t\t\t\tthis.exec('FileInput', 'setOption', name, value);\n\n\t\t\t\tthis.trigger('OptionChanged', name, value, oldValue);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tDisables file-picker element, so that it doesn't react to mouse clicks.\n\n\t\t\t@method disable\n\t\t\t@param {Boolean} [state=true] Disable component if - true, enable if - false\n\t\t\t*/\n\t\t\tdisable: function(state) {\n\t\t\t\tvar runtime = this.getRuntime();\n\t\t\t\tif (runtime) {\n\t\t\t\t\tthis.exec('FileInput', 'disable', Basic.typeOf(state) === 'undefined' ? true : state);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\tReposition and resize dialog trigger to match the position and size of browse_button element.\n\n\t\t\t@method refresh\n\t\t\t*/\n\t\t\trefresh: function() {\n\t\t\t\tthis.trigger(\"Refresh\");\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\tDestroy component.\n\n\t\t\t@method destroy\n\t\t\t*/\n\t\t\tdestroy: function() {\n\t\t\t\tvar runtime = this.getRuntime();\n\t\t\t\tif (runtime) {\n\t\t\t\t\truntime.exec.call(this, 'FileInput', 'destroy');\n\t\t\t\t\tthis.disconnectRuntime();\n\t\t\t\t}\n\n\t\t\t\tif (Basic.typeOf(this.files) === 'array') {\n\t\t\t\t\t// no sense in leaving associated files behind\n\t\t\t\t\tBasic.each(this.files, function(file) {\n\t\t\t\t\t\tfile.destroy();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.files = null;\n\n\t\t\t\tthis.unbindAll();\n\t\t\t}\n\t\t});\n\n\t\tthis.handleEventProps(dispatches);\n\t}\n\n\tFileInput.prototype = EventTarget.instance;\n\n\treturn FileInput;\n});\n\n// Included from: src/javascript/file/File.js\n\n/**\n * File.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/file/File', [\n\t'moxie/core/utils/Basic',\n\t'moxie/core/utils/Mime',\n\t'moxie/file/Blob'\n], function(Basic, Mime, Blob) {\n\t/**\n\t@class moxie/file/File\n\t@extends Blob\n\t@constructor\n\t@param {String} ruid Unique id of the runtime, to which this blob belongs to\n\t@param {Object} file Object \"Native\" file object, as it is represented in the runtime\n\t*/\n\tfunction File(ruid, file) {\n\t\tif (!file) { // avoid extra errors in case we overlooked something\n\t\t\tfile = {};\n\t\t}\n\n\t\tBlob.apply(this, arguments);\n\n\t\tif (!this.type) {\n\t\t\tthis.type = Mime.getFileMime(file.name);\n\t\t}\n\n\t\t// sanitize file name or generate new one\n\t\tvar name;\n\t\tif (file.name) {\n\t\t\tname = file.name.replace(/\\\\/g, '/');\n\t\t\tname = name.substr(name.lastIndexOf('/') + 1);\n\t\t} else if (this.type) {\n\t\t\tvar prefix = this.type.split('/')[0];\n\t\t\tname = Basic.guid((prefix !== '' ? prefix : 'file') + '_');\n\t\t\t\n\t\t\tif (Mime.extensions[this.type]) {\n\t\t\t\tname += '.' + Mime.extensions[this.type][0]; // append proper extension if possible\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tFile name\n\n\t\t\t@property name\n\t\t\t@type {String}\n\t\t\t@default UID\n\t\t\t*/\n\t\t\tname: name || Basic.guid('file_'),\n\n\t\t\t/**\n\t\t\tRelative path to the file inside a directory\n\n\t\t\t@property relativePath\n\t\t\t@type {String}\n\t\t\t@default ''\n\t\t\t*/\n\t\t\trelativePath: '',\n\t\t\t\n\t\t\t/**\n\t\t\tDate of last modification\n\n\t\t\t@property lastModifiedDate\n\t\t\t@type {String}\n\t\t\t@default now\n\t\t\t*/\n\t\t\tlastModifiedDate: file.lastModifiedDate || (new Date()).toLocaleString() // Thu Aug 23 2012 19:40:00 GMT+0400 (GET)\n\t\t});\n\t}\n\n\tFile.prototype = Blob.prototype;\n\n\treturn File;\n});\n\n// Included from: src/javascript/file/FileDrop.js\n\n/**\n * FileDrop.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/file/FileDrop', [\n\t'moxie/core/I18n',\n\t'moxie/core/utils/Dom',\n\t'moxie/core/Exceptions',\n\t'moxie/core/utils/Basic',\n\t'moxie/core/utils/Env',\n\t'moxie/file/File',\n\t'moxie/runtime/RuntimeClient',\n\t'moxie/core/EventTarget',\n\t'moxie/core/utils/Mime'\n], function(I18n, Dom, x, Basic, Env, File, RuntimeClient, EventTarget, Mime) {\n\t/**\n\tTurn arbitrary DOM element to a drop zone accepting files. Converts selected files to _File_ objects, to be used \n\tin conjunction with _Image_, preloaded in memory with _FileReader_ or uploaded to a server through \n\t_XMLHttpRequest_.\n\n\t@example\n\t\t<div id=\"drop_zone\">\n\t\t\tDrop files here\n\t\t</div>\n\t\t<br />\n\t\t<div id=\"filelist\"></div>\n\n\t\t<script type=\"text/javascript\">\n\t\t\tvar fileDrop = new moxie.file.FileDrop('drop_zone'), fileList = moxie.utils.Dom.get('filelist');\n\n\t\t\tfileDrop.ondrop = function() {\n\t\t\t\tmoxie.utils.Basic.each(this.files, function(file) {\n\t\t\t\t\tfileList.innerHTML += '<div>' + file.name + '</div>';\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tfileDrop.init();\n\t\t</script>\n\n\t@class moxie/file/FileDrop\n\t@constructor\n\t@extends EventTarget\n\t@uses RuntimeClient\n\t@param {Object|String} options If options has typeof string, argument is considered as options.drop_zone\n\t\t@param {String|DOMElement} options.drop_zone DOM Element to turn into a drop zone\n\t\t@param {Array} [options.accept] Array of mime types to accept. By default accepts all\n\t\t@param {Object|String} [options.required_caps] Set of required capabilities, that chosen runtime must support\n\t*/\n\tvar dispatches = [\n\t\t/**\n\t\tDispatched when runtime is connected and drop zone is ready to accept files.\n\n\t\t@event ready\n\t\t@param {Object} event\n\t\t*/\n\t\t'ready', \n\n\t\t/**\n\t\tDispatched when dragging cursor enters the drop zone.\n\n\t\t@event dragenter\n\t\t@param {Object} event\n\t\t*/\n\t\t'dragenter',\n\n\t\t/**\n\t\tDispatched when dragging cursor leaves the drop zone.\n\n\t\t@event dragleave\n\t\t@param {Object} event\n\t\t*/\n\t\t'dragleave', \n\n\t\t/**\n\t\tDispatched when file is dropped onto the drop zone.\n\n\t\t@event drop\n\t\t@param {Object} event\n\t\t*/\n\t\t'drop', \n\n\t\t/**\n\t\tDispatched if error occurs.\n\n\t\t@event error\n\t\t@param {Object} event\n\t\t*/\n\t\t'error'\n\t];\n\n\tfunction FileDrop(options) {\n\t\tif (MXI_DEBUG) {\n\t\t\tEnv.log(\"Instantiating FileDrop...\");\t\n\t\t}\n\n\t\tvar self = this, defaults;\n\n\t\t// if flat argument passed it should be drop_zone id\n\t\tif (typeof(options) === 'string') {\n\t\t\toptions = { drop_zone : options };\n\t\t}\n\n\t\t// figure out the options\n\t\tdefaults = {\n\t\t\taccept: [{\n\t\t\t\ttitle: I18n.translate('All Files'),\n\t\t\t\textensions: '*'\n\t\t\t}],\n\t\t\trequired_caps: {\n\t\t\t\tdrag_and_drop: true\n\t\t\t}\n\t\t};\n\t\t\n\t\toptions = typeof(options) === 'object' ? Basic.extend({}, defaults, options) : defaults;\n\n\t\t// this will help us to find proper default container\n\t\toptions.container = Dom.get(options.drop_zone) || document.body;\n\n\t\t// make container relative, if it is not\n\t\tif (Dom.getStyle(options.container, 'position') === 'static') {\n\t\t\toptions.container.style.position = 'relative';\n\t\t}\n\t\t\t\t\t\n\t\t// normalize accept option (could be list of mime types or array of title/extensions pairs)\n\t\tif (typeof(options.accept) === 'string') {\n\t\t\toptions.accept = Mime.mimes2extList(options.accept);\n\t\t}\n\n\t\tRuntimeClient.call(self);\n\n\t\tBasic.extend(self, {\n\t\t\tuid: Basic.guid('uid_'),\n\n\t\t\truid: null,\n\n\t\t\tfiles: null,\n\n\t\t\tinit: function() {\t\t\n\t\t\t\tself.bind('RuntimeInit', function(e, runtime) {\n\t\t\t\t\tself.ruid = runtime.uid;\n\t\t\t\t\truntime.exec.call(self, 'FileDrop', 'init', options);\n\t\t\t\t\tself.dispatchEvent('ready');\n\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t// runtime needs: options.required_features, options.runtime_order and options.container\n\t\t\t\tself.connectRuntime(options); // throws RuntimeError\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tvar runtime = this.getRuntime();\n\t\t\t\tif (runtime) {\n\t\t\t\t\truntime.exec.call(this, 'FileDrop', 'destroy');\n\t\t\t\t\tthis.disconnectRuntime();\n\t\t\t\t}\n\t\t\t\tthis.files = null;\n\t\t\t\t\n\t\t\t\tthis.unbindAll();\n\t\t\t}\n\t\t});\n\n\t\tthis.handleEventProps(dispatches);\n\t}\n\n\tFileDrop.prototype = EventTarget.instance;\n\n\treturn FileDrop;\n});\n\n// Included from: src/javascript/file/FileReader.js\n\n/**\n * FileReader.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/file/FileReader', [\n\t'moxie/core/utils/Basic',\n\t'moxie/core/utils/Encode',\n\t'moxie/core/Exceptions',\n\t'moxie/core/EventTarget',\n\t'moxie/file/Blob',\n\t'moxie/runtime/RuntimeClient'\n], function(Basic, Encode, x, EventTarget, Blob, RuntimeClient) {\n\t/**\n\tUtility for preloading o.Blob/o.File objects in memory. By design closely follows [W3C FileReader](http://www.w3.org/TR/FileAPI/#dfn-filereader)\n\tinterface. Where possible uses native FileReader, where - not falls back to shims.\n\n\t@class moxie/file/FileReader\n\t@constructor FileReader\n\t@extends EventTarget\n\t@uses RuntimeClient\n\t*/\n\tvar dispatches = [\n\n\t\t/** \n\t\tDispatched when the read starts.\n\n\t\t@event loadstart\n\t\t@param {Object} event\n\t\t*/\n\t\t'loadstart', \n\n\t\t/** \n\t\tDispatched while reading (and decoding) blob, and reporting partial Blob data (progess.loaded/progress.total).\n\n\t\t@event progress\n\t\t@param {Object} event\n\t\t*/\n\t\t'progress', \n\n\t\t/** \n\t\tDispatched when the read has successfully completed.\n\n\t\t@event load\n\t\t@param {Object} event\n\t\t*/\n\t\t'load', \n\n\t\t/** \n\t\tDispatched when the read has been aborted. For instance, by invoking the abort() method.\n\n\t\t@event abort\n\t\t@param {Object} event\n\t\t*/\n\t\t'abort', \n\n\t\t/** \n\t\tDispatched when the read has failed.\n\n\t\t@event error\n\t\t@param {Object} event\n\t\t*/\n\t\t'error', \n\n\t\t/** \n\t\tDispatched when the request has completed (either in success or failure).\n\n\t\t@event loadend\n\t\t@param {Object} event\n\t\t*/\n\t\t'loadend'\n\t];\n\t\n\tfunction FileReader() {\n\n\t\tRuntimeClient.call(this);\n\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tUID of the component instance.\n\n\t\t\t@property uid\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\tuid: Basic.guid('uid_'),\n\n\t\t\t/**\n\t\t\tContains current state of FileReader object. Can take values of FileReader.EMPTY, FileReader.LOADING\n\t\t\tand FileReader.DONE.\n\n\t\t\t@property readyState\n\t\t\t@type {Number}\n\t\t\t@default FileReader.EMPTY\n\t\t\t*/\n\t\t\treadyState: FileReader.EMPTY,\n\t\t\t\n\t\t\t/**\n\t\t\tResult of the successful read operation.\n\n\t\t\t@property result\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\tresult: null,\n\t\t\t\n\t\t\t/**\n\t\t\tStores the error of failed asynchronous read operation.\n\n\t\t\t@property error\n\t\t\t@type {DOMError}\n\t\t\t*/\n\t\t\terror: null,\n\t\t\t\n\t\t\t/**\n\t\t\tInitiates reading of File/Blob object contents to binary string.\n\n\t\t\t@method readAsBinaryString\n\t\t\t@param {Blob|File} blob Object to preload\n\t\t\t*/\n\t\t\treadAsBinaryString: function(blob) {\n\t\t\t\t_read.call(this, 'readAsBinaryString', blob);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\tInitiates reading of File/Blob object contents to dataURL string.\n\n\t\t\t@method readAsDataURL\n\t\t\t@param {Blob|File} blob Object to preload\n\t\t\t*/\n\t\t\treadAsDataURL: function(blob) {\n\t\t\t\t_read.call(this, 'readAsDataURL', blob);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\tInitiates reading of File/Blob object contents to string.\n\n\t\t\t@method readAsText\n\t\t\t@param {Blob|File} blob Object to preload\n\t\t\t*/\n\t\t\treadAsText: function(blob) {\n\t\t\t\t_read.call(this, 'readAsText', blob);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\tAborts preloading process.\n\n\t\t\t@method abort\n\t\t\t*/\n\t\t\tabort: function() {\n\t\t\t\tthis.result = null;\n\t\t\t\t\n\t\t\t\tif (Basic.inArray(this.readyState, [FileReader.EMPTY, FileReader.DONE]) !== -1) {\n\t\t\t\t\treturn;\n\t\t\t\t} else if (this.readyState === FileReader.LOADING) {\n\t\t\t\t\tthis.readyState = FileReader.DONE;\n\t\t\t\t}\n\n\t\t\t\tthis.exec('FileReader', 'abort');\n\t\t\t\t\n\t\t\t\tthis.trigger('abort');\n\t\t\t\tthis.trigger('loadend');\n\t\t\t},\n\n\t\t\t/**\n\t\t\tDestroy component and release resources.\n\n\t\t\t@method destroy\n\t\t\t*/\n\t\t\tdestroy: function() {\n\t\t\t\tthis.abort();\n\t\t\t\tthis.exec('FileReader', 'destroy');\n\t\t\t\tthis.disconnectRuntime();\n\t\t\t\tthis.unbindAll();\n\t\t\t}\n\t\t});\n\n\t\t// uid must already be assigned\n\t\tthis.handleEventProps(dispatches);\n\n\t\tthis.bind('Error', function(e, err) {\n\t\t\tthis.readyState = FileReader.DONE;\n\t\t\tthis.error = err;\n\t\t}, 999);\n\t\t\n\t\tthis.bind('Load', function(e) {\n\t\t\tthis.readyState = FileReader.DONE;\n\t\t}, 999);\n\n\t\t\n\t\tfunction _read(op, blob) {\n\t\t\tvar self = this;\t\t\t\n\n\t\t\tthis.trigger('loadstart');\n\n\t\t\tif (this.readyState === FileReader.LOADING) {\n\t\t\t\tthis.trigger('error', new x.DOMException(x.DOMException.INVALID_STATE_ERR));\n\t\t\t\tthis.trigger('loadend');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// if source is not o.Blob/o.File\n\t\t\tif (!(blob instanceof Blob)) {\n\t\t\t\tthis.trigger('error', new x.DOMException(x.DOMException.NOT_FOUND_ERR));\n\t\t\t\tthis.trigger('loadend');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.result = null;\n\t\t\tthis.readyState = FileReader.LOADING;\n\t\t\t\n\t\t\tif (blob.isDetached()) {\n\t\t\t\tvar src = blob.getSource();\n\t\t\t\tswitch (op) {\n\t\t\t\t\tcase 'readAsText':\n\t\t\t\t\tcase 'readAsBinaryString':\n\t\t\t\t\t\tthis.result = src;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'readAsDataURL':\n\t\t\t\t\t\tthis.result = 'data:' + blob.type + ';base64,' + Encode.btoa(src);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.readyState = FileReader.DONE;\n\t\t\t\tthis.trigger('load');\n\t\t\t\tthis.trigger('loadend');\n\t\t\t} else {\n\t\t\t\tthis.connectRuntime(blob.ruid);\n\t\t\t\tthis.exec('FileReader', 'read', op, blob);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\tInitial FileReader state\n\n\t@property EMPTY\n\t@type {Number}\n\t@final\n\t@static\n\t@default 0\n\t*/\n\tFileReader.EMPTY = 0;\n\n\t/**\n\tFileReader switches to this state when it is preloading the source\n\n\t@property LOADING\n\t@type {Number}\n\t@final\n\t@static\n\t@default 1\n\t*/\n\tFileReader.LOADING = 1;\n\n\t/**\n\tPreloading is complete, this is a final state\n\n\t@property DONE\n\t@type {Number}\n\t@final\n\t@static\n\t@default 2\n\t*/\n\tFileReader.DONE = 2;\n\n\tFileReader.prototype = EventTarget.instance;\n\n\treturn FileReader;\n});\n\n// Included from: src/javascript/core/utils/Url.js\n\n/**\n * Url.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/core/utils/Url\n@public\n@static\n*/\n\ndefine('moxie/core/utils/Url', [\n\t'moxie/core/utils/Basic'\n], function(Basic) {\n\t/**\n\tParse url into separate components and fill in absent parts with parts from current url,\n\tbased on https://raw.github.com/kvz/phpjs/master/functions/url/parse_url.js\n\n\t@method parseUrl\n\t@static\n\t@param {String} url Url to parse (defaults to empty string if undefined)\n\t@return {Object} Hash containing extracted uri components\n\t*/\n\tvar parseUrl = function(url, currentUrl) {\n\t\tvar key = ['source', 'scheme', 'authority', 'userInfo', 'user', 'pass', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'fragment']\n\t\t, i = key.length\n\t\t, ports = {\n\t\t\thttp: 80,\n\t\t\thttps: 443\n\t\t}\n\t\t, uri = {}\n\t\t, regex = /^(?:([^:\\/?#]+):)?(?:\\/\\/()(?:(?:()(?:([^:@\\/]*):?([^:@\\/]*))?@)?(\\[[\\da-fA-F:]+\\]|[^:\\/?#]*)(?::(\\d*))?))?()(?:(()(?:(?:[^?#\\/]*\\/)*)()(?:[^?#]*))(?:\\\\?([^#]*))?(?:#(.*))?)/\n\t\t, m = regex.exec(url || '')\n\t\t, isRelative\n\t\t, isSchemeLess = /^\\/\\/\\w/.test(url)\n\t\t;\n\n\t\tswitch (Basic.typeOf(currentUrl)) {\n\t\t\tcase 'undefined':\n\t\t\t\tcurrentUrl = parseUrl(document.location.href, false);\n\t\t\t\tbreak;\n\n\t\t\tcase 'string':\n\t\t\t\tcurrentUrl = parseUrl(currentUrl, false);\n\t\t\t\tbreak;\n\t\t}\n\n\t\twhile (i--) {\n\t\t\tif (m[i]) {\n\t\t\t\turi[key[i]] = m[i];\n\t\t\t}\n\t\t}\n\n\t\tisRelative = !isSchemeLess && !uri.scheme;\n\n\t\tif (isSchemeLess || isRelative) {\n\t\t\turi.scheme = currentUrl.scheme;\n\t\t}\n\n\t\t// when url is relative, we set the origin and the path ourselves\n\t\tif (isRelative) {\n\t\t\turi.host = currentUrl.host;\n\t\t\turi.port = currentUrl.port;\n\n\t\t\tvar path = '';\n\t\t\t// for urls without trailing slash we need to figure out the path\n\t\t\tif (/^[^\\/]/.test(uri.path)) {\n\t\t\t\tpath = currentUrl.path;\n\t\t\t\t// if path ends with a filename, strip it\n\t\t\t\tif (/\\/[^\\/]*\\.[^\\/]*$/.test(path)) {\n\t\t\t\t\tpath = path.replace(/\\/[^\\/]+$/, '/');\n\t\t\t\t} else {\n\t\t\t\t\t// avoid double slash at the end (see #127)\n\t\t\t\t\tpath = path.replace(/\\/?$/, '/');\n\t\t\t\t}\n\t\t\t}\n\t\t\turi.path = path + (uri.path || ''); // site may reside at domain.com or domain.com/subdir\n\t\t}\n\n\t\tif (!uri.port) {\n\t\t\turi.port = ports[uri.scheme] || 80;\n\t\t}\n\n\t\turi.port = parseInt(uri.port, 10);\n\n\t\tif (!uri.path) {\n\t\t\turi.path = \"/\";\n\t\t}\n\n\t\tdelete uri.source;\n\n\t\treturn uri;\n\t};\n\n\t/**\n\tResolve url - among other things will turn relative url to absolute\n\n\t@method resolveUrl\n\t@static\n\t@param {String|Object} url Either absolute or relative, or a result of parseUrl call\n\t@return {String} Resolved, absolute url\n\t*/\n\tvar resolveUrl = function(url) {\n\t\tvar ports = { // we ignore default ports\n\t\t\thttp: 80,\n\t\t\thttps: 443\n\t\t}\n\t\t, urlp = typeof(url) === 'object' ? url : parseUrl(url);\n\t\t;\n\n\t\treturn urlp.scheme + '://' + urlp.host + (urlp.port !== ports[urlp.scheme] ? ':' + urlp.port : '') + urlp.path + (urlp.query ? urlp.query : '');\n\t};\n\n\t/**\n\tCheck if specified url has the same origin as the current document\n\n\t@method hasSameOrigin\n\t@static\n\t@param {String|Object} url\n\t@return {Boolean}\n\t*/\n\tvar hasSameOrigin = function(url) {\n\t\tfunction origin(url) {\n\t\t\treturn [url.scheme, url.host, url.port].join('/');\n\t\t}\n\n\t\tif (typeof url === 'string') {\n\t\t\turl = parseUrl(url);\n\t\t}\n\n\t\treturn origin(parseUrl()) === origin(url);\n\t};\n\n\treturn {\n\t\tparseUrl: parseUrl,\n\t\tresolveUrl: resolveUrl,\n\t\thasSameOrigin: hasSameOrigin\n\t};\n});\n\n// Included from: src/javascript/runtime/RuntimeTarget.js\n\n/**\n * RuntimeTarget.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/runtime/RuntimeTarget', [\n\t'moxie/core/utils/Basic',\n\t'moxie/runtime/RuntimeClient',\n\t\"moxie/core/EventTarget\"\n], function(Basic, RuntimeClient, EventTarget) {\n\t/**\n\tInstance of this class can be used as a target for the events dispatched by shims,\n\twhen allowing them onto components is for either reason inappropriate\n\n\t@class moxie/runtime/RuntimeTarget\n\t@constructor\n\t@protected\n\t@extends EventTarget\n\t*/\n\tfunction RuntimeTarget() {\n\t\tthis.uid = Basic.guid('uid_');\n\t\t\n\t\tRuntimeClient.call(this);\n\n\t\tthis.destroy = function() {\n\t\t\tthis.disconnectRuntime();\n\t\t\tthis.unbindAll();\n\t\t};\n\t}\n\n\tRuntimeTarget.prototype = EventTarget.instance;\n\n\treturn RuntimeTarget;\n});\n\n// Included from: src/javascript/file/FileReaderSync.js\n\n/**\n * FileReaderSync.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine('moxie/file/FileReaderSync', [\n\t'moxie/core/utils/Basic',\n\t'moxie/runtime/RuntimeClient',\n\t'moxie/core/utils/Encode'\n], function(Basic, RuntimeClient, Encode) {\n\t/**\n\tSynchronous FileReader implementation. Something like this is available in WebWorkers environment, here\n\tit can be used to read only preloaded blobs/files and only below certain size (not yet sure what that'd be,\n\tbut probably < 1mb). Not meant to be used directly by user.\n\n\t@class moxie/file/FileReaderSync\n\t@private\n\t@constructor\n\t*/\n\treturn function() {\n\t\tRuntimeClient.call(this);\n\n\t\tBasic.extend(this, {\n\t\t\tuid: Basic.guid('uid_'),\n\n\t\t\treadAsBinaryString: function(blob) {\n\t\t\t\treturn _read.call(this, 'readAsBinaryString', blob);\n\t\t\t},\n\t\t\t\n\t\t\treadAsDataURL: function(blob) {\n\t\t\t\treturn _read.call(this, 'readAsDataURL', blob);\n\t\t\t},\n\t\t\t\n\t\t\t/*readAsArrayBuffer: function(blob) {\n\t\t\t\treturn _read.call(this, 'readAsArrayBuffer', blob);\n\t\t\t},*/\n\t\t\t\n\t\t\treadAsText: function(blob) {\n\t\t\t\treturn _read.call(this, 'readAsText', blob);\n\t\t\t}\n\t\t});\n\n\t\tfunction _read(op, blob) {\n\t\t\tif (blob.isDetached()) {\n\t\t\t\tvar src = blob.getSource();\n\t\t\t\tswitch (op) {\n\t\t\t\t\tcase 'readAsBinaryString':\n\t\t\t\t\t\treturn src;\n\t\t\t\t\tcase 'readAsDataURL':\n\t\t\t\t\t\treturn 'data:' + blob.type + ';base64,' + Encode.btoa(src);\n\t\t\t\t\tcase 'readAsText':\n\t\t\t\t\t\tvar txt = '';\n\t\t\t\t\t\tfor (var i = 0, length = src.length; i < length; i++) {\n\t\t\t\t\t\t\ttxt += String.fromCharCode(src[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn txt;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar result = this.connectRuntime(blob.ruid).exec.call(this, 'FileReaderSync', 'read', op, blob);\n\t\t\t\tthis.disconnectRuntime();\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t};\n});\n\n// Included from: src/javascript/xhr/FormData.js\n\n/**\n * FormData.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine(\"moxie/xhr/FormData\", [\n\t\"moxie/core/Exceptions\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/file/Blob\"\n], function(x, Basic, Blob) {\n\t/**\n\tFormData\n\n\t@class moxie/xhr/FormData\n\t@constructor\n\t*/\n\tfunction FormData() {\n\t\tvar _blob, _fields = [];\n\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tAppend another key-value pair to the FormData object\n\n\t\t\t@method append\n\t\t\t@param {String} name Name for the new field\n\t\t\t@param {String|Blob|Array|Object} value Value for the field\n\t\t\t*/\n\t\t\tappend: function(name, value) {\n\t\t\t\tvar self = this, valueType = Basic.typeOf(value);\n\n\t\t\t\t// according to specs value might be either Blob or String\n\t\t\t\tif (value instanceof Blob) {\n\t\t\t\t\t_blob = {\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\tvalue: value // unfortunately we can only send single Blob in one FormData\n\t\t\t\t\t};\n\t\t\t\t} else if ('array' === valueType) {\n\t\t\t\t\tname += '[]';\n\n\t\t\t\t\tBasic.each(value, function(value) {\n\t\t\t\t\t\tself.append(name, value);\n\t\t\t\t\t});\n\t\t\t\t} else if ('object' === valueType) {\n\t\t\t\t\tBasic.each(value, function(value, key) {\n\t\t\t\t\t\tself.append(name + '[' + key + ']', value);\n\t\t\t\t\t});\n\t\t\t\t} else if ('null' === valueType || 'undefined' === valueType || 'number' === valueType && isNaN(value)) {\n\t\t\t\t\tself.append(name, \"false\");\n\t\t\t\t} else {\n\t\t\t\t\t_fields.push({\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\tvalue: value.toString()\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\tChecks if FormData contains Blob.\n\n\t\t\t@method hasBlob\n\t\t\t@return {Boolean}\n\t\t\t*/\n\t\t\thasBlob: function() {\n\t\t\t\treturn !!this.getBlob();\n\t\t\t},\n\n\t\t\t/**\n\t\t\tRetrieves blob.\n\n\t\t\t@method getBlob\n\t\t\t@return {Object} Either Blob if found or null\n\t\t\t*/\n\t\t\tgetBlob: function() {\n\t\t\t\treturn _blob && _blob.value || null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tRetrieves blob field name.\n\n\t\t\t@method getBlobName\n\t\t\t@return {String} Either Blob field name or null\n\t\t\t*/\n\t\t\tgetBlobName: function() {\n\t\t\t\treturn _blob && _blob.name || null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tLoop over the fields in FormData and invoke the callback for each of them.\n\n\t\t\t@method each\n\t\t\t@param {Function} cb Callback to call for each field\n\t\t\t*/\n\t\t\teach: function(cb) {\n\t\t\t\tBasic.each(_fields, function(field) {\n\t\t\t\t\tcb(field.value, field.name);\n\t\t\t\t});\n\n\t\t\t\tif (_blob) {\n\t\t\t\t\tcb(_blob.value, _blob.name);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\t_blob = null;\n\t\t\t\t_fields = [];\n\t\t\t}\n\t\t});\n\t}\n\n\treturn FormData;\n});\n\n// Included from: src/javascript/xhr/XMLHttpRequest.js\n\n/**\n * XMLHttpRequest.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine(\"moxie/xhr/XMLHttpRequest\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/core/EventTarget\",\n\t\"moxie/core/utils/Encode\",\n\t\"moxie/core/utils/Url\",\n\t\"moxie/runtime/Runtime\",\n\t\"moxie/runtime/RuntimeTarget\",\n\t\"moxie/file/Blob\",\n\t\"moxie/file/FileReaderSync\",\n\t\"moxie/xhr/FormData\",\n\t\"moxie/core/utils/Env\",\n\t\"moxie/core/utils/Mime\"\n], function(Basic, x, EventTarget, Encode, Url, Runtime, RuntimeTarget, Blob, FileReaderSync, FormData, Env, Mime) {\n\n\tvar httpCode = {\n\t\t100: 'Continue',\n\t\t101: 'Switching Protocols',\n\t\t102: 'Processing',\n\n\t\t200: 'OK',\n\t\t201: 'Created',\n\t\t202: 'Accepted',\n\t\t203: 'Non-Authoritative Information',\n\t\t204: 'No Content',\n\t\t205: 'Reset Content',\n\t\t206: 'Partial Content',\n\t\t207: 'Multi-Status',\n\t\t226: 'IM Used',\n\n\t\t300: 'Multiple Choices',\n\t\t301: 'Moved Permanently',\n\t\t302: 'Found',\n\t\t303: 'See Other',\n\t\t304: 'Not Modified',\n\t\t305: 'Use Proxy',\n\t\t306: 'Reserved',\n\t\t307: 'Temporary Redirect',\n\n\t\t400: 'Bad Request',\n\t\t401: 'Unauthorized',\n\t\t402: 'Payment Required',\n\t\t403: 'Forbidden',\n\t\t404: 'Not Found',\n\t\t405: 'Method Not Allowed',\n\t\t406: 'Not Acceptable',\n\t\t407: 'Proxy Authentication Required',\n\t\t408: 'Request Timeout',\n\t\t409: 'Conflict',\n\t\t410: 'Gone',\n\t\t411: 'Length Required',\n\t\t412: 'Precondition Failed',\n\t\t413: 'Request Entity Too Large',\n\t\t414: 'Request-URI Too Long',\n\t\t415: 'Unsupported Media Type',\n\t\t416: 'Requested Range Not Satisfiable',\n\t\t417: 'Expectation Failed',\n\t\t422: 'Unprocessable Entity',\n\t\t423: 'Locked',\n\t\t424: 'Failed Dependency',\n\t\t426: 'Upgrade Required',\n\n\t\t500: 'Internal Server Error',\n\t\t501: 'Not Implemented',\n\t\t502: 'Bad Gateway',\n\t\t503: 'Service Unavailable',\n\t\t504: 'Gateway Timeout',\n\t\t505: 'HTTP Version Not Supported',\n\t\t506: 'Variant Also Negotiates',\n\t\t507: 'Insufficient Storage',\n\t\t510: 'Not Extended'\n\t};\n\n\tfunction XMLHttpRequestUpload() {\n\t\tthis.uid = Basic.guid('uid_');\n\t}\n\n\tXMLHttpRequestUpload.prototype = EventTarget.instance;\n\n\t/**\n\tImplementation of XMLHttpRequest\n\n\t@class moxie/xhr/XMLHttpRequest\n\t@constructor\n\t@uses RuntimeClient\n\t@extends EventTarget\n\t*/\n\tvar dispatches = [\n\t\t'loadstart',\n\n\t\t'progress',\n\n\t\t'abort',\n\n\t\t'error',\n\n\t\t'load',\n\n\t\t'timeout',\n\n\t\t'loadend'\n\n\t\t// readystatechange (for historical reasons)\n\t];\n\n\tvar NATIVE = 1, RUNTIME = 2;\n\n\tfunction XMLHttpRequest() {\n\t\tvar self = this,\n\t\t\t// this (together with _p() @see below) is here to gracefully upgrade to setter/getter syntax where possible\n\t\t\tprops = {\n\t\t\t\t/**\n\t\t\t\tThe amount of milliseconds a request can take before being terminated. Initially zero. Zero means there is no timeout.\n\n\t\t\t\t@property timeout\n\t\t\t\t@type Number\n\t\t\t\t@default 0\n\t\t\t\t*/\n\t\t\t\ttimeout: 0,\n\n\t\t\t\t/**\n\t\t\t\tCurrent state, can take following values:\n\t\t\t\tUNSENT (numeric value 0)\n\t\t\t\tThe object has been constructed.\n\n\t\t\t\tOPENED (numeric value 1)\n\t\t\t\tThe open() method has been successfully invoked. During this state request headers can be set using setRequestHeader() and the request can be made using the send() method.\n\n\t\t\t\tHEADERS_RECEIVED (numeric value 2)\n\t\t\t\tAll redirects (if any) have been followed and all HTTP headers of the final response have been received. Several response members of the object are now available.\n\n\t\t\t\tLOADING (numeric value 3)\n\t\t\t\tThe response entity body is being received.\n\n\t\t\t\tDONE (numeric value 4)\n\n\t\t\t\t@property readyState\n\t\t\t\t@type Number\n\t\t\t\t@default 0 (UNSENT)\n\t\t\t\t*/\n\t\t\t\treadyState: XMLHttpRequest.UNSENT,\n\n\t\t\t\t/**\n\t\t\t\tTrue when user credentials are to be included in a cross-origin request. False when they are to be excluded\n\t\t\t\tin a cross-origin request and when cookies are to be ignored in its response. Initially false.\n\n\t\t\t\t@property withCredentials\n\t\t\t\t@type Boolean\n\t\t\t\t@default false\n\t\t\t\t*/\n\t\t\t\twithCredentials: false,\n\n\t\t\t\t/**\n\t\t\t\tReturns the HTTP status code.\n\n\t\t\t\t@property status\n\t\t\t\t@type Number\n\t\t\t\t@default 0\n\t\t\t\t*/\n\t\t\t\tstatus: 0,\n\n\t\t\t\t/**\n\t\t\t\tReturns the HTTP status text.\n\n\t\t\t\t@property statusText\n\t\t\t\t@type String\n\t\t\t\t*/\n\t\t\t\tstatusText: \"\",\n\n\t\t\t\t/**\n\t\t\t\tReturns the response type. Can be set to change the response type. Values are:\n\t\t\t\tthe empty string (default), \"arraybuffer\", \"blob\", \"document\", \"json\", and \"text\".\n\n\t\t\t\t@property responseType\n\t\t\t\t@type String\n\t\t\t\t*/\n\t\t\t\tresponseType: \"\",\n\n\t\t\t\t/**\n\t\t\t\tReturns the document response entity body.\n\n\t\t\t\tThrows an \"InvalidStateError\" exception if responseType is not the empty string or \"document\".\n\n\t\t\t\t@property responseXML\n\t\t\t\t@type Document\n\t\t\t\t*/\n\t\t\t\tresponseXML: null,\n\n\t\t\t\t/**\n\t\t\t\tReturns the text response entity body.\n\n\t\t\t\tThrows an \"InvalidStateError\" exception if responseType is not the empty string or \"text\".\n\n\t\t\t\t@property responseText\n\t\t\t\t@type String\n\t\t\t\t*/\n\t\t\t\tresponseText: null,\n\n\t\t\t\t/**\n\t\t\t\tReturns the response entity body (http://www.w3.org/TR/XMLHttpRequest/#response-entity-body).\n\t\t\t\tCan become: ArrayBuffer, Blob, Document, JSON, Text\n\n\t\t\t\t@property response\n\t\t\t\t@type Mixed\n\t\t\t\t*/\n\t\t\t\tresponse: null\n\t\t\t},\n\n\t\t\t_async = true,\n\t\t\t_url,\n\t\t\t_method,\n\t\t\t_headers = {},\n\t\t\t_user,\n\t\t\t_password,\n\t\t\t_encoding = null,\n\t\t\t_mimeType = null,\n\n\t\t\t// flags\n\t\t\t_sync_flag = false,\n\t\t\t_send_flag = false,\n\t\t\t_upload_events_flag = false,\n\t\t\t_upload_complete_flag = false,\n\t\t\t_error_flag = false,\n\t\t\t_same_origin_flag = false,\n\n\t\t\t// times\n\t\t\t_start_time,\n\t\t\t_timeoutset_time,\n\n\t\t\t_finalMime = null,\n\t\t\t_finalCharset = null,\n\n\t\t\t_options = {},\n\t\t\t_xhr,\n\t\t\t_responseHeaders = '',\n\t\t\t_responseHeadersBag\n\t\t\t;\n\n\n\t\tBasic.extend(this, props, {\n\t\t\t/**\n\t\t\tUnique id of the component\n\n\t\t\t@property uid\n\t\t\t@type String\n\t\t\t*/\n\t\t\tuid: Basic.guid('uid_'),\n\n\t\t\t/**\n\t\t\tTarget for Upload events\n\n\t\t\t@property upload\n\t\t\t@type XMLHttpRequestUpload\n\t\t\t*/\n\t\t\tupload: new XMLHttpRequestUpload(),\n\n\n\t\t\t/**\n\t\t\tSets the request method, request URL, synchronous flag, request username, and request password.\n\n\t\t\tThrows a \"SyntaxError\" exception if one of the following is true:\n\n\t\t\tmethod is not a valid HTTP method.\n\t\t\turl cannot be resolved.\n\t\t\turl contains the \"user:password\" format in the userinfo production.\n\t\t\tThrows a \"SecurityError\" exception if method is a case-insensitive match for CONNECT, TRACE or TRACK.\n\n\t\t\tThrows an \"InvalidAccessError\" exception if one of the following is true:\n\n\t\t\tEither user or password is passed as argument and the origin of url does not match the XMLHttpRequest origin.\n\t\t\tThere is an associated XMLHttpRequest document and either the timeout attribute is not zero,\n\t\t\tthe withCredentials attribute is true, or the responseType attribute is not the empty string.\n\n\n\t\t\t@method open\n\t\t\t@param {String} method HTTP method to use on request\n\t\t\t@param {String} url URL to request\n\t\t\t@param {Boolean} [async=true] If false request will be done in synchronous manner. Asynchronous by default.\n\t\t\t@param {String} [user] Username to use in HTTP authentication process on server-side\n\t\t\t@param {String} [password] Password to use in HTTP authentication process on server-side\n\t\t\t*/\n\t\t\topen: function(method, url, async, user, password) {\n\t\t\t\tvar urlp;\n\n\t\t\t\t// first two arguments are required\n\t\t\t\tif (!method || !url) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.SYNTAX_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 2 - check if any code point in method is higher than U+00FF or after deflating method it does not match the method\n\t\t\t\tif (/[\\u0100-\\uffff]/.test(method) || Encode.utf8_encode(method) !== method) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.SYNTAX_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 3\n\t\t\t\tif (!!~Basic.inArray(method.toUpperCase(), ['CONNECT', 'DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT', 'TRACE', 'TRACK'])) {\n\t\t\t\t\t_method = method.toUpperCase();\n\t\t\t\t}\n\n\n\t\t\t\t// 4 - allowing these methods poses a security risk\n\t\t\t\tif (!!~Basic.inArray(_method, ['CONNECT', 'TRACE', 'TRACK'])) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.SECURITY_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 5\n\t\t\t\turl = Encode.utf8_encode(url);\n\n\t\t\t\t// 6 - Resolve url relative to the XMLHttpRequest base URL. If the algorithm returns an error, throw a \"SyntaxError\".\n\t\t\t\turlp = Url.parseUrl(url);\n\n\t\t\t\t_same_origin_flag = Url.hasSameOrigin(urlp);\n\n\t\t\t\t// 7 - manually build up absolute url\n\t\t\t\t_url = Url.resolveUrl(url);\n\n\t\t\t\t// 9-10, 12-13\n\t\t\t\tif ((user || password) && !_same_origin_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);\n\t\t\t\t}\n\n\t\t\t\t_user = user || urlp.user;\n\t\t\t\t_password = password || urlp.pass;\n\n\t\t\t\t// 11\n\t\t\t\t_async = async || true;\n\n\t\t\t\tif (_async === false && (_p('timeout') || _p('withCredentials') || _p('responseType') !== \"\")) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 14 - terminate abort()\n\n\t\t\t\t// 15 - terminate send()\n\n\t\t\t\t// 18\n\t\t\t\t_sync_flag = !_async;\n\t\t\t\t_send_flag = false;\n\t\t\t\t_headers = {};\n\t\t\t\t_reset.call(this);\n\n\t\t\t\t// 19\n\t\t\t\t_p('readyState', XMLHttpRequest.OPENED);\n\n\t\t\t\t// 20\n\t\t\t\tthis.dispatchEvent('readystatechange');\n\t\t\t},\n\n\t\t\t/**\n\t\t\tAppends an header to the list of author request headers, or if header is already\n\t\t\tin the list of author request headers, combines its value with value.\n\n\t\t\tThrows an \"InvalidStateError\" exception if the state is not OPENED or if the send() flag is set.\n\t\t\tThrows a \"SyntaxError\" exception if header is not a valid HTTP header field name or if value\n\t\t\tis not a valid HTTP header field value.\n\n\t\t\t@method setRequestHeader\n\t\t\t@param {String} header\n\t\t\t@param {String|Number} value\n\t\t\t*/\n\t\t\tsetRequestHeader: function(header, value) {\n\t\t\t\tvar uaHeaders = [ // these headers are controlled by the user agent\n\t\t\t\t\t\t\"accept-charset\",\n\t\t\t\t\t\t\"accept-encoding\",\n\t\t\t\t\t\t\"access-control-request-headers\",\n\t\t\t\t\t\t\"access-control-request-method\",\n\t\t\t\t\t\t\"connection\",\n\t\t\t\t\t\t\"content-length\",\n\t\t\t\t\t\t\"cookie\",\n\t\t\t\t\t\t\"cookie2\",\n\t\t\t\t\t\t\"content-transfer-encoding\",\n\t\t\t\t\t\t\"date\",\n\t\t\t\t\t\t\"expect\",\n\t\t\t\t\t\t\"host\",\n\t\t\t\t\t\t\"keep-alive\",\n\t\t\t\t\t\t\"origin\",\n\t\t\t\t\t\t\"referer\",\n\t\t\t\t\t\t\"te\",\n\t\t\t\t\t\t\"trailer\",\n\t\t\t\t\t\t\"transfer-encoding\",\n\t\t\t\t\t\t\"upgrade\",\n\t\t\t\t\t\t\"user-agent\",\n\t\t\t\t\t\t\"via\"\n\t\t\t\t\t];\n\n\t\t\t\t// 1-2\n\t\t\t\tif (_p('readyState') !== XMLHttpRequest.OPENED || _send_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 3\n\t\t\t\tif (/[\\u0100-\\uffff]/.test(header) || Encode.utf8_encode(header) !== header) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.SYNTAX_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 4\n\t\t\t\t/* this step is seemingly bypassed in browsers, probably to allow various unicode characters in header values\n\t\t\t\tif (/[\\u0100-\\uffff]/.test(value) || Encode.utf8_encode(value) !== value) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.SYNTAX_ERR);\n\t\t\t\t}*/\n\n\t\t\t\theader = Basic.trim(header).toLowerCase();\n\n\t\t\t\t// setting of proxy-* and sec-* headers is prohibited by spec\n\t\t\t\tif (!!~Basic.inArray(header, uaHeaders) || /^(proxy\\-|sec\\-)/.test(header)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// camelize\n\t\t\t\t// browsers lowercase header names (at least for custom ones)\n\t\t\t\t// header = header.replace(/\\b\\w/g, function($1) { return $1.toUpperCase(); });\n\n\t\t\t\tif (!_headers[header]) {\n\t\t\t\t\t_headers[header] = value;\n\t\t\t\t} else {\n\t\t\t\t\t// http://tools.ietf.org/html/rfc2616#section-4.2 (last paragraph)\n\t\t\t\t\t_headers[header] += ', ' + value;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Test if the specified header is already set on this request.\n\t\t\t * Returns a header value or boolean false if it's not yet set.\n\t\t\t *\n\t\t\t * @method hasRequestHeader\n\t\t\t * @param {String} header Name of the header to test\n\t\t\t * @return {Boolean|String}\n\t\t\t */\n\t\t\thasRequestHeader: function(header) {\n\t\t\t\treturn header && _headers[header.toLowerCase()] || false;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tReturns all headers from the response, with the exception of those whose field name is Set-Cookie or Set-Cookie2.\n\n\t\t\t@method getAllResponseHeaders\n\t\t\t@return {String} reponse headers or empty string\n\t\t\t*/\n\t\t\tgetAllResponseHeaders: function() {\n\t\t\t\treturn _responseHeaders || '';\n\t\t\t},\n\n\t\t\t/**\n\t\t\tReturns the header field value from the response of which the field name matches header,\n\t\t\tunless the field name is Set-Cookie or Set-Cookie2.\n\n\t\t\t@method getResponseHeader\n\t\t\t@param {String} header\n\t\t\t@return {String} value(s) for the specified header or null\n\t\t\t*/\n\t\t\tgetResponseHeader: function(header) {\n\t\t\t\theader = header.toLowerCase();\n\n\t\t\t\tif (_error_flag || !!~Basic.inArray(header, ['set-cookie', 'set-cookie2'])) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (_responseHeaders && _responseHeaders !== '') {\n\t\t\t\t\t// if we didn't parse response headers until now, do it and keep for later\n\t\t\t\t\tif (!_responseHeadersBag) {\n\t\t\t\t\t\t_responseHeadersBag = {};\n\t\t\t\t\t\tBasic.each(_responseHeaders.split(/\\r\\n/), function(line) {\n\t\t\t\t\t\t\tvar pair = line.split(/:\\s+/);\n\t\t\t\t\t\t\tif (pair.length === 2) { // last line might be empty, omit\n\t\t\t\t\t\t\t\tpair[0] = Basic.trim(pair[0]); // just in case\n\t\t\t\t\t\t\t\t_responseHeadersBag[pair[0].toLowerCase()] = { // simply to retain header name in original form\n\t\t\t\t\t\t\t\t\theader: pair[0],\n\t\t\t\t\t\t\t\t\tvalue: Basic.trim(pair[1])\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (_responseHeadersBag.hasOwnProperty(header)) {\n\t\t\t\t\t\treturn _responseHeadersBag[header].header + ': ' + _responseHeadersBag[header].value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tSets the Content-Type header for the response to mime.\n\t\t\tThrows an \"InvalidStateError\" exception if the state is LOADING or DONE.\n\t\t\tThrows a \"SyntaxError\" exception if mime is not a valid media type.\n\n\t\t\t@method overrideMimeType\n\t\t\t@param String mime Mime type to set\n\t\t\t*/\n\t\t\toverrideMimeType: function(mime) {\n\t\t\t\tvar matches, charset;\n\n\t\t\t\t// 1\n\t\t\t\tif (!!~Basic.inArray(_p('readyState'), [XMLHttpRequest.LOADING, XMLHttpRequest.DONE])) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 2\n\t\t\t\tmime = Basic.trim(mime.toLowerCase());\n\n\t\t\t\tif (/;/.test(mime) && (matches = mime.match(/^([^;]+)(?:;\\scharset\\=)?(.*)$/))) {\n\t\t\t\t\tmime = matches[1];\n\t\t\t\t\tif (matches[2]) {\n\t\t\t\t\t\tcharset = matches[2];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!Mime.mimes[mime]) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.SYNTAX_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 3-4\n\t\t\t\t_finalMime = mime;\n\t\t\t\t_finalCharset = charset;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tInitiates the request. The optional argument provides the request entity body.\n\t\t\tThe argument is ignored if request method is GET or HEAD.\n\n\t\t\tThrows an \"InvalidStateError\" exception if the state is not OPENED or if the send() flag is set.\n\n\t\t\t@method send\n\t\t\t@param {Blob|Document|String|FormData} [data] Request entity body\n\t\t\t@param {Object} [options] Set of requirements and pre-requisities for runtime initialization\n\t\t\t*/\n\t\t\tsend: function(data, options) {\n\t\t\t\tif (Basic.typeOf(options) === 'string') {\n\t\t\t\t\t_options = { ruid: options };\n\t\t\t\t} else if (!options) {\n\t\t\t\t\t_options = {};\n\t\t\t\t} else {\n\t\t\t\t\t_options = options;\n\t\t\t\t}\n\n\t\t\t\t// 1-2\n\t\t\t\tif (this.readyState !== XMLHttpRequest.OPENED || _send_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 3\n\t\t\t\t// sending Blob\n\t\t\t\tif (data instanceof Blob) {\n\t\t\t\t\t_options.ruid = data.ruid;\n\t\t\t\t\t_mimeType = data.type || 'application/octet-stream';\n\t\t\t\t}\n\n\t\t\t\t// FormData\n\t\t\t\telse if (data instanceof FormData) {\n\t\t\t\t\tif (data.hasBlob()) {\n\t\t\t\t\t\tvar blob = data.getBlob();\n\t\t\t\t\t\t_options.ruid = blob.ruid;\n\t\t\t\t\t\t_mimeType = blob.type || 'application/octet-stream';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// DOMString\n\t\t\t\telse if (typeof data === 'string') {\n\t\t\t\t\t_encoding = 'UTF-8';\n\t\t\t\t\t_mimeType = 'text/plain;charset=UTF-8';\n\n\t\t\t\t\t// data should be converted to Unicode and encoded as UTF-8\n\t\t\t\t\tdata = Encode.utf8_encode(data);\n\t\t\t\t}\n\n\t\t\t\t// if withCredentials not set, but requested, set it automatically\n\t\t\t\tif (!this.withCredentials) {\n\t\t\t\t\tthis.withCredentials = (_options.required_caps && _options.required_caps.send_browser_cookies) && !_same_origin_flag;\n\t\t\t\t}\n\n\t\t\t\t// 4 - storage mutex\n\t\t\t\t// 5\n\t\t\t\t_upload_events_flag = (!_sync_flag && this.upload.hasEventListener()); // DSAP\n\t\t\t\t// 6\n\t\t\t\t_error_flag = false;\n\t\t\t\t// 7\n\t\t\t\t_upload_complete_flag = !data;\n\t\t\t\t// 8 - Asynchronous steps\n\t\t\t\tif (!_sync_flag) {\n\t\t\t\t\t// 8.1\n\t\t\t\t\t_send_flag = true;\n\t\t\t\t\t// 8.2\n\t\t\t\t\t// this.dispatchEvent('loadstart'); // will be dispatched either by native or runtime xhr\n\t\t\t\t\t// 8.3\n\t\t\t\t\t//if (!_upload_complete_flag) {\n\t\t\t\t\t\t// this.upload.dispatchEvent('loadstart');\t// will be dispatched either by native or runtime xhr\n\t\t\t\t\t//}\n\t\t\t\t}\n\t\t\t\t// 8.5 - Return the send() method call, but continue running the steps in this algorithm.\n\t\t\t\t_doXHR.call(this, data);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tCancels any network activity.\n\n\t\t\t@method abort\n\t\t\t*/\n\t\t\tabort: function() {\n\t\t\t\t_error_flag = true;\n\t\t\t\t_sync_flag = false;\n\n\t\t\t\tif (!~Basic.inArray(_p('readyState'), [XMLHttpRequest.UNSENT, XMLHttpRequest.OPENED, XMLHttpRequest.DONE])) {\n\t\t\t\t\t_p('readyState', XMLHttpRequest.DONE);\n\t\t\t\t\t_send_flag = false;\n\n\t\t\t\t\tif (_xhr) {\n\t\t\t\t\t\t_xhr.getRuntime().exec.call(_xhr, 'XMLHttpRequest', 'abort', _upload_complete_flag);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t\t}\n\n\t\t\t\t\t_upload_complete_flag = true;\n\t\t\t\t} else {\n\t\t\t\t\t_p('readyState', XMLHttpRequest.UNSENT);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tif (_xhr) {\n\t\t\t\t\tif (Basic.typeOf(_xhr.destroy) === 'function') {\n\t\t\t\t\t\t_xhr.destroy();\n\t\t\t\t\t}\n\t\t\t\t\t_xhr = null;\n\t\t\t\t}\n\n\t\t\t\tthis.unbindAll();\n\n\t\t\t\tif (this.upload) {\n\t\t\t\t\tthis.upload.unbindAll();\n\t\t\t\t\tthis.upload = null;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.handleEventProps(dispatches.concat(['readystatechange'])); // for historical reasons\n\t\tthis.upload.handleEventProps(dispatches);\n\n\t\t/* this is nice, but maybe too lengthy\n\n\t\t// if supported by JS version, set getters/setters for specific properties\n\t\to.defineProperty(this, 'readyState', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\treturn _p('readyState');\n\t\t\t}\n\t\t});\n\n\t\to.defineProperty(this, 'timeout', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\treturn _p('timeout');\n\t\t\t},\n\n\t\t\tset: function(value) {\n\n\t\t\t\tif (_sync_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);\n\t\t\t\t}\n\n\t\t\t\t// timeout still should be measured relative to the start time of request\n\t\t\t\t_timeoutset_time = (new Date).getTime();\n\n\t\t\t\t_p('timeout', value);\n\t\t\t}\n\t\t});\n\n\t\t// the withCredentials attribute has no effect when fetching same-origin resources\n\t\to.defineProperty(this, 'withCredentials', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\treturn _p('withCredentials');\n\t\t\t},\n\n\t\t\tset: function(value) {\n\t\t\t\t// 1-2\n\t\t\t\tif (!~o.inArray(_p('readyState'), [XMLHttpRequest.UNSENT, XMLHttpRequest.OPENED]) || _send_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 3-4\n\t\t\t\tif (_anonymous_flag || _sync_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 5\n\t\t\t\t_p('withCredentials', value);\n\t\t\t}\n\t\t});\n\n\t\to.defineProperty(this, 'status', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\treturn _p('status');\n\t\t\t}\n\t\t});\n\n\t\to.defineProperty(this, 'statusText', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\treturn _p('statusText');\n\t\t\t}\n\t\t});\n\n\t\to.defineProperty(this, 'responseType', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\treturn _p('responseType');\n\t\t\t},\n\n\t\t\tset: function(value) {\n\t\t\t\t// 1\n\t\t\t\tif (!!~o.inArray(_p('readyState'), [XMLHttpRequest.LOADING, XMLHttpRequest.DONE])) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 2\n\t\t\t\tif (_sync_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 3\n\t\t\t\t_p('responseType', value.toLowerCase());\n\t\t\t}\n\t\t});\n\n\t\to.defineProperty(this, 'responseText', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\t// 1\n\t\t\t\tif (!~o.inArray(_p('responseType'), ['', 'text'])) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 2-3\n\t\t\t\tif (_p('readyState') !== XMLHttpRequest.DONE && _p('readyState') !== XMLHttpRequest.LOADING || _error_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\treturn _p('responseText');\n\t\t\t}\n\t\t});\n\n\t\to.defineProperty(this, 'responseXML', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\t// 1\n\t\t\t\tif (!~o.inArray(_p('responseType'), ['', 'document'])) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\t// 2-3\n\t\t\t\tif (_p('readyState') !== XMLHttpRequest.DONE || _error_flag) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\n\t\t\t\treturn _p('responseXML');\n\t\t\t}\n\t\t});\n\n\t\to.defineProperty(this, 'response', {\n\t\t\tconfigurable: false,\n\n\t\t\tget: function() {\n\t\t\t\tif (!!~o.inArray(_p('responseType'), ['', 'text'])) {\n\t\t\t\t\tif (_p('readyState') !== XMLHttpRequest.DONE && _p('readyState') !== XMLHttpRequest.LOADING || _error_flag) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (_p('readyState') !== XMLHttpRequest.DONE || _error_flag) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn _p('response');\n\t\t\t}\n\t\t});\n\n\t\t*/\n\n\t\tfunction _p(prop, value) {\n\t\t\tif (!props.hasOwnProperty(prop)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (arguments.length === 1) { // get\n\t\t\t\treturn Env.can('define_property') ? props[prop] : self[prop];\n\t\t\t} else { // set\n\t\t\t\tif (Env.can('define_property')) {\n\t\t\t\t\tprops[prop] = value;\n\t\t\t\t} else {\n\t\t\t\t\tself[prop] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/*\n\t\tfunction _toASCII(str, AllowUnassigned, UseSTD3ASCIIRules) {\n\t\t\t// TODO: http://tools.ietf.org/html/rfc3490#section-4.1\n\t\t\treturn str.toLowerCase();\n\t\t}\n\t\t*/\n\n\n\t\tfunction _doXHR(data) {\n\t\t\tvar self = this;\n\n\t\t\t_start_time = new Date().getTime();\n\n\t\t\t_xhr = new RuntimeTarget();\n\n\t\t\tfunction loadEnd() {\n\t\t\t\tif (_xhr) { // it could have been destroyed by now\n\t\t\t\t\t_xhr.destroy();\n\t\t\t\t\t_xhr = null;\n\t\t\t\t}\n\t\t\t\tself.dispatchEvent('loadend');\n\t\t\t\tself = null;\n\t\t\t}\n\n\t\t\tfunction exec(runtime) {\n\t\t\t\t_xhr.bind('LoadStart', function(e) {\n\t\t\t\t\t_p('readyState', XMLHttpRequest.LOADING);\n\t\t\t\t\tself.dispatchEvent('readystatechange');\n\n\t\t\t\t\tself.dispatchEvent(e);\n\n\t\t\t\t\tif (_upload_events_flag) {\n\t\t\t\t\t\tself.upload.dispatchEvent(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t_xhr.bind('Progress', function(e) {\n\t\t\t\t\tif (_p('readyState') !== XMLHttpRequest.LOADING) {\n\t\t\t\t\t\t_p('readyState', XMLHttpRequest.LOADING); // LoadStart unreliable (in Flash for example)\n\t\t\t\t\t\tself.dispatchEvent('readystatechange');\n\t\t\t\t\t}\n\t\t\t\t\tself.dispatchEvent(e);\n\t\t\t\t});\n\n\t\t\t\t_xhr.bind('UploadProgress', function(e) {\n\t\t\t\t\tif (_upload_events_flag) {\n\t\t\t\t\t\tself.upload.dispatchEvent({\n\t\t\t\t\t\t\ttype: 'progress',\n\t\t\t\t\t\t\tlengthComputable: false,\n\t\t\t\t\t\t\ttotal: e.total,\n\t\t\t\t\t\t\tloaded: e.loaded\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t_xhr.bind('Load', function(e) {\n\t\t\t\t\t_p('readyState', XMLHttpRequest.DONE);\n\t\t\t\t\t_p('status', Number(runtime.exec.call(_xhr, 'XMLHttpRequest', 'getStatus') || 0));\n\t\t\t\t\t_p('statusText', httpCode[_p('status')] || \"\");\n\n\t\t\t\t\t_p('response', runtime.exec.call(_xhr, 'XMLHttpRequest', 'getResponse', _p('responseType')));\n\n\t\t\t\t\tif (!!~Basic.inArray(_p('responseType'), ['text', ''])) {\n\t\t\t\t\t\t_p('responseText', _p('response'));\n\t\t\t\t\t} else if (_p('responseType') === 'document') {\n\t\t\t\t\t\t_p('responseXML', _p('response'));\n\t\t\t\t\t}\n\n\t\t\t\t\t_responseHeaders = runtime.exec.call(_xhr, 'XMLHttpRequest', 'getAllResponseHeaders');\n\n\t\t\t\t\tself.dispatchEvent('readystatechange');\n\n\t\t\t\t\tif (_p('status') > 0) { // status 0 usually means that server is unreachable\n\t\t\t\t\t\tif (_upload_events_flag) {\n\t\t\t\t\t\t\tself.upload.dispatchEvent(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.dispatchEvent(e);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_error_flag = true;\n\t\t\t\t\t\tself.dispatchEvent('error');\n\t\t\t\t\t}\n\t\t\t\t\tloadEnd();\n\t\t\t\t});\n\n\t\t\t\t_xhr.bind('Abort', function(e) {\n\t\t\t\t\tself.dispatchEvent(e);\n\t\t\t\t\tloadEnd();\n\t\t\t\t});\n\n\t\t\t\t_xhr.bind('Error', function(e) {\n\t\t\t\t\t_error_flag = true;\n\t\t\t\t\t_p('readyState', XMLHttpRequest.DONE);\n\t\t\t\t\tself.dispatchEvent('readystatechange');\n\t\t\t\t\t_upload_complete_flag = true;\n\t\t\t\t\tself.dispatchEvent(e);\n\t\t\t\t\tloadEnd();\n\t\t\t\t});\n\n\t\t\t\truntime.exec.call(_xhr, 'XMLHttpRequest', 'send', {\n\t\t\t\t\turl: _url,\n\t\t\t\t\tmethod: _method,\n\t\t\t\t\tasync: _async,\n\t\t\t\t\tuser: _user,\n\t\t\t\t\tpassword: _password,\n\t\t\t\t\theaders: _headers,\n\t\t\t\t\tmimeType: _mimeType,\n\t\t\t\t\tencoding: _encoding,\n\t\t\t\t\tresponseType: self.responseType,\n\t\t\t\t\twithCredentials: self.withCredentials,\n\t\t\t\t\toptions: _options\n\t\t\t\t}, data);\n\t\t\t}\n\n\t\t\t// clarify our requirements\n\t\t\tif (typeof(_options.required_caps) === 'string') {\n\t\t\t\t_options.required_caps = Runtime.parseCaps(_options.required_caps);\n\t\t\t}\n\n\t\t\t_options.required_caps = Basic.extend({}, _options.required_caps, {\n\t\t\t\treturn_response_type: self.responseType\n\t\t\t});\n\n\t\t\tif (data instanceof FormData) {\n\t\t\t\t_options.required_caps.send_multipart = true;\n\t\t\t}\n\n\t\t\tif (!Basic.isEmptyObj(_headers)) {\n\t\t\t\t_options.required_caps.send_custom_headers = true;\n\t\t\t}\n\n\t\t\tif (!_same_origin_flag) {\n\t\t\t\t_options.required_caps.do_cors = true;\n\t\t\t}\n\n\n\t\t\tif (_options.ruid) { // we do not need to wait if we can connect directly\n\t\t\t\texec(_xhr.connectRuntime(_options));\n\t\t\t} else {\n\t\t\t\t_xhr.bind('RuntimeInit', function(e, runtime) {\n\t\t\t\t\texec(runtime);\n\t\t\t\t});\n\t\t\t\t_xhr.bind('RuntimeError', function(e, err) {\n\t\t\t\t\tself.dispatchEvent('RuntimeError', err);\n\t\t\t\t});\n\t\t\t\t_xhr.connectRuntime(_options);\n\t\t\t}\n\t\t}\n\n\n\t\tfunction _reset() {\n\t\t\t_p('responseText', \"\");\n\t\t\t_p('responseXML', null);\n\t\t\t_p('response', null);\n\t\t\t_p('status', 0);\n\t\t\t_p('statusText', \"\");\n\t\t\t_start_time = _timeoutset_time = null;\n\t\t}\n\t}\n\n\tXMLHttpRequest.UNSENT = 0;\n\tXMLHttpRequest.OPENED = 1;\n\tXMLHttpRequest.HEADERS_RECEIVED = 2;\n\tXMLHttpRequest.LOADING = 3;\n\tXMLHttpRequest.DONE = 4;\n\n\tXMLHttpRequest.prototype = EventTarget.instance;\n\n\treturn XMLHttpRequest;\n});\n\n// Included from: src/javascript/runtime/Transporter.js\n\n/**\n * Transporter.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine(\"moxie/runtime/Transporter\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Encode\",\n\t\"moxie/runtime/RuntimeClient\",\n\t\"moxie/core/EventTarget\"\n], function(Basic, Encode, RuntimeClient, EventTarget) {\n\n\t/**\n\t@class moxie/runtime/Transporter\n\t@private\n\t@constructor\n\t*/\n\tfunction Transporter() {\n\t\tvar mod, _runtime, _data, _size, _pos, _chunk_size;\n\n\t\tRuntimeClient.call(this);\n\n\t\tBasic.extend(this, {\n\t\t\tuid: Basic.guid('uid_'),\n\n\t\t\tstate: Transporter.IDLE,\n\n\t\t\tresult: null,\n\n\t\t\ttransport: function(data, type, options) {\n\t\t\t\tvar self = this;\n\n\t\t\t\toptions = Basic.extend({\n\t\t\t\t\tchunk_size: 204798\n\t\t\t\t}, options);\n\n\t\t\t\t// should divide by three, base64 requires this\n\t\t\t\tif ((mod = options.chunk_size % 3)) {\n\t\t\t\t\toptions.chunk_size += 3 - mod;\n\t\t\t\t}\n\n\t\t\t\t_chunk_size = options.chunk_size;\n\n\t\t\t\t_reset.call(this);\n\t\t\t\t_data = data;\n\t\t\t\t_size = data.length;\n\n\t\t\t\tif (Basic.typeOf(options) === 'string' || options.ruid) {\n\t\t\t\t\t_run.call(self, type, this.connectRuntime(options));\n\t\t\t\t} else {\n\t\t\t\t\t// we require this to run only once\n\t\t\t\t\tvar cb = function(e, runtime) {\n\t\t\t\t\t\tself.unbind(\"RuntimeInit\", cb);\n\t\t\t\t\t\t_run.call(self, type, runtime);\n\t\t\t\t\t};\n\t\t\t\t\tthis.bind(\"RuntimeInit\", cb);\n\t\t\t\t\tthis.connectRuntime(options);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tself.state = Transporter.IDLE;\n\t\t\t\tif (_runtime) {\n\t\t\t\t\t_runtime.exec.call(self, 'Transporter', 'clear');\n\t\t\t\t\tself.trigger(\"TransportingAborted\");\n\t\t\t\t}\n\n\t\t\t\t_reset.call(self);\n\t\t\t},\n\n\n\t\t\tdestroy: function() {\n\t\t\t\tthis.unbindAll();\n\t\t\t\t_runtime = null;\n\t\t\t\tthis.disconnectRuntime();\n\t\t\t\t_reset.call(this);\n\t\t\t}\n\t\t});\n\n\t\tfunction _reset() {\n\t\t\t_size = _pos = 0;\n\t\t\t_data = this.result = null;\n\t\t}\n\n\t\tfunction _run(type, runtime) {\n\t\t\tvar self = this;\n\n\t\t\t_runtime = runtime;\n\n\t\t\t//self.unbind(\"RuntimeInit\");\n\n\t\t\tself.bind(\"TransportingProgress\", function(e) {\n\t\t\t\t_pos = e.loaded;\n\n\t\t\t\tif (_pos < _size && Basic.inArray(self.state, [Transporter.IDLE, Transporter.DONE]) === -1) {\n\t\t\t\t\t_transport.call(self);\n\t\t\t\t}\n\t\t\t}, 999);\n\n\t\t\tself.bind(\"TransportingComplete\", function() {\n\t\t\t\t_pos = _size;\n\t\t\t\tself.state = Transporter.DONE;\n\t\t\t\t_data = null; // clean a bit\n\t\t\t\tself.result = _runtime.exec.call(self, 'Transporter', 'getAsBlob', type || '');\n\t\t\t}, 999);\n\n\t\t\tself.state = Transporter.BUSY;\n\t\t\tself.trigger(\"TransportingStarted\");\n\t\t\t_transport.call(self);\n\t\t}\n\n\t\tfunction _transport() {\n\t\t\tvar self = this,\n\t\t\t\tchunk,\n\t\t\t\tbytesLeft = _size - _pos;\n\n\t\t\tif (_chunk_size > bytesLeft) {\n\t\t\t\t_chunk_size = bytesLeft;\n\t\t\t}\n\n\t\t\tchunk = Encode.btoa(_data.substr(_pos, _chunk_size));\n\t\t\t_runtime.exec.call(self, 'Transporter', 'receive', chunk, _size);\n\t\t}\n\t}\n\n\tTransporter.IDLE = 0;\n\tTransporter.BUSY = 1;\n\tTransporter.DONE = 2;\n\n\tTransporter.prototype = EventTarget.instance;\n\n\treturn Transporter;\n});\n\n// Included from: src/javascript/image/Image.js\n\n/**\n * Image.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\ndefine(\"moxie/image/Image\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/file/FileReaderSync\",\n\t\"moxie/xhr/XMLHttpRequest\",\n\t\"moxie/runtime/Runtime\",\n\t\"moxie/runtime/RuntimeClient\",\n\t\"moxie/runtime/Transporter\",\n\t\"moxie/core/utils/Env\",\n\t\"moxie/core/EventTarget\",\n\t\"moxie/file/Blob\",\n\t\"moxie/file/File\",\n\t\"moxie/core/utils/Encode\"\n], function(Basic, Dom, x, FileReaderSync, XMLHttpRequest, Runtime, RuntimeClient, Transporter, Env, EventTarget, Blob, File, Encode) {\n\t/**\n\tImage preloading and manipulation utility. Additionally it provides access to image meta info (Exif, GPS) and raw binary data.\n\n\t@class moxie/image/Image\n\t@constructor\n\t@extends EventTarget\n\t*/\n\tvar dispatches = [\n\t\t'progress',\n\n\t\t/**\n\t\tDispatched when loading is complete.\n\n\t\t@event load\n\t\t@param {Object} event\n\t\t*/\n\t\t'load',\n\n\t\t'error',\n\n\t\t/**\n\t\tDispatched when resize operation is complete.\n\n\t\t@event resize\n\t\t@param {Object} event\n\t\t*/\n\t\t'resize',\n\n\t\t/**\n\t\tDispatched when visual representation of the image is successfully embedded\n\t\tinto the corresponsing container.\n\n\t\t@event embedded\n\t\t@param {Object} event\n\t\t*/\n\t\t'embedded'\n\t];\n\n\tfunction Image() {\n\n\t\tRuntimeClient.call(this);\n\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tUnique id of the component\n\n\t\t\t@property uid\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\tuid: Basic.guid('uid_'),\n\n\t\t\t/**\n\t\t\tUnique id of the connected runtime, if any.\n\n\t\t\t@property ruid\n\t\t\t@type {String}\n\t\t\t*/\n\t\t\truid: null,\n\n\t\t\t/**\n\t\t\tName of the file, that was used to create an image, if available. If not equals to empty string.\n\n\t\t\t@property name\n\t\t\t@type {String}\n\t\t\t@default \"\"\n\t\t\t*/\n\t\t\tname: \"\",\n\n\t\t\t/**\n\t\t\tSize of the image in bytes. Actual value is set only after image is preloaded.\n\n\t\t\t@property size\n\t\t\t@type {Number}\n\t\t\t@default 0\n\t\t\t*/\n\t\t\tsize: 0,\n\n\t\t\t/**\n\t\t\tWidth of the image. Actual value is set only after image is preloaded.\n\n\t\t\t@property width\n\t\t\t@type {Number}\n\t\t\t@default 0\n\t\t\t*/\n\t\t\twidth: 0,\n\n\t\t\t/**\n\t\t\tHeight of the image. Actual value is set only after image is preloaded.\n\n\t\t\t@property height\n\t\t\t@type {Number}\n\t\t\t@default 0\n\t\t\t*/\n\t\t\theight: 0,\n\n\t\t\t/**\n\t\t\tMime type of the image. Currently only image/jpeg and image/png are supported. Actual value is set only after image is preloaded.\n\n\t\t\t@property type\n\t\t\t@type {String}\n\t\t\t@default \"\"\n\t\t\t*/\n\t\t\ttype: \"\",\n\n\t\t\t/**\n\t\t\tHolds meta info (Exif, GPS). Is populated only for image/jpeg. Actual value is set only after image is preloaded.\n\n\t\t\t@property meta\n\t\t\t@type {Object}\n\t\t\t@default {}\n\t\t\t*/\n\t\t\tmeta: {},\n\n\t\t\t/**\n\t\t\tAlias for load method, that takes another moxie.image.Image object as a source (see load).\n\n\t\t\t@method clone\n\t\t\t@param {Image} src Source for the image\n\t\t\t@param {Boolean} [exact=false] Whether to activate in-depth clone mode\n\t\t\t*/\n\t\t\tclone: function() {\n\t\t\t\tthis.load.apply(this, arguments);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tLoads image from various sources. Currently the source for new image can be: moxie.image.Image,\n\t\t\tmoxie.file.Blob/moxie.file.File, native Blob/File, dataUrl or URL. Depending on the type of the\n\t\t\tsource, arguments - differ. When source is URL, Image will be downloaded from remote destination\n\t\t\tand loaded in memory.\n\n\t\t\t@example\n\t\t\t\tvar img = new moxie.image.Image();\n\t\t\t\timg.onload = function() {\n\t\t\t\t\tvar blob = img.getAsBlob();\n\n\t\t\t\t\tvar formData = new moxie.xhr.FormData();\n\t\t\t\t\tformData.append('file', blob);\n\n\t\t\t\t\tvar xhr = new moxie.xhr.XMLHttpRequest();\n\t\t\t\t\txhr.onload = function() {\n\t\t\t\t\t\t// upload complete\n\t\t\t\t\t};\n\t\t\t\t\txhr.open('post', 'upload.php');\n\t\t\t\t\txhr.send(formData);\n\t\t\t\t};\n\t\t\t\timg.load(\"http://www.moxiecode.com/images/mox-logo.jpg\"); // notice file extension (.jpg)\n\n\n\t\t\t@method load\n\t\t\t@param {Image|Blob|File|String} src Source for the image\n\t\t\t@param {Boolean|Object} [mixed]\n\t\t\t*/\n\t\t\tload: function() {\n\t\t\t\t_load.apply(this, arguments);\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\tResizes the image to fit the specified width/height. If crop is specified, image will also be\n\t\t\tcropped to the exact dimensions.\n\n\t\t\t@method resize\n\t\t\t@since 3.0\n\t\t\t@param {Object} options\n\t\t\t\t@param {Number} options.width Resulting width\n\t\t\t\t@param {Number} [options.height=width] Resulting height (optional, if not supplied will default to width)\n\t\t\t\t@param {String} [options.type='image/jpeg'] MIME type of the resulting image\n\t\t\t\t@param {Number} [options.quality=90] In the case of JPEG, controls the quality of resulting image\n\t\t\t\t@param {Boolean} [options.crop='cc'] If not falsy, image will be cropped, by default from center\n\t\t\t\t@param {Boolean} [options.fit=true] Whether to upscale the image to fit the exact dimensions\n\t\t\t\t@param {Boolean} [options.preserveHeaders=true] Whether to preserve meta headers (on JPEGs after resize)\n\t\t\t\t@param {String} [options.resample='default'] Resampling algorithm to use during resize\n\t\t\t\t@param {Boolean} [options.multipass=true] Whether to scale the image in steps (results in better quality)\n\t\t\t*/\n\t\t\tresize: function(options) {\n\t\t\t\tvar self = this;\n\t\t\t\tvar orientation;\n\t\t\t\tvar scale;\n\n\t\t\t\tvar srcRect = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\twidth: self.width,\n\t\t\t\t\theight: self.height\n\t\t\t\t};\n\n\t\t\t\tvar opts = Basic.extendIf({\n\t\t\t\t\twidth: self.width,\n\t\t\t\t\theight: self.height,\n\t\t\t\t\ttype: self.type || 'image/jpeg',\n\t\t\t\t\tquality: 90,\n\t\t\t\t\tcrop: false,\n\t\t\t\t\tfit: true,\n\t\t\t\t\tpreserveHeaders: true,\n\t\t\t\t\tresample: 'default',\n\t\t\t\t\tmultipass: true\n\t\t\t\t}, options);\n\n\t\t\t\ttry {\n\t\t\t\t\tif (!self.size) { // only preloaded image objects can be used as source\n\t\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t\t}\n\n\t\t\t\t\t// no way to reliably intercept the crash due to high resolution, so we simply avoid it\n\t\t\t\t\tif (self.width > Image.MAX_RESIZE_WIDTH || self.height > Image.MAX_RESIZE_HEIGHT) {\n\t\t\t\t\t\tthrow new x.ImageError(x.ImageError.MAX_RESOLUTION_ERR);\n\t\t\t\t\t}\n\n\t\t\t\t\t// take into account orientation tag\n\t\t\t\t\torientation = (self.meta && self.meta.tiff && self.meta.tiff.Orientation) || 1;\n\n\t\t\t\t\tif (Basic.inArray(orientation, [5,6,7,8]) !== -1) { // values that require 90 degree rotation\n\t\t\t\t\t\tvar tmp = opts.width;\n\t\t\t\t\t\topts.width = opts.height;\n\t\t\t\t\t\topts.height = tmp;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (opts.crop) {\n\t\t\t\t\t\tscale = Math.max(opts.width/self.width, opts.height/self.height);\n\n\t\t\t\t\t\tif (options.fit) {\n\t\t\t\t\t\t\t// first scale it up or down to fit the original image\n\t\t\t\t\t\t\tsrcRect.width = Math.min(Math.ceil(opts.width/scale), self.width);\n\t\t\t\t\t\t\tsrcRect.height = Math.min(Math.ceil(opts.height/scale), self.height);\n\n\t\t\t\t\t\t\t// recalculate the scale for adapted dimensions\n\t\t\t\t\t\t\tscale = opts.width/srcRect.width;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsrcRect.width = Math.min(opts.width, self.width);\n\t\t\t\t\t\t\tsrcRect.height = Math.min(opts.height, self.height);\n\n\t\t\t\t\t\t\t// now we do not need to scale it any further\n\t\t\t\t\t\t\tscale = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (typeof(opts.crop) === 'boolean') {\n\t\t\t\t\t\t\topts.crop = 'cc';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tswitch (opts.crop.toLowerCase().replace(/_/, '-')) {\n\t\t\t\t\t\t\tcase 'rb':\n\t\t\t\t\t\t\tcase 'right-bottom':\n\t\t\t\t\t\t\t\tsrcRect.x = self.width - srcRect.width;\n\t\t\t\t\t\t\t\tsrcRect.y = self.height - srcRect.height;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'cb':\n\t\t\t\t\t\t\tcase 'center-bottom':\n\t\t\t\t\t\t\t\tsrcRect.x = Math.floor((self.width - srcRect.width) / 2);\n\t\t\t\t\t\t\t\tsrcRect.y = self.height - srcRect.height;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'lb':\n\t\t\t\t\t\t\tcase 'left-bottom':\n\t\t\t\t\t\t\t\tsrcRect.x = 0;\n\t\t\t\t\t\t\t\tsrcRect.y = self.height - srcRect.height;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'lt':\n\t\t\t\t\t\t\tcase 'left-top':\n\t\t\t\t\t\t\t\tsrcRect.x = 0;\n\t\t\t\t\t\t\t\tsrcRect.y = 0;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'ct':\n\t\t\t\t\t\t\tcase 'center-top':\n\t\t\t\t\t\t\t\tsrcRect.x = Math.floor((self.width - srcRect.width) / 2);\n\t\t\t\t\t\t\t\tsrcRect.y = 0;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'rt':\n\t\t\t\t\t\t\tcase 'right-top':\n\t\t\t\t\t\t\t\tsrcRect.x = self.width - srcRect.width;\n\t\t\t\t\t\t\t\tsrcRect.y = 0;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'rc':\n\t\t\t\t\t\t\tcase 'right-center':\n\t\t\t\t\t\t\tcase 'right-middle':\n\t\t\t\t\t\t\t\tsrcRect.x = self.width - srcRect.width;\n\t\t\t\t\t\t\t\tsrcRect.y = Math.floor((self.height - srcRect.height) / 2);\n\t\t\t\t\t\t\t\tbreak;\n\n\n\t\t\t\t\t\t\tcase 'lc':\n\t\t\t\t\t\t\tcase 'left-center':\n\t\t\t\t\t\t\tcase 'left-middle':\n\t\t\t\t\t\t\t\tsrcRect.x = 0;\n\t\t\t\t\t\t\t\tsrcRect.y = Math.floor((self.height - srcRect.height) / 2);\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'cc':\n\t\t\t\t\t\t\tcase 'center-center':\n\t\t\t\t\t\t\tcase 'center-middle':\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tsrcRect.x = Math.floor((self.width - srcRect.width) / 2);\n\t\t\t\t\t\t\t\tsrcRect.y = Math.floor((self.height - srcRect.height) / 2);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// original image might be smaller than requested crop, so - avoid negative values\n\t\t\t\t\t\tsrcRect.x = Math.max(srcRect.x, 0);\n\t\t\t\t\t\tsrcRect.y = Math.max(srcRect.y, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscale = Math.min(opts.width/self.width, opts.height/self.height);\n\n\t\t\t\t\t\t// do not upscale if we were asked to not fit it\n\t\t\t\t\t\tif (scale > 1 && !opts.fit) {\n\t\t\t\t\t\t\tscale = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.exec('Image', 'resize', srcRect, scale, opts);\n\t\t\t\t} catch(ex) {\n\t\t\t\t\t// for now simply trigger error event\n\t\t\t\t\tself.trigger('error', ex.code);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\tDownsizes the image to fit the specified width/height. If crop is supplied, image will be cropped to exact dimensions.\n\n\t\t\t@method downsize\n\t\t\t@deprecated use resize()\n\t\t\t*/\n\t\t\tdownsize: function(options) {\n\t\t\t\tvar defaults = {\n\t\t\t\t\twidth: this.width,\n\t\t\t\t\theight: this.height,\n\t\t\t\t\ttype: this.type || 'image/jpeg',\n\t\t\t\t\tquality: 90,\n\t\t\t\t\tcrop: false,\n\t\t\t\t\tfit: false,\n\t\t\t\t\tpreserveHeaders: true,\n\t\t\t\t\tresample: 'default'\n\t\t\t\t}, opts;\n\n\t\t\t\tif (typeof(options) === 'object') {\n\t\t\t\t\topts = Basic.extend(defaults, options);\n\t\t\t\t} else {\n\t\t\t\t\t// for backward compatibility\n\t\t\t\t\topts = Basic.extend(defaults, {\n\t\t\t\t\t\twidth: arguments[0],\n\t\t\t\t\t\theight: arguments[1],\n\t\t\t\t\t\tcrop: arguments[2],\n\t\t\t\t\t\tpreserveHeaders: arguments[3]\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.resize(opts);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tAlias for downsize(width, height, true). (see downsize)\n\n\t\t\t@method crop\n\t\t\t@param {Number} width Resulting width\n\t\t\t@param {Number} [height=width] Resulting height (optional, if not supplied will default to width)\n\t\t\t@param {Boolean} [preserveHeaders=true] Whether to preserve meta headers (on JPEGs after resize)\n\t\t\t*/\n\t\t\tcrop: function(width, height, preserveHeaders) {\n\t\t\t\tthis.downsize(width, height, true, preserveHeaders);\n\t\t\t},\n\n\t\t\tgetAsCanvas: function() {\n\t\t\t\tif (!Env.can('create_canvas')) {\n\t\t\t\t\tthrow new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);\n\t\t\t\t}\n\t\t\t\treturn this.exec('Image', 'getAsCanvas');\n\t\t\t},\n\n\t\t\t/**\n\t\t\tRetrieves image in it's current state as moxie.file.Blob object. Cannot be run on empty or image in progress (throws\n\t\t\tDOMException.INVALID_STATE_ERR).\n\n\t\t\t@method getAsBlob\n\t\t\t@param {String} [type=\"image/jpeg\"] Mime type of resulting blob. Can either be image/jpeg or image/png\n\t\t\t@param {Number} [quality=90] Applicable only together with mime type image/jpeg\n\t\t\t@return {Blob} Image as Blob\n\t\t\t*/\n\t\t\tgetAsBlob: function(type, quality) {\n\t\t\t\tif (!this.size) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\t\t\t\treturn this.exec('Image', 'getAsBlob', type || 'image/jpeg', quality || 90);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tRetrieves image in it's current state as dataURL string. Cannot be run on empty or image in progress (throws\n\t\t\tDOMException.INVALID_STATE_ERR).\n\n\t\t\t@method getAsDataURL\n\t\t\t@param {String} [type=\"image/jpeg\"] Mime type of resulting blob. Can either be image/jpeg or image/png\n\t\t\t@param {Number} [quality=90] Applicable only together with mime type image/jpeg\n\t\t\t@return {String} Image as dataURL string\n\t\t\t*/\n\t\t\tgetAsDataURL: function(type, quality) {\n\t\t\t\tif (!this.size) {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t}\n\t\t\t\treturn this.exec('Image', 'getAsDataURL', type || 'image/jpeg', quality || 90);\n\t\t\t},\n\n\t\t\t/**\n\t\t\tRetrieves image in it's current state as binary string. Cannot be run on empty or image in progress (throws\n\t\t\tDOMException.INVALID_STATE_ERR).\n\n\t\t\t@method getAsBinaryString\n\t\t\t@param {String} [type=\"image/jpeg\"] Mime type of resulting blob. Can either be image/jpeg or image/png\n\t\t\t@param {Number} [quality=90] Applicable only together with mime type image/jpeg\n\t\t\t@return {String} Image as binary string\n\t\t\t*/\n\t\t\tgetAsBinaryString: function(type, quality) {\n\t\t\t\tvar dataUrl = this.getAsDataURL(type, quality);\n\t\t\t\treturn Encode.atob(dataUrl.substring(dataUrl.indexOf('base64,') + 7));\n\t\t\t},\n\n\t\t\t/**\n\t\t\tEmbeds a visual representation of the image into the specified node. Depending on the runtime,\n\t\t\tit might be a canvas, an img node or a thrid party shim object (Flash or SilverLight - very rare,\n\t\t\tcan be used in legacy browsers that do not have canvas or proper dataURI support).\n\n\t\t\t@method embed\n\t\t\t@param {DOMElement} el DOM element to insert the image object into\n\t\t\t@param {Object} [options]\n\t\t\t\t@param {Number} [options.width] The width of an embed (defaults to the image width)\n\t\t\t\t@param {Number} [options.height] The height of an embed (defaults to the image height)\n\t\t\t\t@param {String} [options.type=\"image/jpeg\"] Mime type\n\t\t\t\t@param {Number} [options.quality=90] Quality of an embed, if mime type is image/jpeg\n\t\t\t\t@param {Boolean} [options.crop=false] Whether to crop an embed to the specified dimensions\n\t\t\t\t@param {Boolean} [options.fit=true] By default thumbs will be up- or downscaled as necessary to fit the dimensions\n\t\t\t*/\n\t\t\tembed: function(el, options) {\n\t\t\t\tvar self = this\n\t\t\t\t, runtime // this has to be outside of all the closures to contain proper runtime\n\t\t\t\t;\n\n\t\t\t\tvar opts = Basic.extend({\n\t\t\t\t\twidth: this.width,\n\t\t\t\t\theight: this.height,\n\t\t\t\t\ttype: this.type || 'image/jpeg',\n\t\t\t\t\tquality: 90,\n\t\t\t\t\tfit: true,\n\t\t\t\t\tresample: 'nearest'\n\t\t\t\t}, options);\n\n\n\t\t\t\tfunction render(type, quality) {\n\t\t\t\t\tvar img = this;\n\n\t\t\t\t\t// if possible, embed a canvas element directly\n\t\t\t\t\tif (Env.can('create_canvas')) {\n\t\t\t\t\t\tvar canvas = img.getAsCanvas();\n\t\t\t\t\t\tif (canvas) {\n\t\t\t\t\t\t\tel.appendChild(canvas);\n\t\t\t\t\t\t\tcanvas = null;\n\t\t\t\t\t\t\timg.destroy();\n\t\t\t\t\t\t\tself.trigger('embedded');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar dataUrl = img.getAsDataURL(type, quality);\n\t\t\t\t\tif (!dataUrl) {\n\t\t\t\t\t\tthrow new x.ImageError(x.ImageError.WRONG_FORMAT);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Env.can('use_data_uri_of', dataUrl.length)) {\n\t\t\t\t\t\tel.innerHTML = '<img src=\"' + dataUrl + '\" width=\"' + img.width + '\" height=\"' + img.height + '\" alt=\"\" />';\n\t\t\t\t\t\timg.destroy();\n\t\t\t\t\t\tself.trigger('embedded');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar tr = new Transporter();\n\n\t\t\t\t\t\ttr.bind(\"TransportingComplete\", function() {\n\t\t\t\t\t\t\truntime = self.connectRuntime(this.result.ruid);\n\n\t\t\t\t\t\t\tself.bind(\"Embedded\", function() {\n\t\t\t\t\t\t\t\t// position and size properly\n\t\t\t\t\t\t\t\tBasic.extend(runtime.getShimContainer().style, {\n\t\t\t\t\t\t\t\t\t//position: 'relative',\n\t\t\t\t\t\t\t\t\ttop: '0px',\n\t\t\t\t\t\t\t\t\tleft: '0px',\n\t\t\t\t\t\t\t\t\twidth: img.width + 'px',\n\t\t\t\t\t\t\t\t\theight: img.height + 'px'\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// some shims (Flash/SilverLight) reinitialize, if parent element is hidden, reordered or it's\n\t\t\t\t\t\t\t\t// position type changes (in Gecko), but since we basically need this only in IEs 6/7 and\n\t\t\t\t\t\t\t\t// sometimes 8 and they do not have this problem, we can comment this for now\n\t\t\t\t\t\t\t\t/*tr.bind(\"RuntimeInit\", function(e, runtime) {\n\t\t\t\t\t\t\t\t\ttr.destroy();\n\t\t\t\t\t\t\t\t\truntime.destroy();\n\t\t\t\t\t\t\t\t\tonResize.call(self); // re-feed our image data\n\t\t\t\t\t\t\t\t});*/\n\n\t\t\t\t\t\t\t\truntime = null; // release\n\t\t\t\t\t\t\t}, 999);\n\n\t\t\t\t\t\t\truntime.exec.call(self, \"ImageView\", \"display\", this.result.uid, width, height);\n\t\t\t\t\t\t\timg.destroy();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\ttr.transport(Encode.atob(dataUrl.substring(dataUrl.indexOf('base64,') + 7)), type, {\n\t\t\t\t\t\t\trequired_caps: {\n\t\t\t\t\t\t\t\tdisplay_media: true\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\truntime_order: 'flash,silverlight',\n\t\t\t\t\t\t\tcontainer: el\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tif (!(el = Dom.get(el))) {\n\t\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_NODE_TYPE_ERR);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.size) { // only preloaded image objects can be used as source\n\t\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t\t}\n\n\t\t\t\t\t// high-resolution images cannot be consistently handled across the runtimes\n\t\t\t\t\tif (this.width > Image.MAX_RESIZE_WIDTH || this.height > Image.MAX_RESIZE_HEIGHT) {\n\t\t\t\t\t\t//throw new x.ImageError(x.ImageError.MAX_RESOLUTION_ERR);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar imgCopy = new Image();\n\n\t\t\t\t\timgCopy.bind(\"Resize\", function() {\n\t\t\t\t\t\trender.call(this, opts.type, opts.quality);\n\t\t\t\t\t});\n\n\t\t\t\t\timgCopy.bind(\"Load\", function() {\n\t\t\t\t\t\tthis.downsize(opts);\n\t\t\t\t\t});\n\n\t\t\t\t\t// if embedded thumb data is available and dimensions are big enough, use it\n\t\t\t\t\tif (this.meta.thumb && this.meta.thumb.width >= opts.width && this.meta.thumb.height >= opts.height) {\n\t\t\t\t\t\timgCopy.load(this.meta.thumb.data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\timgCopy.clone(this, false);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn imgCopy;\n\t\t\t\t} catch(ex) {\n\t\t\t\t\t// for now simply trigger error event\n\t\t\t\t\tthis.trigger('error', ex.code);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\tProperly destroys the image and frees resources in use. If any. Recommended way to dispose\n\t\t\tmoxie.image.Image object.\n\n\t\t\t@method destroy\n\t\t\t*/\n\t\t\tdestroy: function() {\n\t\t\t\tif (this.ruid) {\n\t\t\t\t\tthis.getRuntime().exec.call(this, 'Image', 'destroy');\n\t\t\t\t\tthis.disconnectRuntime();\n\t\t\t\t}\n\t\t\t\tif (this.meta && this.meta.thumb) {\n\t\t\t\t\t// thumb is blob, make sure we destroy it first\n\t\t\t\t\tthis.meta.thumb.data.destroy();\n\t\t\t\t}\n\t\t\t\tthis.unbindAll();\n\t\t\t}\n\t\t});\n\n\n\t\t// this is here, because in order to bind properly, we need uid, which is created above\n\t\tthis.handleEventProps(dispatches);\n\n\t\tthis.bind('Load Resize', function() {\n\t\t\treturn _updateInfo.call(this); // if operation fails (e.g. image is neither PNG nor JPEG) cancel all pending events\n\t\t}, 999);\n\n\n\t\tfunction _updateInfo(info) {\n\t\t\ttry {\n\t\t\t\tif (!info) {\n\t\t\t\t\tinfo = this.exec('Image', 'getInfo');\n\t\t\t\t}\n\n\t\t\t\tthis.size = info.size;\n\t\t\t\tthis.width = info.width;\n\t\t\t\tthis.height = info.height;\n\t\t\t\tthis.type = info.type;\n\t\t\t\tthis.meta = info.meta;\n\n\t\t\t\t// update file name, only if empty\n\t\t\t\tif (this.name === '') {\n\t\t\t\t\tthis.name = info.name;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t} catch(ex) {\n\t\t\t\tthis.trigger('error', ex.code);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\n\t\tfunction _load(src) {\n\t\t\tvar srcType = Basic.typeOf(src);\n\n\t\t\ttry {\n\t\t\t\t// if source is Image\n\t\t\t\tif (src instanceof Image) {\n\t\t\t\t\tif (!src.size) { // only preloaded image objects can be used as source\n\t\t\t\t\t\tthrow new x.DOMException(x.DOMException.INVALID_STATE_ERR);\n\t\t\t\t\t}\n\t\t\t\t\t_loadFromImage.apply(this, arguments);\n\t\t\t\t}\n\t\t\t\t// if source is o.Blob/o.File\n\t\t\t\telse if (src instanceof Blob) {\n\t\t\t\t\tif (!~Basic.inArray(src.type, ['image/jpeg', 'image/png'])) {\n\t\t\t\t\t\tthrow new x.ImageError(x.ImageError.WRONG_FORMAT);\n\t\t\t\t\t}\n\t\t\t\t\t_loadFromBlob.apply(this, arguments);\n\t\t\t\t}\n\t\t\t\t// if native blob/file\n\t\t\t\telse if (Basic.inArray(srcType, ['blob', 'file']) !== -1) {\n\t\t\t\t\t_load.call(this, new File(null, src), arguments[1]);\n\t\t\t\t}\n\t\t\t\t// if String\n\t\t\t\telse if (srcType === 'string') {\n\t\t\t\t\t// if dataUrl String\n\t\t\t\t\tif (src.substr(0, 5) === 'data:') {\n\t\t\t\t\t\t_load.call(this, new Blob(null, { data: src }), arguments[1]);\n\t\t\t\t\t}\n\t\t\t\t\t// else assume Url, either relative or absolute\n\t\t\t\t\telse {\n\t\t\t\t\t\t_loadFromUrl.apply(this, arguments);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// if source seems to be an img node\n\t\t\t\telse if (srcType === 'node' && src.nodeName.toLowerCase() === 'img') {\n\t\t\t\t\t_load.call(this, src.src, arguments[1]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthrow new x.DOMException(x.DOMException.TYPE_MISMATCH_ERR);\n\t\t\t\t}\n\t\t\t} catch(ex) {\n\t\t\t\t// for now simply trigger error event\n\t\t\t\tthis.trigger('error', ex.code);\n\t\t\t}\n\t\t}\n\n\n\t\tfunction _loadFromImage(img, exact) {\n\t\t\tvar runtime = this.connectRuntime(img.ruid);\n\t\t\tthis.ruid = runtime.uid;\n\t\t\truntime.exec.call(this, 'Image', 'loadFromImage', img, (Basic.typeOf(exact) === 'undefined' ? true : exact));\n\t\t}\n\n\n\t\tfunction _loadFromBlob(blob, options) {\n\t\t\tvar self = this;\n\n\t\t\tself.name = blob.name || '';\n\n\t\t\tfunction exec(runtime) {\n\t\t\t\tself.ruid = runtime.uid;\n\t\t\t\truntime.exec.call(self, 'Image', 'loadFromBlob', blob);\n\t\t\t}\n\n\t\t\tif (blob.isDetached()) {\n\t\t\t\tthis.bind('RuntimeInit', function(e, runtime) {\n\t\t\t\t\texec(runtime);\n\t\t\t\t});\n\n\t\t\t\t// convert to object representation\n\t\t\t\tif (options && typeof(options.required_caps) === 'string') {\n\t\t\t\t\toptions.required_caps = Runtime.parseCaps(options.required_caps);\n\t\t\t\t}\n\n\t\t\t\tthis.connectRuntime(Basic.extend({\n\t\t\t\t\trequired_caps: {\n\t\t\t\t\t\taccess_image_binary: true,\n\t\t\t\t\t\tresize_image: true\n\t\t\t\t\t}\n\t\t\t\t}, options));\n\t\t\t} else {\n\t\t\t\texec(this.connectRuntime(blob.ruid));\n\t\t\t}\n\t\t}\n\n\n\t\tfunction _loadFromUrl(url, options) {\n\t\t\tvar self = this, xhr;\n\n\t\t\txhr = new XMLHttpRequest();\n\n\t\t\txhr.open('get', url);\n\t\t\txhr.responseType = 'blob';\n\n\t\t\txhr.onprogress = function(e) {\n\t\t\t\tself.trigger(e);\n\t\t\t};\n\n\t\t\txhr.onload = function() {\n\t\t\t\t_loadFromBlob.call(self, xhr.response, true);\n\t\t\t};\n\n\t\t\txhr.onerror = function(e) {\n\t\t\t\tself.trigger(e);\n\t\t\t};\n\n\t\t\txhr.onloadend = function() {\n\t\t\t\txhr.destroy();\n\t\t\t};\n\n\t\t\txhr.bind('RuntimeError', function(e, err) {\n\t\t\t\tself.trigger('RuntimeError', err);\n\t\t\t});\n\n\t\t\txhr.send(null, options);\n\t\t}\n\t}\n\n\t// virtual world will crash on you if image has a resolution higher than this:\n\tImage.MAX_RESIZE_WIDTH = 8192;\n\tImage.MAX_RESIZE_HEIGHT = 8192;\n\n\tImage.prototype = EventTarget.instance;\n\n\treturn Image;\n});\n\n// Included from: src/javascript/runtime/html5/Runtime.js\n\n/**\n * Runtime.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/*global File:true */\n\n/**\nDefines constructor for HTML5 runtime.\n\n@class moxie/runtime/html5/Runtime\n@private\n*/\ndefine(\"moxie/runtime/html5/Runtime\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/runtime/Runtime\",\n\t\"moxie/core/utils/Env\"\n], function(Basic, x, Runtime, Env) {\n\t\n\tvar type = \"html5\", extensions = {};\n\t\n\tfunction Html5Runtime(options) {\n\t\tvar I = this\n\t\t, Test = Runtime.capTest\n\t\t, True = Runtime.capTrue\n\t\t;\n\n\t\tvar caps = Basic.extend({\n\t\t\t\taccess_binary: Test(window.FileReader || window.File && window.File.getAsDataURL),\n\t\t\t\taccess_image_binary: function() {\n\t\t\t\t\treturn I.can('access_binary') && !!extensions.Image;\n\t\t\t\t},\n\t\t\t\tdisplay_media: Test(\n\t\t\t\t\t(Env.can('create_canvas') || Env.can('use_data_uri_over32kb')) && \n\t\t\t\t\tdefined('moxie/image/Image')\n\t\t\t\t),\n\t\t\t\tdo_cors: Test(window.XMLHttpRequest && 'withCredentials' in new XMLHttpRequest()),\n\t\t\t\tdrag_and_drop: Test(function() {\n\t\t\t\t\t// this comes directly from Modernizr: http://www.modernizr.com/\n\t\t\t\t\tvar div = document.createElement('div');\n\t\t\t\t\t// IE has support for drag and drop since version 5, but doesn't support dropping files from desktop\n\t\t\t\t\treturn (('draggable' in div) || ('ondragstart' in div && 'ondrop' in div)) && \n\t\t\t\t\t\t(Env.browser !== 'IE' || Env.verComp(Env.version, 9, '>'));\n\t\t\t\t}()),\n\t\t\t\tfilter_by_extension: Test(function() { // if you know how to feature-detect this, please suggest\n\t\t\t\t\treturn !(\n\t\t\t\t\t\t(Env.browser === 'Chrome' && Env.verComp(Env.version, 28, '<')) || \n\t\t\t\t\t\t(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<')) || \n\t\t\t\t\t\t(Env.browser === 'Safari' && Env.verComp(Env.version, 7, '<')) ||\n\t\t\t\t\t\t(Env.browser === 'Firefox' && Env.verComp(Env.version, 37, '<'))\n\t\t\t\t\t);\n\t\t\t\t}()),\n\t\t\t\treturn_response_headers: True,\n\t\t\t\treturn_response_type: function(responseType) {\n\t\t\t\t\tif (responseType === 'json' && !!window.JSON) { // we can fake this one even if it's not supported\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} \n\t\t\t\t\treturn Env.can('return_response_type', responseType);\n\t\t\t\t},\n\t\t\t\treturn_status_code: True,\n\t\t\t\treport_upload_progress: Test(window.XMLHttpRequest && new XMLHttpRequest().upload),\n\t\t\t\tresize_image: function() {\n\t\t\t\t\treturn I.can('access_binary') && Env.can('create_canvas');\n\t\t\t\t},\n\t\t\t\tselect_file: function() {\n\t\t\t\t\treturn Env.can('use_fileinput') && window.File;\n\t\t\t\t},\n\t\t\t\tselect_folder: function() {\n\t\t\t\t\treturn I.can('select_file') && (\n\t\t\t\t\t\tEnv.browser === 'Chrome' && Env.verComp(Env.version, 21, '>=') ||\n\t\t\t\t\t\tEnv.browser === 'Firefox' && Env.verComp(Env.version, 42, '>=') // https://developer.mozilla.org/en-US/Firefox/Releases/42\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tselect_multiple: function() {\n\t\t\t\t\t// it is buggy on Safari Windows and iOS\n\t\t\t\t\treturn I.can('select_file') &&\n\t\t\t\t\t\t!(Env.browser === 'Safari' && Env.os === 'Windows') &&\n\t\t\t\t\t\t!(Env.os === 'iOS' && Env.verComp(Env.osVersion, \"7.0.0\", '>') && Env.verComp(Env.osVersion, \"8.0.0\", '<'));\n\t\t\t\t},\n\t\t\t\tsend_binary_string: Test(window.XMLHttpRequest && (new XMLHttpRequest().sendAsBinary || (window.Uint8Array && window.ArrayBuffer))),\n\t\t\t\tsend_custom_headers: Test(window.XMLHttpRequest),\n\t\t\t\tsend_multipart: function() {\n\t\t\t\t\treturn !!(window.XMLHttpRequest && new XMLHttpRequest().upload && window.FormData) || I.can('send_binary_string');\n\t\t\t\t},\n\t\t\t\tslice_blob: Test(window.File && (File.prototype.mozSlice || File.prototype.webkitSlice || File.prototype.slice)),\n\t\t\t\tstream_upload: function(){\n\t\t\t\t\treturn I.can('slice_blob') && I.can('send_multipart');\n\t\t\t\t},\n\t\t\t\tsummon_file_dialog: function() { // yeah... some dirty sniffing here...\n\t\t\t\t\treturn I.can('select_file') && !(\n\t\t\t\t\t\t(Env.browser === 'Firefox' && Env.verComp(Env.version, 4, '<')) ||\n\t\t\t\t\t\t(Env.browser === 'Opera' && Env.verComp(Env.version, 12, '<')) ||\n\t\t\t\t\t\t(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<'))\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tupload_filesize: True,\n\t\t\t\tuse_http_method: True\n\t\t\t}, \n\t\t\targuments[2]\n\t\t);\n\n\t\tRuntime.call(this, options, (arguments[1] || type), caps);\n\n\n\t\tBasic.extend(this, {\n\n\t\t\tinit : function() {\n\t\t\t\tthis.trigger(\"Init\");\n\t\t\t},\n\n\t\t\tdestroy: (function(destroy) { // extend default destroy method\n\t\t\t\treturn function() {\n\t\t\t\t\tdestroy.call(I);\n\t\t\t\t\tdestroy = I = null;\n\t\t\t\t};\n\t\t\t}(this.destroy))\n\t\t});\n\n\t\tBasic.extend(this.getShim(), extensions);\n\t}\n\n\tRuntime.addConstructor(type, Html5Runtime);\n\n\treturn extensions;\n});\n\n// Included from: src/javascript/runtime/html5/file/Blob.js\n\n/**\n * Blob.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/file/Blob\n@private\n*/\ndefine(\"moxie/runtime/html5/file/Blob\", [\n\t\"moxie/runtime/html5/Runtime\",\n\t\"moxie/file/Blob\"\n], function(extensions, Blob) {\n\n\tfunction HTML5Blob() {\n\t\tfunction w3cBlobSlice(blob, start, end) {\n\t\t\tvar blobSlice;\n\n\t\t\tif (window.File.prototype.slice) {\n\t\t\t\ttry {\n\t\t\t\t\tblob.slice();\t// depricated version will throw WRONG_ARGUMENTS_ERR exception\n\t\t\t\t\treturn blob.slice(start, end);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// depricated slice method\n\t\t\t\t\treturn blob.slice(start, end - start);\n\t\t\t\t}\n\t\t\t// slice method got prefixed: https://bugzilla.mozilla.org/show_bug.cgi?id=649672\n\t\t\t} else if ((blobSlice = window.File.prototype.webkitSlice || window.File.prototype.mozSlice)) {\n\t\t\t\treturn blobSlice.call(blob, start, end);\n\t\t\t} else {\n\t\t\t\treturn null; // or throw some exception\n\t\t\t}\n\t\t}\n\n\t\tthis.slice = function() {\n\t\t\treturn new Blob(this.getRuntime().uid, w3cBlobSlice.apply(this, arguments));\n\t\t};\n\n\t\tthis.destroy = function() {\n\t\t\tthis.getRuntime().getShim().removeInstance(this.uid);\n\t\t};\n\t}\n\n\treturn (extensions.Blob = HTML5Blob);\n});\n\n// Included from: src/javascript/core/utils/Events.js\n\n/**\n * Events.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/core/utils/Events\n@public\n@static\n*/\n\ndefine('moxie/core/utils/Events', [\n\t'moxie/core/utils/Basic'\n], function(Basic) {\n\tvar eventhash = {}, uid = 'moxie_' + Basic.guid();\n\t\n\t// IE W3C like event funcs\n\tfunction preventDefault() {\n\t\tthis.returnValue = false;\n\t}\n\n\tfunction stopPropagation() {\n\t\tthis.cancelBubble = true;\n\t}\n\n\t/**\n\tAdds an event handler to the specified object and store reference to the handler\n\tin objects internal Plupload registry (@see removeEvent).\n\t\n\t@method addEvent\n\t@static\n\t@param {Object} obj DOM element like object to add handler to.\n\t@param {String} name Name to add event listener to.\n\t@param {Function} callback Function to call when event occurs.\n\t@param {String} [key] that might be used to add specifity to the event record.\n\t*/\n\tvar addEvent = function(obj, name, callback, key) {\n\t\tvar func, events;\n\t\t\t\t\t\n\t\tname = name.toLowerCase();\n\n\t\t// Add event listener\n\t\tif (obj.addEventListener) {\n\t\t\tfunc = callback;\n\t\t\t\n\t\t\tobj.addEventListener(name, func, false);\n\t\t} else if (obj.attachEvent) {\n\t\t\tfunc = function() {\n\t\t\t\tvar evt = window.event;\n\n\t\t\t\tif (!evt.target) {\n\t\t\t\t\tevt.target = evt.srcElement;\n\t\t\t\t}\n\n\t\t\t\tevt.preventDefault = preventDefault;\n\t\t\t\tevt.stopPropagation = stopPropagation;\n\n\t\t\t\tcallback(evt);\n\t\t\t};\n\n\t\t\tobj.attachEvent('on' + name, func);\n\t\t}\n\t\t\n\t\t// Log event handler to objects internal mOxie registry\n\t\tif (!obj[uid]) {\n\t\t\tobj[uid] = Basic.guid();\n\t\t}\n\t\t\n\t\tif (!eventhash.hasOwnProperty(obj[uid])) {\n\t\t\teventhash[obj[uid]] = {};\n\t\t}\n\t\t\n\t\tevents = eventhash[obj[uid]];\n\t\t\n\t\tif (!events.hasOwnProperty(name)) {\n\t\t\tevents[name] = [];\n\t\t}\n\t\t\t\t\n\t\tevents[name].push({\n\t\t\tfunc: func,\n\t\t\torig: callback, // store original callback for IE\n\t\t\tkey: key\n\t\t});\n\t};\n\t\n\t\n\t/**\n\tRemove event handler from the specified object. If third argument (callback)\n\tis not specified remove all events with the specified name.\n\t\n\t@method removeEvent\n\t@static\n\t@param {Object} obj DOM element to remove event listener(s) from.\n\t@param {String} name Name of event listener to remove.\n\t@param {Function|String} [callback] might be a callback or unique key to match.\n\t*/\n\tvar removeEvent = function(obj, name, callback) {\n\t\tvar type, undef;\n\t\t\n\t\tname = name.toLowerCase();\n\t\t\n\t\tif (obj[uid] && eventhash[obj[uid]] && eventhash[obj[uid]][name]) {\n\t\t\ttype = eventhash[obj[uid]][name];\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t\t\t\n\t\tfor (var i = type.length - 1; i >= 0; i--) {\n\t\t\t// undefined or not, key should match\n\t\t\tif (type[i].orig === callback || type[i].key === callback) {\n\t\t\t\tif (obj.removeEventListener) {\n\t\t\t\t\tobj.removeEventListener(name, type[i].func, false);\n\t\t\t\t} else if (obj.detachEvent) {\n\t\t\t\t\tobj.detachEvent('on'+name, type[i].func);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttype[i].orig = null;\n\t\t\t\ttype[i].func = null;\n\t\t\t\ttype.splice(i, 1);\n\t\t\t\t\n\t\t\t\t// If callback was passed we are done here, otherwise proceed\n\t\t\t\tif (callback !== undef) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// If event array got empty, remove it\n\t\tif (!type.length) {\n\t\t\tdelete eventhash[obj[uid]][name];\n\t\t}\n\t\t\n\t\t// If mOxie registry has become empty, remove it\n\t\tif (Basic.isEmptyObj(eventhash[obj[uid]])) {\n\t\t\tdelete eventhash[obj[uid]];\n\t\t\t\n\t\t\t// IE doesn't let you remove DOM object property with - delete\n\t\t\ttry {\n\t\t\t\tdelete obj[uid];\n\t\t\t} catch(e) {\n\t\t\t\tobj[uid] = undef;\n\t\t\t}\n\t\t}\n\t};\n\t\n\t\n\t/**\n\tRemove all kind of events from the specified object\n\t\n\t@method removeAllEvents\n\t@static\n\t@param {Object} obj DOM element to remove event listeners from.\n\t@param {String} [key] unique key to match, when removing events.\n\t*/\n\tvar removeAllEvents = function(obj, key) {\t\t\n\t\tif (!obj || !obj[uid]) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tBasic.each(eventhash[obj[uid]], function(events, name) {\n\t\t\tremoveEvent(obj, name, key);\n\t\t});\n\t};\n\n\treturn {\n\t\taddEvent: addEvent,\n\t\tremoveEvent: removeEvent,\n\t\tremoveAllEvents: removeAllEvents\n\t};\n});\n\n// Included from: src/javascript/runtime/html5/file/FileInput.js\n\n/**\n * FileInput.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/file/FileInput\n@private\n*/\ndefine(\"moxie/runtime/html5/file/FileInput\", [\n\t\"moxie/runtime/html5/Runtime\",\n\t\"moxie/file/File\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/utils/Events\",\n\t\"moxie/core/utils/Mime\",\n\t\"moxie/core/utils/Env\"\n], function(extensions, File, Basic, Dom, Events, Mime, Env) {\n\t\n\tfunction FileInput() {\n\t\tvar _options, _browseBtnZIndex; // save original z-index\n\n\t\tBasic.extend(this, {\n\t\t\tinit: function(options) {\n\t\t\t\tvar comp = this, I = comp.getRuntime(), input, shimContainer, mimes, browseButton, zIndex, top;\n\n\t\t\t\t_options = options;\n\n\t\t\t\t// figure out accept string\n\t\t\t\tmimes = Mime.extList2mimes(_options.accept, I.can('filter_by_extension'));\n\n\t\t\t\tshimContainer = I.getShimContainer();\n\n\t\t\t\tshimContainer.innerHTML = '<input id=\"' + I.uid +'\" type=\"file\" style=\"font-size:999px;opacity:0;\"' +\n\t\t\t\t\t(_options.multiple && I.can('select_multiple') ? 'multiple' : '') + \n\t\t\t\t\t(_options.directory && I.can('select_folder') ? 'webkitdirectory directory' : '') + // Chrome 11+\n\t\t\t\t\t(mimes ? ' accept=\"' + mimes.join(',') + '\"' : '') + ' />';\n\n\t\t\t\tinput = Dom.get(I.uid);\n\n\t\t\t\t// prepare file input to be placed underneath the browse_button element\n\t\t\t\tBasic.extend(input.style, {\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\theight: '100%'\n\t\t\t\t});\n\n\n\t\t\t\tbrowseButton = Dom.get(_options.browse_button);\n\t\t\t\t_browseBtnZIndex = Dom.getStyle(browseButton, 'z-index') || 'auto';\n\n\t\t\t\t// Route click event to the input[type=file] element for browsers that support such behavior\n\t\t\t\tif (I.can('summon_file_dialog')) {\n\t\t\t\t\tif (Dom.getStyle(browseButton, 'position') === 'static') {\n\t\t\t\t\t\tbrowseButton.style.position = 'relative';\n\t\t\t\t\t}\n\n\t\t\t\t\tEvents.addEvent(browseButton, 'click', function(e) {\n\t\t\t\t\t\tvar input = Dom.get(I.uid);\n\t\t\t\t\t\tif (input && !input.disabled) { // for some reason FF (up to 8.0.1 so far) lets to click disabled input[type=file]\n\t\t\t\t\t\t\tinput.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}, comp.uid);\n\n\t\t\t\t\tcomp.bind('Refresh', function() {\n\t\t\t\t\t\tzIndex = parseInt(_browseBtnZIndex, 10) || 1;\n\n\t\t\t\t\t\tDom.get(_options.browse_button).style.zIndex = zIndex;\n\t\t\t\t\t\tthis.getRuntime().getShimContainer().style.zIndex = zIndex - 1;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t/* Since we have to place input[type=file] on top of the browse_button for some browsers,\n\t\t\t\tbrowse_button loses interactivity, so we restore it here */\n\t\t\t\ttop = I.can('summon_file_dialog') ? browseButton : shimContainer;\n\n\t\t\t\tEvents.addEvent(top, 'mouseover', function() {\n\t\t\t\t\tcomp.trigger('mouseenter');\n\t\t\t\t}, comp.uid);\n\n\t\t\t\tEvents.addEvent(top, 'mouseout', function() {\n\t\t\t\t\tcomp.trigger('mouseleave');\n\t\t\t\t}, comp.uid);\n\n\t\t\t\tEvents.addEvent(top, 'mousedown', function() {\n\t\t\t\t\tcomp.trigger('mousedown');\n\t\t\t\t}, comp.uid);\n\n\t\t\t\tEvents.addEvent(Dom.get(_options.container), 'mouseup', function() {\n\t\t\t\t\tcomp.trigger('mouseup');\n\t\t\t\t}, comp.uid);\n\n\t\t\t\t// it shouldn't be possible to tab into the hidden element\n\t\t\t\t(I.can('summon_file_dialog') ? input : browseButton).setAttribute('tabindex', -1);\n\n\t\t\t\tinput.onchange = function onChange() { // there should be only one handler for this\n\t\t\t\t\tcomp.files = [];\n\n\t\t\t\t\tBasic.each(this.files, function(file) {\n\t\t\t\t\t\tvar relativePath = '';\n\n\t\t\t\t\t\tif (_options.directory) {\n\t\t\t\t\t\t\t// folders are represented by dots, filter them out (Chrome 11+)\n\t\t\t\t\t\t\tif (file.name == \".\") {\n\t\t\t\t\t\t\t\t// if it looks like a folder...\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (file.webkitRelativePath) {\n\t\t\t\t\t\t\trelativePath = '/' + file.webkitRelativePath.replace(/^\\//, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tfile = new File(I.uid, file);\n\t\t\t\t\t\tfile.relativePath = relativePath;\n\n\t\t\t\t\t\tcomp.files.push(file);\n\t\t\t\t\t});\n\n\t\t\t\t\t// clearing the value enables the user to select the same file again if they want to\n\t\t\t\t\tif (Env.browser !== 'IE' && Env.browser !== 'IEMobile') {\n\t\t\t\t\t\tthis.value = '';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// in IE input[type=\"file\"] is read-only so the only way to reset it is to re-insert it\n\t\t\t\t\t\tvar clone = this.cloneNode(true);\n\t\t\t\t\t\tthis.parentNode.replaceChild(clone, this);\n\t\t\t\t\t\tclone.onchange = onChange;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (comp.files.length) {\n\t\t\t\t\t\tcomp.trigger('change');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// ready event is perfectly asynchronous\n\t\t\t\tcomp.trigger({\n\t\t\t\t\ttype: 'ready',\n\t\t\t\t\tasync: true\n\t\t\t\t});\n\n\t\t\t\tshimContainer = null;\n\t\t\t},\n\n\n\t\t\tsetOption: function(name, value) {\n\t\t\t\tvar I = this.getRuntime();\n\t\t\t\tvar input = Dom.get(I.uid);\n\n\t\t\t\tswitch (name) {\n\t\t\t\t\tcase 'accept':\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\tvar mimes = value.mimes || Mime.extList2mimes(value, I.can('filter_by_extension'));\n\t\t\t\t\t\t\tinput.setAttribute('accept', mimes.join(','));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tinput.removeAttribute('accept');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'directory':\n\t\t\t\t\t\tif (value && I.can('select_folder')) {\n\t\t\t\t\t\t\tinput.setAttribute('directory', '');\n\t\t\t\t\t\t\tinput.setAttribute('webkitdirectory', '');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tinput.removeAttribute('directory');\n\t\t\t\t\t\t\tinput.removeAttribute('webkitdirectory');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'multiple':\n\t\t\t\t\t\tif (value && I.can('select_multiple')) {\n\t\t\t\t\t\t\tinput.setAttribute('multiple', '');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tinput.removeAttribute('multiple');\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\tdisable: function(state) {\n\t\t\t\tvar I = this.getRuntime(), input;\n\n\t\t\t\tif ((input = Dom.get(I.uid))) {\n\t\t\t\t\tinput.disabled = !!state;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tvar I = this.getRuntime()\n\t\t\t\t, shim = I.getShim()\n\t\t\t\t, shimContainer = I.getShimContainer()\n\t\t\t\t, container = _options && Dom.get(_options.container)\n\t\t\t\t, browseButton = _options && Dom.get(_options.browse_button)\n\t\t\t\t;\n\t\t\t\t\n\t\t\t\tif (container) {\n\t\t\t\t\tEvents.removeAllEvents(container, this.uid);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (browseButton) {\n\t\t\t\t\tEvents.removeAllEvents(browseButton, this.uid);\n\t\t\t\t\tbrowseButton.style.zIndex = _browseBtnZIndex; // reset to original value\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (shimContainer) {\n\t\t\t\t\tEvents.removeAllEvents(shimContainer, this.uid);\n\t\t\t\t\tshimContainer.innerHTML = '';\n\t\t\t\t}\n\n\t\t\t\tshim.removeInstance(this.uid);\n\n\t\t\t\t_options = shimContainer = container = browseButton = shim = null;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn (extensions.FileInput = FileInput);\n});\n\n// Included from: src/javascript/runtime/html5/file/FileDrop.js\n\n/**\n * FileDrop.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/file/FileDrop\n@private\n*/\ndefine(\"moxie/runtime/html5/file/FileDrop\", [\n\t\"moxie/runtime/html5/Runtime\",\n\t'moxie/file/File',\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/utils/Events\",\n\t\"moxie/core/utils/Mime\"\n], function(extensions, File, Basic, Dom, Events, Mime) {\n\t\n\tfunction FileDrop() {\n\t\tvar _files = [], _allowedExts = [], _options, _ruid;\n\n\t\tBasic.extend(this, {\n\t\t\tinit: function(options) {\n\t\t\t\tvar comp = this, dropZone;\n\n\t\t\t\t_options = options;\n\t\t\t\t_ruid = comp.ruid; // every dropped-in file should have a reference to the runtime\n\t\t\t\t_allowedExts = _extractExts(_options.accept);\n\t\t\t\tdropZone = _options.container;\n\n\t\t\t\tEvents.addEvent(dropZone, 'dragover', function(e) {\n\t\t\t\t\tif (!_hasFiles(e)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.dataTransfer.dropEffect = 'copy';\n\t\t\t\t}, comp.uid);\n\n\t\t\t\tEvents.addEvent(dropZone, 'drop', function(e) {\n\t\t\t\t\tif (!_hasFiles(e)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t_files = [];\n\n\t\t\t\t\t// Chrome 21+ accepts folders via Drag'n'Drop\n\t\t\t\t\tif (e.dataTransfer.items && e.dataTransfer.items[0].webkitGetAsEntry) {\n\t\t\t\t\t\t_readItems(e.dataTransfer.items, function() {\n\t\t\t\t\t\t\tcomp.files = _files;\n\t\t\t\t\t\t\tcomp.trigger(\"drop\");\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tBasic.each(e.dataTransfer.files, function(file) {\n\t\t\t\t\t\t\t_addFile(file);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcomp.files = _files;\n\t\t\t\t\t\tcomp.trigger(\"drop\");\n\t\t\t\t\t}\n\t\t\t\t}, comp.uid);\n\n\t\t\t\tEvents.addEvent(dropZone, 'dragenter', function(e) {\n\t\t\t\t\tcomp.trigger(\"dragenter\");\n\t\t\t\t}, comp.uid);\n\n\t\t\t\tEvents.addEvent(dropZone, 'dragleave', function(e) {\n\t\t\t\t\tcomp.trigger(\"dragleave\");\n\t\t\t\t}, comp.uid);\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tEvents.removeAllEvents(_options && Dom.get(_options.container), this.uid);\n\t\t\t\t_ruid = _files = _allowedExts = _options = null;\n\t\t\t\tthis.getRuntime().getShim().removeInstance(this.uid);\n\t\t\t}\n\t\t});\n\n\n\t\tfunction _hasFiles(e) {\n\t\t\tif (!e.dataTransfer || !e.dataTransfer.types) { // e.dataTransfer.files is not available in Gecko during dragover\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar types = Basic.toArray(e.dataTransfer.types || []);\n\n\t\t\treturn Basic.inArray(\"Files\", types) !== -1 ||\n\t\t\t\tBasic.inArray(\"public.file-url\", types) !== -1 || // Safari < 5\n\t\t\t\tBasic.inArray(\"application/x-moz-file\", types) !== -1 // Gecko < 1.9.2 (< Firefox 3.6)\n\t\t\t\t;\n\t\t}\n\n\n\t\tfunction _addFile(file, relativePath) {\n\t\t\tif (_isAcceptable(file)) {\n\t\t\t\tvar fileObj = new File(_ruid, file);\n\t\t\t\tfileObj.relativePath = relativePath || '';\n\t\t\t\t_files.push(fileObj);\n\t\t\t}\n\t\t}\n\n\t\t\n\t\tfunction _extractExts(accept) {\n\t\t\tvar exts = [];\n\t\t\tfor (var i = 0; i < accept.length; i++) {\n\t\t\t\t[].push.apply(exts, accept[i].extensions.split(/\\s*,\\s*/));\n\t\t\t}\n\t\t\treturn Basic.inArray('*', exts) === -1 ? exts : [];\n\t\t}\n\n\n\t\tfunction _isAcceptable(file) {\n\t\t\tif (!_allowedExts.length) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tvar ext = Mime.getFileExtension(file.name);\n\t\t\treturn !ext || Basic.inArray(ext, _allowedExts) !== -1;\n\t\t}\n\n\n\t\tfunction _readItems(items, cb) {\n\t\t\tvar entries = [];\n\t\t\tBasic.each(items, function(item) {\n\t\t\t\tvar entry = item.webkitGetAsEntry();\n\t\t\t\t// Address #998 (https://code.google.com/p/chromium/issues/detail?id=332579)\n\t\t\t\tif (entry) {\n\t\t\t\t\t// file() fails on OSX when the filename contains a special character (e.g. umlaut): see #61\n\t\t\t\t\tif (entry.isFile) {\n\t\t\t\t\t\t_addFile(item.getAsFile(), entry.fullPath);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentries.push(entry);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (entries.length) {\n\t\t\t\t_readEntries(entries, cb);\n\t\t\t} else {\n\t\t\t\tcb();\n\t\t\t}\n\t\t}\n\n\n\t\tfunction _readEntries(entries, cb) {\n\t\t\tvar queue = [];\n\t\t\tBasic.each(entries, function(entry) {\n\t\t\t\tqueue.push(function(cbcb) {\n\t\t\t\t\t_readEntry(entry, cbcb);\n\t\t\t\t});\n\t\t\t});\n\t\t\tBasic.inSeries(queue, function() {\n\t\t\t\tcb();\n\t\t\t});\n\t\t}\n\n\n\t\tfunction _readEntry(entry, cb) {\n\t\t\tif (entry.isFile) {\n\t\t\t\tentry.file(function(file) {\n\t\t\t\t\t_addFile(file, entry.fullPath);\n\t\t\t\t\tcb();\n\t\t\t\t}, function() {\n\t\t\t\t\t// fire an error event maybe\n\t\t\t\t\tcb();\n\t\t\t\t});\n\t\t\t} else if (entry.isDirectory) {\n\t\t\t\t_readDirEntry(entry, cb);\n\t\t\t} else {\n\t\t\t\tcb(); // not file, not directory? what then?..\n\t\t\t}\n\t\t}\n\n\n\t\tfunction _readDirEntry(dirEntry, cb) {\n\t\t\tvar entries = [], dirReader = dirEntry.createReader();\n\n\t\t\t// keep quering recursively till no more entries\n\t\t\tfunction getEntries(cbcb) {\n\t\t\t\tdirReader.readEntries(function(moreEntries) {\n\t\t\t\t\tif (moreEntries.length) {\n\t\t\t\t\t\t[].push.apply(entries, moreEntries);\n\t\t\t\t\t\tgetEntries(cbcb);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcbcb();\n\t\t\t\t\t}\n\t\t\t\t}, cbcb);\n\t\t\t}\n\n\t\t\t// ...and you thought FileReader was crazy...\n\t\t\tgetEntries(function() {\n\t\t\t\t_readEntries(entries, cb);\n\t\t\t}); \n\t\t}\n\t}\n\n\treturn (extensions.FileDrop = FileDrop);\n});\n\n// Included from: src/javascript/runtime/html5/file/FileReader.js\n\n/**\n * FileReader.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/file/FileReader\n@private\n*/\ndefine(\"moxie/runtime/html5/file/FileReader\", [\n\t\"moxie/runtime/html5/Runtime\",\n\t\"moxie/core/utils/Encode\",\n\t\"moxie/core/utils/Basic\"\n], function(extensions, Encode, Basic) {\n\t\n\tfunction FileReader() {\n\t\tvar _fr, _convertToBinary = false;\n\n\t\tBasic.extend(this, {\n\n\t\t\tread: function(op, blob) {\n\t\t\t\tvar comp = this;\n\n\t\t\t\tcomp.result = '';\n\n\t\t\t\t_fr = new window.FileReader();\n\n\t\t\t\t_fr.addEventListener('progress', function(e) {\n\t\t\t\t\tcomp.trigger(e);\n\t\t\t\t});\n\n\t\t\t\t_fr.addEventListener('load', function(e) {\n\t\t\t\t\tcomp.result = _convertToBinary ? _toBinary(_fr.result) : _fr.result;\n\t\t\t\t\tcomp.trigger(e);\n\t\t\t\t});\n\n\t\t\t\t_fr.addEventListener('error', function(e) {\n\t\t\t\t\tcomp.trigger(e, _fr.error);\n\t\t\t\t});\n\n\t\t\t\t_fr.addEventListener('loadend', function(e) {\n\t\t\t\t\t_fr = null;\n\t\t\t\t\tcomp.trigger(e);\n\t\t\t\t});\n\n\t\t\t\tif (Basic.typeOf(_fr[op]) === 'function') {\n\t\t\t\t\t_convertToBinary = false;\n\t\t\t\t\t_fr[op](blob.getSource());\n\t\t\t\t} else if (op === 'readAsBinaryString') { // readAsBinaryString is depricated in general and never existed in IE10+\n\t\t\t\t\t_convertToBinary = true;\n\t\t\t\t\t_fr.readAsDataURL(blob.getSource());\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tif (_fr) {\n\t\t\t\t\t_fr.abort();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\t_fr = null;\n\t\t\t\tthis.getRuntime().getShim().removeInstance(this.uid);\n\t\t\t}\n\t\t});\n\n\t\tfunction _toBinary(str) {\n\t\t\treturn Encode.atob(str.substring(str.indexOf('base64,') + 7));\n\t\t}\n\t}\n\n\treturn (extensions.FileReader = FileReader);\n});\n\n// Included from: src/javascript/runtime/html5/xhr/XMLHttpRequest.js\n\n/**\n * XMLHttpRequest.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/*global ActiveXObject:true */\n\n/**\n@class moxie/runtime/html5/xhr/XMLHttpRequest\n@private\n*/\ndefine(\"moxie/runtime/html5/xhr/XMLHttpRequest\", [\n\t\"moxie/runtime/html5/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Mime\",\n\t\"moxie/core/utils/Url\",\n\t\"moxie/file/File\",\n\t\"moxie/file/Blob\",\n\t\"moxie/xhr/FormData\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/core/utils/Env\"\n], function(extensions, Basic, Mime, Url, File, Blob, FormData, x, Env) {\n\t\n\tfunction XMLHttpRequest() {\n\t\tvar self = this\n\t\t, _xhr\n\t\t, _filename\n\t\t;\n\n\t\tBasic.extend(this, {\n\t\t\tsend: function(meta, data) {\n\t\t\t\tvar target = this\n\t\t\t\t, isGecko2_5_6 = (Env.browser === 'Mozilla' && Env.verComp(Env.version, 4, '>=') && Env.verComp(Env.version, 7, '<'))\n\t\t\t\t, isAndroidBrowser = Env.browser === 'Android Browser'\n\t\t\t\t, mustSendAsBinary = false\n\t\t\t\t;\n\n\t\t\t\t// extract file name\n\t\t\t\t_filename = meta.url.replace(/^.+?\\/([\\w\\-\\.]+)$/, '$1').toLowerCase();\n\n\t\t\t\t_xhr = _getNativeXHR();\n\t\t\t\t_xhr.open(meta.method, meta.url, meta.async, meta.user, meta.password);\n\n\n\t\t\t\t// prepare data to be sent\n\t\t\t\tif (data instanceof Blob) {\n\t\t\t\t\tif (data.isDetached()) {\n\t\t\t\t\t\tmustSendAsBinary = true;\n\t\t\t\t\t}\n\t\t\t\t\tdata = data.getSource();\n\t\t\t\t} else if (data instanceof FormData) {\n\n\t\t\t\t\tif (data.hasBlob()) {\n\t\t\t\t\t\tif (data.getBlob().isDetached()) {\n\t\t\t\t\t\t\tdata = _prepareMultipart.call(target, data); // _xhr must be instantiated and be in OPENED state\n\t\t\t\t\t\t\tmustSendAsBinary = true;\n\t\t\t\t\t\t} else if ((isGecko2_5_6 || isAndroidBrowser) && Basic.typeOf(data.getBlob().getSource()) === 'blob' && window.FileReader) {\n\t\t\t\t\t\t\t// Gecko 2/5/6 can't send blob in FormData: https://bugzilla.mozilla.org/show_bug.cgi?id=649150\n\t\t\t\t\t\t\t// Android browsers (default one and Dolphin) seem to have the same issue, see: #613\n\t\t\t\t\t\t\t_preloadAndSend.call(target, meta, data);\n\t\t\t\t\t\t\treturn; // _preloadAndSend will reinvoke send() with transmutated FormData =%D\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\n\t\t\t\t\t// transfer fields to real FormData\n\t\t\t\t\tif (data instanceof FormData) { // if still a FormData, e.g. not mangled by _prepareMultipart()\n\t\t\t\t\t\tvar fd = new window.FormData();\n\t\t\t\t\t\tdata.each(function(value, name) {\n\t\t\t\t\t\t\tif (value instanceof Blob) {\n\t\t\t\t\t\t\t\tfd.append(name, value.getSource());\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfd.append(name, value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdata = fd;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\t// if XHR L2\n\t\t\t\tif (_xhr.upload) {\n\t\t\t\t\tif (meta.withCredentials) {\n\t\t\t\t\t\t_xhr.withCredentials = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t_xhr.addEventListener('load', function(e) {\n\t\t\t\t\t\ttarget.trigger(e);\n\t\t\t\t\t});\n\n\t\t\t\t\t_xhr.addEventListener('error', function(e) {\n\t\t\t\t\t\ttarget.trigger(e);\n\t\t\t\t\t});\n\n\t\t\t\t\t// additionally listen to progress events\n\t\t\t\t\t_xhr.addEventListener('progress', function(e) {\n\t\t\t\t\t\ttarget.trigger(e);\n\t\t\t\t\t});\n\n\t\t\t\t\t_xhr.upload.addEventListener('progress', function(e) {\n\t\t\t\t\t\ttarget.trigger({\n\t\t\t\t\t\t\ttype: 'UploadProgress',\n\t\t\t\t\t\t\tloaded: e.loaded,\n\t\t\t\t\t\t\ttotal: e.total\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t// ... otherwise simulate XHR L2\n\t\t\t\t} else {\n\t\t\t\t\t_xhr.onreadystatechange = function onReadyStateChange() {\n\t\t\t\t\t\t\n\t\t\t\t\t\t// fake Level 2 events\n\t\t\t\t\t\tswitch (_xhr.readyState) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcase 1: // XMLHttpRequest.OPENED\n\t\t\t\t\t\t\t\t// readystatechanged is fired twice for OPENED state (in IE and Mozilla) - neu\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// looks like HEADERS_RECEIVED (state 2) is not reported in Opera (or it's old versions) - neu\n\t\t\t\t\t\t\tcase 2: // XMLHttpRequest.HEADERS_RECEIVED\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcase 3: // XMLHttpRequest.LOADING \n\t\t\t\t\t\t\t\t// try to fire progress event for not XHR L2\n\t\t\t\t\t\t\t\tvar total, loaded;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tif (Url.hasSameOrigin(meta.url)) { // Content-Length not accessible for cross-domain on some browsers\n\t\t\t\t\t\t\t\t\t\ttotal = _xhr.getResponseHeader('Content-Length') || 0; // old Safari throws an exception here\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (_xhr.responseText) { // responseText was introduced in IE7\n\t\t\t\t\t\t\t\t\t\tloaded = _xhr.responseText.length;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch(ex) {\n\t\t\t\t\t\t\t\t\ttotal = loaded = 0;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttarget.trigger({\n\t\t\t\t\t\t\t\t\ttype: 'progress',\n\t\t\t\t\t\t\t\t\tlengthComputable: !!total,\n\t\t\t\t\t\t\t\t\ttotal: parseInt(total, 10),\n\t\t\t\t\t\t\t\t\tloaded: loaded\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcase 4: // XMLHttpRequest.DONE\n\t\t\t\t\t\t\t\t// release readystatechange handler (mostly for IE)\n\t\t\t\t\t\t\t\t_xhr.onreadystatechange = function() {};\n\n\t\t\t\t\t\t\t\t// usually status 0 is returned when server is unreachable, but FF also fails to status 0 for 408 timeout\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tif (_xhr.status >= 200 && _xhr.status < 400) {\n\t\t\t\t\t\t\t\t\t\ttarget.trigger('load');\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch(ex) {}\n\n\t\t\t\t\t\t\t\ttarget.trigger('error');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\n\t\t\t\t// set request headers\n\t\t\t\tif (!Basic.isEmptyObj(meta.headers)) {\n\t\t\t\t\tBasic.each(meta.headers, function(value, header) {\n\t\t\t\t\t\t_xhr.setRequestHeader(header, value);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// request response type\n\t\t\t\tif (\"\" !== meta.responseType && 'responseType' in _xhr) {\n\t\t\t\t\tif ('json' === meta.responseType && !Env.can('return_response_type', 'json')) { // we can fake this one\n\t\t\t\t\t\t_xhr.responseType = 'text';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_xhr.responseType = meta.responseType;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// send ...\n\t\t\t\tif (!mustSendAsBinary) {\n\t\t\t\t\t_xhr.send(data);\n\t\t\t\t} else {\n\t\t\t\t\tif (_xhr.sendAsBinary) { // Gecko\n\t\t\t\t\t\t_xhr.sendAsBinary(data);\n\t\t\t\t\t} else { // other browsers having support for typed arrays\n\t\t\t\t\t\t(function() {\n\t\t\t\t\t\t\t// mimic Gecko's sendAsBinary\n\t\t\t\t\t\t\tvar ui8a = new Uint8Array(data.length);\n\t\t\t\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\t\t\t\tui8a[i] = (data.charCodeAt(i) & 0xff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t_xhr.send(ui8a.buffer);\n\t\t\t\t\t\t}());\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttarget.trigger('loadstart');\n\t\t\t},\n\n\t\t\tgetStatus: function() {\n\t\t\t\t// according to W3C spec it should return 0 for readyState < 3, but instead it throws an exception\n\t\t\t\ttry {\n\t\t\t\t\tif (_xhr) {\n\t\t\t\t\t\treturn _xhr.status;\n\t\t\t\t\t}\n\t\t\t\t} catch(ex) {}\n\t\t\t\treturn 0;\n\t\t\t},\n\n\t\t\tgetResponse: function(responseType) {\n\t\t\t\tvar I = this.getRuntime();\n\n\t\t\t\ttry {\n\t\t\t\t\tswitch (responseType) {\n\t\t\t\t\t\tcase 'blob':\n\t\t\t\t\t\t\tvar file = new File(I.uid, _xhr.response);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// try to extract file name from content-disposition if possible (might be - not, if CORS for example)\t\n\t\t\t\t\t\t\tvar disposition = _xhr.getResponseHeader('Content-Disposition');\n\t\t\t\t\t\t\tif (disposition) {\n\t\t\t\t\t\t\t\t// extract filename from response header if available\n\t\t\t\t\t\t\t\tvar match = disposition.match(/filename=([\\'\\\"'])([^\\1]+)\\1/);\n\t\t\t\t\t\t\t\tif (match) {\n\t\t\t\t\t\t\t\t\t_filename = match[2];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfile.name = _filename;\n\n\t\t\t\t\t\t\t// pre-webkit Opera doesn't set type property on the blob response\n\t\t\t\t\t\t\tif (!file.type) {\n\t\t\t\t\t\t\t\tfile.type = Mime.getFileMime(_filename);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn file;\n\n\t\t\t\t\t\tcase 'json':\n\t\t\t\t\t\t\tif (!Env.can('return_response_type', 'json')) {\n\t\t\t\t\t\t\t\treturn _xhr.status === 200 && !!window.JSON ? JSON.parse(_xhr.responseText) : null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn _xhr.response;\n\n\t\t\t\t\t\tcase 'document':\n\t\t\t\t\t\t\treturn _getDocument(_xhr);\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn _xhr.responseText !== '' ? _xhr.responseText : null; // against the specs, but for consistency across the runtimes\n\t\t\t\t\t}\n\t\t\t\t} catch(ex) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\t\t\t\t\n\t\t\t},\n\n\t\t\tgetAllResponseHeaders: function() {\n\t\t\t\ttry {\n\t\t\t\t\treturn _xhr.getAllResponseHeaders();\n\t\t\t\t} catch(ex) {}\n\t\t\t\treturn '';\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tif (_xhr) {\n\t\t\t\t\t_xhr.abort();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tself = _filename = null;\n\t\t\t\tthis.getRuntime().getShim().removeInstance(this.uid);\n\t\t\t}\n\t\t});\n\n\n\t\t// here we go... ugly fix for ugly bug\n\t\tfunction _preloadAndSend(meta, data) {\n\t\t\tvar target = this, blob, fr;\n\t\t\t\t\n\t\t\t// get original blob\n\t\t\tblob = data.getBlob().getSource();\n\t\t\t\n\t\t\t// preload blob in memory to be sent as binary string\n\t\t\tfr = new window.FileReader();\n\t\t\tfr.onload = function() {\n\t\t\t\t// overwrite original blob\n\t\t\t\tdata.append(data.getBlobName(), new Blob(null, {\n\t\t\t\t\ttype: blob.type,\n\t\t\t\t\tdata: fr.result\n\t\t\t\t}));\n\t\t\t\t// invoke send operation again\n\t\t\t\tself.send.call(target, meta, data);\n\t\t\t};\n\t\t\tfr.readAsBinaryString(blob);\n\t\t}\n\n\t\t\n\t\tfunction _getNativeXHR() {\n\t\t\tif (window.XMLHttpRequest && !(Env.browser === 'IE' && Env.verComp(Env.version, 8, '<'))) { // IE7 has native XHR but it's buggy\n\t\t\t\treturn new window.XMLHttpRequest();\n\t\t\t} else {\n\t\t\t\treturn (function() {\n\t\t\t\t\tvar progIDs = ['Msxml2.XMLHTTP.6.0', 'Microsoft.XMLHTTP']; // if 6.0 available, use it, otherwise failback to default 3.0\n\t\t\t\t\tfor (var i = 0; i < progIDs.length; i++) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\treturn new ActiveXObject(progIDs[i]);\n\t\t\t\t\t\t} catch (ex) {}\n\t\t\t\t\t}\n\t\t\t\t})();\n\t\t\t}\n\t\t}\n\t\t\n\t\t// @credits Sergey Ilinsky\t(http://www.ilinsky.com/)\n\t\tfunction _getDocument(xhr) {\n\t\t\tvar rXML = xhr.responseXML;\n\t\t\tvar rText = xhr.responseText;\n\t\t\t\n\t\t\t// Try parsing responseText (@see: http://www.ilinsky.com/articles/XMLHttpRequest/#bugs-ie-responseXML-content-type)\n\t\t\tif (Env.browser === 'IE' && rText && rXML && !rXML.documentElement && /[^\\/]+\\/[^\\+]+\\+xml/.test(xhr.getResponseHeader(\"Content-Type\"))) {\n\t\t\t\trXML = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\t\trXML.async = false;\n\t\t\t\trXML.validateOnParse = false;\n\t\t\t\trXML.loadXML(rText);\n\t\t\t}\n\t\n\t\t\t// Check if there is no error in document\n\t\t\tif (rXML) {\n\t\t\t\tif ((Env.browser === 'IE' && rXML.parseError !== 0) || !rXML.documentElement || rXML.documentElement.tagName === \"parsererror\") {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn rXML;\n\t\t}\n\n\n\t\tfunction _prepareMultipart(fd) {\n\t\t\tvar boundary = '----moxieboundary' + new Date().getTime()\n\t\t\t, dashdash = '--'\n\t\t\t, crlf = '\\r\\n'\n\t\t\t, multipart = ''\n\t\t\t, I = this.getRuntime()\n\t\t\t;\n\n\t\t\tif (!I.can('send_binary_string')) {\n\t\t\t\tthrow new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);\n\t\t\t}\n\n\t\t\t_xhr.setRequestHeader('Content-Type', 'multipart/form-data; boundary=' + boundary);\n\n\t\t\t// append multipart parameters\n\t\t\tfd.each(function(value, name) {\n\t\t\t\t// Firefox 3.6 failed to convert multibyte characters to UTF-8 in sendAsBinary(), \n\t\t\t\t// so we try it here ourselves with: unescape(encodeURIComponent(value))\n\t\t\t\tif (value instanceof Blob) {\n\t\t\t\t\t// Build RFC2388 blob\n\t\t\t\t\tmultipart += dashdash + boundary + crlf +\n\t\t\t\t\t\t'Content-Disposition: form-data; name=\"' + name + '\"; filename=\"' + unescape(encodeURIComponent(value.name || 'blob')) + '\"' + crlf +\n\t\t\t\t\t\t'Content-Type: ' + (value.type || 'application/octet-stream') + crlf + crlf +\n\t\t\t\t\t\tvalue.getSource() + crlf;\n\t\t\t\t} else {\n\t\t\t\t\tmultipart += dashdash + boundary + crlf +\n\t\t\t\t\t\t'Content-Disposition: form-data; name=\"' + name + '\"' + crlf + crlf +\n\t\t\t\t\t\tunescape(encodeURIComponent(value)) + crlf;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tmultipart += dashdash + boundary + dashdash + crlf;\n\n\t\t\treturn multipart;\n\t\t}\n\t}\n\n\treturn (extensions.XMLHttpRequest = XMLHttpRequest);\n});\n\n// Included from: src/javascript/runtime/html5/utils/BinaryReader.js\n\n/**\n * BinaryReader.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/utils/BinaryReader\n@private\n*/\ndefine(\"moxie/runtime/html5/utils/BinaryReader\", [\n\t\"moxie/core/utils/Basic\"\n], function(Basic) {\n\n\t\n\tfunction BinaryReader(data) {\n\t\tif (data instanceof ArrayBuffer) {\n\t\t\tArrayBufferReader.apply(this, arguments);\n\t\t} else {\n\t\t\tUTF16StringReader.apply(this, arguments);\n\t\t}\n\t}\n\n\tBasic.extend(BinaryReader.prototype, {\n\t\t\n\t\tlittleEndian: false,\n\n\n\t\tread: function(idx, size) {\n\t\t\tvar sum, mv, i;\n\n\t\t\tif (idx + size > this.length()) {\n\t\t\t\tthrow new Error(\"You are trying to read outside the source boundaries.\");\n\t\t\t}\n\t\t\t\n\t\t\tmv = this.littleEndian \n\t\t\t\t? 0 \n\t\t\t\t: -8 * (size - 1)\n\t\t\t;\n\n\t\t\tfor (i = 0, sum = 0; i < size; i++) {\n\t\t\t\tsum |= (this.readByteAt(idx + i) << Math.abs(mv + i*8));\n\t\t\t}\n\t\t\treturn sum;\n\t\t},\n\n\n\t\twrite: function(idx, num, size) {\n\t\t\tvar mv, i, str = '';\n\n\t\t\tif (idx > this.length()) {\n\t\t\t\tthrow new Error(\"You are trying to write outside the source boundaries.\");\n\t\t\t}\n\n\t\t\tmv = this.littleEndian \n\t\t\t\t? 0 \n\t\t\t\t: -8 * (size - 1)\n\t\t\t;\n\n\t\t\tfor (i = 0; i < size; i++) {\n\t\t\t\tthis.writeByteAt(idx + i, (num >> Math.abs(mv + i*8)) & 255);\n\t\t\t}\n\t\t},\n\n\n\t\tBYTE: function(idx) {\n\t\t\treturn this.read(idx, 1);\n\t\t},\n\n\n\t\tSHORT: function(idx) {\n\t\t\treturn this.read(idx, 2);\n\t\t},\n\n\n\t\tLONG: function(idx) {\n\t\t\treturn this.read(idx, 4);\n\t\t},\n\n\n\t\tSLONG: function(idx) { // 2's complement notation\n\t\t\tvar num = this.read(idx, 4);\n\t\t\treturn (num > 2147483647 ? num - 4294967296 : num);\n\t\t},\n\n\n\t\tCHAR: function(idx) {\n\t\t\treturn String.fromCharCode(this.read(idx, 1));\n\t\t},\n\n\n\t\tSTRING: function(idx, count) {\n\t\t\treturn this.asArray('CHAR', idx, count).join('');\n\t\t},\n\n\n\t\tasArray: function(type, idx, count) {\n\t\t\tvar values = [];\n\n\t\t\tfor (var i = 0; i < count; i++) {\n\t\t\t\tvalues[i] = this[type](idx + i);\n\t\t\t}\n\t\t\treturn values;\n\t\t}\n\t});\n\n\n\tfunction ArrayBufferReader(data) {\n\t\tvar _dv = new DataView(data);\n\n\t\tBasic.extend(this, {\n\t\t\t\n\t\t\treadByteAt: function(idx) {\n\t\t\t\treturn _dv.getUint8(idx);\n\t\t\t},\n\n\n\t\t\twriteByteAt: function(idx, value) {\n\t\t\t\t_dv.setUint8(idx, value);\n\t\t\t},\n\t\t\t\n\n\t\t\tSEGMENT: function(idx, size, value) {\n\t\t\t\tswitch (arguments.length) {\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\treturn data.slice(idx, idx + size);\n\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\treturn data.slice(idx);\n\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\t\tvalue = new ArrayBuffer();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (value instanceof ArrayBuffer) {\t\t\t\t\t\n\t\t\t\t\t\t\tvar arr = new Uint8Array(this.length() - size + value.byteLength);\n\t\t\t\t\t\t\tif (idx > 0) {\n\t\t\t\t\t\t\t\tarr.set(new Uint8Array(data.slice(0, idx)), 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tarr.set(new Uint8Array(value), idx);\n\t\t\t\t\t\t\tarr.set(new Uint8Array(data.slice(idx + size)), idx + value.byteLength);\n\n\t\t\t\t\t\t\tthis.clear();\n\t\t\t\t\t\t\tdata = arr.buffer;\n\t\t\t\t\t\t\t_dv = new DataView(data);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\tdefault: return data;\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\tlength: function() {\n\t\t\t\treturn data ? data.byteLength : 0;\n\t\t\t},\n\n\n\t\t\tclear: function() {\n\t\t\t\t_dv = data = null;\n\t\t\t}\n\t\t});\n\t}\n\n\n\tfunction UTF16StringReader(data) {\n\t\tBasic.extend(this, {\n\t\t\t\n\t\t\treadByteAt: function(idx) {\n\t\t\t\treturn data.charCodeAt(idx);\n\t\t\t},\n\n\n\t\t\twriteByteAt: function(idx, value) {\n\t\t\t\tputstr(String.fromCharCode(value), idx, 1);\n\t\t\t},\n\n\n\t\t\tSEGMENT: function(idx, length, segment) {\n\t\t\t\tswitch (arguments.length) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\treturn data.substr(idx);\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\treturn data.substr(idx, length);\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tputstr(segment !== null ? segment : '', idx, length);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault: return data;\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\tlength: function() {\n\t\t\t\treturn data ? data.length : 0;\n\t\t\t}, \n\n\t\t\tclear: function() {\n\t\t\t\tdata = null;\n\t\t\t}\n\t\t});\n\n\n\t\tfunction putstr(segment, idx, length) {\n\t\t\tlength = arguments.length === 3 ? length : data.length - idx - 1;\n\t\t\tdata = data.substr(0, idx) + segment + data.substr(length + idx);\n\t\t}\n\t}\n\n\n\treturn BinaryReader;\n});\n\n// Included from: src/javascript/runtime/html5/image/JPEGHeaders.js\n\n/**\n * JPEGHeaders.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n \n/**\n@class moxie/runtime/html5/image/JPEGHeaders\n@private\n*/\ndefine(\"moxie/runtime/html5/image/JPEGHeaders\", [\n\t\"moxie/runtime/html5/utils/BinaryReader\",\n\t\"moxie/core/Exceptions\"\n], function(BinaryReader, x) {\n\t\n\treturn function JPEGHeaders(data) {\n\t\tvar headers = [], _br, idx, marker, length = 0;\n\n\t\t_br = new BinaryReader(data);\n\n\t\t// Check if data is jpeg\n\t\tif (_br.SHORT(0) !== 0xFFD8) {\n\t\t\t_br.clear();\n\t\t\tthrow new x.ImageError(x.ImageError.WRONG_FORMAT);\n\t\t}\n\n\t\tidx = 2;\n\n\t\twhile (idx <= _br.length()) {\n\t\t\tmarker = _br.SHORT(idx);\n\n\t\t\t// omit RST (restart) markers\n\t\t\tif (marker >= 0xFFD0 && marker <= 0xFFD7) {\n\t\t\t\tidx += 2;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// no headers allowed after SOS marker\n\t\t\tif (marker === 0xFFDA || marker === 0xFFD9) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tlength = _br.SHORT(idx + 2) + 2;\n\n\t\t\t// APPn marker detected\n\t\t\tif (marker >= 0xFFE1 && marker <= 0xFFEF) {\n\t\t\t\theaders.push({\n\t\t\t\t\thex: marker,\n\t\t\t\t\tname: 'APP' + (marker & 0x000F),\n\t\t\t\t\tstart: idx,\n\t\t\t\t\tlength: length,\n\t\t\t\t\tsegment: _br.SEGMENT(idx, length)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tidx += length;\n\t\t}\n\n\t\t_br.clear();\n\n\t\treturn {\n\t\t\theaders: headers,\n\n\t\t\trestore: function(data) {\n\t\t\t\tvar max, i, br;\n\n\t\t\t\tbr = new BinaryReader(data);\n\n\t\t\t\tidx = br.SHORT(2) == 0xFFE0 ? 4 + br.SHORT(4) : 2;\n\n\t\t\t\tfor (i = 0, max = headers.length; i < max; i++) {\n\t\t\t\t\tbr.SEGMENT(idx, 0, headers[i].segment);\n\t\t\t\t\tidx += headers[i].length;\n\t\t\t\t}\n\n\t\t\t\tdata = br.SEGMENT();\n\t\t\t\tbr.clear();\n\t\t\t\treturn data;\n\t\t\t},\n\n\t\t\tstrip: function(data) {\n\t\t\t\tvar br, headers, jpegHeaders, i;\n\n\t\t\t\tjpegHeaders = new JPEGHeaders(data);\n\t\t\t\theaders = jpegHeaders.headers;\n\t\t\t\tjpegHeaders.purge();\n\n\t\t\t\tbr = new BinaryReader(data);\n\n\t\t\t\ti = headers.length;\n\t\t\t\twhile (i--) {\n\t\t\t\t\tbr.SEGMENT(headers[i].start, headers[i].length, '');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdata = br.SEGMENT();\n\t\t\t\tbr.clear();\n\t\t\t\treturn data;\n\t\t\t},\n\n\t\t\tget: function(name) {\n\t\t\t\tvar array = [];\n\n\t\t\t\tfor (var i = 0, max = headers.length; i < max; i++) {\n\t\t\t\t\tif (headers[i].name === name.toUpperCase()) {\n\t\t\t\t\t\tarray.push(headers[i].segment);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn array;\n\t\t\t},\n\n\t\t\tset: function(name, segment) {\n\t\t\t\tvar array = [], i, ii, max;\n\n\t\t\t\tif (typeof(segment) === 'string') {\n\t\t\t\t\tarray.push(segment);\n\t\t\t\t} else {\n\t\t\t\t\tarray = segment;\n\t\t\t\t}\n\n\t\t\t\tfor (i = ii = 0, max = headers.length; i < max; i++) {\n\t\t\t\t\tif (headers[i].name === name.toUpperCase()) {\n\t\t\t\t\t\theaders[i].segment = array[ii];\n\t\t\t\t\t\theaders[i].length = array[ii].length;\n\t\t\t\t\t\tii++;\n\t\t\t\t\t}\n\t\t\t\t\tif (ii >= array.length) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tpurge: function() {\n\t\t\t\tthis.headers = headers = [];\n\t\t\t}\n\t\t};\n\t};\n});\n\n// Included from: src/javascript/runtime/html5/image/ExifParser.js\n\n/**\n * ExifParser.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/image/ExifParser\n@private\n*/\ndefine(\"moxie/runtime/html5/image/ExifParser\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/html5/utils/BinaryReader\",\n\t\"moxie/core/Exceptions\"\n], function(Basic, BinaryReader, x) {\n\t\n\tfunction ExifParser(data) {\n\t\tvar __super__, tags, tagDescs, offsets, idx, Tiff;\n\t\t\n\t\tBinaryReader.call(this, data);\n\n\t\ttags = {\n\t\t\ttiff: {\n\t\t\t\t/*\n\t\t\t\tThe image orientation viewed in terms of rows and columns.\n\n\t\t\t\t1 = The 0th row is at the visual top of the image, and the 0th column is the visual left-hand side.\n\t\t\t\t2 = The 0th row is at the visual top of the image, and the 0th column is the visual right-hand side.\n\t\t\t\t3 = The 0th row is at the visual bottom of the image, and the 0th column is the visual right-hand side.\n\t\t\t\t4 = The 0th row is at the visual bottom of the image, and the 0th column is the visual left-hand side.\n\t\t\t\t5 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual top.\n\t\t\t\t6 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual top.\n\t\t\t\t7 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual bottom.\n\t\t\t\t8 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual bottom.\n\t\t\t\t*/\n\t\t\t\t0x0112: 'Orientation',\n\t\t\t\t0x010E: 'ImageDescription',\n\t\t\t\t0x010F: 'Make',\n\t\t\t\t0x0110: 'Model',\n\t\t\t\t0x0131: 'Software',\n\t\t\t\t0x8769: 'ExifIFDPointer',\n\t\t\t\t0x8825:\t'GPSInfoIFDPointer'\n\t\t\t},\n\t\t\texif: {\n\t\t\t\t0x9000: 'ExifVersion',\n\t\t\t\t0xA001: 'ColorSpace',\n\t\t\t\t0xA002: 'PixelXDimension',\n\t\t\t\t0xA003: 'PixelYDimension',\n\t\t\t\t0x9003: 'DateTimeOriginal',\n\t\t\t\t0x829A: 'ExposureTime',\n\t\t\t\t0x829D: 'FNumber',\n\t\t\t\t0x8827: 'ISOSpeedRatings',\n\t\t\t\t0x9201: 'ShutterSpeedValue',\n\t\t\t\t0x9202: 'ApertureValue'\t,\n\t\t\t\t0x9207: 'MeteringMode',\n\t\t\t\t0x9208: 'LightSource',\n\t\t\t\t0x9209: 'Flash',\n\t\t\t\t0x920A: 'FocalLength',\n\t\t\t\t0xA402: 'ExposureMode',\n\t\t\t\t0xA403: 'WhiteBalance',\n\t\t\t\t0xA406: 'SceneCaptureType',\n\t\t\t\t0xA404: 'DigitalZoomRatio',\n\t\t\t\t0xA408: 'Contrast',\n\t\t\t\t0xA409: 'Saturation',\n\t\t\t\t0xA40A: 'Sharpness'\n\t\t\t},\n\t\t\tgps: {\n\t\t\t\t0x0000: 'GPSVersionID',\n\t\t\t\t0x0001: 'GPSLatitudeRef',\n\t\t\t\t0x0002: 'GPSLatitude',\n\t\t\t\t0x0003: 'GPSLongitudeRef',\n\t\t\t\t0x0004: 'GPSLongitude'\n\t\t\t},\n\n\t\t\tthumb: {\n\t\t\t\t0x0201: 'JPEGInterchangeFormat',\n\t\t\t\t0x0202: 'JPEGInterchangeFormatLength'\n\t\t\t}\n\t\t};\n\n\t\ttagDescs = {\n\t\t\t'ColorSpace': {\n\t\t\t\t1: 'sRGB',\n\t\t\t\t0: 'Uncalibrated'\n\t\t\t},\n\n\t\t\t'MeteringMode': {\n\t\t\t\t0: 'Unknown',\n\t\t\t\t1: 'Average',\n\t\t\t\t2: 'CenterWeightedAverage',\n\t\t\t\t3: 'Spot',\n\t\t\t\t4: 'MultiSpot',\n\t\t\t\t5: 'Pattern',\n\t\t\t\t6: 'Partial',\n\t\t\t\t255: 'Other'\n\t\t\t},\n\n\t\t\t'LightSource': {\n\t\t\t\t1: 'Daylight',\n\t\t\t\t2: 'Fliorescent',\n\t\t\t\t3: 'Tungsten',\n\t\t\t\t4: 'Flash',\n\t\t\t\t9: 'Fine weather',\n\t\t\t\t10: 'Cloudy weather',\n\t\t\t\t11: 'Shade',\n\t\t\t\t12: 'Daylight fluorescent (D 5700 - 7100K)',\n\t\t\t\t13: 'Day white fluorescent (N 4600 -5400K)',\n\t\t\t\t14: 'Cool white fluorescent (W 3900 - 4500K)',\n\t\t\t\t15: 'White fluorescent (WW 3200 - 3700K)',\n\t\t\t\t17: 'Standard light A',\n\t\t\t\t18: 'Standard light B',\n\t\t\t\t19: 'Standard light C',\n\t\t\t\t20: 'D55',\n\t\t\t\t21: 'D65',\n\t\t\t\t22: 'D75',\n\t\t\t\t23: 'D50',\n\t\t\t\t24: 'ISO studio tungsten',\n\t\t\t\t255: 'Other'\n\t\t\t},\n\n\t\t\t'Flash': {\n\t\t\t\t0x0000: 'Flash did not fire',\n\t\t\t\t0x0001: 'Flash fired',\n\t\t\t\t0x0005: 'Strobe return light not detected',\n\t\t\t\t0x0007: 'Strobe return light detected',\n\t\t\t\t0x0009: 'Flash fired, compulsory flash mode',\n\t\t\t\t0x000D: 'Flash fired, compulsory flash mode, return light not detected',\n\t\t\t\t0x000F: 'Flash fired, compulsory flash mode, return light detected',\n\t\t\t\t0x0010: 'Flash did not fire, compulsory flash mode',\n\t\t\t\t0x0018: 'Flash did not fire, auto mode',\n\t\t\t\t0x0019: 'Flash fired, auto mode',\n\t\t\t\t0x001D: 'Flash fired, auto mode, return light not detected',\n\t\t\t\t0x001F: 'Flash fired, auto mode, return light detected',\n\t\t\t\t0x0020: 'No flash function',\n\t\t\t\t0x0041: 'Flash fired, red-eye reduction mode',\n\t\t\t\t0x0045: 'Flash fired, red-eye reduction mode, return light not detected',\n\t\t\t\t0x0047: 'Flash fired, red-eye reduction mode, return light detected',\n\t\t\t\t0x0049: 'Flash fired, compulsory flash mode, red-eye reduction mode',\n\t\t\t\t0x004D: 'Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected',\n\t\t\t\t0x004F: 'Flash fired, compulsory flash mode, red-eye reduction mode, return light detected',\n\t\t\t\t0x0059: 'Flash fired, auto mode, red-eye reduction mode',\n\t\t\t\t0x005D: 'Flash fired, auto mode, return light not detected, red-eye reduction mode',\n\t\t\t\t0x005F: 'Flash fired, auto mode, return light detected, red-eye reduction mode'\n\t\t\t},\n\n\t\t\t'ExposureMode': {\n\t\t\t\t0: 'Auto exposure',\n\t\t\t\t1: 'Manual exposure',\n\t\t\t\t2: 'Auto bracket'\n\t\t\t},\n\n\t\t\t'WhiteBalance': {\n\t\t\t\t0: 'Auto white balance',\n\t\t\t\t1: 'Manual white balance'\n\t\t\t},\n\n\t\t\t'SceneCaptureType': {\n\t\t\t\t0: 'Standard',\n\t\t\t\t1: 'Landscape',\n\t\t\t\t2: 'Portrait',\n\t\t\t\t3: 'Night scene'\n\t\t\t},\n\n\t\t\t'Contrast': {\n\t\t\t\t0: 'Normal',\n\t\t\t\t1: 'Soft',\n\t\t\t\t2: 'Hard'\n\t\t\t},\n\n\t\t\t'Saturation': {\n\t\t\t\t0: 'Normal',\n\t\t\t\t1: 'Low saturation',\n\t\t\t\t2: 'High saturation'\n\t\t\t},\n\n\t\t\t'Sharpness': {\n\t\t\t\t0: 'Normal',\n\t\t\t\t1: 'Soft',\n\t\t\t\t2: 'Hard'\n\t\t\t},\n\n\t\t\t// GPS related\n\t\t\t'GPSLatitudeRef': {\n\t\t\t\tN: 'North latitude',\n\t\t\t\tS: 'South latitude'\n\t\t\t},\n\n\t\t\t'GPSLongitudeRef': {\n\t\t\t\tE: 'East longitude',\n\t\t\t\tW: 'West longitude'\n\t\t\t}\n\t\t};\n\n\t\toffsets = {\n\t\t\ttiffHeader: 10\n\t\t};\n\t\t\n\t\tidx = offsets.tiffHeader;\n\n\t\t__super__ = {\n\t\t\tclear: this.clear\n\t\t};\n\n\t\t// Public functions\n\t\tBasic.extend(this, {\n\t\t\t\n\t\t\tread: function() {\n\t\t\t\ttry {\n\t\t\t\t\treturn ExifParser.prototype.read.apply(this, arguments);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tthrow new x.ImageError(x.ImageError.INVALID_META_ERR);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\twrite: function() {\n\t\t\t\ttry {\n\t\t\t\t\treturn ExifParser.prototype.write.apply(this, arguments);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tthrow new x.ImageError(x.ImageError.INVALID_META_ERR);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\tUNDEFINED: function() {\n\t\t\t\treturn this.BYTE.apply(this, arguments);\n\t\t\t},\n\n\n\t\t\tRATIONAL: function(idx) {\n\t\t\t\treturn this.LONG(idx) / this.LONG(idx + 4)\n\t\t\t},\n\n\n\t\t\tSRATIONAL: function(idx) {\n\t\t\t\treturn this.SLONG(idx) / this.SLONG(idx + 4)\n\t\t\t},\n\n\t\t\tASCII: function(idx) {\n\t\t\t\treturn this.CHAR(idx);\n\t\t\t},\n\n\t\t\tTIFF: function() {\n\t\t\t\treturn Tiff || null;\n\t\t\t},\n\n\n\t\t\tEXIF: function() {\n\t\t\t\tvar Exif = null;\n\n\t\t\t\tif (offsets.exifIFD) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tExif = extractTags.call(this, offsets.exifIFD, tags.exif);\n\t\t\t\t\t} catch(ex) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Fix formatting of some tags\n\t\t\t\t\tif (Exif.ExifVersion && Basic.typeOf(Exif.ExifVersion) === 'array') {\n\t\t\t\t\t\tfor (var i = 0, exifVersion = ''; i < Exif.ExifVersion.length; i++) {\n\t\t\t\t\t\t\texifVersion += String.fromCharCode(Exif.ExifVersion[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tExif.ExifVersion = exifVersion;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn Exif;\n\t\t\t},\n\n\n\t\t\tGPS: function() {\n\t\t\t\tvar GPS = null;\n\n\t\t\t\tif (offsets.gpsIFD) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tGPS = extractTags.call(this, offsets.gpsIFD, tags.gps);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// iOS devices (and probably some others) do not put in GPSVersionID tag (why?..)\n\t\t\t\t\tif (GPS.GPSVersionID && Basic.typeOf(GPS.GPSVersionID) === 'array') {\n\t\t\t\t\t\tGPS.GPSVersionID = GPS.GPSVersionID.join('.');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn GPS;\n\t\t\t},\n\n\n\t\t\tthumb: function() {\n\t\t\t\tif (offsets.IFD1) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar IFD1Tags = extractTags.call(this, offsets.IFD1, tags.thumb);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif ('JPEGInterchangeFormat' in IFD1Tags) {\n\t\t\t\t\t\t\treturn this.SEGMENT(offsets.tiffHeader + IFD1Tags.JPEGInterchangeFormat, IFD1Tags.JPEGInterchangeFormatLength);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (ex) {}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\n\n\t\t\tsetExif: function(tag, value) {\n\t\t\t\t// Right now only setting of width/height is possible\n\t\t\t\tif (tag !== 'PixelXDimension' && tag !== 'PixelYDimension') { return false; }\n\n\t\t\t\treturn setTag.call(this, 'exif', tag, value);\n\t\t\t},\n\n\n\t\t\tclear: function() {\n\t\t\t\t__super__.clear();\n\t\t\t\tdata = tags = tagDescs = Tiff = offsets = __super__ = null;\n\t\t\t}\n\t\t});\n\n\n\t\t// Check if that's APP1 and that it has EXIF\n\t\tif (this.SHORT(0) !== 0xFFE1 || this.STRING(4, 5).toUpperCase() !== \"EXIF\\0\") {\n\t\t\tthrow new x.ImageError(x.ImageError.INVALID_META_ERR);\n\t\t}\n\n\t\t// Set read order of multi-byte data\n\t\tthis.littleEndian = (this.SHORT(idx) == 0x4949);\n\n\t\t// Check if always present bytes are indeed present\n\t\tif (this.SHORT(idx+=2) !== 0x002A) {\n\t\t\tthrow new x.ImageError(x.ImageError.INVALID_META_ERR);\n\t\t}\n\n\t\toffsets.IFD0 = offsets.tiffHeader + this.LONG(idx += 2);\n\t\tTiff = extractTags.call(this, offsets.IFD0, tags.tiff);\n\n\t\tif ('ExifIFDPointer' in Tiff) {\n\t\t\toffsets.exifIFD = offsets.tiffHeader + Tiff.ExifIFDPointer;\n\t\t\tdelete Tiff.ExifIFDPointer;\n\t\t}\n\n\t\tif ('GPSInfoIFDPointer' in Tiff) {\n\t\t\toffsets.gpsIFD = offsets.tiffHeader + Tiff.GPSInfoIFDPointer;\n\t\t\tdelete Tiff.GPSInfoIFDPointer;\n\t\t}\n\n\t\tif (Basic.isEmptyObj(Tiff)) {\n\t\t\tTiff = null;\n\t\t}\n\n\t\t// check if we have a thumb as well\n\t\tvar IFD1Offset = this.LONG(offsets.IFD0 + this.SHORT(offsets.IFD0) * 12 + 2);\n\t\tif (IFD1Offset) {\n\t\t\toffsets.IFD1 = offsets.tiffHeader + IFD1Offset;\n\t\t}\n\n\n\t\tfunction extractTags(IFD_offset, tags2extract) {\n\t\t\tvar data = this;\n\t\t\tvar length, i, tag, type, count, size, offset, value, values = [], hash = {};\n\t\t\t\n\t\t\tvar types = {\n\t\t\t\t1 : 'BYTE',\n\t\t\t\t7 : 'UNDEFINED',\n\t\t\t\t2 : 'ASCII',\n\t\t\t\t3 : 'SHORT',\n\t\t\t\t4 : 'LONG',\n\t\t\t\t5 : 'RATIONAL',\n\t\t\t\t9 : 'SLONG',\n\t\t\t\t10: 'SRATIONAL'\n\t\t\t};\n\n\t\t\tvar sizes = {\n\t\t\t\t'BYTE' \t\t: 1,\n\t\t\t\t'UNDEFINED'\t: 1,\n\t\t\t\t'ASCII'\t\t: 1,\n\t\t\t\t'SHORT'\t\t: 2,\n\t\t\t\t'LONG' \t\t: 4,\n\t\t\t\t'RATIONAL' \t: 8,\n\t\t\t\t'SLONG'\t\t: 4,\n\t\t\t\t'SRATIONAL'\t: 8\n\t\t\t};\n\n\t\t\tlength = data.SHORT(IFD_offset);\n\n\t\t\t// The size of APP1 including all these elements shall not exceed the 64 Kbytes specified in the JPEG standard.\n\n\t\t\tfor (i = 0; i < length; i++) {\n\t\t\t\tvalues = [];\n\n\t\t\t\t// Set binary reader pointer to beginning of the next tag\n\t\t\t\toffset = IFD_offset + 2 + i*12;\n\n\t\t\t\ttag = tags2extract[data.SHORT(offset)];\n\n\t\t\t\tif (tag === undefined) {\n\t\t\t\t\tcontinue; // Not the tag we requested\n\t\t\t\t}\n\n\t\t\t\ttype = types[data.SHORT(offset+=2)];\n\t\t\t\tcount = data.LONG(offset+=2);\n\t\t\t\tsize = sizes[type];\n\n\t\t\t\tif (!size) {\n\t\t\t\t\tthrow new x.ImageError(x.ImageError.INVALID_META_ERR);\n\t\t\t\t}\n\n\t\t\t\toffset += 4;\n\n\t\t\t\t// tag can only fit 4 bytes of data, if data is larger we should look outside\n\t\t\t\tif (size * count > 4) {\n\t\t\t\t\t// instead of data tag contains an offset of the data\n\t\t\t\t\toffset = data.LONG(offset) + offsets.tiffHeader;\n\t\t\t\t}\n\n\t\t\t\t// in case we left the boundaries of data throw an early exception\n\t\t\t\tif (offset + size * count >= this.length()) {\n\t\t\t\t\tthrow new x.ImageError(x.ImageError.INVALID_META_ERR);\n\t\t\t\t} \n\n\t\t\t\t// special care for the string\n\t\t\t\tif (type === 'ASCII') {\n\t\t\t\t\thash[tag] = Basic.trim(data.STRING(offset, count).replace(/\\0$/, '')); // strip trailing NULL\n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\tvalues = data.asArray(type, offset, count);\n\t\t\t\t\tvalue = (count == 1 ? values[0] : values);\n\n\t\t\t\t\tif (tagDescs.hasOwnProperty(tag) && typeof value != 'object') {\n\t\t\t\t\t\thash[tag] = tagDescs[tag][value];\n\t\t\t\t\t} else {\n\t\t\t\t\t\thash[tag] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn hash;\n\t\t}\n\n\t\t// At the moment only setting of simple (LONG) values, that do not require offset recalculation, is supported\n\t\tfunction setTag(ifd, tag, value) {\n\t\t\tvar offset, length, tagOffset, valueOffset = 0;\n\n\t\t\t// If tag name passed translate into hex key\n\t\t\tif (typeof(tag) === 'string') {\n\t\t\t\tvar tmpTags = tags[ifd.toLowerCase()];\n\t\t\t\tfor (var hex in tmpTags) {\n\t\t\t\t\tif (tmpTags[hex] === tag) {\n\t\t\t\t\t\ttag = hex;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\toffset = offsets[ifd.toLowerCase() + 'IFD'];\n\t\t\tlength = this.SHORT(offset);\n\n\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\ttagOffset = offset + 12 * i + 2;\n\n\t\t\t\tif (this.SHORT(tagOffset) == tag) {\n\t\t\t\t\tvalueOffset = tagOffset + 8;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!valueOffset) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tthis.write(valueOffset, value, 4);\n\t\t\t} catch(ex) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tExifParser.prototype = BinaryReader.prototype;\n\n\treturn ExifParser;\n});\n\n// Included from: src/javascript/runtime/html5/image/JPEG.js\n\n/**\n * JPEG.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/image/JPEG\n@private\n*/\ndefine(\"moxie/runtime/html5/image/JPEG\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/runtime/html5/image/JPEGHeaders\",\n\t\"moxie/runtime/html5/utils/BinaryReader\",\n\t\"moxie/runtime/html5/image/ExifParser\"\n], function(Basic, x, JPEGHeaders, BinaryReader, ExifParser) {\n\t\n\tfunction JPEG(data) {\n\t\tvar _br, _hm, _ep, _info;\n\n\t\t_br = new BinaryReader(data);\n\n\t\t// check if it is jpeg\n\t\tif (_br.SHORT(0) !== 0xFFD8) {\n\t\t\tthrow new x.ImageError(x.ImageError.WRONG_FORMAT);\n\t\t}\n\n\t\t// backup headers\n\t\t_hm = new JPEGHeaders(data);\n\n\t\t// extract exif info\n\t\ttry {\n\t\t\t_ep = new ExifParser(_hm.get('app1')[0]);\n\t\t} catch(ex) {}\n\n\t\t// get dimensions\n\t\t_info = _getDimensions.call(this);\n\n\t\tBasic.extend(this, {\n\t\t\ttype: 'image/jpeg',\n\n\t\t\tsize: _br.length(),\n\n\t\t\twidth: _info && _info.width || 0,\n\n\t\t\theight: _info && _info.height || 0,\n\n\t\t\tsetExif: function(tag, value) {\n\t\t\t\tif (!_ep) {\n\t\t\t\t\treturn false; // or throw an exception\n\t\t\t\t}\n\n\t\t\t\tif (Basic.typeOf(tag) === 'object') {\n\t\t\t\t\tBasic.each(tag, function(value, tag) {\n\t\t\t\t\t\t_ep.setExif(tag, value);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t_ep.setExif(tag, value);\n\t\t\t\t}\n\n\t\t\t\t// update internal headers\n\t\t\t\t_hm.set('app1', _ep.SEGMENT());\n\t\t\t},\n\n\t\t\twriteHeaders: function() {\n\t\t\t\tif (!arguments.length) {\n\t\t\t\t\t// if no arguments passed, update headers internally\n\t\t\t\t\treturn _hm.restore(data);\n\t\t\t\t}\n\t\t\t\treturn _hm.restore(arguments[0]);\n\t\t\t},\n\n\t\t\tstripHeaders: function(data) {\n\t\t\t\treturn _hm.strip(data);\n\t\t\t},\n\n\t\t\tpurge: function() {\n\t\t\t\t_purge.call(this);\n\t\t\t}\n\t\t});\n\n\t\tif (_ep) {\n\t\t\tthis.meta = {\n\t\t\t\ttiff: _ep.TIFF(),\n\t\t\t\texif: _ep.EXIF(),\n\t\t\t\tgps: _ep.GPS(),\n\t\t\t\tthumb: _getThumb()\n\t\t\t};\n\t\t}\n\n\n\t\tfunction _getDimensions(br) {\n\t\t\tvar idx = 0\n\t\t\t, marker\n\t\t\t, length\n\t\t\t;\n\n\t\t\tif (!br) {\n\t\t\t\tbr = _br;\n\t\t\t}\n\n\t\t\t// examine all through the end, since some images might have very large APP segments\n\t\t\twhile (idx <= br.length()) {\n\t\t\t\tmarker = br.SHORT(idx += 2);\n\n\t\t\t\tif (marker >= 0xFFC0 && marker <= 0xFFC3) { // SOFn\n\t\t\t\t\tidx += 5; // marker (2 bytes) + length (2 bytes) + Sample precision (1 byte)\n\t\t\t\t\treturn {\n\t\t\t\t\t\theight: br.SHORT(idx),\n\t\t\t\t\t\twidth: br.SHORT(idx += 2)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tlength = br.SHORT(idx += 2);\n\t\t\t\tidx += length - 2;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\n\t\tfunction _getThumb() {\n\t\t\tvar data =  _ep.thumb()\n\t\t\t, br\n\t\t\t, info\n\t\t\t;\n\n\t\t\tif (data) {\n\t\t\t\tbr = new BinaryReader(data);\n\t\t\t\tinfo = _getDimensions(br);\n\t\t\t\tbr.clear();\n\n\t\t\t\tif (info) {\n\t\t\t\t\tinfo.data = data;\n\t\t\t\t\treturn info;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\n\t\tfunction _purge() {\n\t\t\tif (!_ep || !_hm || !_br) { \n\t\t\t\treturn; // ignore any repeating purge requests\n\t\t\t}\n\t\t\t_ep.clear();\n\t\t\t_hm.purge();\n\t\t\t_br.clear();\n\t\t\t_info = _hm = _ep = _br = null;\n\t\t}\n\t}\n\n\treturn JPEG;\n});\n\n// Included from: src/javascript/runtime/html5/image/PNG.js\n\n/**\n * PNG.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/image/PNG\n@private\n*/\ndefine(\"moxie/runtime/html5/image/PNG\", [\n\t\"moxie/core/Exceptions\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/html5/utils/BinaryReader\"\n], function(x, Basic, BinaryReader) {\n\t\n\tfunction PNG(data) {\n\t\tvar _br, _hm, _ep, _info;\n\n\t\t_br = new BinaryReader(data);\n\n\t\t// check if it's png\n\t\t(function() {\n\t\t\tvar idx = 0, i = 0\n\t\t\t, signature = [0x8950, 0x4E47, 0x0D0A, 0x1A0A]\n\t\t\t;\n\n\t\t\tfor (i = 0; i < signature.length; i++, idx += 2) {\n\t\t\t\tif (signature[i] != _br.SHORT(idx)) {\n\t\t\t\t\tthrow new x.ImageError(x.ImageError.WRONG_FORMAT);\n\t\t\t\t}\n\t\t\t}\n\t\t}());\n\n\t\tfunction _getDimensions() {\n\t\t\tvar chunk, idx;\n\n\t\t\tchunk = _getChunkAt.call(this, 8);\n\n\t\t\tif (chunk.type == 'IHDR') {\n\t\t\t\tidx = chunk.start;\n\t\t\t\treturn {\n\t\t\t\t\twidth: _br.LONG(idx),\n\t\t\t\t\theight: _br.LONG(idx += 4)\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction _purge() {\n\t\t\tif (!_br) {\n\t\t\t\treturn; // ignore any repeating purge requests\n\t\t\t}\n\t\t\t_br.clear();\n\t\t\tdata = _info = _hm = _ep = _br = null;\n\t\t}\n\n\t\t_info = _getDimensions.call(this);\n\n\t\tBasic.extend(this, {\n\t\t\ttype: 'image/png',\n\n\t\t\tsize: _br.length(),\n\n\t\t\twidth: _info.width,\n\n\t\t\theight: _info.height,\n\n\t\t\tpurge: function() {\n\t\t\t\t_purge.call(this);\n\t\t\t}\n\t\t});\n\n\t\t// for PNG we can safely trigger purge automatically, as we do not keep any data for later\n\t\t_purge.call(this);\n\n\t\tfunction _getChunkAt(idx) {\n\t\t\tvar length, type, start, CRC;\n\n\t\t\tlength = _br.LONG(idx);\n\t\t\ttype = _br.STRING(idx += 4, 4);\n\t\t\tstart = idx += 4;\n\t\t\tCRC = _br.LONG(idx + length);\n\n\t\t\treturn {\n\t\t\t\tlength: length,\n\t\t\t\ttype: type,\n\t\t\t\tstart: start,\n\t\t\t\tCRC: CRC\n\t\t\t};\n\t\t}\n\t}\n\n\treturn PNG;\n});\n\n// Included from: src/javascript/runtime/html5/image/ImageInfo.js\n\n/**\n * ImageInfo.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\nOptional image investigation tool for HTML5 runtime. Provides the following features:\n- ability to distinguish image type (JPEG or PNG) by signature\n- ability to extract image width/height directly from it's internals, without preloading in memory (fast)\n- ability to extract APP headers from JPEGs (Exif, GPS, etc)\n- ability to replace width/height tags in extracted JPEG headers\n- ability to restore APP headers, that were for example stripped during image manipulation\n\n@class moxie/runtime/html5/image/ImageInfo\n@private\n@param {String} data Image source as binary string\n*/\ndefine(\"moxie/runtime/html5/image/ImageInfo\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/runtime/html5/image/JPEG\",\n\t\"moxie/runtime/html5/image/PNG\"\n], function(Basic, x, JPEG, PNG) {\n\n\treturn function(data) {\n\t\tvar _cs = [JPEG, PNG], _img;\n\n\t\t// figure out the format, throw: ImageError.WRONG_FORMAT if not supported\n\t\t_img = (function() {\n\t\t\tfor (var i = 0; i < _cs.length; i++) {\n\t\t\t\ttry {\n\t\t\t\t\treturn new _cs[i](data);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\t// console.info(ex);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthrow new x.ImageError(x.ImageError.WRONG_FORMAT);\n\t\t}());\n\n\t\tBasic.extend(this, {\n\t\t\t/**\n\t\t\tImage Mime Type extracted from it's depths\n\n\t\t\t@property type\n\t\t\t@type {String}\n\t\t\t@default ''\n\t\t\t*/\n\t\t\ttype: '',\n\n\t\t\t/**\n\t\t\tImage size in bytes\n\n\t\t\t@property size\n\t\t\t@type {Number}\n\t\t\t@default 0\n\t\t\t*/\n\t\t\tsize: 0,\n\n\t\t\t/**\n\t\t\tImage width extracted from image source\n\n\t\t\t@property width\n\t\t\t@type {Number}\n\t\t\t@default 0\n\t\t\t*/\n\t\t\twidth: 0,\n\n\t\t\t/**\n\t\t\tImage height extracted from image source\n\n\t\t\t@property height\n\t\t\t@type {Number}\n\t\t\t@default 0\n\t\t\t*/\n\t\t\theight: 0,\n\n\t\t\t/**\n\t\t\tSets Exif tag. Currently applicable only for width and height tags. Obviously works only with JPEGs.\n\n\t\t\t@method setExif\n\t\t\t@param {String} tag Tag to set\n\t\t\t@param {Mixed} value Value to assign to the tag\n\t\t\t*/\n\t\t\tsetExif: function() {},\n\n\t\t\t/**\n\t\t\tRestores headers to the source.\n\n\t\t\t@method writeHeaders\n\t\t\t@param {String} data Image source as binary string\n\t\t\t@return {String} Updated binary string\n\t\t\t*/\n\t\t\twriteHeaders: function(data) {\n\t\t\t\treturn data;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tStrip all headers from the source.\n\n\t\t\t@method stripHeaders\n\t\t\t@param {String} data Image source as binary string\n\t\t\t@return {String} Updated binary string\n\t\t\t*/\n\t\t\tstripHeaders: function(data) {\n\t\t\t\treturn data;\n\t\t\t},\n\n\t\t\t/**\n\t\t\tDispose resources.\n\n\t\t\t@method purge\n\t\t\t*/\n\t\t\tpurge: function() {\n\t\t\t\tdata = null;\n\t\t\t}\n\t\t});\n\n\t\tBasic.extend(this, _img);\n\n\t\tthis.purge = function() {\n\t\t\t_img.purge();\n\t\t\t_img = null;\n\t\t};\n\t};\n});\n\n// Included from: src/javascript/runtime/html5/image/ResizerCanvas.js\n\n/**\n * ResizerCanvas.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n * Resizes image/canvas using canvas\n */\ndefine(\"moxie/runtime/html5/image/ResizerCanvas\", [], function() {\n\n    function scale(image, ratio, resample) {\n        var sD = image.width > image.height ? 'width' : 'height'; // take the largest side\n        var dD = Math.round(image[sD] * ratio);\n        var scaleCapped = false;\n\n        if (resample !== 'nearest' && (ratio < 0.5 || ratio > 2)) {\n            ratio = ratio < 0.5 ? 0.5 : 2;\n            scaleCapped = true;\n        }\n\n        var tCanvas = _scale(image, ratio);\n\n        if (scaleCapped) {\n            return scale(tCanvas, dD / tCanvas[sD], resample);\n        } else {\n            return tCanvas;\n        }\n    }\n\n\n    function _scale(image, ratio) {\n        var sW = image.width;\n        var sH = image.height;\n        var dW = Math.round(sW * ratio);\n        var dH = Math.round(sH * ratio);\n\n        var canvas = document.createElement('canvas');\n        canvas.width = dW;\n        canvas.height = dH;\n        canvas.getContext(\"2d\").drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);\n\n        image = null; // just in case\n        return canvas;\n    }\n\n    return {\n        scale: scale\n    };\n\n});\n\n// Included from: src/javascript/runtime/html5/image/Image.js\n\n/**\n * Image.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html5/image/Image\n@private\n*/\ndefine(\"moxie/runtime/html5/image/Image\", [\n\t\"moxie/runtime/html5/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/core/utils/Encode\",\n\t\"moxie/file/Blob\",\n\t\"moxie/file/File\",\n\t\"moxie/runtime/html5/image/ImageInfo\",\n\t\"moxie/runtime/html5/image/ResizerCanvas\",\n\t\"moxie/core/utils/Mime\",\n\t\"moxie/core/utils/Env\"\n], function(extensions, Basic, x, Encode, Blob, File, ImageInfo, ResizerCanvas, Mime, Env) {\n\n\tfunction HTML5Image() {\n\t\tvar me = this\n\t\t, _img, _imgInfo, _canvas, _binStr, _blob\n\t\t, _modified = false // is set true whenever image is modified\n\t\t, _preserveHeaders = true\n\t\t;\n\n\t\tBasic.extend(this, {\n\t\t\tloadFromBlob: function(blob) {\n\t\t\t\tvar I = this.getRuntime()\n\t\t\t\t, asBinary = arguments.length > 1 ? arguments[1] : true\n\t\t\t\t;\n\n\t\t\t\tif (!I.can('access_binary')) {\n\t\t\t\t\tthrow new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);\n\t\t\t\t}\n\n\t\t\t\t_blob = blob;\n\n\t\t\t\tif (blob.isDetached()) {\n\t\t\t\t\t_binStr = blob.getSource();\n\t\t\t\t\t_preload.call(this, _binStr);\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\t_readAsDataUrl.call(this, blob.getSource(), function(dataUrl) {\n\t\t\t\t\t\tif (asBinary) {\n\t\t\t\t\t\t\t_binStr = _toBinary(dataUrl);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_preload.call(this, dataUrl);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tloadFromImage: function(img, exact) {\n\t\t\t\tthis.meta = img.meta;\n\n\t\t\t\t_blob = new File(null, {\n\t\t\t\t\tname: img.name,\n\t\t\t\t\tsize: img.size,\n\t\t\t\t\ttype: img.type\n\t\t\t\t});\n\n\t\t\t\t_preload.call(this, exact ? (_binStr = img.getAsBinaryString()) : img.getAsDataURL());\n\t\t\t},\n\n\t\t\tgetInfo: function() {\n\t\t\t\tvar I = this.getRuntime(), info;\n\n\t\t\t\tif (!_imgInfo && _binStr && I.can('access_image_binary')) {\n\t\t\t\t\t_imgInfo = new ImageInfo(_binStr);\n\t\t\t\t}\n\n\t\t\t\t// this stuff below is definitely having fun with itself\n\t\t\t\tinfo = {\n\t\t\t\t\twidth: _getImg().width || 0,\n\t\t\t\t\theight: _getImg().height || 0,\n\t\t\t\t\ttype: _blob.type || Mime.getFileMime(_blob.name),\n\t\t\t\t\tsize: _binStr && _binStr.length || _blob.size || 0,\n\t\t\t\t\tname: _blob.name || '',\n\t\t\t\t\tmeta: null\n\t\t\t\t};\n\n\t\t\t\tif (_preserveHeaders) {\n\t\t\t\t\tinfo.meta = _imgInfo && _imgInfo.meta || this.meta || {};\n\n\t\t\t\t\t// if data was taken from ImageInfo it will be a binary string, so we convert it to blob\n\t\t\t\t\tif (info.meta && info.meta.thumb && !(info.meta.thumb.data instanceof Blob)) {\n\t\t\t\t\t\tinfo.meta.thumb.data = new Blob(null, {\n\t\t\t\t\t\t\ttype: 'image/jpeg',\n\t\t\t\t\t\t\tdata: info.meta.thumb.data\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn info;\n\t\t\t},\n\n\n\t\t\tresize: function(rect, ratio, options) {\n\t\t\t\tvar canvas = document.createElement('canvas');\n\t\t\t\tcanvas.width = rect.width;\n\t\t\t\tcanvas.height = rect.height;\n\n\t\t\t\tcanvas.getContext(\"2d\").drawImage(_getImg(), rect.x, rect.y, rect.width, rect.height, 0, 0, canvas.width, canvas.height);\n\n\t\t\t\t_canvas = ResizerCanvas.scale(canvas, ratio);\n\n\t\t\t\t_preserveHeaders = options.preserveHeaders;\n\n\t\t\t\t// rotate if required, according to orientation tag\n\t\t\t\tif (!_preserveHeaders) {\n\t\t\t\t\tvar orientation = (this.meta && this.meta.tiff && this.meta.tiff.Orientation) || 1;\n\t\t\t\t\t_canvas = _rotateToOrientaion(_canvas, orientation);\n\t\t\t\t}\n\n\t\t\t\tthis.width = _canvas.width;\n\t\t\t\tthis.height = _canvas.height;\n\n\t\t\t\t_modified = true;\n\n\t\t\t\tthis.trigger('Resize');\n\t\t\t},\n\n\t\t\tgetAsCanvas: function() {\n\t\t\t\tif (!_canvas) {\n\t\t\t\t\t_canvas = _getCanvas();\n\t\t\t\t}\n\t\t\t\t_canvas.id = this.uid + '_canvas';\n\t\t\t\treturn _canvas;\n\t\t\t},\n\n\t\t\tgetAsBlob: function(type, quality) {\n\t\t\t\tif (type !== this.type) {\n\t\t\t\t\t_modified = true; // reconsider the state\n\t\t\t\t\treturn new File(null, {\n\t\t\t\t\t\tname: _blob.name || '',\n\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\tdata: me.getAsDataURL(type, quality)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn new File(null, {\n\t\t\t\t\tname: _blob.name || '',\n\t\t\t\t\ttype: type,\n\t\t\t\t\tdata: me.getAsBinaryString(type, quality)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tgetAsDataURL: function(type) {\n\t\t\t\tvar quality = arguments[1] || 90;\n\n\t\t\t\t// if image has not been modified, return the source right away\n\t\t\t\tif (!_modified) {\n\t\t\t\t\treturn _img.src;\n\t\t\t\t}\n\n\t\t\t\t// make sure we have a canvas to work with\n\t\t\t\t_getCanvas();\n\n\t\t\t\tif ('image/jpeg' !== type) {\n\t\t\t\t\treturn _canvas.toDataURL('image/png');\n\t\t\t\t} else {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// older Geckos used to result in an exception on quality argument\n\t\t\t\t\t\treturn _canvas.toDataURL('image/jpeg', quality/100);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\treturn _canvas.toDataURL('image/jpeg');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetAsBinaryString: function(type, quality) {\n\t\t\t\t// if image has not been modified, return the source right away\n\t\t\t\tif (!_modified) {\n\t\t\t\t\t// if image was not loaded from binary string\n\t\t\t\t\tif (!_binStr) {\n\t\t\t\t\t\t_binStr = _toBinary(me.getAsDataURL(type, quality));\n\t\t\t\t\t}\n\t\t\t\t\treturn _binStr;\n\t\t\t\t}\n\n\t\t\t\tif ('image/jpeg' !== type) {\n\t\t\t\t\t_binStr = _toBinary(me.getAsDataURL(type, quality));\n\t\t\t\t} else {\n\t\t\t\t\tvar dataUrl;\n\n\t\t\t\t\t// if jpeg\n\t\t\t\t\tif (!quality) {\n\t\t\t\t\t\tquality = 90;\n\t\t\t\t\t}\n\n\t\t\t\t\t// make sure we have a canvas to work with\n\t\t\t\t\t_getCanvas();\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// older Geckos used to result in an exception on quality argument\n\t\t\t\t\t\tdataUrl = _canvas.toDataURL('image/jpeg', quality/100);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tdataUrl = _canvas.toDataURL('image/jpeg');\n\t\t\t\t\t}\n\n\t\t\t\t\t_binStr = _toBinary(dataUrl);\n\n\t\t\t\t\tif (_imgInfo) {\n\t\t\t\t\t\t_binStr = _imgInfo.stripHeaders(_binStr);\n\n\t\t\t\t\t\tif (_preserveHeaders) {\n\t\t\t\t\t\t\t// update dimensions info in exif\n\t\t\t\t\t\t\tif (_imgInfo.meta && _imgInfo.meta.exif) {\n\t\t\t\t\t\t\t\t_imgInfo.setExif({\n\t\t\t\t\t\t\t\t\tPixelXDimension: this.width,\n\t\t\t\t\t\t\t\t\tPixelYDimension: this.height\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// re-inject the headers\n\t\t\t\t\t\t\t_binStr = _imgInfo.writeHeaders(_binStr);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// will be re-created from fresh on next getInfo call\n\t\t\t\t\t\t_imgInfo.purge();\n\t\t\t\t\t\t_imgInfo = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t_modified = false;\n\n\t\t\t\treturn _binStr;\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tme = null;\n\t\t\t\t_purge.call(this);\n\t\t\t\tthis.getRuntime().getShim().removeInstance(this.uid);\n\t\t\t}\n\t\t});\n\n\n\t\tfunction _getImg() {\n\t\t\tif (!_canvas && !_img) {\n\t\t\t\tthrow new x.ImageError(x.DOMException.INVALID_STATE_ERR);\n\t\t\t}\n\t\t\treturn _canvas || _img;\n\t\t}\n\n\n\t\tfunction _getCanvas() {\n\t\t\tvar canvas = _getImg();\n\t\t\tif (canvas.nodeName.toLowerCase() == 'canvas') {\n\t\t\t\treturn canvas;\n\t\t\t}\n\t\t\t_canvas = document.createElement('canvas');\n\t\t\t_canvas.width = canvas.width;\n\t\t\t_canvas.height = canvas.height;\n\t\t\t_canvas.getContext(\"2d\").drawImage(canvas, 0, 0);\n\t\t\treturn _canvas;\n\t\t}\n\n\n\t\tfunction _toBinary(str) {\n\t\t\treturn Encode.atob(str.substring(str.indexOf('base64,') + 7));\n\t\t}\n\n\n\t\tfunction _toDataUrl(str, type) {\n\t\t\treturn 'data:' + (type || '') + ';base64,' + Encode.btoa(str);\n\t\t}\n\n\n\t\tfunction _preload(str) {\n\t\t\tvar comp = this;\n\n\t\t\t_img = new Image();\n\t\t\t_img.onerror = function() {\n\t\t\t\t_purge.call(this);\n\t\t\t\tcomp.trigger('error', x.ImageError.WRONG_FORMAT);\n\t\t\t};\n\t\t\t_img.onload = function() {\n\t\t\t\tcomp.trigger('load');\n\t\t\t};\n\n\t\t\t_img.src = str.substr(0, 5) == 'data:' ? str : _toDataUrl(str, _blob.type);\n\t\t}\n\n\n\t\tfunction _readAsDataUrl(file, callback) {\n\t\t\tvar comp = this, fr;\n\n\t\t\t// use FileReader if it's available\n\t\t\tif (window.FileReader) {\n\t\t\t\tfr = new FileReader();\n\t\t\t\tfr.onload = function() {\n\t\t\t\t\tcallback.call(comp, this.result);\n\t\t\t\t};\n\t\t\t\tfr.onerror = function() {\n\t\t\t\t\tcomp.trigger('error', x.ImageError.WRONG_FORMAT);\n\t\t\t\t};\n\t\t\t\tfr.readAsDataURL(file);\n\t\t\t} else {\n\t\t\t\treturn callback.call(this, file.getAsDataURL());\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t* Transform canvas coordination according to specified frame size and orientation\n\t\t* Orientation value is from EXIF tag\n\t\t* @author Shinichi Tomita <shinichi.tomita@gmail.com>\n\t\t*/\n\t\tfunction _rotateToOrientaion(img, orientation) {\n\t\t\tvar RADIANS = Math.PI/180;\n\t\t\tvar canvas = document.createElement('canvas');\n\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\tvar width = img.width;\n\t\t\tvar height = img.height;\n\n\t\t\tif (Basic.inArray(orientation, [5,6,7,8]) > -1) {\n\t\t\t\tcanvas.width = height;\n\t\t\t\tcanvas.height = width;\n\t\t\t} else {\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t1 = The 0th row is at the visual top of the image, and the 0th column is the visual left-hand side.\n\t\t\t2 = The 0th row is at the visual top of the image, and the 0th column is the visual right-hand side.\n\t\t\t3 = The 0th row is at the visual bottom of the image, and the 0th column is the visual right-hand side.\n\t\t\t4 = The 0th row is at the visual bottom of the image, and the 0th column is the visual left-hand side.\n\t\t\t5 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual top.\n\t\t\t6 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual top.\n\t\t\t7 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual bottom.\n\t\t\t8 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual bottom.\n\t\t\t*/\n\t\t\tswitch (orientation) {\n\t\t\t\tcase 2:\n\t\t\t\t\t// horizontal flip\n\t\t\t\t\tctx.translate(width, 0);\n\t\t\t\t\tctx.scale(-1, 1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\t// 180 rotate left\n\t\t\t\t\tctx.translate(width, height);\n\t\t\t\t\tctx.rotate(180 * RADIANS);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\t// vertical flip\n\t\t\t\t\tctx.translate(0, height);\n\t\t\t\t\tctx.scale(1, -1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 5:\n\t\t\t\t\t// vertical flip + 90 rotate right\n\t\t\t\t\tctx.rotate(90 * RADIANS);\n\t\t\t\t\tctx.scale(1, -1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 6:\n\t\t\t\t\t// 90 rotate right\n\t\t\t\t\tctx.rotate(90 * RADIANS);\n\t\t\t\t\tctx.translate(0, -height);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 7:\n\t\t\t\t\t// horizontal flip + 90 rotate right\n\t\t\t\t\tctx.rotate(90 * RADIANS);\n\t\t\t\t\tctx.translate(width, -height);\n\t\t\t\t\tctx.scale(-1, 1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\t// 90 rotate left\n\t\t\t\t\tctx.rotate(-90 * RADIANS);\n\t\t\t\t\tctx.translate(-width, 0);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tctx.drawImage(img, 0, 0, width, height);\n\t\t\treturn canvas;\n\t\t}\n\n\n\t\tfunction _purge() {\n\t\t\tif (_imgInfo) {\n\t\t\t\t_imgInfo.purge();\n\t\t\t\t_imgInfo = null;\n\t\t\t}\n\n\t\t\t_binStr = _img = _canvas = _blob = null;\n\t\t\t_modified = false;\n\t\t}\n\t}\n\n\treturn (extensions.Image = HTML5Image);\n});\n\n// Included from: src/javascript/runtime/flash/Runtime.js\n\n/**\n * Runtime.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/*global ActiveXObject:true */\n\n/**\nDefines constructor for Flash runtime.\n\n@class moxie/runtime/flash/Runtime\n@private\n*/\ndefine(\"moxie/runtime/flash/Runtime\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Env\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/runtime/Runtime\"\n], function(Basic, Env, Dom, x, Runtime) {\n\t\n\tvar type = 'flash', extensions = {};\n\n\t/**\n\tGet the version of the Flash Player\n\n\t@method getShimVersion\n\t@private\n\t@return {Number} Flash Player version\n\t*/\n\tfunction getShimVersion() {\n\t\tvar version;\n\n\t\ttry {\n\t\t\tversion = navigator.plugins['Shockwave Flash'];\n\t\t\tversion = version.description;\n\t\t} catch (e1) {\n\t\t\ttry {\n\t\t\t\tversion = new ActiveXObject('ShockwaveFlash.ShockwaveFlash').GetVariable('$version');\n\t\t\t} catch (e2) {\n\t\t\t\tversion = '0.0';\n\t\t\t}\n\t\t}\n\t\tversion = version.match(/\\d+/g);\n\t\treturn parseFloat(version[0] + '.' + version[1]);\n\t}\n\n\n\t/**\n\tCross-browser SWF removal\n    \t- Especially needed to safely and completely remove a SWF in Internet Explorer\n\n   \tOriginated from SWFObject v2.2 <http://code.google.com/p/swfobject/> \n\t*/\n\tfunction removeSWF(id) {\n        var obj = Dom.get(id);\n        if (obj && obj.nodeName == \"OBJECT\") {\n            if (Env.browser === 'IE') {\n                obj.style.display = \"none\";\n                (function onInit(){\n                \t// http://msdn.microsoft.com/en-us/library/ie/ms534360(v=vs.85).aspx\n                    if (obj.readyState == 4) {\n                        removeObjectInIE(id);\n                    }\n                    else {\n                        setTimeout(onInit, 10);\n                    }\n                })();\n            }\n            else {\n                obj.parentNode.removeChild(obj);\n            }\n        }\n    }\n\n\n\tfunction removeObjectInIE(id) {\n        var obj = Dom.get(id);\n        if (obj) {\n            for (var i in obj) {\n                if (typeof obj[i] == \"function\") {\n                    obj[i] = null;\n                }\n            }\n            obj.parentNode.removeChild(obj);\n        }\n    }\n\n\t/**\n\tConstructor for the Flash Runtime\n\t*/\n\tfunction FlashRuntime(options) {\n\t\tvar I = this, initTimer;\n\n\t\toptions = Basic.extend({ swf_url: Env.swf_url }, options);\n\n\t\tRuntime.call(this, options, type, {\n\t\t\taccess_binary: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\taccess_image_binary: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\tdisplay_media: Runtime.capTest(defined('moxie/image/Image')),\n\t\t\tdo_cors: Runtime.capTrue,\n\t\t\tdrag_and_drop: false,\n\t\t\treport_upload_progress: function() {\n\t\t\t\treturn I.mode === 'client';\n\t\t\t},\n\t\t\tresize_image: Runtime.capTrue,\n\t\t\treturn_response_headers: false,\n\t\t\treturn_response_type: function(responseType) {\n\t\t\t\tif (responseType === 'json' && !!window.JSON) {\n\t\t\t\t\treturn true;\n\t\t\t\t} \n\t\t\t\treturn !Basic.arrayDiff(responseType, ['', 'text', 'document']) || I.mode === 'browser';\n\t\t\t},\n\t\t\treturn_status_code: function(code) {\n\t\t\t\treturn I.mode === 'browser' || !Basic.arrayDiff(code, [200, 404]);\n\t\t\t},\n\t\t\tselect_file: Runtime.capTrue,\n\t\t\tselect_multiple: Runtime.capTrue,\n\t\t\tsend_binary_string: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\tsend_browser_cookies: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\tsend_custom_headers: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\tsend_multipart: Runtime.capTrue,\n\t\t\tslice_blob: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\tstream_upload: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\tsummon_file_dialog: false,\n\t\t\tupload_filesize: function(size) {\n\t\t\t\treturn Basic.parseSizeStr(size) <= 2097152 || I.mode === 'client';\n\t\t\t},\n\t\t\tuse_http_method: function(methods) {\n\t\t\t\treturn !Basic.arrayDiff(methods, ['GET', 'POST']);\n\t\t\t}\n\t\t}, { \n\t\t\t// capabilities that require specific mode\n\t\t\taccess_binary: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\taccess_image_binary: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\treport_upload_progress: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\treturn_response_type: function(responseType) {\n\t\t\t\treturn Basic.arrayDiff(responseType, ['', 'text', 'json', 'document']) ? 'browser' : ['client', 'browser'];\n\t\t\t},\n\t\t\treturn_status_code: function(code) {\n\t\t\t\treturn Basic.arrayDiff(code, [200, 404]) ? 'browser' : ['client', 'browser'];\n\t\t\t},\n\t\t\tsend_binary_string: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\tsend_browser_cookies: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\tsend_custom_headers: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\tslice_blob: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\tstream_upload: function(value) {\n\t\t\t\treturn value ? 'client' : 'browser';\n\t\t\t},\n\t\t\tupload_filesize: function(size) {\n\t\t\t\treturn Basic.parseSizeStr(size) >= 2097152 ? 'client' : 'browser';\n\t\t\t}\n\t\t}, 'client');\n\n\n\t\t// minimal requirement for Flash Player version\n\t\tif (getShimVersion() < 11.3) {\n\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\tEnv.log(\"\\tFlash didn't meet minimal version requirement (11.3).\");\t\n\t\t\t}\n\n\t\t\tthis.mode = false; // with falsy mode, runtime won't operable, no matter what the mode was before\n\t\t}\n\n\n\t\tBasic.extend(this, {\n\n\t\t\tgetShim: function() {\n\t\t\t\treturn Dom.get(this.uid);\n\t\t\t},\n\n\t\t\tshimExec: function(component, action) {\n\t\t\t\tvar args = [].slice.call(arguments, 2);\n\t\t\t\treturn I.getShim().exec(this.uid, component, action, args);\n\t\t\t},\n\n\t\t\tinit: function() {\n\t\t\t\tvar html, el, container;\n\n\t\t\t\tcontainer = this.getShimContainer();\n\n\t\t\t\t// if not the minimal height, shims are not initialized in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n\t\t\t\tBasic.extend(container.style, {\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\ttop: '-8px',\n\t\t\t\t\tleft: '-8px',\n\t\t\t\t\twidth: '9px',\n\t\t\t\t\theight: '9px',\n\t\t\t\t\toverflow: 'hidden'\n\t\t\t\t});\n\n\t\t\t\t// insert flash object\n\t\t\t\thtml = '<object id=\"' + this.uid + '\" type=\"application/x-shockwave-flash\" data=\"' +  options.swf_url + '\" ';\n\n\t\t\t\tif (Env.browser === 'IE') {\n\t\t\t\t\thtml += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n\t\t\t\t}\n\n\t\t\t\thtml += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n\t\t\t\t\t'<param name=\"movie\" value=\"' + options.swf_url + '\" />' +\n\t\t\t\t\t'<param name=\"flashvars\" value=\"uid=' + escape(this.uid) + '&target=' + Runtime.getGlobalEventTarget() + '\" />' +\n\t\t\t\t\t'<param name=\"wmode\" value=\"transparent\" />' +\n\t\t\t\t\t'<param name=\"allowscriptaccess\" value=\"always\" />' +\n\t\t\t\t'</object>';\n\n\t\t\t\tif (Env.browser === 'IE') {\n\t\t\t\t\tel = document.createElement('div');\n\t\t\t\t\tcontainer.appendChild(el);\n\t\t\t\t\tel.outerHTML = html;\n\t\t\t\t\tel = container = null; // just in case\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.innerHTML = html;\n\t\t\t\t}\n\n\t\t\t\t// Init is dispatched by the shim\n\t\t\t\tinitTimer = setTimeout(function() {\n\t\t\t\t\tif (I && !I.initialized) { // runtime might be already destroyed by this moment\n\t\t\t\t\t\tI.trigger(\"Error\", new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR));\n\n\t\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\t\tEnv.log(\"\\tFlash failed to initialize within a specified period of time (typically 5s).\");\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, 5000);\n\t\t\t},\n\n\t\t\tdestroy: (function(destroy) { // extend default destroy method\n\t\t\t\treturn function() {\n\t\t\t\t\tremoveSWF(I.uid); // SWF removal requires special care in IE\n\n\t\t\t\t\tdestroy.call(I);\n\t\t\t\t\tclearTimeout(initTimer); // initialization check might be still onwait\n\t\t\t\t\toptions = initTimer = destroy = I = null;\n\t\t\t\t};\n\t\t\t}(this.destroy))\n\n\t\t}, extensions);\n\t}\n\n\tRuntime.addConstructor(type, FlashRuntime);\n\n\treturn extensions;\n});\n\n// Included from: src/javascript/runtime/flash/file/Blob.js\n\n/**\n * Blob.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/flash/file/Blob\n@private\n*/\ndefine(\"moxie/runtime/flash/file/Blob\", [\n\t\"moxie/runtime/flash/Runtime\",\n\t\"moxie/file/Blob\"\n], function(extensions, Blob) {\n\n\tvar FlashBlob = {\n\t\tslice: function(blob, start, end, type) {\n\t\t\tvar self = this.getRuntime();\n\n\t\t\tif (start < 0) {\n\t\t\t\tstart = Math.max(blob.size + start, 0);\n\t\t\t} else if (start > 0) {\n\t\t\t\tstart = Math.min(start, blob.size);\n\t\t\t}\n\n\t\t\tif (end < 0) {\n\t\t\t\tend = Math.max(blob.size + end, 0);\n\t\t\t} else if (end > 0) {\n\t\t\t\tend = Math.min(end, blob.size);\n\t\t\t}\n\n\t\t\tblob = self.shimExec.call(this, 'Blob', 'slice', start, end, type || '');\n\n\t\t\tif (blob) {\n\t\t\t\tblob = new Blob(self.uid, blob);\n\t\t\t}\n\t\t\treturn blob;\n\t\t}\n\t};\n\n\treturn (extensions.Blob = FlashBlob);\n});\n\n// Included from: src/javascript/runtime/flash/file/FileInput.js\n\n/**\n * FileInput.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/flash/file/FileInput\n@private\n*/\ndefine(\"moxie/runtime/flash/file/FileInput\", [\n\t\"moxie/runtime/flash/Runtime\",\n\t\"moxie/file/File\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/utils/Basic\"\n], function(extensions, File, Dom, Basic) {\n\n\tvar FileInput = {\n\t\tinit: function(options) {\n\t\t\tvar comp = this, I = this.getRuntime();\n\t\t\tvar browseButton = Dom.get(options.browse_button);\n\n\t\t\tif (browseButton) {\n\t\t\t\tbrowseButton.setAttribute('tabindex', -1);\n\t\t\t\tbrowseButton = null;\n\t\t\t}\n\n\t\t\tthis.bind(\"Change\", function() {\n\t\t\t\tvar files = I.shimExec.call(comp, 'FileInput', 'getFiles');\n\t\t\t\tcomp.files = [];\n\t\t\t\tBasic.each(files, function(file) {\n\t\t\t\t\tcomp.files.push(new File(I.uid, file));\n\t\t\t\t});\n\t\t\t}, 999);\n\n\t\t\tthis.getRuntime().shimExec.call(this, 'FileInput', 'init', {\n\t\t\t\taccept: options.accept,\n\t\t\t\tmultiple: options.multiple\n\t\t\t});\n\n\t\t\tthis.trigger('ready');\n\t\t}\n\t};\n\n\treturn (extensions.FileInput = FileInput);\n});\n\n// Included from: src/javascript/runtime/flash/file/FileReader.js\n\n/**\n * FileReader.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/flash/file/FileReader\n@private\n*/\ndefine(\"moxie/runtime/flash/file/FileReader\", [\n\t\"moxie/runtime/flash/Runtime\",\n\t\"moxie/core/utils/Encode\"\n], function(extensions, Encode) {\n\n\tfunction _formatData(data, op) {\n\t\tswitch (op) {\n\t\t\tcase 'readAsText':\n\t\t\t\treturn Encode.atob(data, 'utf8');\n\t\t\tcase 'readAsBinaryString':\n\t\t\t\treturn Encode.atob(data);\n\t\t\tcase 'readAsDataURL':\n\t\t\t\treturn data;\n\t\t}\n\t\treturn null;\n\t}\n\n\tvar FileReader = {\n\t\tread: function(op, blob) {\n\t\t\tvar comp = this;\n\n\t\t\tcomp.result = '';\n\n\t\t\t// special prefix for DataURL read mode\n\t\t\tif (op === 'readAsDataURL') {\n\t\t\t\tcomp.result = 'data:' + (blob.type || '') + ';base64,';\n\t\t\t}\n\n\t\t\tcomp.bind('Progress', function(e, data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tcomp.result += _formatData(data, op);\n\t\t\t\t}\n\t\t\t}, 999);\n\n\t\t\treturn comp.getRuntime().shimExec.call(this, 'FileReader', 'readAsBase64', blob.uid);\n\t\t}\n\t};\n\n\treturn (extensions.FileReader = FileReader);\n});\n\n// Included from: src/javascript/runtime/flash/file/FileReaderSync.js\n\n/**\n * FileReaderSync.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/flash/file/FileReaderSync\n@private\n*/\ndefine(\"moxie/runtime/flash/file/FileReaderSync\", [\n\t\"moxie/runtime/flash/Runtime\",\n\t\"moxie/core/utils/Encode\"\n], function(extensions, Encode) {\n\t\n\tfunction _formatData(data, op) {\n\t\tswitch (op) {\n\t\t\tcase 'readAsText':\n\t\t\t\treturn Encode.atob(data, 'utf8');\n\t\t\tcase 'readAsBinaryString':\n\t\t\t\treturn Encode.atob(data);\n\t\t\tcase 'readAsDataURL':\n\t\t\t\treturn data;\n\t\t}\n\t\treturn null;\n\t}\n\n\tvar FileReaderSync = {\n\t\tread: function(op, blob) {\n\t\t\tvar result, self = this.getRuntime();\n\n\t\t\tresult = self.shimExec.call(this, 'FileReaderSync', 'readAsBase64', blob.uid);\n\t\t\tif (!result) {\n\t\t\t\treturn null; // or throw ex\n\t\t\t}\n\n\t\t\t// special prefix for DataURL read mode\n\t\t\tif (op === 'readAsDataURL') {\n\t\t\t\tresult = 'data:' + (blob.type || '') + ';base64,' + result;\n\t\t\t}\n\n\t\t\treturn _formatData(result, op, blob.type);\n\t\t}\n\t};\n\n\treturn (extensions.FileReaderSync = FileReaderSync);\n});\n\n// Included from: src/javascript/runtime/flash/runtime/Transporter.js\n\n/**\n * Transporter.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/flash/runtime/Transporter\n@private\n*/\ndefine(\"moxie/runtime/flash/runtime/Transporter\", [\n\t\"moxie/runtime/flash/Runtime\",\n\t\"moxie/file/Blob\"\n], function(extensions, Blob) {\n\n\tvar Transporter = {\n\t\tgetAsBlob: function(type) {\n\t\t\tvar self = this.getRuntime()\n\t\t\t, blob = self.shimExec.call(this, 'Transporter', 'getAsBlob', type)\n\t\t\t;\n\t\t\tif (blob) {\n\t\t\t\treturn new Blob(self.uid, blob);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t};\n\n\treturn (extensions.Transporter = Transporter);\n});\n\n// Included from: src/javascript/runtime/flash/xhr/XMLHttpRequest.js\n\n/**\n * XMLHttpRequest.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/flash/xhr/XMLHttpRequest\n@private\n*/\ndefine(\"moxie/runtime/flash/xhr/XMLHttpRequest\", [\n\t\"moxie/runtime/flash/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/file/Blob\",\n\t\"moxie/file/File\",\n\t\"moxie/file/FileReaderSync\",\n\t\"moxie/runtime/flash/file/FileReaderSync\",\n\t\"moxie/xhr/FormData\",\n\t\"moxie/runtime/Transporter\",\n\t\"moxie/runtime/flash/runtime/Transporter\"\n], function(extensions, Basic, Blob, File, FileReaderSync, FileReaderSyncFlash, FormData, Transporter, TransporterFlash) {\n\t\n\tvar XMLHttpRequest = {\n\n\t\tsend: function(meta, data) {\n\t\t\tvar target = this, self = target.getRuntime();\n\n\t\t\tfunction send() {\n\t\t\t\tmeta.transport = self.mode;\n\t\t\t\tself.shimExec.call(target, 'XMLHttpRequest', 'send', meta, data);\n\t\t\t}\n\n\n\t\t\tfunction appendBlob(name, blob) {\n\t\t\t\tself.shimExec.call(target, 'XMLHttpRequest', 'appendBlob', name, blob.uid);\n\t\t\t\tdata = null;\n\t\t\t\tsend();\n\t\t\t}\n\n\n\t\t\tfunction attachBlob(blob, cb) {\n\t\t\t\tvar tr = new Transporter();\n\n\t\t\t\ttr.bind(\"TransportingComplete\", function() {\n\t\t\t\t\tcb(this.result);\n\t\t\t\t});\n\n\t\t\t\ttr.transport(blob.getSource(), blob.type, {\n\t\t\t\t\truid: self.uid\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// copy over the headers if any\n\t\t\tif (!Basic.isEmptyObj(meta.headers)) {\n\t\t\t\tBasic.each(meta.headers, function(value, header) {\n\t\t\t\t\tself.shimExec.call(target, 'XMLHttpRequest', 'setRequestHeader', header, value.toString()); // Silverlight doesn't accept integers into the arguments of type object\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// transfer over multipart params and blob itself\n\t\t\tif (data instanceof FormData) {\n\t\t\t\tvar blobField;\n\t\t\t\tdata.each(function(value, name) {\n\t\t\t\t\tif (value instanceof Blob) {\n\t\t\t\t\t\tblobField = name;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.shimExec.call(target, 'XMLHttpRequest', 'append', name, value);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (!data.hasBlob()) {\n\t\t\t\t\tdata = null;\n\t\t\t\t\tsend();\n\t\t\t\t} else {\n\t\t\t\t\tvar blob = data.getBlob();\n\t\t\t\t\tif (blob.isDetached()) {\n\t\t\t\t\t\tattachBlob(blob, function(attachedBlob) {\n\t\t\t\t\t\t\tblob.destroy();\n\t\t\t\t\t\t\tappendBlob(blobField, attachedBlob);\t\t\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tappendBlob(blobField, blob);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (data instanceof Blob) {\n\t\t\t\tif (data.isDetached()) {\n\t\t\t\t\tattachBlob(data, function(attachedBlob) {\n\t\t\t\t\t\tdata.destroy();\n\t\t\t\t\t\tdata = attachedBlob.uid;\n\t\t\t\t\t\tsend();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tdata = data.uid;\n\t\t\t\t\tsend();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsend();\n\t\t\t}\n\t\t},\n\n\t\tgetResponse: function(responseType) {\n\t\t\tvar frs, blob, self = this.getRuntime();\n\n\t\t\tblob = self.shimExec.call(this, 'XMLHttpRequest', 'getResponseAsBlob');\n\n\t\t\tif (blob) {\n\t\t\t\tblob = new File(self.uid, blob);\n\n\t\t\t\tif ('blob' === responseType) {\n\t\t\t\t\treturn blob;\n\t\t\t\t}\n\n\t\t\t\ttry { \n\t\t\t\t\tfrs = new FileReaderSync();\n\n\t\t\t\t\tif (!!~Basic.inArray(responseType, [\"\", \"text\"])) {\n\t\t\t\t\t\treturn frs.readAsText(blob);\n\t\t\t\t\t} else if ('json' === responseType && !!window.JSON) {\n\t\t\t\t\t\treturn JSON.parse(frs.readAsText(blob));\n\t\t\t\t\t}\n\t\t\t\t} finally {\n\t\t\t\t\tblob.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tabort: function(upload_complete_flag) {\n\t\t\tvar self = this.getRuntime();\n\n\t\t\tself.shimExec.call(this, 'XMLHttpRequest', 'abort');\n\n\t\t\tthis.dispatchEvent('readystatechange');\n\t\t\t// this.dispatchEvent('progress');\n\t\t\tthis.dispatchEvent('abort');\n\n\t\t\t//if (!upload_complete_flag) {\n\t\t\t\t// this.dispatchEvent('uploadprogress');\n\t\t\t//}\n\t\t}\n\t};\n\n\treturn (extensions.XMLHttpRequest = XMLHttpRequest);\n});\n\n// Included from: src/javascript/runtime/flash/image/Image.js\n\n/**\n * Image.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/flash/image/Image\n@private\n*/\ndefine(\"moxie/runtime/flash/image/Image\", [\n\t\"moxie/runtime/flash/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/Transporter\",\n\t\"moxie/file/Blob\",\n\t\"moxie/file/FileReaderSync\"\n], function(extensions, Basic, Transporter, Blob, FileReaderSync) {\n\t\n\tvar Image = {\n\t\tloadFromBlob: function(blob) {\n\t\t\tvar comp = this, self = comp.getRuntime();\n\n\t\t\tfunction exec(srcBlob) {\n\t\t\t\tself.shimExec.call(comp, 'Image', 'loadFromBlob', srcBlob.uid);\n\t\t\t\tcomp = self = null;\n\t\t\t}\n\n\t\t\tif (blob.isDetached()) { // binary string\n\t\t\t\tvar tr = new Transporter();\n\t\t\t\ttr.bind(\"TransportingComplete\", function() {\n\t\t\t\t\texec(tr.result.getSource());\n\t\t\t\t});\n\t\t\t\ttr.transport(blob.getSource(), blob.type, { ruid: self.uid });\n\t\t\t} else {\n\t\t\t\texec(blob.getSource());\n\t\t\t}\n\t\t},\n\n\t\tloadFromImage: function(img) {\n\t\t\tvar self = this.getRuntime();\n\t\t\treturn self.shimExec.call(this, 'Image', 'loadFromImage', img.uid);\n\t\t},\n\n\t\tgetInfo: function() {\n\t\t\tvar self = this.getRuntime()\n\t\t\t, info = self.shimExec.call(this, 'Image', 'getInfo')\n\t\t\t;\n\n\t\t\tif (info.meta && info.meta.thumb && info.meta.thumb.data && !(self.meta.thumb.data instanceof Blob)) {\n\t\t\t\tinfo.meta.thumb.data = new Blob(self.uid, info.meta.thumb.data);\n\t\t\t}\n\t\t\treturn info;\n\t\t},\n\n\t\tgetAsBlob: function(type, quality) {\n\t\t\tvar self = this.getRuntime()\n\t\t\t, blob = self.shimExec.call(this, 'Image', 'getAsBlob', type, quality)\n\t\t\t;\n\t\t\tif (blob) {\n\t\t\t\treturn new Blob(self.uid, blob);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tgetAsDataURL: function() {\n\t\t\tvar self = this.getRuntime()\n\t\t\t, blob = self.Image.getAsBlob.apply(this, arguments)\n\t\t\t, frs\n\t\t\t;\n\t\t\tif (!blob) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tfrs = new FileReaderSync();\n\t\t\treturn frs.readAsDataURL(blob);\n\t\t}\n\t};\n\n\treturn (extensions.Image = Image);\n});\n\n// Included from: src/javascript/runtime/silverlight/Runtime.js\n\n/**\n * RunTime.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/*global ActiveXObject:true */\n\n/**\nDefines constructor for Silverlight runtime.\n\n@class moxie/runtime/silverlight/Runtime\n@private\n*/\ndefine(\"moxie/runtime/silverlight/Runtime\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Env\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/runtime/Runtime\"\n], function(Basic, Env, Dom, x, Runtime) {\n\t\n\tvar type = \"silverlight\", extensions = {};\n\n\tfunction isInstalled(version) {\n\t\tvar isVersionSupported = false, control = null, actualVer,\n\t\t\tactualVerArray, reqVerArray, requiredVersionPart, actualVersionPart, index = 0;\n\n\t\ttry {\n\t\t\ttry {\n\t\t\t\tcontrol = new ActiveXObject('AgControl.AgControl');\n\n\t\t\t\tif (control.IsVersionSupported(version)) {\n\t\t\t\t\tisVersionSupported = true;\n\t\t\t\t}\n\n\t\t\t\tcontrol = null;\n\t\t\t} catch (e) {\n\t\t\t\tvar plugin = navigator.plugins[\"Silverlight Plug-In\"];\n\n\t\t\t\tif (plugin) {\n\t\t\t\t\tactualVer = plugin.description;\n\n\t\t\t\t\tif (actualVer === \"1.0.30226.2\") {\n\t\t\t\t\t\tactualVer = \"2.0.30226.2\";\n\t\t\t\t\t}\n\n\t\t\t\t\tactualVerArray = actualVer.split(\".\");\n\n\t\t\t\t\twhile (actualVerArray.length > 3) {\n\t\t\t\t\t\tactualVerArray.pop();\n\t\t\t\t\t}\n\n\t\t\t\t\twhile ( actualVerArray.length < 4) {\n\t\t\t\t\t\tactualVerArray.push(0);\n\t\t\t\t\t}\n\n\t\t\t\t\treqVerArray = version.split(\".\");\n\n\t\t\t\t\twhile (reqVerArray.length > 4) {\n\t\t\t\t\t\treqVerArray.pop();\n\t\t\t\t\t}\n\n\t\t\t\t\tdo {\n\t\t\t\t\t\trequiredVersionPart = parseInt(reqVerArray[index], 10);\n\t\t\t\t\t\tactualVersionPart = parseInt(actualVerArray[index], 10);\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t} while (index < reqVerArray.length && requiredVersionPart === actualVersionPart);\n\n\t\t\t\t\tif (requiredVersionPart <= actualVersionPart && !isNaN(requiredVersionPart)) {\n\t\t\t\t\t\tisVersionSupported = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e2) {\n\t\t\tisVersionSupported = false;\n\t\t}\n\n\t\treturn isVersionSupported;\n\t}\n\n\t/**\n\tConstructor for the Silverlight Runtime\n\t*/\n\tfunction SilverlightRuntime(options) {\n\t\tvar I = this, initTimer;\n\n\t\toptions = Basic.extend({ xap_url: Env.xap_url }, options);\n\n\t\tRuntime.call(this, options, type, {\n\t\t\taccess_binary: Runtime.capTrue,\n\t\t\taccess_image_binary: Runtime.capTrue,\n\t\t\tdisplay_media: Runtime.capTest(defined('moxie/image/Image')),\n\t\t\tdo_cors: Runtime.capTrue,\n\t\t\tdrag_and_drop: false,\n\t\t\treport_upload_progress: Runtime.capTrue,\n\t\t\tresize_image: Runtime.capTrue,\n\t\t\treturn_response_headers: function(value) {\n\t\t\t\treturn value && I.mode === 'client';\n\t\t\t},\n\t\t\treturn_response_type: function(responseType) {\n\t\t\t\tif (responseType !== 'json') {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn !!window.JSON;\n\t\t\t\t}\n\t\t\t},\n\t\t\treturn_status_code: function(code) {\n\t\t\t\treturn I.mode === 'client' || !Basic.arrayDiff(code, [200, 404]);\n\t\t\t},\n\t\t\tselect_file: Runtime.capTrue,\n\t\t\tselect_multiple: Runtime.capTrue,\n\t\t\tsend_binary_string: Runtime.capTrue,\n\t\t\tsend_browser_cookies: function(value) {\n\t\t\t\treturn value && I.mode === 'browser';\n\t\t\t},\n\t\t\tsend_custom_headers: function(value) {\n\t\t\t\treturn value && I.mode === 'client';\n\t\t\t},\n\t\t\tsend_multipart: Runtime.capTrue,\n\t\t\tslice_blob: Runtime.capTrue,\n\t\t\tstream_upload: true,\n\t\t\tsummon_file_dialog: false,\n\t\t\tupload_filesize: Runtime.capTrue,\n\t\t\tuse_http_method: function(methods) {\n\t\t\t\treturn I.mode === 'client' || !Basic.arrayDiff(methods, ['GET', 'POST']);\n\t\t\t}\n\t\t}, { \n\t\t\t// capabilities that require specific mode\n\t\t\treturn_response_headers: function(value) {\n\t\t\t\treturn value ? 'client' : 'browser';\n\t\t\t},\n\t\t\treturn_status_code: function(code) {\n\t\t\t\treturn Basic.arrayDiff(code, [200, 404]) ? 'client' : ['client', 'browser'];\n\t\t\t},\n\t\t\tsend_browser_cookies: function(value) {\n\t\t\t\treturn value ? 'browser' : 'client';\n\t\t\t},\n\t\t\tsend_custom_headers: function(value) {\n\t\t\t\treturn value ? 'client' : 'browser';\n\t\t\t},\n\t\t\tuse_http_method: function(methods) {\n\t\t\t\treturn Basic.arrayDiff(methods, ['GET', 'POST']) ? 'client' : ['client', 'browser'];\n\t\t\t}\n\t\t});\n\n\n\t\t// minimal requirement\n\t\tif (!isInstalled('2.0.31005.0') || Env.browser === 'Opera') {\n\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\tEnv.log(\"\\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely).\");\t\n\t\t\t}\n\n\t\t\tthis.mode = false;\n\t\t}\n\n\n\t\tBasic.extend(this, {\n\t\t\tgetShim: function() {\n\t\t\t\treturn Dom.get(this.uid).content.Moxie;\n\t\t\t},\n\n\t\t\tshimExec: function(component, action) {\n\t\t\t\tvar args = [].slice.call(arguments, 2);\n\t\t\t\treturn I.getShim().exec(this.uid, component, action, args);\n\t\t\t},\n\n\t\t\tinit : function() {\n\t\t\t\tvar container;\n\n\t\t\t\tcontainer = this.getShimContainer();\n\n\t\t\t\tcontainer.innerHTML = '<object id=\"' + this.uid + '\" data=\"data:application/x-silverlight,\" type=\"application/x-silverlight-2\" width=\"100%\" height=\"100%\" style=\"outline:none;\">' +\n\t\t\t\t\t'<param name=\"source\" value=\"' + options.xap_url + '\"/>' +\n\t\t\t\t\t'<param name=\"background\" value=\"Transparent\"/>' +\n\t\t\t\t\t'<param name=\"windowless\" value=\"true\"/>' +\n\t\t\t\t\t'<param name=\"enablehtmlaccess\" value=\"true\"/>' +\n\t\t\t\t\t'<param name=\"initParams\" value=\"uid=' + this.uid + ',target=' + Runtime.getGlobalEventTarget() + '\"/>' +\n\t\t\t\t'</object>';\n\n\t\t\t\t// Init is dispatched by the shim\n\t\t\t\tinitTimer = setTimeout(function() {\n\t\t\t\t\tif (I && !I.initialized) { // runtime might be already destroyed by this moment\n\t\t\t\t\t\tI.trigger(\"Error\", new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR));\n\n\t\t\t\t\t\tif (MXI_DEBUG && Env.debug.runtime) {\n\t\t\t\t\t\t\tEnv.log(\"\\Silverlight failed to initialize within a specified period of time (5-10s).\");\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, Env.OS !== 'Windows'? 10000 : 5000); // give it more time to initialize in non Windows OS (like Mac)\n\t\t\t},\n\n\t\t\tdestroy: (function(destroy) { // extend default destroy method\n\t\t\t\treturn function() {\n\t\t\t\t\tdestroy.call(I);\n\t\t\t\t\tclearTimeout(initTimer); // initialization check might be still onwait\n\t\t\t\t\toptions = initTimer = destroy = I = null;\n\t\t\t\t};\n\t\t\t}(this.destroy))\n\n\t\t}, extensions);\n\t}\n\n\tRuntime.addConstructor(type, SilverlightRuntime); \n\n\treturn extensions;\n});\n\n// Included from: src/javascript/runtime/silverlight/file/Blob.js\n\n/**\n * Blob.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/silverlight/file/Blob\n@private\n*/\ndefine(\"moxie/runtime/silverlight/file/Blob\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/flash/file/Blob\"\n], function(extensions, Basic, Blob) {\n\treturn (extensions.Blob = Basic.extend({}, Blob));\n});\n\n// Included from: src/javascript/runtime/silverlight/file/FileInput.js\n\n/**\n * FileInput.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/silverlight/file/FileInput\n@private\n*/\ndefine(\"moxie/runtime/silverlight/file/FileInput\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/file/File\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/utils/Basic\"\n], function(extensions, File, Dom, Basic) {\n\n\tfunction toFilters(accept) {\n\t\tvar filter = '';\n\t\tfor (var i = 0; i < accept.length; i++) {\n\t\t\tfilter += (filter !== '' ? '|' : '') + accept[i].title + \" | *.\" + accept[i].extensions.replace(/,/g, ';*.');\n\t\t}\n\t\treturn filter;\n\t}\n\n\t\n\tvar FileInput = {\n\t\tinit: function(options) {\n\t\t\tvar comp = this, I = this.getRuntime();\n\t\t\tvar browseButton = Dom.get(options.browse_button);\n\n\t\t\tif (browseButton) {\n\t\t\t\tbrowseButton.setAttribute('tabindex', -1);\n\t\t\t\tbrowseButton = null;\n\t\t\t}\n\n\t\t\tthis.bind(\"Change\", function() {\n\t\t\t\tvar files = I.shimExec.call(comp, 'FileInput', 'getFiles');\n\t\t\t\tcomp.files = [];\n\t\t\t\tBasic.each(files, function(file) {\n\t\t\t\t\tcomp.files.push(new File(I.uid, file));\n\t\t\t\t});\n\t\t\t}, 999);\n\t\t\t\n\t\t\tI.shimExec.call(this, 'FileInput', 'init', toFilters(options.accept), options.multiple);\n\t\t\tthis.trigger('ready');\n\t\t},\n\n\t\tsetOption: function(name, value) {\n\t\t\tif (name == 'accept') {\n\t\t\t\tvalue = toFilters(value);\n\t\t\t}\n\t\t\tthis.getRuntime().shimExec.call(this, 'FileInput', 'setOption', name, value);\n\t\t}\n\t};\n\n\treturn (extensions.FileInput = FileInput);\n});\n\n// Included from: src/javascript/runtime/silverlight/file/FileDrop.js\n\n/**\n * FileDrop.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/silverlight/file/FileDrop\n@private\n*/\ndefine(\"moxie/runtime/silverlight/file/FileDrop\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/core/utils/Dom\", \n\t\"moxie/core/utils/Events\"\n], function(extensions, Dom, Events) {\n\n\t// not exactly useful, since works only in safari (...crickets...)\n\tvar FileDrop = {\n\t\tinit: function() {\n\t\t\tvar comp = this, self = comp.getRuntime(), dropZone;\n\n\t\t\tdropZone = self.getShimContainer();\n\n\t\t\tEvents.addEvent(dropZone, 'dragover', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\te.dataTransfer.dropEffect = 'copy';\n\t\t\t}, comp.uid);\n\n\t\t\tEvents.addEvent(dropZone, 'dragenter', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar flag = Dom.get(self.uid).dragEnter(e);\n\t\t\t\t// If handled, then stop propagation of event in DOM\n\t\t\t\tif (flag) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t}, comp.uid);\n\n\t\t\tEvents.addEvent(dropZone, 'drop', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar flag = Dom.get(self.uid).dragDrop(e);\n\t\t\t\t// If handled, then stop propagation of event in DOM\n\t\t\t\tif (flag) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t}, comp.uid);\n\n\t\t\treturn self.shimExec.call(this, 'FileDrop', 'init');\n\t\t}\n\t};\n\n\treturn (extensions.FileDrop = FileDrop);\n});\n\n// Included from: src/javascript/runtime/silverlight/file/FileReader.js\n\n/**\n * FileReader.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/silverlight/file/FileReader\n@private\n*/\ndefine(\"moxie/runtime/silverlight/file/FileReader\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/flash/file/FileReader\"\n], function(extensions, Basic, FileReader) {\n\treturn (extensions.FileReader = Basic.extend({}, FileReader));\n});\n\n// Included from: src/javascript/runtime/silverlight/file/FileReaderSync.js\n\n/**\n * FileReaderSync.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/silverlight/file/FileReaderSync\n@private\n*/\ndefine(\"moxie/runtime/silverlight/file/FileReaderSync\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/flash/file/FileReaderSync\"\n], function(extensions, Basic, FileReaderSync) {\n\treturn (extensions.FileReaderSync = Basic.extend({}, FileReaderSync));\n});\n\n// Included from: src/javascript/runtime/silverlight/runtime/Transporter.js\n\n/**\n * Transporter.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/silverlight/runtime/Transporter\n@private\n*/\ndefine(\"moxie/runtime/silverlight/runtime/Transporter\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/flash/runtime/Transporter\"\n], function(extensions, Basic, Transporter) {\n\treturn (extensions.Transporter = Basic.extend({}, Transporter));\n});\n\n// Included from: src/javascript/runtime/silverlight/xhr/XMLHttpRequest.js\n\n/**\n * XMLHttpRequest.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/silverlight/xhr/XMLHttpRequest\n@private\n*/\ndefine(\"moxie/runtime/silverlight/xhr/XMLHttpRequest\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/runtime/flash/xhr/XMLHttpRequest\",\n\t\"moxie/runtime/silverlight/file/FileReaderSync\",\n\t\"moxie/runtime/silverlight/runtime/Transporter\"\n], function(extensions, Basic, XMLHttpRequest, FileReaderSyncSilverlight, TransporterSilverlight) {\n\treturn (extensions.XMLHttpRequest = Basic.extend({}, XMLHttpRequest));\n});\n\n// Included from: src/javascript/runtime/silverlight/image/Image.js\n\n/**\n * Image.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n \n/**\n@class moxie/runtime/silverlight/image/Image\n@private\n*/\ndefine(\"moxie/runtime/silverlight/image/Image\", [\n\t\"moxie/runtime/silverlight/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/file/Blob\",\n\t\"moxie/runtime/flash/image/Image\"\n], function(extensions, Basic, Blob, Image) {\n\treturn (extensions.Image = Basic.extend({}, Image, {\n\n\t\tgetInfo: function() {\n\t\t\tvar self = this.getRuntime()\n\t\t\t, grps = ['tiff', 'exif', 'gps', 'thumb']\n\t\t\t, info = { meta: {} }\n\t\t\t, rawInfo = self.shimExec.call(this, 'Image', 'getInfo')\n\t\t\t;\n\n\t\t\tif (rawInfo.meta) {\n\t\t\t\tBasic.each(grps, function(grp) {\n\t\t\t\t\tvar meta = rawInfo.meta[grp]\n\t\t\t\t\t, tag\n\t\t\t\t\t, i\n\t\t\t\t\t, length\n\t\t\t\t\t, value\n\t\t\t\t\t;\n\t\t\t\t\tif (meta && meta.keys) {\n\t\t\t\t\t\tinfo.meta[grp] = {};\n\t\t\t\t\t\tfor (i = 0, length = meta.keys.length; i < length; i++) {\n\t\t\t\t\t\t\ttag = meta.keys[i];\n\t\t\t\t\t\t\tvalue = meta[tag];\n\t\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\t\t// convert numbers\n\t\t\t\t\t\t\t\tif (/^(\\d|[1-9]\\d+)$/.test(value)) { // integer (make sure doesn't start with zero)\n\t\t\t\t\t\t\t\t\tvalue = parseInt(value, 10);\n\t\t\t\t\t\t\t\t} else if (/^\\d*\\.\\d+$/.test(value)) { // double\n\t\t\t\t\t\t\t\t\tvalue = parseFloat(value);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tinfo.meta[grp][tag] = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// save thumb data as blob\n\t\t\t\tif (info.meta && info.meta.thumb && info.meta.thumb.data && !(self.meta.thumb.data instanceof Blob)) {\n\t\t\t\t\tinfo.meta.thumb.data = new Blob(self.uid, info.meta.thumb.data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tinfo.width = parseInt(rawInfo.width, 10);\n\t\t\tinfo.height = parseInt(rawInfo.height, 10);\n\t\t\tinfo.size = parseInt(rawInfo.size, 10);\n\t\t\tinfo.type = rawInfo.type;\n\t\t\tinfo.name = rawInfo.name;\n\n\t\t\treturn info;\n\t\t},\n\n\t\tresize: function(rect, ratio, opts) {\n\t\t\tthis.getRuntime().shimExec.call(this, 'Image', 'resize', rect.x, rect.y, rect.width, rect.height, ratio, opts.preserveHeaders, opts.resample);\n\t\t}\n\t}));\n});\n\n// Included from: src/javascript/runtime/html4/Runtime.js\n\n/**\n * Runtime.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/*global File:true */\n\n/**\nDefines constructor for HTML4 runtime.\n\n@class moxie/runtime/html4/Runtime\n@private\n*/\ndefine(\"moxie/runtime/html4/Runtime\", [\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/runtime/Runtime\",\n\t\"moxie/core/utils/Env\"\n], function(Basic, x, Runtime, Env) {\n\t\n\tvar type = 'html4', extensions = {};\n\n\tfunction Html4Runtime(options) {\n\t\tvar I = this\n\t\t, Test = Runtime.capTest\n\t\t, True = Runtime.capTrue\n\t\t;\n\n\t\tRuntime.call(this, options, type, {\n\t\t\taccess_binary: Test(window.FileReader || window.File && File.getAsDataURL),\n\t\t\taccess_image_binary: false,\n\t\t\tdisplay_media: Test(\n\t\t\t\t(Env.can('create_canvas') || Env.can('use_data_uri_over32kb')) && \n\t\t\t\tdefined('moxie/image/Image')\n\t\t\t),\n\t\t\tdo_cors: false,\n\t\t\tdrag_and_drop: false,\n\t\t\tfilter_by_extension: Test(function() { // if you know how to feature-detect this, please suggest\n\t\t\t\treturn !(\n\t\t\t\t\t(Env.browser === 'Chrome' && Env.verComp(Env.version, 28, '<')) || \n\t\t\t\t\t(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<')) || \n\t\t\t\t\t(Env.browser === 'Safari' && Env.verComp(Env.version, 7, '<')) ||\n\t\t\t\t\t(Env.browser === 'Firefox' && Env.verComp(Env.version, 37, '<'))\n\t\t\t\t);\n\t\t\t}()),\n\t\t\tresize_image: function() {\n\t\t\t\treturn extensions.Image && I.can('access_binary') && Env.can('create_canvas');\n\t\t\t},\n\t\t\treport_upload_progress: false,\n\t\t\treturn_response_headers: false,\n\t\t\treturn_response_type: function(responseType) {\n\t\t\t\tif (responseType === 'json' && !!window.JSON) {\n\t\t\t\t\treturn true;\n\t\t\t\t} \n\t\t\t\treturn !!~Basic.inArray(responseType, ['text', 'document', '']);\n\t\t\t},\n\t\t\treturn_status_code: function(code) {\n\t\t\t\treturn !Basic.arrayDiff(code, [200, 404]);\n\t\t\t},\n\t\t\tselect_file: function() {\n\t\t\t\treturn Env.can('use_fileinput');\n\t\t\t},\n\t\t\tselect_multiple: false,\n\t\t\tsend_binary_string: false,\n\t\t\tsend_custom_headers: false,\n\t\t\tsend_multipart: true,\n\t\t\tslice_blob: false,\n\t\t\tstream_upload: function() {\n\t\t\t\treturn I.can('select_file');\n\t\t\t},\n\t\t\tsummon_file_dialog: function() { // yeah... some dirty sniffing here...\n\t\t\t\treturn I.can('select_file') && !(\n\t\t\t\t\t(Env.browser === 'Firefox' && Env.verComp(Env.version, 4, '<')) ||\n\t\t\t\t\t(Env.browser === 'Opera' && Env.verComp(Env.version, 12, '<')) ||\n\t\t\t\t\t(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<'))\n\t\t\t\t);\n\t\t\t},\n\t\t\tupload_filesize: True,\n\t\t\tuse_http_method: function(methods) {\n\t\t\t\treturn !Basic.arrayDiff(methods, ['GET', 'POST']);\n\t\t\t}\n\t\t});\n\n\n\t\tBasic.extend(this, {\n\t\t\tinit : function() {\n\t\t\t\tthis.trigger(\"Init\");\n\t\t\t},\n\n\t\t\tdestroy: (function(destroy) { // extend default destroy method\n\t\t\t\treturn function() {\n\t\t\t\t\tdestroy.call(I);\n\t\t\t\t\tdestroy = I = null;\n\t\t\t\t};\n\t\t\t}(this.destroy))\n\t\t});\n\n\t\tBasic.extend(this.getShim(), extensions);\n\t}\n\n\tRuntime.addConstructor(type, Html4Runtime);\n\n\treturn extensions;\n});\n\n// Included from: src/javascript/runtime/html4/file/FileInput.js\n\n/**\n * FileInput.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html4/file/FileInput\n@private\n*/\ndefine(\"moxie/runtime/html4/file/FileInput\", [\n\t\"moxie/runtime/html4/Runtime\",\n\t\"moxie/file/File\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/utils/Events\",\n\t\"moxie/core/utils/Mime\",\n\t\"moxie/core/utils/Env\"\n], function(extensions, File, Basic, Dom, Events, Mime, Env) {\n\t\n\tfunction FileInput() {\n\t\tvar _uid, _mimes = [], _options, _browseBtnZIndex; // save original z-index;\n\n\t\tfunction addInput() {\n\t\t\tvar comp = this, I = comp.getRuntime(), shimContainer, browseButton, currForm, form, input, uid;\n\n\t\t\tuid = Basic.guid('uid_');\n\n\t\t\tshimContainer = I.getShimContainer(); // we get new ref every time to avoid memory leaks in IE\n\n\t\t\tif (_uid) { // move previous form out of the view\n\t\t\t\tcurrForm = Dom.get(_uid + '_form');\n\t\t\t\tif (currForm) {\n\t\t\t\t\tBasic.extend(currForm.style, { top: '100%' });\n\t\t\t\t\t// it shouldn't be possible to tab into the hidden element\n\t\t\t\t\tcurrForm.firstChild.setAttribute('tabindex', -1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// build form in DOM, since innerHTML version not able to submit file for some reason\n\t\t\tform = document.createElement('form');\n\t\t\tform.setAttribute('id', uid + '_form');\n\t\t\tform.setAttribute('method', 'post');\n\t\t\tform.setAttribute('enctype', 'multipart/form-data');\n\t\t\tform.setAttribute('encoding', 'multipart/form-data');\n\n\t\t\tBasic.extend(form.style, {\n\t\t\t\toverflow: 'hidden',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0,\n\t\t\t\twidth: '100%',\n\t\t\t\theight: '100%'\n\t\t\t});\n\n\t\t\tinput = document.createElement('input');\n\t\t\tinput.setAttribute('id', uid);\n\t\t\tinput.setAttribute('type', 'file');\n\t\t\tinput.setAttribute('accept', _mimes.join(','));\n\n\t\t\tif (I.can('summon_file_dialog')) {\n\t\t\t\tinput.setAttribute('tabindex', -1);\n\t\t\t}\n\n\t\t\tBasic.extend(input.style, {\n\t\t\t\tfontSize: '999px',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\tform.appendChild(input);\n\t\t\tshimContainer.appendChild(form);\n\n\t\t\t// prepare file input to be placed underneath the browse_button element\n\t\t\tBasic.extend(input.style, {\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0,\n\t\t\t\twidth: '100%',\n\t\t\t\theight: '100%'\n\t\t\t});\n\n\t\t\tif (Env.browser === 'IE' && Env.verComp(Env.version, 10, '<')) {\n\t\t\t\tBasic.extend(input.style, {\n\t\t\t\t\tfilter : \"progid:DXImageTransform.Microsoft.Alpha(opacity=0)\"\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tinput.onchange = function() { // there should be only one handler for this\n\t\t\t\tvar file;\n\n\t\t\t\tif (!this.value) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.files) { // check if browser is fresh enough\n\t\t\t\t\tfile = this.files[0];\n\t\t\t\t} else {\n\t\t\t\t\tfile = {\n\t\t\t\t\t\tname: this.value\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tfile = new File(I.uid, file);\n\n\t\t\t\t// clear event handler\n\t\t\t\tthis.onchange = function() {}; \n\t\t\t\taddInput.call(comp); \n\n\t\t\t\tcomp.files = [file];\n\n\t\t\t\t// substitute all ids with file uids (consider file.uid read-only - we cannot do it the other way around)\n\t\t\t\tinput.setAttribute('id', file.uid);\n\t\t\t\tform.setAttribute('id', file.uid + '_form');\n\t\t\t\t\n\t\t\t\tcomp.trigger('change');\n\n\t\t\t\tinput = form = null;\n\t\t\t};\n\n\n\t\t\t// route click event to the input\n\t\t\tif (I.can('summon_file_dialog')) {\n\t\t\t\tbrowseButton = Dom.get(_options.browse_button);\n\t\t\t\tEvents.removeEvent(browseButton, 'click', comp.uid);\n\t\t\t\tEvents.addEvent(browseButton, 'click', function(e) {\n\t\t\t\t\tif (input && !input.disabled) { // for some reason FF (up to 8.0.1 so far) lets to click disabled input[type=file]\n\t\t\t\t\t\tinput.click();\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}, comp.uid);\n\t\t\t}\n\n\t\t\t_uid = uid;\n\n\t\t\tshimContainer = currForm = browseButton = null;\n\t\t}\n\n\t\tBasic.extend(this, {\n\t\t\tinit: function(options) {\n\t\t\t\tvar comp = this, I = comp.getRuntime(), shimContainer;\n\n\t\t\t\t// figure out accept string\n\t\t\t\t_options = options;\n\t\t\t\t_mimes = Mime.extList2mimes(options.accept, I.can('filter_by_extension'));\n\n\t\t\t\tshimContainer = I.getShimContainer();\n\n\t\t\t\t(function() {\n\t\t\t\t\tvar browseButton, zIndex, top;\n\n\t\t\t\t\tbrowseButton = Dom.get(options.browse_button);\n\t\t\t\t\t_browseBtnZIndex = Dom.getStyle(browseButton, 'z-index') || 'auto';\n\n\t\t\t\t\t// Route click event to the input[type=file] element for browsers that support such behavior\n\t\t\t\t\tif (I.can('summon_file_dialog')) {\n\t\t\t\t\t\tif (Dom.getStyle(browseButton, 'position') === 'static') {\n\t\t\t\t\t\t\tbrowseButton.style.position = 'relative';\n\t\t\t\t\t\t}\t\t\t\t\t\t\n\n\t\t\t\t\t\tcomp.bind('Refresh', function() {\n\t\t\t\t\t\t\tzIndex = parseInt(_browseBtnZIndex, 10) || 1;\n\n\t\t\t\t\t\t\tDom.get(_options.browse_button).style.zIndex = zIndex;\n\t\t\t\t\t\t\tthis.getRuntime().getShimContainer().style.zIndex = zIndex - 1;\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// it shouldn't be possible to tab into the hidden element\n\t\t\t\t\t\tbrowseButton.setAttribute('tabindex', -1);\n\t\t\t\t\t}\n\n\t\t\t\t\t/* Since we have to place input[type=file] on top of the browse_button for some browsers,\n\t\t\t\t\tbrowse_button loses interactivity, so we restore it here */\n\t\t\t\t\ttop = I.can('summon_file_dialog') ? browseButton : shimContainer;\n\n\t\t\t\t\tEvents.addEvent(top, 'mouseover', function() {\n\t\t\t\t\t\tcomp.trigger('mouseenter');\n\t\t\t\t\t}, comp.uid);\n\n\t\t\t\t\tEvents.addEvent(top, 'mouseout', function() {\n\t\t\t\t\t\tcomp.trigger('mouseleave');\n\t\t\t\t\t}, comp.uid);\n\n\t\t\t\t\tEvents.addEvent(top, 'mousedown', function() {\n\t\t\t\t\t\tcomp.trigger('mousedown');\n\t\t\t\t\t}, comp.uid);\n\n\t\t\t\t\tEvents.addEvent(Dom.get(options.container), 'mouseup', function() {\n\t\t\t\t\t\tcomp.trigger('mouseup');\n\t\t\t\t\t}, comp.uid);\n\n\t\t\t\t\tbrowseButton = null;\n\t\t\t\t}());\n\n\t\t\t\taddInput.call(this);\n\n\t\t\t\tshimContainer = null;\n\n\t\t\t\t// trigger ready event asynchronously\n\t\t\t\tcomp.trigger({\n\t\t\t\t\ttype: 'ready',\n\t\t\t\t\tasync: true\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetOption: function(name, value) {\n\t\t\t\tvar I = this.getRuntime();\n\t\t\t\tvar input;\n\n\t\t\t\tif (name == 'accept') {\n\t\t\t\t\t_mimes = value.mimes || Mime.extList2mimes(value, I.can('filter_by_extension'));\n\t\t\t\t}\n\n\t\t\t\t// update current input\n\t\t\t\tinput = Dom.get(_uid)\n\t\t\t\tif (input) {\n\t\t\t\t\tinput.setAttribute('accept', _mimes.join(','));\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\tdisable: function(state) {\n\t\t\t\tvar input;\n\n\t\t\t\tif ((input = Dom.get(_uid))) {\n\t\t\t\t\tinput.disabled = !!state;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tvar I = this.getRuntime()\n\t\t\t\t, shim = I.getShim()\n\t\t\t\t, shimContainer = I.getShimContainer()\n\t\t\t\t, container = _options && Dom.get(_options.container)\n\t\t\t\t, browseButton = _options && Dom.get(_options.browse_button)\n\t\t\t\t;\n\t\t\t\t\n\t\t\t\tif (container) {\n\t\t\t\t\tEvents.removeAllEvents(container, this.uid);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (browseButton) {\n\t\t\t\t\tEvents.removeAllEvents(browseButton, this.uid);\n\t\t\t\t\tbrowseButton.style.zIndex = _browseBtnZIndex; // reset to original value\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (shimContainer) {\n\t\t\t\t\tEvents.removeAllEvents(shimContainer, this.uid);\n\t\t\t\t\tshimContainer.innerHTML = '';\n\t\t\t\t}\n\n\t\t\t\tshim.removeInstance(this.uid);\n\n\t\t\t\t_uid = _mimes = _options = shimContainer = container = browseButton = shim = null;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn (extensions.FileInput = FileInput);\n});\n\n// Included from: src/javascript/runtime/html4/file/FileReader.js\n\n/**\n * FileReader.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html4/file/FileReader\n@private\n*/\ndefine(\"moxie/runtime/html4/file/FileReader\", [\n\t\"moxie/runtime/html4/Runtime\",\n\t\"moxie/runtime/html5/file/FileReader\"\n], function(extensions, FileReader) {\n\treturn (extensions.FileReader = FileReader);\n});\n\n// Included from: src/javascript/runtime/html4/xhr/XMLHttpRequest.js\n\n/**\n * XMLHttpRequest.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html4/xhr/XMLHttpRequest\n@private\n*/\ndefine(\"moxie/runtime/html4/xhr/XMLHttpRequest\", [\n\t\"moxie/runtime/html4/Runtime\",\n\t\"moxie/core/utils/Basic\",\n\t\"moxie/core/utils/Dom\",\n\t\"moxie/core/utils/Url\",\n\t\"moxie/core/Exceptions\",\n\t\"moxie/core/utils/Events\",\n\t\"moxie/file/Blob\",\n\t\"moxie/xhr/FormData\"\n], function(extensions, Basic, Dom, Url, x, Events, Blob, FormData) {\n\t\n\tfunction XMLHttpRequest() {\n\t\tvar _status, _response, _iframe;\n\n\t\tfunction cleanup(cb) {\n\t\t\tvar target = this, uid, form, inputs, i, hasFile = false;\n\n\t\t\tif (!_iframe) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tuid = _iframe.id.replace(/_iframe$/, '');\n\n\t\t\tform = Dom.get(uid + '_form');\n\t\t\tif (form) {\n\t\t\t\tinputs = form.getElementsByTagName('input');\n\t\t\t\ti = inputs.length;\n\n\t\t\t\twhile (i--) {\n\t\t\t\t\tswitch (inputs[i].getAttribute('type')) {\n\t\t\t\t\t\tcase 'hidden':\n\t\t\t\t\t\t\tinputs[i].parentNode.removeChild(inputs[i]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'file':\n\t\t\t\t\t\t\thasFile = true; // flag the case for later\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tinputs = [];\n\n\t\t\t\tif (!hasFile) { // we need to keep the form for sake of possible retries\n\t\t\t\t\tform.parentNode.removeChild(form);\n\t\t\t\t}\n\t\t\t\tform = null;\n\t\t\t}\n\n\t\t\t// without timeout, request is marked as canceled (in console)\n\t\t\tsetTimeout(function() {\n\t\t\t\tEvents.removeEvent(_iframe, 'load', target.uid);\n\t\t\t\tif (_iframe.parentNode) { // #382\n\t\t\t\t\t_iframe.parentNode.removeChild(_iframe);\n\t\t\t\t}\n\n\t\t\t\t// check if shim container has any other children, if - not, remove it as well\n\t\t\t\tvar shimContainer = target.getRuntime().getShimContainer();\n\t\t\t\tif (!shimContainer.children.length) {\n\t\t\t\t\tshimContainer.parentNode.removeChild(shimContainer);\n\t\t\t\t}\n\n\t\t\t\tshimContainer = _iframe = null;\n\t\t\t\tcb();\n\t\t\t}, 1);\n\t\t}\n\n\t\tBasic.extend(this, {\n\t\t\tsend: function(meta, data) {\n\t\t\t\tvar target = this, I = target.getRuntime(), uid, form, input, blob;\n\n\t\t\t\t_status = _response = null;\n\n\t\t\t\tfunction createIframe() {\n\t\t\t\t\tvar container = I.getShimContainer() || document.body\n\t\t\t\t\t, temp = document.createElement('div')\n\t\t\t\t\t;\n\n\t\t\t\t\t// IE 6 won't be able to set the name using setAttribute or iframe.name\n\t\t\t\t\ttemp.innerHTML = '<iframe id=\"' + uid + '_iframe\" name=\"' + uid + '_iframe\" src=\"javascript:&quot;&quot;\" style=\"display:none\"></iframe>';\n\t\t\t\t\t_iframe = temp.firstChild;\n\t\t\t\t\tcontainer.appendChild(_iframe);\n\n\t\t\t\t\t/* _iframe.onreadystatechange = function() {\n\t\t\t\t\t\tconsole.info(_iframe.readyState);\n\t\t\t\t\t};*/\n\n\t\t\t\t\tEvents.addEvent(_iframe, 'load', function() { // _iframe.onload doesn't work in IE lte 8\n\t\t\t\t\t\tvar el;\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tel = _iframe.contentWindow.document || _iframe.contentDocument || window.frames[_iframe.id].document;\n\n\t\t\t\t\t\t\t// try to detect some standard error pages\n\t\t\t\t\t\t\tif (/^4(0[0-9]|1[0-7]|2[2346])\\s/.test(el.title)) { // test if title starts with 4xx HTTP error\n\t\t\t\t\t\t\t\t_status = el.title.replace(/^(\\d+).*$/, '$1');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_status = 200;\n\t\t\t\t\t\t\t\t// get result\n\t\t\t\t\t\t\t\t_response = Basic.trim(el.body.innerHTML);\n\n\t\t\t\t\t\t\t\t// we need to fire these at least once\n\t\t\t\t\t\t\t\ttarget.trigger({\n\t\t\t\t\t\t\t\t\ttype: 'progress',\n\t\t\t\t\t\t\t\t\tloaded: _response.length,\n\t\t\t\t\t\t\t\t\ttotal: _response.length\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tif (blob) { // if we were uploading a file\n\t\t\t\t\t\t\t\t\ttarget.trigger({\n\t\t\t\t\t\t\t\t\t\ttype: 'uploadprogress',\n\t\t\t\t\t\t\t\t\t\tloaded: blob.size || 1025,\n\t\t\t\t\t\t\t\t\t\ttotal: blob.size || 1025\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\tif (Url.hasSameOrigin(meta.url)) {\n\t\t\t\t\t\t\t\t// if response is sent with error code, iframe in IE gets redirected to res://ieframe.dll/http_x.htm\n\t\t\t\t\t\t\t\t// which obviously results to cross domain error (wtf?)\n\t\t\t\t\t\t\t\t_status = 404;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcleanup.call(target, function() {\n\t\t\t\t\t\t\t\t\ttarget.trigger('error');\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\n\t\t\t\t\t\n\t\t\t\t\t\tcleanup.call(target, function() {\n\t\t\t\t\t\t\ttarget.trigger('load');\n\t\t\t\t\t\t});\n\t\t\t\t\t}, target.uid);\n\t\t\t\t} // end createIframe\n\n\t\t\t\t// prepare data to be sent and convert if required\n\t\t\t\tif (data instanceof FormData && data.hasBlob()) {\n\t\t\t\t\tblob = data.getBlob();\n\t\t\t\t\tuid = blob.uid;\n\t\t\t\t\tinput = Dom.get(uid);\n\t\t\t\t\tform = Dom.get(uid + '_form');\n\t\t\t\t\tif (!form) {\n\t\t\t\t\t\tthrow new x.DOMException(x.DOMException.NOT_FOUND_ERR);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tuid = Basic.guid('uid_');\n\n\t\t\t\t\tform = document.createElement('form');\n\t\t\t\t\tform.setAttribute('id', uid + '_form');\n\t\t\t\t\tform.setAttribute('method', meta.method);\n\t\t\t\t\tform.setAttribute('enctype', 'multipart/form-data');\n\t\t\t\t\tform.setAttribute('encoding', 'multipart/form-data');\n\n\t\t\t\t\tI.getShimContainer().appendChild(form);\n\t\t\t\t}\n\n\t\t\t\t// set upload target\n\t\t\t\tform.setAttribute('target', uid + '_iframe');\n\n\t\t\t\tif (data instanceof FormData) {\n\t\t\t\t\tdata.each(function(value, name) {\n\t\t\t\t\t\tif (value instanceof Blob) {\n\t\t\t\t\t\t\tif (input) {\n\t\t\t\t\t\t\t\tinput.setAttribute('name', name);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar hidden = document.createElement('input');\n\n\t\t\t\t\t\t\tBasic.extend(hidden, {\n\t\t\t\t\t\t\t\ttype : 'hidden',\n\t\t\t\t\t\t\t\tname : name,\n\t\t\t\t\t\t\t\tvalue : value\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// make sure that input[type=\"file\"], if it's there, comes last\n\t\t\t\t\t\t\tif (input) {\n\t\t\t\t\t\t\t\tform.insertBefore(hidden, input);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tform.appendChild(hidden);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// set destination url\n\t\t\t\tform.setAttribute(\"action\", meta.url);\n\n\t\t\t\tcreateIframe();\n\t\t\t\tform.submit();\n\t\t\t\ttarget.trigger('loadstart');\n\t\t\t},\n\n\t\t\tgetStatus: function() {\n\t\t\t\treturn _status;\n\t\t\t},\n\n\t\t\tgetResponse: function(responseType) {\n\t\t\t\tif ('json' === responseType) {\n\t\t\t\t\t// strip off <pre>..</pre> tags that might be enclosing the response\n\t\t\t\t\tif (Basic.typeOf(_response) === 'string' && !!window.JSON) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\treturn JSON.parse(_response.replace(/^\\s*<pre[^>]*>/, '').replace(/<\\/pre>\\s*$/, ''));\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t} \n\t\t\t\t} else if ('document' === responseType) {\n\n\t\t\t\t}\n\t\t\t\treturn _response;\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tvar target = this;\n\n\t\t\t\tif (_iframe && _iframe.contentWindow) {\n\t\t\t\t\tif (_iframe.contentWindow.stop) { // FireFox/Safari/Chrome\n\t\t\t\t\t\t_iframe.contentWindow.stop();\n\t\t\t\t\t} else if (_iframe.contentWindow.document.execCommand) { // IE\n\t\t\t\t\t\t_iframe.contentWindow.document.execCommand('Stop');\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_iframe.src = \"about:blank\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcleanup.call(this, function() {\n\t\t\t\t\t// target.dispatchEvent('readystatechange');\n\t\t\t\t\ttarget.dispatchEvent('abort');\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdestroy: function() {\n\t\t\t\tthis.getRuntime().getShim().removeInstance(this.uid);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn (extensions.XMLHttpRequest = XMLHttpRequest);\n});\n\n// Included from: src/javascript/runtime/html4/image/Image.js\n\n/**\n * Image.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n/**\n@class moxie/runtime/html4/image/Image\n@private\n*/\ndefine(\"moxie/runtime/html4/image/Image\", [\n\t\"moxie/runtime/html4/Runtime\",\n\t\"moxie/runtime/html5/image/Image\"\n], function(extensions, Image) {\n\treturn (extensions.Image = Image);\n});\n\nexpose([\"moxie/core/utils/Basic\",\"moxie/core/utils/Encode\",\"moxie/core/utils/Env\",\"moxie/core/Exceptions\",\"moxie/core/utils/Dom\",\"moxie/core/EventTarget\",\"moxie/runtime/Runtime\",\"moxie/runtime/RuntimeClient\",\"moxie/file/Blob\",\"moxie/core/I18n\",\"moxie/core/utils/Mime\",\"moxie/file/FileInput\",\"moxie/file/File\",\"moxie/file/FileDrop\",\"moxie/file/FileReader\",\"moxie/core/utils/Url\",\"moxie/runtime/RuntimeTarget\",\"moxie/xhr/FormData\",\"moxie/xhr/XMLHttpRequest\",\"moxie/image/Image\",\"moxie/core/utils/Events\",\"moxie/runtime/html5/image/ResizerCanvas\"]);\n})(this);\n}));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcGx1cGxvYWQvanMvbW94aWUuanM/ZWE5NyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxpR0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLEtBQUssSUFBMEM7QUFDL0MsRUFBRSxpQ0FBZ0IsRUFBRSxvQ0FBRSxPQUFPO0FBQUE7QUFBQTtBQUFBLG9HQUFDO0FBQzlCLEVBQUUsTUFBTSxFQUlOO0FBQ0YsQ0FBQztBQUNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSxpQkFBaUIsZ0JBQWdCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxrQkFBa0IsdUJBQXVCO0FBQ3pDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUIsZ0JBQWdCO0FBQ2pDO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUIsMkJBQTJCO0FBQzlDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUyxPQUFPO0FBQ2hCLFVBQVUsT0FBTztBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtB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QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw2QkFBNkIsSUFBSTtBQUNqQzs7QUFFQSwwREFBMEQ7QUFDMUQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOzs7QUFHRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELEdBQUc7QUFDMUQ7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4QkFBOEI7QUFDOUIsS0FBSztBQUNMO0FBQ0EsSUFBSTs7QUFFSixzQ0FBc0M7QUFDdEM7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsY0FBYztBQUNkO0FBQ0E7O0FBRUE7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0EsRUFBRTs7O0FBR0Y7OztBQUdBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVB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VUFBVTtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLFVBQVU7QUFDckI7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRzs7O0FBR0g7QUFDQSxtQjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVMsT0FBTztBQUNoQixVQUFVLE9BQU87QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0Qzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUyxjQUFjO0FBQ3ZCLFVBQVUsT0FBTztBQUNqQjtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTLGNBQWM7QUFDdkIsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQSwwQ0FBMEMsWUFBWTtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLHlCQUF5QjtBQUNwQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ04sS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLE9BQU87QUFDbkI7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0EsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBLFdBQVcsU0FBUztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLE9BQU87QUFDbEIsV0FBVyxjQUFjO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0RBQXNELHlCQUF5QixFQUFFOztBQUVqRjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLE9BQU87QUFDbkI7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLE9BQU87QUFDbEIsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CLHNDQUFzQztBQUN0QyxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsVUFBVSw0Q0FBNEMsT0FBTztBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLFdBQVcsOEJBQThCO0FBQ3pDLFdBQVcsT0FBTztBQUNsQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCOztBQUU3QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUgsaUVBQWlFO0FBQ2pFOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7O0FBRUo7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0EsSUFBSSxPQUFPO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMkNBQTJDO0FBQzNDO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0EsdUJBQXVCO0FBQ3ZCO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJOzs7QUFHSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQSxNO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7O0FBRUosZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtB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QTtBQUNBO0FBQ0E7QUFDQSxHQUFHOzs7QUFHSDtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0Esa0JBQWtCLG1CQUFtQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKLFNBQVM7QUFDVDtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUksRTtBQUNKO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLLHdDQUF3QztB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QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEseUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7O0FBR0o7QUFDQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7O0FBR0o7QUFDQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOzs7QUFHSjtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxHQUFHOzs7QUFHSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLHFDQUFxQyxTQUFTO0FBQzlDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQSx5Q0FBeUMsU0FBUztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQSwwQ0FBMEMsU0FBUztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJOzs7QUFHSjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7QUFDQSxJQUFJOzs7QUFHSjtBQUNBO0FBQ0EsSUFBSTs7O0FBR0o7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVDQUF1Qyw2QkFBNkI7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsSUFBSTs7O0FBR0o7QUFDQTtBQUNBLGlFQUFpRSxjQUFjOztBQUUvRTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7O0FBR0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsY0FBYyxZQUFZO0FBQzFCOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxjQUFjO0FBQ2Q7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEs7O0FBRUE7QUFDQTtBQUNBLDJFQUEyRTtBQUMzRTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtCQUFrQixZQUFZO0FBQzlCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTixLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLCtDQUErQztBQUMvQyxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0EsOEI7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGNBQWMsc0JBQXNCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFRLE9BQU87QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0IsZ0JBQWdCO0FBQ2xDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLE1BQU07QUFDakI7QUFDQSx5QkFBeUI7O0FBRXpCO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLE9BQU87QUFDbEIsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBLFdBQVcsT0FBTztBQUNsQixZQUFZLE9BQU87QUFDbkI7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlFQUFpRTtBQUNqRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFCQUFxQjtBQUNyQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7O0FBR0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0EscUNBQXFDO0FBQ3JDOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVUsT0FBTztBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDBCQUEwQix1QkFBdUI7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEs7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRyxHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7OztBQUdIO0FBQ0E7QUFDQTtBQUNBLHVFO0FBQ0E7O0FBRUEscUJBQXFCO0FBQ3JCOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7O0FBRUE7QUFDQSxpRztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTs7QUFFSixnQ0FBZ0M7QUFDaEM7QUFDQSxzQkFBc0I7O0FBRXRCO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQSxJQUFJOztBQUVKLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0Esa0RBQWtEO0FBQ2xEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7O0FBRUE7QUFDQTtBQUNBLDZDQUE2QztBQUM3Qzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdHQUFnRztBQUNoRyxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsUztBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsK0NBQStDLGlCQUFpQjtBQUNoRSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07O0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwwQkFBMEIsdUJBQXVCOztBQUVq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QTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE87O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7OztBQUdKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtEQUFrRDtBQUNsRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVHQUF1RyxNQUFNO0FBQzdHO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87O0FBRVAsa0RBQWtEO0FBQ2xEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSwwREFBMEQ7QUFDMUQ7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVULG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE87O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ04sS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTs7QUFFUjtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE07QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQSxNQUFNLHVEQUF1RDtBQUM3RDtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBLENBQUM7QUFDRCxDQUFDIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL3BsdXBsb2FkL2pzL21veGllLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiO3ZhciBNWElfREVCVUcgPSB0cnVlO1xuLyoqXG4gKiBtT3hpZSAtIG11bHRpLXJ1bnRpbWUgRmlsZSBBUEkgJiBYTUxIdHRwUmVxdWVzdCBMMiBQb2x5ZmlsbFxuICogdjEuNS43XG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICpcbiAqIERhdGU6IDIwMTctMTEtMDNcbiAqL1xuOyhmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG5cdHZhciBleHRyYWN0ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGN0eCA9IHt9O1xuXHRcdGZhY3RvcnkuYXBwbHkoY3R4LCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiBjdHgubW94aWU7XG5cdH07XG5cdFxuXHRpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcblx0XHRkZWZpbmUoXCJtb3hpZVwiLCBbXSwgZXh0cmFjdCk7XG5cdH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIiAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZXh0cmFjdCgpO1xuXHR9IGVsc2Uge1xuXHRcdGdsb2JhbC5tb3hpZSA9IGV4dHJhY3QoKTtcblx0fVxufSh0aGlzIHx8IHdpbmRvdywgZnVuY3Rpb24oKSB7XG4vKipcbiAqIENvbXBpbGVkIGlubGluZSB2ZXJzaW9uLiAoTGlicmFyeSBtb2RlKVxuICovXG5cbi8qanNoaW50IHNtYXJ0dGFiczp0cnVlLCB1bmRlZjp0cnVlLCBsYXRlZGVmOnRydWUsIGN1cmx5OnRydWUsIGJpdHdpc2U6dHJ1ZSwgY2FtZWxjYXNlOnRydWUgKi9cbi8qZ2xvYmFscyAkY29kZSAqL1xuXG4oZnVuY3Rpb24oZXhwb3J0cywgdW5kZWZpbmVkKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdHZhciBtb2R1bGVzID0ge307XG5cblx0ZnVuY3Rpb24gcmVxdWlyZShpZHMsIGNhbGxiYWNrKSB7XG5cdFx0dmFyIG1vZHVsZSwgZGVmcyA9IFtdO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyArK2kpIHtcblx0XHRcdG1vZHVsZSA9IG1vZHVsZXNbaWRzW2ldXSB8fCByZXNvbHZlKGlkc1tpXSk7XG5cdFx0XHRpZiAoIW1vZHVsZSkge1xuXHRcdFx0XHR0aHJvdyAnbW9kdWxlIGRlZmluaXRpb24gZGVwZW5kZWN5IG5vdCBmb3VuZDogJyArIGlkc1tpXTtcblx0XHRcdH1cblxuXHRcdFx0ZGVmcy5wdXNoKG1vZHVsZSk7XG5cdFx0fVxuXG5cdFx0Y2FsbGJhY2suYXBwbHkobnVsbCwgZGVmcyk7XG5cdH1cblxuXHRmdW5jdGlvbiBkZWZpbmUoaWQsIGRlcGVuZGVuY2llcywgZGVmaW5pdGlvbikge1xuXHRcdGlmICh0eXBlb2YgaWQgIT09ICdzdHJpbmcnKSB7XG5cdFx0XHR0aHJvdyAnaW52YWxpZCBtb2R1bGUgZGVmaW5pdGlvbiwgbW9kdWxlIGlkIG11c3QgYmUgZGVmaW5lZCBhbmQgYmUgYSBzdHJpbmcnO1xuXHRcdH1cblxuXHRcdGlmIChkZXBlbmRlbmNpZXMgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhyb3cgJ2ludmFsaWQgbW9kdWxlIGRlZmluaXRpb24sIGRlcGVuZGVuY2llcyBtdXN0IGJlIHNwZWNpZmllZCc7XG5cdFx0fVxuXG5cdFx0aWYgKGRlZmluaXRpb24gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhyb3cgJ2ludmFsaWQgbW9kdWxlIGRlZmluaXRpb24sIGRlZmluaXRpb24gZnVuY3Rpb24gbXVzdCBiZSBzcGVjaWZpZWQnO1xuXHRcdH1cblxuXHRcdHJlcXVpcmUoZGVwZW5kZW5jaWVzLCBmdW5jdGlvbigpIHtcblx0XHRcdG1vZHVsZXNbaWRdID0gZGVmaW5pdGlvbi5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gZGVmaW5lZChpZCkge1xuXHRcdHJldHVybiAhIW1vZHVsZXNbaWRdO1xuXHR9XG5cblx0ZnVuY3Rpb24gcmVzb2x2ZShpZCkge1xuXHRcdHZhciB0YXJnZXQgPSBleHBvcnRzO1xuXHRcdHZhciBmcmFnbWVudHMgPSBpZC5zcGxpdCgvWy5cXC9dLyk7XG5cblx0XHRmb3IgKHZhciBmaSA9IDA7IGZpIDwgZnJhZ21lbnRzLmxlbmd0aDsgKytmaSkge1xuXHRcdFx0aWYgKCF0YXJnZXRbZnJhZ21lbnRzW2ZpXV0pIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHR0YXJnZXQgPSB0YXJnZXRbZnJhZ21lbnRzW2ZpXV07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldDtcblx0fVxuXG5cdGZ1bmN0aW9uIGV4cG9zZShpZHMpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHRhcmdldCA9IGV4cG9ydHM7XG5cdFx0XHR2YXIgaWQgPSBpZHNbaV07XG5cdFx0XHR2YXIgZnJhZ21lbnRzID0gaWQuc3BsaXQoL1suXFwvXS8pO1xuXG5cdFx0XHRmb3IgKHZhciBmaSA9IDA7IGZpIDwgZnJhZ21lbnRzLmxlbmd0aCAtIDE7ICsrZmkpIHtcblx0XHRcdFx0aWYgKHRhcmdldFtmcmFnbWVudHNbZmldXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0dGFyZ2V0W2ZyYWdtZW50c1tmaV1dID0ge307XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0YXJnZXQgPSB0YXJnZXRbZnJhZ21lbnRzW2ZpXV07XG5cdFx0XHR9XG5cblx0XHRcdHRhcmdldFtmcmFnbWVudHNbZnJhZ21lbnRzLmxlbmd0aCAtIDFdXSA9IG1vZHVsZXNbaWRdO1xuXHRcdH1cblx0fVxuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL0Jhc2ljLmpzXG5cbi8qKlxuICogQmFzaWMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvY29yZS91dGlscy9CYXNpY1xuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJywgW10sIGZ1bmN0aW9uKCkge1xuXHQvKipcblx0R2V0cyB0aGUgdHJ1ZSB0eXBlIG9mIHRoZSBidWlsdC1pbiBvYmplY3QgKGJldHRlciB2ZXJzaW9uIG9mIHR5cGVvZikuXG5cdEBhdXRob3IgQW5ndXMgQ3JvbGwgKGh0dHA6Ly9qYXZhc2NyaXB0d2VibG9nLndvcmRwcmVzcy5jb20vKVxuXG5cdEBtZXRob2QgdHlwZU9mXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG8gT2JqZWN0IHRvIGNoZWNrLlxuXHRAcmV0dXJuIHtTdHJpbmd9IE9iamVjdCBbW0NsYXNzXV1cblx0Ki9cblx0ZnVuY3Rpb24gdHlwZU9mKG8pIHtcblx0XHR2YXIgdW5kZWY7XG5cblx0XHRpZiAobyA9PT0gdW5kZWYpIHtcblx0XHRcdHJldHVybiAndW5kZWZpbmVkJztcblx0XHR9IGVsc2UgaWYgKG8gPT09IG51bGwpIHtcblx0XHRcdHJldHVybiAnbnVsbCc7XG5cdFx0fSBlbHNlIGlmIChvLm5vZGVUeXBlKSB7XG5cdFx0XHRyZXR1cm4gJ25vZGUnO1xuXHRcdH1cblxuXHRcdC8vIHRoZSBzbmlwcGV0IGJlbG93IGlzIGF3ZXNvbWUsIGhvd2V2ZXIgaXQgZmFpbHMgdG8gZGV0ZWN0IG51bGwsIHVuZGVmaW5lZCBhbmQgYXJndW1lbnRzIHR5cGVzIGluIElFIGx0ZSA4XG5cdFx0cmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvKS5tYXRjaCgvXFxzKFthLXp8QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKTtcblx0fVxuXG5cdC8qKlxuXHRFeHRlbmRzIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHdpdGggYW5vdGhlciBvYmplY3QocykuXG5cblx0QG1ldGhvZCBleHRlbmRcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gdGFyZ2V0IE9iamVjdCB0byBleHRlbmQuXG5cdEBwYXJhbSB7T2JqZWN0fSBbb2JqXSogTXVsdGlwbGUgb2JqZWN0cyB0byBleHRlbmQgd2l0aC5cblx0QHJldHVybiB7T2JqZWN0fSBTYW1lIGFzIHRhcmdldCwgdGhlIGV4dGVuZGVkIG9iamVjdC5cblx0Ki9cblx0ZnVuY3Rpb24gZXh0ZW5kKCkge1xuXHRcdHJldHVybiBtZXJnZShmYWxzZSwgZmFsc2UsIGFyZ3VtZW50cyk7XG5cdH1cblxuXG5cdC8qKlxuXHRFeHRlbmRzIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHdpdGggYW5vdGhlciBvYmplY3QocyksIGJ1dCBvbmx5IGlmIHRoZSBwcm9wZXJ0eSBleGlzdHMgaW4gdGhlIHRhcmdldC5cblxuXHRAbWV0aG9kIGV4dGVuZElmXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IHRhcmdldCBPYmplY3QgdG8gZXh0ZW5kLlxuXHRAcGFyYW0ge09iamVjdH0gW29ial0qIE11bHRpcGxlIG9iamVjdHMgdG8gZXh0ZW5kIHdpdGguXG5cdEByZXR1cm4ge09iamVjdH0gU2FtZSBhcyB0YXJnZXQsIHRoZSBleHRlbmRlZCBvYmplY3QuXG5cdCovXG5cdGZ1bmN0aW9uIGV4dGVuZElmKCkge1xuXHRcdHJldHVybiBtZXJnZSh0cnVlLCBmYWxzZSwgYXJndW1lbnRzKTtcblx0fVxuXG5cblx0ZnVuY3Rpb24gZXh0ZW5kSW1tdXRhYmxlKCkge1xuXHRcdHJldHVybiBtZXJnZShmYWxzZSwgdHJ1ZSwgYXJndW1lbnRzKTtcblx0fVxuXG5cblx0ZnVuY3Rpb24gZXh0ZW5kSW1tdXRhYmxlSWYoKSB7XG5cdFx0cmV0dXJuIG1lcmdlKHRydWUsIHRydWUsIGFyZ3VtZW50cyk7XG5cdH1cblxuXG5cdGZ1bmN0aW9uIGNsb25lKHZhbHVlKSB7XG5cdFx0c3dpdGNoICh0eXBlT2YodmFsdWUpKSB7XG5cdFx0XHRjYXNlICdhcnJheSc6XG5cdFx0XHRcdHJldHVybiBtZXJnZShmYWxzZSwgdHJ1ZSwgW1tdLCB2YWx1ZV0pO1xuXG5cdFx0XHRjYXNlICdvYmplY3QnOlxuXHRcdFx0XHRyZXR1cm4gbWVyZ2UoZmFsc2UsIHRydWUsIFt7fSwgdmFsdWVdKTtcblxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdH1cblx0fVxuXG5cblx0ZnVuY3Rpb24gc2hhbGxvd0NvcHkob2JqKSB7XG5cdFx0c3dpdGNoICh0eXBlT2Yob2JqKSkge1xuXHRcdFx0Y2FzZSAnYXJyYXknOlxuXHRcdFx0XHRyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwob2JqKTtcblxuXHRcdFx0Y2FzZSAnb2JqZWN0Jzpcblx0XHRcdFx0cmV0dXJuIGV4dGVuZCh7fSwgb2JqKTtcblx0XHR9XG5cdFx0cmV0dXJuIG9iajtcblx0fVxuXG5cblx0ZnVuY3Rpb24gbWVyZ2Uoc3RyaWN0LCBpbW11dGFibGUsIGFyZ3MpIHtcblx0XHR2YXIgdW5kZWY7XG5cdFx0dmFyIHRhcmdldCA9IGFyZ3NbMF07XG5cblx0XHRlYWNoKGFyZ3MsIGZ1bmN0aW9uKGFyZywgaSkge1xuXHRcdFx0aWYgKGkgPiAwKSB7XG5cdFx0XHRcdGVhY2goYXJnLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdFx0XHRcdFx0dmFyIGlzQ29tcGxleCA9IGluQXJyYXkodHlwZU9mKHZhbHVlKSwgWydhcnJheScsICdvYmplY3QnXSkgIT09IC0xO1xuXG5cdFx0XHRcdFx0aWYgKHZhbHVlID09PSB1bmRlZiB8fCBzdHJpY3QgJiYgdGFyZ2V0W2tleV0gPT09IHVuZGVmKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoaXNDb21wbGV4ICYmIGltbXV0YWJsZSkge1xuXHRcdFx0XHRcdFx0dmFsdWUgPSBzaGFsbG93Q29weSh2YWx1ZSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHR5cGVPZih0YXJnZXRba2V5XSkgPT09IHR5cGVPZih2YWx1ZSkgJiYgaXNDb21wbGV4KSB7XG5cdFx0XHRcdFx0XHRtZXJnZShzdHJpY3QsIGltbXV0YWJsZSwgW3RhcmdldFtrZXldLCB2YWx1ZV0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0YXJnZXRba2V5XSA9IHZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gdGFyZ2V0O1xuXHR9XG5cblxuXHQvKipcblx0QSB3YXkgdG8gaW5oZXJpdCBvbmUgYGNsYXNzYCBmcm9tIGFub3RoZXIgaW4gYSBjb25zaXNzdGVudCB3YXkgKG1vcmUgb3IgbGVzcylcblxuXHRAbWV0aG9kIGluaGVyaXRcblx0QHN0YXRpY1xuXHRAc2luY2UgPjEuNC4xXG5cdEBwYXJhbSB7RnVuY3Rpb259IGNoaWxkXG5cdEBwYXJhbSB7RnVuY3Rpb259IHBhcmVudFxuXHRAcmV0dXJuIHtGdW5jdGlvbn0gUHJlcGFyZWQgY29uc3RydWN0b3Jcblx0Ki9cblx0ZnVuY3Rpb24gaW5oZXJpdChjaGlsZCwgcGFyZW50KSB7XG5cdFx0Ly8gY29weSBvdmVyIGFsbCBwYXJlbnQgcHJvcGVydGllc1xuXHRcdGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHtcblx0XHRcdGlmICh7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHBhcmVudCwga2V5KSkge1xuXHRcdFx0XHRjaGlsZFtrZXldID0gcGFyZW50W2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gZ2l2ZSBjaGlsZCBgY2xhc3NgIGEgcGxhY2UgdG8gZGVmaW5lIGl0cyBvd24gbWV0aG9kc1xuXHRcdGZ1bmN0aW9uIGN0b3IoKSB7XG5cdFx0XHR0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7XG5cblx0XHRcdGlmIChNWElfREVCVUcpIHtcblx0XHRcdFx0dmFyIGdldEN0b3JOYW1lID0gZnVuY3Rpb24oZm4pIHtcblx0XHRcdFx0XHR2YXIgbSA9IGZuLnRvU3RyaW5nKCkubWF0Y2goL15mdW5jdGlvblxccyhbXlxcKFxcc10rKS8pO1xuXHRcdFx0XHRcdHJldHVybiBtID8gbVsxXSA6IGZhbHNlO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHRoaXMuY3Rvck5hbWUgPSBnZXRDdG9yTmFtZShjaGlsZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTtcblx0XHRjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpO1xuXG5cdFx0Ly8ga2VlcCBhIHdheSB0byByZWZlcmVuY2UgcGFyZW50IG1ldGhvZHNcblx0XHRjaGlsZC5wYXJlbnQgPSBwYXJlbnQucHJvdG90eXBlO1xuXHRcdHJldHVybiBjaGlsZDtcblx0fVxuXG5cblx0LyoqXG5cdEV4ZWN1dGVzIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBmb3IgZWFjaCBpdGVtIGluIGFycmF5L29iamVjdC4gSWYgeW91IHJldHVybiBmYWxzZSBpbiB0aGVcblx0Y2FsbGJhY2sgaXQgd2lsbCBicmVhayB0aGUgbG9vcC5cblxuXHRAbWV0aG9kIGVhY2hcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIE9iamVjdCB0byBpdGVyYXRlLlxuXHRAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayBDYWxsYmFjayBmdW5jdGlvbiB0byBleGVjdXRlIGZvciBlYWNoIGl0ZW0uXG5cdCovXG5cdGZ1bmN0aW9uIGVhY2gob2JqLCBjYWxsYmFjaykge1xuXHRcdHZhciBsZW5ndGgsIGtleSwgaSwgdW5kZWY7XG5cblx0XHRpZiAob2JqKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZW5ndGggPSBvYmoubGVuZ3RoO1xuXHRcdFx0fSBjYXRjaChleCkge1xuXHRcdFx0XHRsZW5ndGggPSB1bmRlZjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGxlbmd0aCA9PT0gdW5kZWYgfHwgdHlwZW9mKGxlbmd0aCkgIT09ICdudW1iZXInKSB7XG5cdFx0XHRcdC8vIExvb3Agb2JqZWN0IGl0ZW1zXG5cdFx0XHRcdGZvciAoa2V5IGluIG9iaikge1xuXHRcdFx0XHRcdGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHRcdFx0XHRcdFx0aWYgKGNhbGxiYWNrKG9ialtrZXldLCBrZXkpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBMb29wIGFycmF5IGl0ZW1zXG5cdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChjYWxsYmFjayhvYmpbaV0sIGkpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHRDaGVja3MgaWYgb2JqZWN0IGlzIGVtcHR5LlxuXG5cdEBtZXRob2QgaXNFbXB0eU9ialxuXHRAc3RhdGljXG5cdEBwYXJhbSB7T2JqZWN0fSBvIE9iamVjdCB0byBjaGVjay5cblx0QHJldHVybiB7Qm9vbGVhbn1cblx0Ki9cblx0ZnVuY3Rpb24gaXNFbXB0eU9iaihvYmopIHtcblx0XHR2YXIgcHJvcDtcblxuXHRcdGlmICghb2JqIHx8IHR5cGVPZihvYmopICE9PSAnb2JqZWN0Jykge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Zm9yIChwcm9wIGluIG9iaikge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0LyoqXG5cdFJlY2lldmUgYW4gYXJyYXkgb2YgZnVuY3Rpb25zICh1c3VhbGx5IGFzeW5jKSB0byBjYWxsIGluIHNlcXVlbmNlLCBlYWNoICBmdW5jdGlvblxuXHRyZWNlaXZlcyBhIGNhbGxiYWNrIGFzIGZpcnN0IGFyZ3VtZW50IHRoYXQgaXQgc2hvdWxkIGNhbGwsIHdoZW4gaXQgY29tcGxldGVzLiBGaW5hbGx5LFxuXHRhZnRlciBldmVyeXRoaW5nIGlzIGNvbXBsZXRlLCBtYWluIGNhbGxiYWNrIGlzIGNhbGxlZC4gUGFzc2luZyB0cnV0aHkgdmFsdWUgdG8gdGhlXG5cdGNhbGxiYWNrIGFzIGEgZmlyc3QgYXJndW1lbnQgd2lsbCBpbnRlcnJ1cHQgdGhlIHNlcXVlbmNlIGFuZCBpbnZva2UgbWFpbiBjYWxsYmFja1xuXHRpbW1lZGlhdGVseS5cblxuXHRAbWV0aG9kIGluU2VyaWVzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtBcnJheX0gcXVldWUgQXJyYXkgb2YgZnVuY3Rpb25zIHRvIGNhbGwgaW4gc2VxdWVuY2Vcblx0QHBhcmFtIHtGdW5jdGlvbn0gY2IgTWFpbiBjYWxsYmFjayB0aGF0IGlzIGNhbGxlZCBpbiB0aGUgZW5kLCBvciBpbiBjYXNlIG9mIGVycm9yXG5cdCovXG5cdGZ1bmN0aW9uIGluU2VyaWVzKHF1ZXVlLCBjYikge1xuXHRcdHZhciBpID0gMCwgbGVuZ3RoID0gcXVldWUubGVuZ3RoO1xuXG5cdFx0aWYgKHR5cGVPZihjYikgIT09ICdmdW5jdGlvbicpIHtcblx0XHRcdGNiID0gZnVuY3Rpb24oKSB7fTtcblx0XHR9XG5cblx0XHRpZiAoIXF1ZXVlIHx8ICFxdWV1ZS5sZW5ndGgpIHtcblx0XHRcdGNiKCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY2FsbE5leHQoaSkge1xuXHRcdFx0aWYgKHR5cGVPZihxdWV1ZVtpXSkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0cXVldWVbaV0oZnVuY3Rpb24oZXJyb3IpIHtcblx0XHRcdFx0XHQvKmpzaGludCBleHByOnRydWUgKi9cblx0XHRcdFx0XHQrK2kgPCBsZW5ndGggJiYgIWVycm9yID8gY2FsbE5leHQoaSkgOiBjYihlcnJvcik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRjYWxsTmV4dChpKTtcblx0fVxuXG5cblx0LyoqXG5cdFJlY2lldmUgYW4gYXJyYXkgb2YgZnVuY3Rpb25zICh1c3VhbGx5IGFzeW5jKSB0byBjYWxsIGluIHBhcmFsbGVsLCBlYWNoICBmdW5jdGlvblxuXHRyZWNlaXZlcyBhIGNhbGxiYWNrIGFzIGZpcnN0IGFyZ3VtZW50IHRoYXQgaXQgc2hvdWxkIGNhbGwsIHdoZW4gaXQgY29tcGxldGVzLiBBZnRlclxuXHRldmVyeXRoaW5nIGlzIGNvbXBsZXRlLCBtYWluIGNhbGxiYWNrIGlzIGNhbGxlZC4gUGFzc2luZyB0cnV0aHkgdmFsdWUgdG8gdGhlXG5cdGNhbGxiYWNrIGFzIGEgZmlyc3QgYXJndW1lbnQgd2lsbCBpbnRlcnJ1cHQgdGhlIHByb2Nlc3MgYW5kIGludm9rZSBtYWluIGNhbGxiYWNrXG5cdGltbWVkaWF0ZWx5LlxuXG5cdEBtZXRob2QgaW5QYXJhbGxlbFxuXHRAc3RhdGljXG5cdEBwYXJhbSB7QXJyYXl9IHF1ZXVlIEFycmF5IG9mIGZ1bmN0aW9ucyB0byBjYWxsIGluIHNlcXVlbmNlXG5cdEBwYXJhbSB7RnVuY3Rpb259IGNiIE1haW4gY2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgaW4gdGhlIGVuZCwgb3IgaW4gY2FzZSBvZiBlcnJvXG5cdCovXG5cdGZ1bmN0aW9uIGluUGFyYWxsZWwocXVldWUsIGNiKSB7XG5cdFx0dmFyIGNvdW50ID0gMCwgbnVtID0gcXVldWUubGVuZ3RoLCBjYkFyZ3MgPSBuZXcgQXJyYXkobnVtKTtcblxuXHRcdGVhY2gocXVldWUsIGZ1bmN0aW9uKGZuLCBpKSB7XG5cdFx0XHRmbihmdW5jdGlvbihlcnJvcikge1xuXHRcdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0XHRyZXR1cm4gY2IoZXJyb3IpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cdFx0XHRcdGFyZ3Muc2hpZnQoKTsgLy8gc3RyaXAgZXJyb3IgLSB1bmRlZmluZWQgb3Igbm90XG5cblx0XHRcdFx0Y2JBcmdzW2ldID0gYXJncztcblx0XHRcdFx0Y291bnQrKztcblxuXHRcdFx0XHRpZiAoY291bnQgPT09IG51bSkge1xuXHRcdFx0XHRcdGNiQXJncy51bnNoaWZ0KG51bGwpO1xuXHRcdFx0XHRcdGNiLmFwcGx5KHRoaXMsIGNiQXJncyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblxuXHQvKipcblx0RmluZCBhbiBlbGVtZW50IGluIGFycmF5IGFuZCByZXR1cm4gaXQncyBpbmRleCBpZiBwcmVzZW50LCBvdGhlcndpc2UgcmV0dXJuIC0xLlxuXG5cdEBtZXRob2QgaW5BcnJheVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7TWl4ZWR9IG5lZWRsZSBFbGVtZW50IHRvIGZpbmRcblx0QHBhcmFtIHtBcnJheX0gYXJyYXlcblx0QHJldHVybiB7SW50fSBJbmRleCBvZiB0aGUgZWxlbWVudCwgb3IgLTEgaWYgbm90IGZvdW5kXG5cdCovXG5cdGZ1bmN0aW9uIGluQXJyYXkobmVlZGxlLCBhcnJheSkge1xuXHRcdGlmIChhcnJheSkge1xuXHRcdFx0aWYgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XG5cdFx0XHRcdHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGFycmF5LCBuZWVkbGUpO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gYXJyYXkubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKGFycmF5W2ldID09PSBuZWVkbGUpIHtcblx0XHRcdFx0XHRyZXR1cm4gaTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gLTE7XG5cdH1cblxuXG5cdC8qKlxuXHRSZXR1cm5zIGVsZW1lbnRzIG9mIGZpcnN0IGFycmF5IGlmIHRoZXkgYXJlIG5vdCBwcmVzZW50IGluIHNlY29uZC4gQW5kIGZhbHNlIC0gb3RoZXJ3aXNlLlxuXG5cdEBwcml2YXRlXG5cdEBtZXRob2QgYXJyYXlEaWZmXG5cdEBwYXJhbSB7QXJyYXl9IG5lZWRsZXNcblx0QHBhcmFtIHtBcnJheX0gYXJyYXlcblx0QHJldHVybiB7QXJyYXl8Qm9vbGVhbn1cblx0Ki9cblx0ZnVuY3Rpb24gYXJyYXlEaWZmKG5lZWRsZXMsIGFycmF5KSB7XG5cdFx0dmFyIGRpZmYgPSBbXTtcblxuXHRcdGlmICh0eXBlT2YobmVlZGxlcykgIT09ICdhcnJheScpIHtcblx0XHRcdG5lZWRsZXMgPSBbbmVlZGxlc107XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVPZihhcnJheSkgIT09ICdhcnJheScpIHtcblx0XHRcdGFycmF5ID0gW2FycmF5XTtcblx0XHR9XG5cblx0XHRmb3IgKHZhciBpIGluIG5lZWRsZXMpIHtcblx0XHRcdGlmIChpbkFycmF5KG5lZWRsZXNbaV0sIGFycmF5KSA9PT0gLTEpIHtcblx0XHRcdFx0ZGlmZi5wdXNoKG5lZWRsZXNbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZGlmZi5sZW5ndGggPyBkaWZmIDogZmFsc2U7XG5cdH1cblxuXG5cdC8qKlxuXHRGaW5kIGludGVyc2VjdGlvbiBvZiB0d28gYXJyYXlzLlxuXG5cdEBwcml2YXRlXG5cdEBtZXRob2QgYXJyYXlJbnRlcnNlY3Rcblx0QHBhcmFtIHtBcnJheX0gYXJyYXkxXG5cdEBwYXJhbSB7QXJyYXl9IGFycmF5MlxuXHRAcmV0dXJuIHtBcnJheX0gSW50ZXJzZWN0aW9uIG9mIHR3byBhcnJheXMgb3IgbnVsbCBpZiB0aGVyZSBpcyBub25lXG5cdCovXG5cdGZ1bmN0aW9uIGFycmF5SW50ZXJzZWN0KGFycmF5MSwgYXJyYXkyKSB7XG5cdFx0dmFyIHJlc3VsdCA9IFtdO1xuXHRcdGVhY2goYXJyYXkxLCBmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRpZiAoaW5BcnJheShpdGVtLCBhcnJheTIpICE9PSAtMSkge1xuXHRcdFx0XHRyZXN1bHQucHVzaChpdGVtKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gcmVzdWx0Lmxlbmd0aCA/IHJlc3VsdCA6IG51bGw7XG5cdH1cblxuXG5cdC8qKlxuXHRGb3JjZXMgYW55dGhpbmcgaW50byBhbiBhcnJheS5cblxuXHRAbWV0aG9kIHRvQXJyYXlcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIE9iamVjdCB3aXRoIGxlbmd0aCBmaWVsZC5cblx0QHJldHVybiB7QXJyYXl9IEFycmF5IG9iamVjdCBjb250YWluaW5nIGFsbCBpdGVtcy5cblx0Ki9cblx0ZnVuY3Rpb24gdG9BcnJheShvYmopIHtcblx0XHR2YXIgaSwgYXJyID0gW107XG5cblx0XHRmb3IgKGkgPSAwOyBpIDwgb2JqLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRhcnJbaV0gPSBvYmpbaV07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGFycjtcblx0fVxuXG5cblx0LyoqXG5cdEdlbmVyYXRlcyBhbiB1bmlxdWUgSUQuIFRoZSBvbmx5IHdheSBhIHVzZXIgd291bGQgYmUgYWJsZSB0byBnZXQgdGhlIHNhbWUgSUQgaXMgaWYgdGhlIHR3byBwZXJzb25zXG5cdGF0IHRoZSBzYW1lIGV4YWN0IG1pbGxpc2Vjb25kIG1hbmFnZSB0byBnZXQgdGhlIHNhbWUgNSByYW5kb20gbnVtYmVycyBiZXR3ZWVuIDAtNjU1MzU7IGl0IGFsc28gdXNlc1xuXHRhIGNvdW50ZXIgc28gZWFjaCBJRCBpcyBndWFyYW50ZWVkIHRvIGJlIHVuaXF1ZSBmb3IgdGhlIGdpdmVuIHBhZ2UuIEl0IGlzIG1vcmUgcHJvYmFibGUgZm9yIHRoZSBlYXJ0aFxuXHR0byBiZSBoaXQgd2l0aCBhbiBhc3Rlcm9pZC5cblxuXHRAbWV0aG9kIGd1aWRcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gcHJlZml4IHRvIHByZXBlbmQgKGJ5IGRlZmF1bHQgJ28nIHdpbGwgYmUgcHJlcGVuZGVkKS5cblx0QG1ldGhvZCBndWlkXG5cdEByZXR1cm4ge1N0cmluZ30gVmlydHVhbGx5IHVuaXF1ZSBpZC5cblx0Ki9cblx0dmFyIGd1aWQgPSAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGNvdW50ZXIgPSAwO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHByZWZpeCkge1xuXHRcdFx0dmFyIGd1aWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygzMiksIGk7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCA1OyBpKyspIHtcblx0XHRcdFx0Z3VpZCArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA2NTUzNSkudG9TdHJpbmcoMzIpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gKHByZWZpeCB8fCAnb18nKSArIGd1aWQgKyAoY291bnRlcisrKS50b1N0cmluZygzMik7XG5cdFx0fTtcblx0fSgpKTtcblxuXG5cdC8qKlxuXHRUcmltcyB3aGl0ZSBzcGFjZXMgYXJvdW5kIHRoZSBzdHJpbmdcblxuXHRAbWV0aG9kIHRyaW1cblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gc3RyXG5cdEByZXR1cm4ge1N0cmluZ31cblx0Ki9cblx0ZnVuY3Rpb24gdHJpbShzdHIpIHtcblx0XHRpZiAoIXN0cikge1xuXHRcdFx0cmV0dXJuIHN0cjtcblx0XHR9XG5cdFx0cmV0dXJuIFN0cmluZy5wcm90b3R5cGUudHJpbSA/IFN0cmluZy5wcm90b3R5cGUudHJpbS5jYWxsKHN0cikgOiBzdHIudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxzKi8sICcnKS5yZXBsYWNlKC9cXHMqJC8sICcnKTtcblx0fVxuXG5cblx0LyoqXG5cdFBhcnNlcyB0aGUgc3BlY2lmaWVkIHNpemUgc3RyaW5nIGludG8gYSBieXRlIHZhbHVlLiBGb3IgZXhhbXBsZSAxMGtiIGJlY29tZXMgMTAyNDAuXG5cblx0QG1ldGhvZCBwYXJzZVNpemVTdHJcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZy9OdW1iZXJ9IHNpemUgU3RyaW5nIHRvIHBhcnNlIG9yIG51bWJlciB0byBqdXN0IHBhc3MgdGhyb3VnaC5cblx0QHJldHVybiB7TnVtYmVyfSBTaXplIGluIGJ5dGVzLlxuXHQqL1xuXHRmdW5jdGlvbiBwYXJzZVNpemVTdHIoc2l6ZSkge1xuXHRcdGlmICh0eXBlb2Yoc2l6ZSkgIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRyZXR1cm4gc2l6ZTtcblx0XHR9XG5cblx0XHR2YXIgbXVscyA9IHtcblx0XHRcdFx0dDogMTA5OTUxMTYyNzc3Nixcblx0XHRcdFx0ZzogMTA3Mzc0MTgyNCxcblx0XHRcdFx0bTogMTA0ODU3Nixcblx0XHRcdFx0azogMTAyNFxuXHRcdFx0fSxcblx0XHRcdG11bDtcblxuXHRcdHNpemUgPSAvXihbMC05XFwuXSspKFt0bWdrXT8pJC8uZXhlYyhzaXplLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW14wLTlcXC50bWtnXS9nLCAnJykpO1xuXHRcdG11bCA9IHNpemVbMl07XG5cdFx0c2l6ZSA9ICtzaXplWzFdO1xuXG5cdFx0aWYgKG11bHMuaGFzT3duUHJvcGVydHkobXVsKSkge1xuXHRcdFx0c2l6ZSAqPSBtdWxzW211bF07XG5cdFx0fVxuXHRcdHJldHVybiBNYXRoLmZsb29yKHNpemUpO1xuXHR9XG5cblxuXHQvKipcblx0ICogUHNldWRvIHNwcmludGYgaW1wbGVtZW50YXRpb24gLSBzaW1wbGUgd2F5IHRvIHJlcGxhY2UgdG9rZW5zIHdpdGggc3BlY2lmaWVkIHZhbHVlcy5cblx0ICpcblx0ICogQHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgd2l0aCB0b2tlbnNcblx0ICogQHJldHVybiB7U3RyaW5nfSBTdHJpbmcgd2l0aCByZXBsYWNlZCB0b2tlbnNcblx0ICovXG5cdGZ1bmN0aW9uIHNwcmludGYoc3RyKSB7XG5cdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cblx0XHRyZXR1cm4gc3RyLnJlcGxhY2UoLyUoW2Etel0pL2csIGZ1bmN0aW9uKCQwLCAkMSkge1xuXHRcdFx0dmFyIHZhbHVlID0gYXJncy5zaGlmdCgpO1xuXG5cdFx0XHRzd2l0Y2ggKCQxKSB7XG5cdFx0XHRcdGNhc2UgJ3MnOlxuXHRcdFx0XHRcdHJldHVybiB2YWx1ZSArICcnO1xuXG5cdFx0XHRcdGNhc2UgJ2QnOlxuXHRcdFx0XHRcdHJldHVybiBwYXJzZUludCh2YWx1ZSwgMTApO1xuXG5cdFx0XHRcdGNhc2UgJ2YnOlxuXHRcdFx0XHRcdHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKTtcblxuXHRcdFx0XHRjYXNlICdjJzpcblx0XHRcdFx0XHRyZXR1cm4gJyc7XG5cblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXG5cblx0ZnVuY3Rpb24gZGVsYXkoY2IsIHRpbWVvdXQpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdGNiLmNhbGwoc2VsZik7XG5cdFx0fSwgdGltZW91dCB8fCAxKTtcblx0fVxuXG5cblx0cmV0dXJuIHtcblx0XHRndWlkOiBndWlkLFxuXHRcdHR5cGVPZjogdHlwZU9mLFxuXHRcdGV4dGVuZDogZXh0ZW5kLFxuXHRcdGV4dGVuZElmOiBleHRlbmRJZixcblx0XHRleHRlbmRJbW11dGFibGU6IGV4dGVuZEltbXV0YWJsZSxcblx0XHRleHRlbmRJbW11dGFibGVJZjogZXh0ZW5kSW1tdXRhYmxlSWYsXG5cdFx0Y2xvbmU6IGNsb25lLFxuXHRcdGluaGVyaXQ6IGluaGVyaXQsXG5cdFx0ZWFjaDogZWFjaCxcblx0XHRpc0VtcHR5T2JqOiBpc0VtcHR5T2JqLFxuXHRcdGluU2VyaWVzOiBpblNlcmllcyxcblx0XHRpblBhcmFsbGVsOiBpblBhcmFsbGVsLFxuXHRcdGluQXJyYXk6IGluQXJyYXksXG5cdFx0YXJyYXlEaWZmOiBhcnJheURpZmYsXG5cdFx0YXJyYXlJbnRlcnNlY3Q6IGFycmF5SW50ZXJzZWN0LFxuXHRcdHRvQXJyYXk6IHRvQXJyYXksXG5cdFx0dHJpbTogdHJpbSxcblx0XHRzcHJpbnRmOiBzcHJpbnRmLFxuXHRcdHBhcnNlU2l6ZVN0cjogcGFyc2VTaXplU3RyLFxuXHRcdGRlbGF5OiBkZWxheVxuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2NvcmUvdXRpbHMvRW5jb2RlLmpzXG5cbi8qKlxuICogRW5jb2RlLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL2NvcmUvdXRpbHMvRW5jb2RlXG5AcHVibGljXG5Ac3RhdGljXG4qL1xuXG5kZWZpbmUoJ21veGllL2NvcmUvdXRpbHMvRW5jb2RlJywgW10sIGZ1bmN0aW9uKCkge1xuXG5cdC8qKlxuXHRFbmNvZGUgc3RyaW5nIHdpdGggVVRGLThcblxuXHRAbWV0aG9kIHV0ZjhfZW5jb2RlXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgdG8gZW5jb2RlXG5cdEByZXR1cm4ge1N0cmluZ30gVVRGLTggZW5jb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIHV0ZjhfZW5jb2RlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0cmV0dXJuIHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdHIpKTtcblx0fTtcblx0XG5cdC8qKlxuXHREZWNvZGUgVVRGLTggZW5jb2RlZCBzdHJpbmdcblxuXHRAbWV0aG9kIHV0ZjhfZGVjb2RlXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgdG8gZGVjb2RlXG5cdEByZXR1cm4ge1N0cmluZ30gRGVjb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIHV0ZjhfZGVjb2RlID0gZnVuY3Rpb24oc3RyX2RhdGEpIHtcblx0XHRyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShzdHJfZGF0YSkpO1xuXHR9O1xuXHRcblx0LyoqXG5cdERlY29kZSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgKHVzZXMgYnJvd3NlcidzIGRlZmF1bHQgbWV0aG9kIGlmIGF2YWlsYWJsZSksXG5cdGZyb206IGh0dHBzOi8vcmF3LmdpdGh1Yi5jb20va3Z6L3BocGpzL21hc3Rlci9mdW5jdGlvbnMvdXJsL2Jhc2U2NF9kZWNvZGUuanNcblxuXHRAbWV0aG9kIGF0b2Jcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gZGF0YSBTdHJpbmcgdG8gZGVjb2RlXG5cdEByZXR1cm4ge1N0cmluZ30gRGVjb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIGF0b2IgPSBmdW5jdGlvbihkYXRhLCB1dGY4KSB7XG5cdFx0aWYgKHR5cGVvZih3aW5kb3cuYXRvYikgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdHJldHVybiB1dGY4ID8gdXRmOF9kZWNvZGUod2luZG93LmF0b2IoZGF0YSkpIDogd2luZG93LmF0b2IoZGF0YSk7XG5cdFx0fVxuXG5cdFx0Ly8gaHR0cDovL2tldmluLnZhbnpvbm5ldmVsZC5uZXRcblx0XHQvLyArICAgb3JpZ2luYWwgYnk6IFR5bGVyIEFraW5zIChodHRwOi8vcnVta2luLmNvbSlcblx0XHQvLyArICAgaW1wcm92ZWQgYnk6IFRodW5kZXIubVxuXHRcdC8vICsgICAgICBpbnB1dCBieTogQW1hbiBHdXB0YVxuXHRcdC8vICsgICBpbXByb3ZlZCBieTogS2V2aW4gdmFuIFpvbm5ldmVsZCAoaHR0cDovL2tldmluLnZhbnpvbm5ldmVsZC5uZXQpXG5cdFx0Ly8gKyAgIGJ1Z2ZpeGVkIGJ5OiBPbm5vIE1hcnNtYW5cblx0XHQvLyArICAgYnVnZml4ZWQgYnk6IFBlbGxlbnRlc3F1ZSBNYWxlc3VhZGFcblx0XHQvLyArICAgaW1wcm92ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxuXHRcdC8vICsgICAgICBpbnB1dCBieTogQnJldHQgWmFtaXIgKGh0dHA6Ly9icmV0dC16YW1pci5tZSlcblx0XHQvLyArICAgYnVnZml4ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxuXHRcdC8vICogICAgIGV4YW1wbGUgMTogYmFzZTY0X2RlY29kZSgnUzJWMmFXNGdkbUZ1SUZwdmJtNWxkbVZzWkE9PScpO1xuXHRcdC8vICogICAgIHJldHVybnMgMTogJ0tldmluIHZhbiBab25uZXZlbGQnXG5cdFx0Ly8gbW96aWxsYSBoYXMgdGhpcyBuYXRpdmVcblx0XHQvLyAtIGJ1dCBicmVha3MgaW4gMi4wLjAuMTIhXG5cdFx0Ly9pZiAodHlwZW9mIHRoaXMud2luZG93LmF0b2IgPT0gJ2Z1bmN0aW9uJykge1xuXHRcdC8vICAgIHJldHVybiBhdG9iKGRhdGEpO1xuXHRcdC8vfVxuXHRcdHZhciBiNjQgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCI7XG5cdFx0dmFyIG8xLCBvMiwgbzMsIGgxLCBoMiwgaDMsIGg0LCBiaXRzLCBpID0gMCxcblx0XHRcdGFjID0gMCxcblx0XHRcdGRlYyA9IFwiXCIsXG5cdFx0XHR0bXBfYXJyID0gW107XG5cblx0XHRpZiAoIWRhdGEpIHtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH1cblxuXHRcdGRhdGEgKz0gJyc7XG5cblx0XHRkbyB7IC8vIHVucGFjayBmb3VyIGhleGV0cyBpbnRvIHRocmVlIG9jdGV0cyB1c2luZyBpbmRleCBwb2ludHMgaW4gYjY0XG5cdFx0XHRoMSA9IGI2NC5pbmRleE9mKGRhdGEuY2hhckF0KGkrKykpO1xuXHRcdFx0aDIgPSBiNjQuaW5kZXhPZihkYXRhLmNoYXJBdChpKyspKTtcblx0XHRcdGgzID0gYjY0LmluZGV4T2YoZGF0YS5jaGFyQXQoaSsrKSk7XG5cdFx0XHRoNCA9IGI2NC5pbmRleE9mKGRhdGEuY2hhckF0KGkrKykpO1xuXG5cdFx0XHRiaXRzID0gaDEgPDwgMTggfCBoMiA8PCAxMiB8IGgzIDw8IDYgfCBoNDtcblxuXHRcdFx0bzEgPSBiaXRzID4+IDE2ICYgMHhmZjtcblx0XHRcdG8yID0gYml0cyA+PiA4ICYgMHhmZjtcblx0XHRcdG8zID0gYml0cyAmIDB4ZmY7XG5cblx0XHRcdGlmIChoMyA9PSA2NCkge1xuXHRcdFx0XHR0bXBfYXJyW2FjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZShvMSk7XG5cdFx0XHR9IGVsc2UgaWYgKGg0ID09IDY0KSB7XG5cdFx0XHRcdHRtcF9hcnJbYWMrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKG8xLCBvMik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0bXBfYXJyW2FjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZShvMSwgbzIsIG8zKTtcblx0XHRcdH1cblx0XHR9IHdoaWxlIChpIDwgZGF0YS5sZW5ndGgpO1xuXG5cdFx0ZGVjID0gdG1wX2Fyci5qb2luKCcnKTtcblxuXHRcdHJldHVybiB1dGY4ID8gdXRmOF9kZWNvZGUoZGVjKSA6IGRlYztcblx0fTtcblx0XG5cdC8qKlxuXHRCYXNlNjQgZW5jb2RlIHN0cmluZyAodXNlcyBicm93c2VyJ3MgZGVmYXVsdCBtZXRob2QgaWYgYXZhaWxhYmxlKSxcblx0ZnJvbTogaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9rdnovcGhwanMvbWFzdGVyL2Z1bmN0aW9ucy91cmwvYmFzZTY0X2VuY29kZS5qc1xuXG5cdEBtZXRob2QgYnRvYVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSBkYXRhIFN0cmluZyB0byBlbmNvZGVcblx0QHJldHVybiB7U3RyaW5nfSBCYXNlNjQgZW5jb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIGJ0b2EgPSBmdW5jdGlvbihkYXRhLCB1dGY4KSB7XG5cdFx0aWYgKHV0ZjgpIHtcblx0XHRcdGRhdGEgPSB1dGY4X2VuY29kZShkYXRhKTtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mKHdpbmRvdy5idG9hKSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy5idG9hKGRhdGEpO1xuXHRcdH1cblxuXHRcdC8vIGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0XG5cdFx0Ly8gKyAgIG9yaWdpbmFsIGJ5OiBUeWxlciBBa2lucyAoaHR0cDovL3J1bWtpbi5jb20pXG5cdFx0Ly8gKyAgIGltcHJvdmVkIGJ5OiBCYXlyb24gR3VldmFyYVxuXHRcdC8vICsgICBpbXByb3ZlZCBieTogVGh1bmRlci5tXG5cdFx0Ly8gKyAgIGltcHJvdmVkIGJ5OiBLZXZpbiB2YW4gWm9ubmV2ZWxkIChodHRwOi8va2V2aW4udmFuem9ubmV2ZWxkLm5ldClcblx0XHQvLyArICAgYnVnZml4ZWQgYnk6IFBlbGxlbnRlc3F1ZSBNYWxlc3VhZGFcblx0XHQvLyArICAgaW1wcm92ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxuXHRcdC8vICsgICBpbXByb3ZlZCBieTogUmFmYcWCIEt1a2F3c2tpIChodHRwOi8va3VrYXdza2kucGwpXG5cdFx0Ly8gKiAgICAgZXhhbXBsZSAxOiBiYXNlNjRfZW5jb2RlKCdLZXZpbiB2YW4gWm9ubmV2ZWxkJyk7XG5cdFx0Ly8gKiAgICAgcmV0dXJucyAxOiAnUzJWMmFXNGdkbUZ1SUZwdmJtNWxkbVZzWkE9PSdcblx0XHQvLyBtb3ppbGxhIGhhcyB0aGlzIG5hdGl2ZVxuXHRcdC8vIC0gYnV0IGJyZWFrcyBpbiAyLjAuMC4xMiFcblx0XHR2YXIgYjY0ID0gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiO1xuXHRcdHZhciBvMSwgbzIsIG8zLCBoMSwgaDIsIGgzLCBoNCwgYml0cywgaSA9IDAsXG5cdFx0XHRhYyA9IDAsXG5cdFx0XHRlbmMgPSBcIlwiLFxuXHRcdFx0dG1wX2FyciA9IFtdO1xuXG5cdFx0aWYgKCFkYXRhKSB7XG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9XG5cblx0XHRkbyB7IC8vIHBhY2sgdGhyZWUgb2N0ZXRzIGludG8gZm91ciBoZXhldHNcblx0XHRcdG8xID0gZGF0YS5jaGFyQ29kZUF0KGkrKyk7XG5cdFx0XHRvMiA9IGRhdGEuY2hhckNvZGVBdChpKyspO1xuXHRcdFx0bzMgPSBkYXRhLmNoYXJDb2RlQXQoaSsrKTtcblxuXHRcdFx0Yml0cyA9IG8xIDw8IDE2IHwgbzIgPDwgOCB8IG8zO1xuXG5cdFx0XHRoMSA9IGJpdHMgPj4gMTggJiAweDNmO1xuXHRcdFx0aDIgPSBiaXRzID4+IDEyICYgMHgzZjtcblx0XHRcdGgzID0gYml0cyA+PiA2ICYgMHgzZjtcblx0XHRcdGg0ID0gYml0cyAmIDB4M2Y7XG5cblx0XHRcdC8vIHVzZSBoZXhldHMgdG8gaW5kZXggaW50byBiNjQsIGFuZCBhcHBlbmQgcmVzdWx0IHRvIGVuY29kZWQgc3RyaW5nXG5cdFx0XHR0bXBfYXJyW2FjKytdID0gYjY0LmNoYXJBdChoMSkgKyBiNjQuY2hhckF0KGgyKSArIGI2NC5jaGFyQXQoaDMpICsgYjY0LmNoYXJBdChoNCk7XG5cdFx0fSB3aGlsZSAoaSA8IGRhdGEubGVuZ3RoKTtcblxuXHRcdGVuYyA9IHRtcF9hcnIuam9pbignJyk7XG5cblx0XHR2YXIgciA9IGRhdGEubGVuZ3RoICUgMztcblxuXHRcdHJldHVybiAociA/IGVuYy5zbGljZSgwLCByIC0gMykgOiBlbmMpICsgJz09PScuc2xpY2UociB8fCAzKTtcblx0fTtcblxuXG5cdHJldHVybiB7XG5cdFx0dXRmOF9lbmNvZGU6IHV0ZjhfZW5jb2RlLFxuXHRcdHV0ZjhfZGVjb2RlOiB1dGY4X2RlY29kZSxcblx0XHRhdG9iOiBhdG9iLFxuXHRcdGJ0b2E6IGJ0b2Fcblx0fTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL0Vudi5qc1xuXG4vKipcbiAqIEVudi5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9jb3JlL3V0aWxzL0VudlxuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKFwibW94aWUvY29yZS91dGlscy9FbnZcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIlxuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblxuXHQvKipcblx0ICogVUFQYXJzZXIuanMgdjAuNy43XG5cdCAqIExpZ2h0d2VpZ2h0IEphdmFTY3JpcHQtYmFzZWQgVXNlci1BZ2VudCBzdHJpbmcgcGFyc2VyXG5cdCAqIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWlzYWxtYW4vdWEtcGFyc2VyLWpzXG5cdCAqXG5cdCAqIENvcHlyaWdodCDCqSAyMDEyLTIwMTUgRmFpc2FsIFNhbG1hbiA8Znl6bG1hbkBnbWFpbC5jb20+XG5cdCAqIER1YWwgbGljZW5zZWQgdW5kZXIgR1BMdjIgJiBNSVRcblx0ICovXG5cdHZhciBVQVBhcnNlciA9IChmdW5jdGlvbiAodW5kZWZpbmVkKSB7XG5cblx0ICAgIC8vLy8vLy8vLy8vLy8vXG5cdCAgICAvLyBDb25zdGFudHNcblx0ICAgIC8vLy8vLy8vLy8vLy9cblxuXG5cdCAgICB2YXIgRU1QVFkgICAgICAgPSAnJyxcblx0ICAgICAgICBVTktOT1dOICAgICA9ICc/Jyxcblx0ICAgICAgICBGVU5DX1RZUEUgICA9ICdmdW5jdGlvbicsXG5cdCAgICAgICAgVU5ERUZfVFlQRSAgPSAndW5kZWZpbmVkJyxcblx0ICAgICAgICBPQkpfVFlQRSAgICA9ICdvYmplY3QnLFxuXHQgICAgICAgIE1BSk9SICAgICAgID0gJ21ham9yJyxcblx0ICAgICAgICBNT0RFTCAgICAgICA9ICdtb2RlbCcsXG5cdCAgICAgICAgTkFNRSAgICAgICAgPSAnbmFtZScsXG5cdCAgICAgICAgVFlQRSAgICAgICAgPSAndHlwZScsXG5cdCAgICAgICAgVkVORE9SICAgICAgPSAndmVuZG9yJyxcblx0ICAgICAgICBWRVJTSU9OICAgICA9ICd2ZXJzaW9uJyxcblx0ICAgICAgICBBUkNISVRFQ1RVUkU9ICdhcmNoaXRlY3R1cmUnLFxuXHQgICAgICAgIENPTlNPTEUgICAgID0gJ2NvbnNvbGUnLFxuXHQgICAgICAgIE1PQklMRSAgICAgID0gJ21vYmlsZScsXG5cdCAgICAgICAgVEFCTEVUICAgICAgPSAndGFibGV0JztcblxuXG5cdCAgICAvLy8vLy8vLy8vL1xuXHQgICAgLy8gSGVscGVyXG5cdCAgICAvLy8vLy8vLy8vXG5cblxuXHQgICAgdmFyIHV0aWwgPSB7XG5cdCAgICAgICAgaGFzIDogZnVuY3Rpb24gKHN0cjEsIHN0cjIpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHN0cjIudG9Mb3dlckNhc2UoKS5pbmRleE9mKHN0cjEudG9Mb3dlckNhc2UoKSkgIT09IC0xO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgbG93ZXJpemUgOiBmdW5jdGlvbiAoc3RyKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBzdHIudG9Mb3dlckNhc2UoKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXG5cblx0ICAgIC8vLy8vLy8vLy8vLy8vL1xuXHQgICAgLy8gTWFwIGhlbHBlclxuXHQgICAgLy8vLy8vLy8vLy8vLy9cblxuXG5cdCAgICB2YXIgbWFwcGVyID0ge1xuXG5cdCAgICAgICAgcmd4IDogZnVuY3Rpb24gKCkge1xuXG5cdCAgICAgICAgICAgIC8vIGxvb3AgdGhyb3VnaCBhbGwgcmVnZXhlcyBtYXBzXG5cdCAgICAgICAgICAgIGZvciAodmFyIHJlc3VsdCwgaSA9IDAsIGosIGssIHAsIHEsIG1hdGNoZXMsIG1hdGNoLCBhcmdzID0gYXJndW1lbnRzOyBpIDwgYXJncy5sZW5ndGg7IGkgKz0gMikge1xuXG5cdCAgICAgICAgICAgICAgICB2YXIgcmVnZXggPSBhcmdzW2ldLCAgICAgICAvLyBldmVuIHNlcXVlbmNlICgwLDIsNCwuLilcblx0ICAgICAgICAgICAgICAgICAgICBwcm9wcyA9IGFyZ3NbaSArIDFdOyAgIC8vIG9kZCBzZXF1ZW5jZSAoMSwzLDUsLi4pXG5cblx0ICAgICAgICAgICAgICAgIC8vIGNvbnN0cnVjdCBvYmplY3QgYmFyZWJvbmVzXG5cdCAgICAgICAgICAgICAgICBpZiAodHlwZW9mKHJlc3VsdCkgPT09IFVOREVGX1RZUEUpIHtcblx0ICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7fTtcblx0ICAgICAgICAgICAgICAgICAgICBmb3IgKHAgaW4gcHJvcHMpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcSA9IHByb3BzW3BdO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mKHEpID09PSBPQkpfVFlQRSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FbMF1dID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FdID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICAvLyB0cnkgbWF0Y2hpbmcgdWFzdHJpbmcgd2l0aCByZWdleGVzXG5cdCAgICAgICAgICAgICAgICBmb3IgKGogPSBrID0gMDsgaiA8IHJlZ2V4Lmxlbmd0aDsgaisrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHJlZ2V4W2pdLmV4ZWModGhpcy5nZXRVQSgpKTtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoISFtYXRjaGVzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGZvciAocCA9IDA7IHAgPCBwcm9wcy5sZW5ndGg7IHArKykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBtYXRjaGVzWysra107XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBxID0gcHJvcHNbcF07XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiBnaXZlbiBwcm9wZXJ0eSBpcyBhY3R1YWxseSBhcnJheVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihxKSA9PT0gT0JKX1RZUEUgJiYgcS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHEubGVuZ3RoID09IDIpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihxWzFdKSA9PSBGVU5DX1RZUEUpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzc2lnbiBtb2RpZmllZCBtYXRjaFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FbMF1dID0gcVsxXS5jYWxsKHRoaXMsIG1hdGNoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzc2lnbiBnaXZlbiB2YWx1ZSwgaWdub3JlIHJlZ2V4IG1hdGNoXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcVswXV0gPSBxWzFdO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChxLmxlbmd0aCA9PSAzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHdoZXRoZXIgZnVuY3Rpb24gb3IgcmVnZXhcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihxWzFdKSA9PT0gRlVOQ19UWVBFICYmICEocVsxXS5leGVjICYmIHFbMV0udGVzdCkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhbGwgZnVuY3Rpb24gKHVzdWFsbHkgc3RyaW5nIG1hcHBlcilcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtxWzBdXSA9IG1hdGNoID8gcVsxXS5jYWxsKHRoaXMsIG1hdGNoLCBxWzJdKSA6IHVuZGVmaW5lZDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNhbml0aXplIG1hdGNoIHVzaW5nIGdpdmVuIHJlZ2V4XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcVswXV0gPSBtYXRjaCA/IG1hdGNoLnJlcGxhY2UocVsxXSwgcVsyXSkgOiB1bmRlZmluZWQ7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHEubGVuZ3RoID09IDQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtxWzBdXSA9IG1hdGNoID8gcVszXS5jYWxsKHRoaXMsIG1hdGNoLnJlcGxhY2UocVsxXSwgcVsyXSkpIDogdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FdID0gbWF0Y2ggPyBtYXRjaCA6IHVuZGVmaW5lZDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgIGlmKCEhbWF0Y2hlcykgYnJlYWs7IC8vIGJyZWFrIHRoZSBsb29wIGltbWVkaWF0ZWx5IGlmIG1hdGNoIGZvdW5kXG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblx0ICAgICAgICB9LFxuXG5cdCAgICAgICAgc3RyIDogZnVuY3Rpb24gKHN0ciwgbWFwKSB7XG5cblx0ICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBtYXApIHtcblx0ICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGFycmF5XG5cdCAgICAgICAgICAgICAgICBpZiAodHlwZW9mKG1hcFtpXSkgPT09IE9CSl9UWVBFICYmIG1hcFtpXS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBtYXBbaV0ubGVuZ3RoOyBqKyspIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWwuaGFzKG1hcFtpXVtqXSwgc3RyKSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpID09PSBVTktOT1dOKSA/IHVuZGVmaW5lZCA6IGk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHV0aWwuaGFzKG1hcFtpXSwgc3RyKSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaSA9PT0gVU5LTk9XTikgPyB1bmRlZmluZWQgOiBpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBzdHI7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblxuXG5cdCAgICAvLy8vLy8vLy8vLy8vLy9cblx0ICAgIC8vIFN0cmluZyBtYXBcblx0ICAgIC8vLy8vLy8vLy8vLy8vXG5cblxuXHQgICAgdmFyIG1hcHMgPSB7XG5cblx0ICAgICAgICBicm93c2VyIDoge1xuXHQgICAgICAgICAgICBvbGRzYWZhcmkgOiB7XG5cdCAgICAgICAgICAgICAgICBtYWpvciA6IHtcblx0ICAgICAgICAgICAgICAgICAgICAnMScgOiBbJy84JywgJy8xJywgJy8zJ10sXG5cdCAgICAgICAgICAgICAgICAgICAgJzInIDogJy80Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnPycgOiAnLydcblx0ICAgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgICB2ZXJzaW9uIDoge1xuXHQgICAgICAgICAgICAgICAgICAgICcxLjAnICAgOiAnLzgnLFxuXHQgICAgICAgICAgICAgICAgICAgICcxLjInICAgOiAnLzEnLFxuXHQgICAgICAgICAgICAgICAgICAgICcxLjMnICAgOiAnLzMnLFxuXHQgICAgICAgICAgICAgICAgICAgICcyLjAnICAgOiAnLzQxMicsXG5cdCAgICAgICAgICAgICAgICAgICAgJzIuMC4yJyA6ICcvNDE2Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnMi4wLjMnIDogJy80MTcnLFxuXHQgICAgICAgICAgICAgICAgICAgICcyLjAuNCcgOiAnLzQxOScsXG5cdCAgICAgICAgICAgICAgICAgICAgJz8nICAgICA6ICcvJ1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSxcblxuXHQgICAgICAgIGRldmljZSA6IHtcblx0ICAgICAgICAgICAgc3ByaW50IDoge1xuXHQgICAgICAgICAgICAgICAgbW9kZWwgOiB7XG5cdCAgICAgICAgICAgICAgICAgICAgJ0V2byBTaGlmdCA0RycgOiAnNzM3M0tUJ1xuXHQgICAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICAgIHZlbmRvciA6IHtcblx0ICAgICAgICAgICAgICAgICAgICAnSFRDJyAgICAgICA6ICdBUEEnLFxuXHQgICAgICAgICAgICAgICAgICAgICdTcHJpbnQnICAgIDogJ1NwcmludCdcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sXG5cblx0ICAgICAgICBvcyA6IHtcblx0ICAgICAgICAgICAgd2luZG93cyA6IHtcblx0ICAgICAgICAgICAgICAgIHZlcnNpb24gOiB7XG5cdCAgICAgICAgICAgICAgICAgICAgJ01FJyAgICAgICAgOiAnNC45MCcsXG5cdCAgICAgICAgICAgICAgICAgICAgJ05UIDMuMTEnICAgOiAnTlQzLjUxJyxcblx0ICAgICAgICAgICAgICAgICAgICAnTlQgNC4wJyAgICA6ICdOVDQuMCcsXG5cdCAgICAgICAgICAgICAgICAgICAgJzIwMDAnICAgICAgOiAnTlQgNS4wJyxcblx0ICAgICAgICAgICAgICAgICAgICAnWFAnICAgICAgICA6IFsnTlQgNS4xJywgJ05UIDUuMiddLFxuXHQgICAgICAgICAgICAgICAgICAgICdWaXN0YScgICAgIDogJ05UIDYuMCcsXG5cdCAgICAgICAgICAgICAgICAgICAgJzcnICAgICAgICAgOiAnTlQgNi4xJyxcblx0ICAgICAgICAgICAgICAgICAgICAnOCcgICAgICAgICA6ICdOVCA2LjInLFxuXHQgICAgICAgICAgICAgICAgICAgICc4LjEnICAgICAgIDogJ05UIDYuMycsXG5cdCAgICAgICAgICAgICAgICAgICAgJ1JUJyAgICAgICAgOiAnQVJNJ1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblxuXG5cdCAgICAvLy8vLy8vLy8vLy8vL1xuXHQgICAgLy8gUmVnZXggbWFwXG5cdCAgICAvLy8vLy8vLy8vLy8vXG5cblxuXHQgICAgdmFyIHJlZ2V4ZXMgPSB7XG5cblx0ICAgICAgICBicm93c2VyIDogW1tcblxuXHQgICAgICAgICAgICAvLyBQcmVzdG8gYmFzZWRcblx0ICAgICAgICAgICAgLyhvcGVyYVxcc21pbmkpXFwvKFtcXHdcXC4tXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3BlcmEgTWluaVxuXHQgICAgICAgICAgICAvKG9wZXJhXFxzW21vYmlsZXRhYl0rKS4rdmVyc2lvblxcLyhbXFx3XFwuLV0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVyYSBNb2JpL1RhYmxldFxuXHQgICAgICAgICAgICAvKG9wZXJhKS4rdmVyc2lvblxcLyhbXFx3XFwuXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wZXJhID4gOS44MFxuXHQgICAgICAgICAgICAvKG9wZXJhKVtcXC9cXHNdKyhbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVyYSA8IDkuODBcblxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvXFxzKG9wcilcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVyYSBXZWJraXRcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnT3BlcmEnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvLyBNaXhlZFxuXHQgICAgICAgICAgICAvKGtpbmRsZSlcXC8oW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEtpbmRsZVxuXHQgICAgICAgICAgICAvKGx1bmFzY2FwZXxtYXh0aG9ufG5ldGZyb250fGphc21pbmV8YmxhemVyKVtcXC9cXHNdPyhbXFx3XFwuXSspKi9pLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEx1bmFzY2FwZS9NYXh0aG9uL05ldGZyb250L0phc21pbmUvQmxhemVyXG5cblx0ICAgICAgICAgICAgLy8gVHJpZGVudCBiYXNlZFxuXHQgICAgICAgICAgICAvKGF2YW50XFxzfGllbW9iaWxlfHNsaW18YmFpZHUpKD86YnJvd3Nlcik/W1xcL1xcc10/KFtcXHdcXC5dKikvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBdmFudC9JRU1vYmlsZS9TbGltQnJvd3Nlci9CYWlkdVxuXHQgICAgICAgICAgICAvKD86bXN8XFwoKShpZSlcXHMoW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbnRlcm5ldCBFeHBsb3JlclxuXG5cdCAgICAgICAgICAgIC8vIFdlYmtpdC9LSFRNTCBiYXNlZFxuXHQgICAgICAgICAgICAvKHJla29ucSlcXC8oW1xcd1xcLl0rKSovaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJla29ucVxuXHQgICAgICAgICAgICAvKGNocm9taXVtfGZsb2NrfHJvY2ttZWx0fG1pZG9yaXxlcGlwaGFueXxzaWxrfHNreWZpcmV8b3ZpYnJvd3Nlcnxib2x0fGlyb258dml2YWxkaSlcXC8oW1xcd1xcLi1dKykvaVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENocm9taXVtL0Zsb2NrL1JvY2tNZWx0L01pZG9yaS9FcGlwaGFueS9TaWxrL1NreWZpcmUvQm9sdC9Jcm9uXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8odHJpZGVudCkuK3J2WzpcXHNdKFtcXHdcXC5dKykuK2xpa2VcXHNnZWNrby9pICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElFMTFcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnSUUnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKGVkZ2UpXFwvKChcXGQrKT9bXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNaWNyb3NvZnQgRWRnZVxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKHlhYnJvd3NlcilcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFlhbmRleFxuXHQgICAgICAgICAgICBdLCBbW05BTUUsICdZYW5kZXgnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKGNvbW9kb19kcmFnb24pXFwvKFtcXHdcXC5dKykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW9kbyBEcmFnb25cblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAvXy9nLCAnICddLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8oY2hyb21lfG9tbml3ZWJ8YXJvcmF8W3RpemVub2thXXs1fVxccz9icm93c2VyKVxcL3Y/KFtcXHdcXC5dKykvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaHJvbWUvT21uaVdlYi9Bcm9yYS9UaXplbi9Ob2tpYVxuXHQgICAgICAgICAgICAvKHVjXFxzP2Jyb3dzZXJ8cXFicm93c2VyKVtcXC9cXHNdPyhbXFx3XFwuXSspL2lcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVQ0Jyb3dzZXIvUVFCcm93c2VyXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8oZG9sZmluKVxcLyhbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9scGhpblxuXHQgICAgICAgICAgICBdLCBbW05BTUUsICdEb2xwaGluJ10sIFZFUlNJT05dLCBbXG5cblx0ICAgICAgICAgICAgLygoPzphbmRyb2lkLispY3Jtb3xjcmlvcylcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaHJvbWUgZm9yIEFuZHJvaWQvaU9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0Nocm9tZSddLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC9YaWFvTWlcXC9NaXVpQnJvd3NlclxcLyhbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1JVUkgQnJvd3NlclxuXHQgICAgICAgICAgICBdLCBbVkVSU0lPTiwgW05BTUUsICdNSVVJIEJyb3dzZXInXV0sIFtcblxuXHQgICAgICAgICAgICAvYW5kcm9pZC4rdmVyc2lvblxcLyhbXFx3XFwuXSspXFxzKyg/Om1vYmlsZVxccz9zYWZhcml8c2FmYXJpKS9pICAgICAgICAgLy8gQW5kcm9pZCBCcm93c2VyXG5cdCAgICAgICAgICAgIF0sIFtWRVJTSU9OLCBbTkFNRSwgJ0FuZHJvaWQgQnJvd3NlciddXSwgW1xuXG5cdCAgICAgICAgICAgIC9GQkFWXFwvKFtcXHdcXC5dKyk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmFjZWJvb2sgQXBwIGZvciBpT1Ncblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIFtOQU1FLCAnRmFjZWJvb2snXV0sIFtcblxuXHQgICAgICAgICAgICAvdmVyc2lvblxcLyhbXFx3XFwuXSspLis/bW9iaWxlXFwvXFx3K1xccyhzYWZhcmkpL2kgICAgICAgICAgICAgICAgICAgICAgIC8vIE1vYmlsZSBTYWZhcmlcblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIFtOQU1FLCAnTW9iaWxlIFNhZmFyaSddXSwgW1xuXG5cdCAgICAgICAgICAgIC92ZXJzaW9uXFwvKFtcXHdcXC5dKykuKz8obW9iaWxlXFxzP3NhZmFyaXxzYWZhcmkpL2kgICAgICAgICAgICAgICAgICAgIC8vIFNhZmFyaSAmIFNhZmFyaSBNb2JpbGVcblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIE5BTUVdLCBbXG5cblx0ICAgICAgICAgICAgL3dlYmtpdC4rPyhtb2JpbGVcXHM/c2FmYXJpfHNhZmFyaSkoXFwvW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgLy8gU2FmYXJpIDwgMy4wXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBbVkVSU0lPTiwgbWFwcGVyLnN0ciwgbWFwcy5icm93c2VyLm9sZHNhZmFyaS52ZXJzaW9uXV0sIFtcblxuXHQgICAgICAgICAgICAvKGtvbnF1ZXJvcilcXC8oW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEtvbnF1ZXJvclxuXHQgICAgICAgICAgICAvKHdlYmtpdHxraHRtbClcXC8oW1xcd1xcLl0rKS9pXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8vIEdlY2tvIGJhc2VkXG5cdCAgICAgICAgICAgIC8obmF2aWdhdG9yfG5ldHNjYXBlKVxcLyhbXFx3XFwuLV0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmV0c2NhcGVcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnTmV0c2NhcGUnXSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgLyhzd2lmdGZveCkvaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTd2lmdGZveFxuXHQgICAgICAgICAgICAvKGljZWRyYWdvbnxpY2V3ZWFzZWx8Y2FtaW5vfGNoaW1lcmF8ZmVubmVjfG1hZW1vXFxzYnJvd3NlcnxtaW5pbW98Y29ua2Vyb3IpW1xcL1xcc10/KFtcXHdcXC5cXCtdKykvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJY2VEcmFnb24vSWNld2Vhc2VsL0NhbWluby9DaGltZXJhL0Zlbm5lYy9NYWVtby9NaW5pbW8vQ29ua2Vyb3Jcblx0ICAgICAgICAgICAgLyhmaXJlZm94fHNlYW1vbmtleXxrLW1lbGVvbnxpY2VjYXR8aWNlYXBlfGZpcmViaXJkfHBob2VuaXgpXFwvKFtcXHdcXC4tXSspL2ksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyZWZveC9TZWFNb25rZXkvSy1NZWxlb24vSWNlQ2F0L0ljZUFwZS9GaXJlYmlyZC9QaG9lbml4XG5cdCAgICAgICAgICAgIC8obW96aWxsYSlcXC8oW1xcd1xcLl0rKS4rcnZcXDouK2dlY2tvXFwvXFxkKy9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW96aWxsYVxuXG5cdCAgICAgICAgICAgIC8vIE90aGVyXG5cdCAgICAgICAgICAgIC8ocG9sYXJpc3xseW54fGRpbGxvfGljYWJ8ZG9yaXN8YW1heWF8dzNtfG5ldHN1cmYpW1xcL1xcc10/KFtcXHdcXC5dKykvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb2xhcmlzL0x5bngvRGlsbG8vaUNhYi9Eb3Jpcy9BbWF5YS93M20vTmV0U3VyZlxuXHQgICAgICAgICAgICAvKGxpbmtzKVxcc1xcKChbXFx3XFwuXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMaW5rc1xuXHQgICAgICAgICAgICAvKGdvYnJvd3NlcilcXC8/KFtcXHdcXC5dKykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdvQnJvd3NlclxuXHQgICAgICAgICAgICAvKGljZVxccz9icm93c2VyKVxcL3Y/KFtcXHdcXC5fXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJQ0UgQnJvd3NlclxuXHQgICAgICAgICAgICAvKG1vc2FpYylbXFwvXFxzXShbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNb3NhaWNcblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dXG5cdCAgICAgICAgXSxcblxuXHQgICAgICAgIGVuZ2luZSA6IFtbXG5cblx0ICAgICAgICAgICAgL3dpbmRvd3MuK1xcc2VkZ2VcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWRnZUhUTUxcblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIFtOQU1FLCAnRWRnZUhUTUwnXV0sIFtcblxuXHQgICAgICAgICAgICAvKHByZXN0bylcXC8oW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXN0b1xuXHQgICAgICAgICAgICAvKHdlYmtpdHx0cmlkZW50fG5ldGZyb250fG5ldHN1cmZ8YW1heWF8bHlueHx3M20pXFwvKFtcXHdcXC5dKykvaSwgICAgIC8vIFdlYktpdC9UcmlkZW50L05ldEZyb250L05ldFN1cmYvQW1heWEvTHlueC93M21cblx0ICAgICAgICAgICAgLyhraHRtbHx0YXNtYW58bGlua3MpW1xcL1xcc11cXCg/KFtcXHdcXC5dKykvaSwgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEtIVE1ML1Rhc21hbi9MaW5rc1xuXHQgICAgICAgICAgICAvKGljYWIpW1xcL1xcc10oWzIzXVxcLltcXGRcXC5dKykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaUNhYlxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvcnZcXDooW1xcd1xcLl0rKS4qKGdlY2tvKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdlY2tvXG5cdCAgICAgICAgICAgIF0sIFtWRVJTSU9OLCBOQU1FXVxuXHQgICAgICAgIF0sXG5cblx0ICAgICAgICBvcyA6IFtbXG5cblx0ICAgICAgICAgICAgLy8gV2luZG93cyBiYXNlZFxuXHQgICAgICAgICAgICAvbWljcm9zb2Z0XFxzKHdpbmRvd3MpXFxzKHZpc3RhfHhwKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2luZG93cyAoaVR1bmVzKVxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgLyh3aW5kb3dzKVxcc250XFxzNlxcLjI7XFxzKGFybSkvaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2luZG93cyBSVFxuXHQgICAgICAgICAgICAvKHdpbmRvd3NcXHNwaG9uZSg/Olxcc29zKSp8d2luZG93c1xcc21vYmlsZXx3aW5kb3dzKVtcXHNcXC9dPyhbbnRjZVxcZFxcLlxcc10rXFx3KS9pXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBbVkVSU0lPTiwgbWFwcGVyLnN0ciwgbWFwcy5vcy53aW5kb3dzLnZlcnNpb25dXSwgW1xuXHQgICAgICAgICAgICAvKHdpbig/PTN8OXxuKXx3aW5cXHM5eFxccykoW250XFxkXFwuXSspL2lcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnV2luZG93cyddLCBbVkVSU0lPTiwgbWFwcGVyLnN0ciwgbWFwcy5vcy53aW5kb3dzLnZlcnNpb25dXSwgW1xuXG5cdCAgICAgICAgICAgIC8vIE1vYmlsZS9FbWJlZGRlZCBPU1xuXHQgICAgICAgICAgICAvXFwoKGJiKSgxMCk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBCbGFja0JlcnJ5IDEwXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0JsYWNrQmVycnknXSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgLyhibGFja2JlcnJ5KVxcdypcXC8/KFtcXHdcXC5dKykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2tiZXJyeVxuXHQgICAgICAgICAgICAvKHRpemVuKVtcXC9cXHNdKFtcXHdcXC5dKykvaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaXplblxuXHQgICAgICAgICAgICAvKGFuZHJvaWR8d2Vib3N8cGFsbVxcb3N8cW54fGJhZGF8cmltXFxzdGFibGV0XFxzb3N8bWVlZ298Y29udGlraSlbXFwvXFxzLV0/KFtcXHdcXC5dKykqL2ksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQW5kcm9pZC9XZWJPUy9QYWxtL1FOWC9CYWRhL1JJTS9NZWVHby9Db250aWtpXG5cdCAgICAgICAgICAgIC9saW51eDsuKyhzYWlsZmlzaCk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2FpbGZpc2ggT1Ncblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dLCBbXG5cdCAgICAgICAgICAgIC8oc3ltYmlhblxccz9vc3xzeW1ib3N8czYwKD89OykpW1xcL1xccy1dPyhbXFx3XFwuXSspKi9pICAgICAgICAgICAgICAgICAvLyBTeW1iaWFuXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ1N5bWJpYW4nXSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgL1xcKChzZXJpZXM0MCk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2VyaWVzIDQwXG5cdCAgICAgICAgICAgIF0sIFtOQU1FXSwgW1xuXHQgICAgICAgICAgICAvbW96aWxsYS4rXFwobW9iaWxlOy4rZ2Vja28uK2ZpcmVmb3gvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXJlZm94IE9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0ZpcmVmb3ggT1MnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvLyBDb25zb2xlXG5cdCAgICAgICAgICAgIC8obmludGVuZG98cGxheXN0YXRpb24pXFxzKFt3aWRzM3BvcnRhYmxldnVdKykvaSwgICAgICAgICAgICAgICAgICAgIC8vIE5pbnRlbmRvL1BsYXlzdGF0aW9uXG5cblx0ICAgICAgICAgICAgLy8gR05VL0xpbnV4IGJhc2VkXG5cdCAgICAgICAgICAgIC8obWludClbXFwvXFxzXFwoXT8oXFx3KykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1pbnRcblx0ICAgICAgICAgICAgLyhtYWdlaWF8dmVjdG9ybGludXgpWztcXHNdL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFnZWlhL1ZlY3RvckxpbnV4XG5cdCAgICAgICAgICAgIC8oam9saXxba3hsbl0/dWJ1bnR1fGRlYmlhbnxbb3Blbl0qc3VzZXxnZW50b298YXJjaHxzbGFja3dhcmV8ZmVkb3JhfG1hbmRyaXZhfGNlbnRvc3xwY2xpbnV4b3N8cmVkaGF0fHplbndhbGt8bGlucHVzKVtcXC9cXHMtXT8oW1xcd1xcLi1dKykqL2ksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSm9saS9VYnVudHUvRGViaWFuL1NVU0UvR2VudG9vL0FyY2gvU2xhY2t3YXJlXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmVkb3JhL01hbmRyaXZhL0NlbnRPUy9QQ0xpbnV4T1MvUmVkSGF0L1plbndhbGsvTGlucHVzXG5cdCAgICAgICAgICAgIC8oaHVyZHxsaW51eClcXHM/KFtcXHdcXC5dKykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSHVyZC9MaW51eFxuXHQgICAgICAgICAgICAvKGdudSlcXHM/KFtcXHdcXC5dKykqL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdOVVxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKGNyb3MpXFxzW1xcd10rXFxzKFtcXHdcXC5dK1xcdykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENocm9taXVtIE9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0Nocm9taXVtIE9TJ10sIFZFUlNJT05dLFtcblxuXHQgICAgICAgICAgICAvLyBTb2xhcmlzXG5cdCAgICAgICAgICAgIC8oc3Vub3MpXFxzPyhbXFx3XFwuXStcXGQpKi9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNvbGFyaXNcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnU29sYXJpcyddLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8vIEJTRCBiYXNlZFxuXHQgICAgICAgICAgICAvXFxzKFtmcmVudG9wYy1dezAsNH1ic2R8ZHJhZ29uZmx5KVxccz8oW1xcd1xcLl0rKSovaSAgICAgICAgICAgICAgICAgICAvLyBGcmVlQlNEL05ldEJTRC9PcGVuQlNEL1BDLUJTRC9EcmFnb25GbHlcblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dLFtcblxuXHQgICAgICAgICAgICAvKGlwW2hvbmVhZF0rKSg/Oi4qb3NcXHMqKFtcXHddKykqXFxzbGlrZVxcc21hY3w7XFxzb3BlcmEpL2kgICAgICAgICAgICAgLy8gaU9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ2lPUyddLCBbVkVSU0lPTiwgL18vZywgJy4nXV0sIFtcblxuXHQgICAgICAgICAgICAvKG1hY1xcc29zXFxzeClcXHM/KFtcXHdcXHNcXC5dK1xcdykqL2ksXG5cdCAgICAgICAgICAgIC8obWFjaW50b3NofG1hYyg/PV9wb3dlcnBjKVxccykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hYyBPU1xuXHQgICAgICAgICAgICBdLCBbW05BTUUsICdNYWMgT1MnXSwgW1ZFUlNJT04sIC9fL2csICcuJ11dLCBbXG5cblx0ICAgICAgICAgICAgLy8gT3RoZXJcblx0ICAgICAgICAgICAgLygoPzpvcGVuKT9zb2xhcmlzKVtcXC9cXHMtXT8oW1xcd1xcLl0rKSovaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU29sYXJpc1xuXHQgICAgICAgICAgICAvKGhhaWt1KVxccyhcXHcrKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFpa3Vcblx0ICAgICAgICAgICAgLyhhaXgpXFxzKChcXGQpKD89XFwufFxcKXxcXHMpW1xcd1xcLl0qKSovaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQUlYXG5cdCAgICAgICAgICAgIC8ocGxhblxcczl8bWluaXh8YmVvc3xvc1xcLzJ8YW1pZ2Fvc3xtb3JwaG9zfHJpc2NcXHNvc3xvcGVudm1zKS9pLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBsYW45L01pbml4L0JlT1MvT1MyL0FtaWdhT1MvTW9ycGhPUy9SSVNDT1MvT3BlblZNU1xuXHQgICAgICAgICAgICAvKHVuaXgpXFxzPyhbXFx3XFwuXSspKi9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVOSVhcblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dXG5cdCAgICAgICAgXVxuXHQgICAgfTtcblxuXG5cdCAgICAvLy8vLy8vLy8vLy8vLy8vL1xuXHQgICAgLy8gQ29uc3RydWN0b3Jcblx0ICAgIC8vLy8vLy8vLy8vLy8vLy9cblxuXG5cdCAgICB2YXIgVUFQYXJzZXIgPSBmdW5jdGlvbiAodWFzdHJpbmcpIHtcblxuXHQgICAgICAgIHZhciB1YSA9IHVhc3RyaW5nIHx8ICgod2luZG93ICYmIHdpbmRvdy5uYXZpZ2F0b3IgJiYgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpID8gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQgOiBFTVBUWSk7XG5cblx0ICAgICAgICB0aGlzLmdldEJyb3dzZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBtYXBwZXIucmd4LmFwcGx5KHRoaXMsIHJlZ2V4ZXMuYnJvd3Nlcik7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLmdldEVuZ2luZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG1hcHBlci5yZ3guYXBwbHkodGhpcywgcmVnZXhlcy5lbmdpbmUpO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdGhpcy5nZXRPUyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG1hcHBlci5yZ3guYXBwbHkodGhpcywgcmVnZXhlcy5vcyk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLmdldFJlc3VsdCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICAgICAgdWEgICAgICA6IHRoaXMuZ2V0VUEoKSxcblx0ICAgICAgICAgICAgICAgIGJyb3dzZXIgOiB0aGlzLmdldEJyb3dzZXIoKSxcblx0ICAgICAgICAgICAgICAgIGVuZ2luZSAgOiB0aGlzLmdldEVuZ2luZSgpLFxuXHQgICAgICAgICAgICAgICAgb3MgICAgICA6IHRoaXMuZ2V0T1MoKVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdGhpcy5nZXRVQSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHVhO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdGhpcy5zZXRVQSA9IGZ1bmN0aW9uICh1YXN0cmluZykge1xuXHQgICAgICAgICAgICB1YSA9IHVhc3RyaW5nO1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHRoaXMuc2V0VUEodWEpO1xuXHQgICAgfTtcblxuXHQgICAgcmV0dXJuIFVBUGFyc2VyO1xuXHR9KSgpO1xuXG5cblx0ZnVuY3Rpb24gdmVyc2lvbl9jb21wYXJlKHYxLCB2Miwgb3BlcmF0b3IpIHtcblx0ICAvLyBGcm9tOiBodHRwOi8vcGhwanMub3JnL2Z1bmN0aW9uc1xuXHQgIC8vICsgICAgICBvcmlnaW5hbCBieTogUGhpbGlwcGUgSmF1c2lvbnMgKGh0dHA6Ly9wZWFyLnBocC5uZXQvdXNlci9qYXVzaW9ucylcblx0ICAvLyArICAgICAgb3JpZ2luYWwgYnk6IEFpZGFuIExpc3RlciAoaHR0cDovL2FpZGFubGlzdGVyLmNvbS8pXG5cdCAgLy8gKyByZWltcGxlbWVudGVkIGJ5OiBLYW5rcmVsdW5lIChodHRwOi8vd3d3LndlYmZha3RvcnkuaW5mby8pXG5cdCAgLy8gKyAgICAgIGltcHJvdmVkIGJ5OiBCcmV0dCBaYW1pciAoaHR0cDovL2JyZXR0LXphbWlyLm1lKVxuXHQgIC8vICsgICAgICBpbXByb3ZlZCBieTogU2NvdHQgQmFrZXJcblx0ICAvLyArICAgICAgaW1wcm92ZWQgYnk6IFRoZXJpYXVsdFxuXHQgIC8vICogICAgICAgIGV4YW1wbGUgMTogdmVyc2lvbl9jb21wYXJlKCc4LjIuNXJjJywgJzguMi41YScpO1xuXHQgIC8vICogICAgICAgIHJldHVybnMgMTogMVxuXHQgIC8vICogICAgICAgIGV4YW1wbGUgMjogdmVyc2lvbl9jb21wYXJlKCc4LjIuNTAnLCAnOC4yLjUyJywgJzwnKTtcblx0ICAvLyAqICAgICAgICByZXR1cm5zIDI6IHRydWVcblx0ICAvLyAqICAgICAgICBleGFtcGxlIDM6IHZlcnNpb25fY29tcGFyZSgnNS4zLjAtZGV2JywgJzUuMy4wJyk7XG5cdCAgLy8gKiAgICAgICAgcmV0dXJucyAzOiAtMVxuXHQgIC8vICogICAgICAgIGV4YW1wbGUgNDogdmVyc2lvbl9jb21wYXJlKCc0LjEuMC41MicsJzQuMDEuMC41MScpO1xuXHQgIC8vICogICAgICAgIHJldHVybnMgNDogMVxuXG5cdCAgLy8gSW1wb3J0YW50OiBjb21wYXJlIG11c3QgYmUgaW5pdGlhbGl6ZWQgYXQgMC5cblx0ICB2YXIgaSA9IDAsXG5cdCAgICB4ID0gMCxcblx0ICAgIGNvbXBhcmUgPSAwLFxuXHQgICAgLy8gdm0gbWFwcyB0ZXh0dWFsIFBIUCB2ZXJzaW9ucyB0byBuZWdhdGl2ZXMgc28gdGhleSdyZSBsZXNzIHRoYW4gMC5cblx0ICAgIC8vIFBIUCBjdXJyZW50bHkgZGVmaW5lcyB0aGVzZSBhcyBDQVNFLVNFTlNJVElWRS4gSXQgaXMgaW1wb3J0YW50IHRvXG5cdCAgICAvLyBsZWF2ZSB0aGVzZSBhcyBuZWdhdGl2ZXMgc28gdGhhdCB0aGV5IGNhbiBjb21lIGJlZm9yZSBudW1lcmljYWwgdmVyc2lvbnNcblx0ICAgIC8vIGFuZCBhcyBpZiBubyBsZXR0ZXJzIHdlcmUgdGhlcmUgdG8gYmVnaW4gd2l0aC5cblx0ICAgIC8vICgxYWxwaGEgaXMgPCAxIGFuZCA8IDEuMSBidXQgPiAxZGV2MSlcblx0ICAgIC8vIElmIGEgbm9uLW51bWVyaWNhbCB2YWx1ZSBjYW4ndCBiZSBtYXBwZWQgdG8gdGhpcyB0YWJsZSwgaXQgcmVjZWl2ZXNcblx0ICAgIC8vIC03IGFzIGl0cyB2YWx1ZS5cblx0ICAgIHZtID0ge1xuXHQgICAgICAnZGV2JzogLTYsXG5cdCAgICAgICdhbHBoYSc6IC01LFxuXHQgICAgICAnYSc6IC01LFxuXHQgICAgICAnYmV0YSc6IC00LFxuXHQgICAgICAnYic6IC00LFxuXHQgICAgICAnUkMnOiAtMyxcblx0ICAgICAgJ3JjJzogLTMsXG5cdCAgICAgICcjJzogLTIsXG5cdCAgICAgICdwJzogMSxcblx0ICAgICAgJ3BsJzogMVxuXHQgICAgfSxcblx0ICAgIC8vIFRoaXMgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgdG8gcHJlcGFyZSBlYWNoIHZlcnNpb24gYXJndW1lbnQuXG5cdCAgICAvLyBJdCByZXBsYWNlcyBldmVyeSBfLCAtLCBhbmQgKyB3aXRoIGEgZG90LlxuXHQgICAgLy8gSXQgc3Vycm91bmRzIGFueSBub25zZXF1ZW5jZSBvZiBudW1iZXJzL2RvdHMgd2l0aCBkb3RzLlxuXHQgICAgLy8gSXQgcmVwbGFjZXMgc2VxdWVuY2VzIG9mIGRvdHMgd2l0aCBhIHNpbmdsZSBkb3QuXG5cdCAgICAvLyAgICB2ZXJzaW9uX2NvbXBhcmUoJzQuLjAnLCAnNC4wJykgPT0gMFxuXHQgICAgLy8gSW1wb3J0YW50OiBBIHN0cmluZyBvZiAwIGxlbmd0aCBuZWVkcyB0byBiZSBjb252ZXJ0ZWQgaW50byBhIHZhbHVlXG5cdCAgICAvLyBldmVuIGxlc3MgdGhhbiBhbiB1bmV4aXN0aW5nIHZhbHVlIGluIHZtICgtNyksIGhlbmNlIFstOF0uXG5cdCAgICAvLyBJdCdzIGFsc28gaW1wb3J0YW50IHRvIG5vdCBzdHJpcCBzcGFjZXMgYmVjYXVzZSBvZiB0aGlzLlxuXHQgICAgLy8gICB2ZXJzaW9uX2NvbXBhcmUoJycsICcgJykgPT0gMVxuXHQgICAgcHJlcFZlcnNpb24gPSBmdW5jdGlvbiAodikge1xuXHQgICAgICB2ID0gKCcnICsgdikucmVwbGFjZSgvW19cXC0rXS9nLCAnLicpO1xuXHQgICAgICB2ID0gdi5yZXBsYWNlKC8oW14uXFxkXSspL2csICcuJDEuJykucmVwbGFjZSgvXFwuezIsfS9nLCAnLicpO1xuXHQgICAgICByZXR1cm4gKCF2Lmxlbmd0aCA/IFstOF0gOiB2LnNwbGl0KCcuJykpO1xuXHQgICAgfSxcblx0ICAgIC8vIFRoaXMgY29udmVydHMgYSB2ZXJzaW9uIGNvbXBvbmVudCB0byBhIG51bWJlci5cblx0ICAgIC8vIEVtcHR5IGNvbXBvbmVudCBiZWNvbWVzIDAuXG5cdCAgICAvLyBOb24tbnVtZXJpY2FsIGNvbXBvbmVudCBiZWNvbWVzIGEgbmVnYXRpdmUgbnVtYmVyLlxuXHQgICAgLy8gTnVtZXJpY2FsIGNvbXBvbmVudCBiZWNvbWVzIGl0c2VsZiBhcyBhbiBpbnRlZ2VyLlxuXHQgICAgbnVtVmVyc2lvbiA9IGZ1bmN0aW9uICh2KSB7XG5cdCAgICAgIHJldHVybiAhdiA/IDAgOiAoaXNOYU4odikgPyB2bVt2XSB8fCAtNyA6IHBhcnNlSW50KHYsIDEwKSk7XG5cdCAgICB9O1xuXG5cdCAgdjEgPSBwcmVwVmVyc2lvbih2MSk7XG5cdCAgdjIgPSBwcmVwVmVyc2lvbih2Mik7XG5cdCAgeCA9IE1hdGgubWF4KHYxLmxlbmd0aCwgdjIubGVuZ3RoKTtcblx0ICBmb3IgKGkgPSAwOyBpIDwgeDsgaSsrKSB7XG5cdCAgICBpZiAodjFbaV0gPT0gdjJbaV0pIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICB2MVtpXSA9IG51bVZlcnNpb24odjFbaV0pO1xuXHQgICAgdjJbaV0gPSBudW1WZXJzaW9uKHYyW2ldKTtcblx0ICAgIGlmICh2MVtpXSA8IHYyW2ldKSB7XG5cdCAgICAgIGNvbXBhcmUgPSAtMTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICB9IGVsc2UgaWYgKHYxW2ldID4gdjJbaV0pIHtcblx0ICAgICAgY29tcGFyZSA9IDE7XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgfVxuXHQgIH1cblx0ICBpZiAoIW9wZXJhdG9yKSB7XG5cdCAgICByZXR1cm4gY29tcGFyZTtcblx0ICB9XG5cblx0ICAvLyBJbXBvcnRhbnQ6IG9wZXJhdG9yIGlzIENBU0UtU0VOU0lUSVZFLlxuXHQgIC8vIFwiTm8gb3BlcmF0b3JcIiBzZWVtcyB0byBiZSB0cmVhdGVkIGFzIFwiPC5cIlxuXHQgIC8vIEFueSBvdGhlciB2YWx1ZXMgc2VlbSB0byBtYWtlIHRoZSBmdW5jdGlvbiByZXR1cm4gbnVsbC5cblx0ICBzd2l0Y2ggKG9wZXJhdG9yKSB7XG5cdCAgY2FzZSAnPic6XG5cdCAgY2FzZSAnZ3QnOlxuXHQgICAgcmV0dXJuIChjb21wYXJlID4gMCk7XG5cdCAgY2FzZSAnPj0nOlxuXHQgIGNhc2UgJ2dlJzpcblx0ICAgIHJldHVybiAoY29tcGFyZSA+PSAwKTtcblx0ICBjYXNlICc8PSc6XG5cdCAgY2FzZSAnbGUnOlxuXHQgICAgcmV0dXJuIChjb21wYXJlIDw9IDApO1xuXHQgIGNhc2UgJz09Jzpcblx0ICBjYXNlICc9Jzpcblx0ICBjYXNlICdlcSc6XG5cdCAgICByZXR1cm4gKGNvbXBhcmUgPT09IDApO1xuXHQgIGNhc2UgJzw+Jzpcblx0ICBjYXNlICchPSc6XG5cdCAgY2FzZSAnbmUnOlxuXHQgICAgcmV0dXJuIChjb21wYXJlICE9PSAwKTtcblx0ICBjYXNlICcnOlxuXHQgIGNhc2UgJzwnOlxuXHQgIGNhc2UgJ2x0Jzpcblx0ICAgIHJldHVybiAoY29tcGFyZSA8IDApO1xuXHQgIGRlZmF1bHQ6XG5cdCAgICByZXR1cm4gbnVsbDtcblx0ICB9XG5cdH1cblxuXG5cdHZhciBjYW4gPSAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGNhcHMgPSB7XG5cdFx0XHRhY2Nlc3NfZ2xvYmFsX25zOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJldHVybiAhIXdpbmRvdy5tb3hpZTtcblx0XHRcdH0sXG5cblx0XHRcdGRlZmluZV9wcm9wZXJ0eTogKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvKiAvLyBjdXJyZW50bHkgdG9vIG11Y2ggZXh0cmEgY29kZSByZXF1aXJlZCwgbm90IGV4YWN0bHkgd29ydGggaXRcblx0XHRcdFx0dHJ5IHsgLy8gYXMgb2YgSUU4LCBnZXR0ZXJzL3NldHRlcnMgYXJlIHN1cHBvcnRlZCBvbmx5IG9uIERPTSBlbGVtZW50c1xuXHRcdFx0XHRcdHZhciBvYmogPSB7fTtcblx0XHRcdFx0XHRpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7XG5cdFx0XHRcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCAncHJvcCcsIHtcblx0XHRcdFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaChleCkge31cblxuXHRcdFx0XHRpZiAoT2JqZWN0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fICYmIE9iamVjdC5wcm90b3R5cGUuX19kZWZpbmVTZXR0ZXJfXykge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9Ki9cblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSgpKSxcblxuXHRcdFx0Y3JlYXRlX2NhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIE9uIHRoZSBTNjAgYW5kIEJCIFN0b3JtLCBnZXRDb250ZXh0IGV4aXN0cywgYnV0IGFsd2F5cyByZXR1cm5zIHVuZGVmaW5lZFxuXHRcdFx0XHQvLyBzbyB3ZSBhY3R1YWxseSBoYXZlIHRvIGNhbGwgZ2V0Q29udGV4dCgpIHRvIHZlcmlmeVxuXHRcdFx0XHQvLyBnaXRodWIuY29tL01vZGVybml6ci9Nb2Rlcm5penIvaXNzdWVzL2lzc3VlLzk3L1xuXHRcdFx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdFx0dmFyIGlzU3VwcG9ydGVkID0gISEoZWwuZ2V0Q29udGV4dCAmJiBlbC5nZXRDb250ZXh0KCcyZCcpKTtcblx0XHRcdFx0Y2Fwcy5jcmVhdGVfY2FudmFzID0gaXNTdXBwb3J0ZWQ7XG5cdFx0XHRcdHJldHVybiBpc1N1cHBvcnRlZDtcblx0XHRcdH0sXG5cblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRpZiAoQmFzaWMuaW5BcnJheShyZXNwb25zZVR5cGUsIFsnJywgJ3RleHQnLCAnZG9jdW1lbnQnXSkgIT09IC0xKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCkge1xuXHRcdFx0XHRcdFx0dmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdFx0XHRcdFx0eGhyLm9wZW4oJ2dldCcsICcvJyk7IC8vIG90aGVyd2lzZSBHZWNrbyB0aHJvd3MgYW4gZXhjZXB0aW9uXG5cdFx0XHRcdFx0XHRpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyKSB7XG5cdFx0XHRcdFx0XHRcdHhoci5yZXNwb25zZVR5cGUgPSByZXNwb25zZVR5cGU7XG5cdFx0XHRcdFx0XHRcdC8vIGFzIG9mIDIzLjAuMTI3MS42NCwgQ2hyb21lIHN3aXRjaGVkIGZyb20gdGhyb3dpbmcgZXhjZXB0aW9uIHRvIG1lcmVseSBsb2dnaW5nIGl0IHRvIHRoZSBjb25zb2xlICh3aHk/IG8gd2h5Pylcblx0XHRcdFx0XHRcdFx0aWYgKHhoci5yZXNwb25zZVR5cGUgIT09IHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGV4KSB7fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9LFxuXG5cdFx0XHR1c2VfYmxvYl91cmk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgVVJMID0gd2luZG93LlVSTDtcblx0XHRcdFx0Y2Fwcy51c2VfYmxvYl91cmkgPSAoVVJMICYmXG5cdFx0XHRcdFx0J2NyZWF0ZU9iamVjdFVSTCcgaW4gVVJMICYmXG5cdFx0XHRcdFx0J3Jldm9rZU9iamVjdFVSTCcgaW4gVVJMICYmXG5cdFx0XHRcdFx0KEVudi5icm93c2VyICE9PSAnSUUnIHx8IEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAnMTEuMC40NicsICc+PScpKSAvLyBJRSBzdXBwb3J0cyBjcmVhdGVPYmplY3RVUkwsIGJ1dCBub3QgZnVsbHksIGZvciBleGFtcGxlIGl0IGZhaWxzIHRvIHVzZSBpdCBhcyBhIHNyYyBmb3IgdGhlIGltYWdlXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHJldHVybiBjYXBzLnVzZV9ibG9iX3VyaTtcblx0XHRcdH0sXG5cblx0XHRcdC8vIGlkZWFzIGZvciB0aGlzIGhlYXZpbHkgY29tZSBmcm9tIE1vZGVybml6ciAoaHR0cDovL21vZGVybml6ci5jb20vKVxuXHRcdFx0dXNlX2RhdGFfdXJpOiAoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBkdSA9IG5ldyBJbWFnZSgpO1xuXG5cdFx0XHRcdGR1Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNhcHMudXNlX2RhdGFfdXJpID0gKGR1LndpZHRoID09PSAxICYmIGR1LmhlaWdodCA9PT0gMSk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkdS5zcmMgPSBcImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQVA4QUFBQUFBQ0g1QkFBQUFBQUFMQUFBQUFBQkFBRUFBQUlDUkFFQU93PT1cIjtcblx0XHRcdFx0fSwgMSk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0oKSksXG5cblx0XHRcdHVzZV9kYXRhX3VyaV9vdmVyMzJrYjogZnVuY3Rpb24oKSB7IC8vIElFOFxuXHRcdFx0XHRyZXR1cm4gY2Fwcy51c2VfZGF0YV91cmkgJiYgKEVudi5icm93c2VyICE9PSAnSUUnIHx8IEVudi52ZXJzaW9uID49IDkpO1xuXHRcdFx0fSxcblxuXHRcdFx0dXNlX2RhdGFfdXJpX29mOiBmdW5jdGlvbihieXRlcykge1xuXHRcdFx0XHRyZXR1cm4gKGNhcHMudXNlX2RhdGFfdXJpICYmIGJ5dGVzIDwgMzMwMDAgfHwgY2Fwcy51c2VfZGF0YV91cmlfb3ZlcjMya2IoKSk7XG5cdFx0XHR9LFxuXG5cdFx0XHR1c2VfZmlsZWlucHV0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goLyhBbmRyb2lkICgxLjB8MS4xfDEuNXwxLjZ8Mi4wfDIuMSkpfChXaW5kb3dzIFBob25lIChPUyA3fDguMCkpfChYQkxXUCl8KFp1bmVXUCl8KHcoZWIpP09TQnJvd3Nlcil8KHdlYk9TKXwoS2luZGxlXFwvKDEuMHwyLjB8Mi41fDMuMCkpLykpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuXHRcdFx0XHRlbC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnZmlsZScpO1xuXHRcdFx0XHRyZXR1cm4gY2Fwcy51c2VfZmlsZWlucHV0ID0gIWVsLmRpc2FibGVkO1xuXHRcdFx0fSxcblxuXHRcdFx0dXNlX3dlYmdsOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHRcdFx0XHR2YXIgZ2wgPSBudWxsLCBpc1N1cHBvcnRlZDtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRnbCA9IGNhbnZhcy5nZXRDb250ZXh0KFwid2ViZ2xcIikgfHwgY2FudmFzLmdldENvbnRleHQoXCJleHBlcmltZW50YWwtd2ViZ2xcIik7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y2F0Y2goZSkge31cblxuXHRcdFx0XHRpZiAoIWdsKSB7IC8vIGl0IHNlZW1zIHRoYXQgc29tZXRpbWVzIGl0IGRvZXNuJ3QgdGhyb3cgZXhjZXB0aW9uLCBidXQgc3RpbGwgZmFpbHMgdG8gZ2V0IGNvbnRleHRcblx0XHRcdFx0XHRnbCA9IG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpc1N1cHBvcnRlZCA9ICEhZ2w7XG5cdFx0XHRcdGNhcHMudXNlX3dlYmdsID0gaXNTdXBwb3J0ZWQ7IC8vIHNhdmUgcmVzdWx0IG9mIG91ciBjaGVja1xuXHRcdFx0XHRjYW52YXMgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdHJldHVybiBpc1N1cHBvcnRlZDtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKGNhcCkge1xuXHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cdFx0XHRhcmdzLnNoaWZ0KCk7IC8vIHNoaWZ0IG9mIGNhcFxuXHRcdFx0cmV0dXJuIEJhc2ljLnR5cGVPZihjYXBzW2NhcF0pID09PSAnZnVuY3Rpb24nID8gY2Fwc1tjYXBdLmFwcGx5KHRoaXMsIGFyZ3MpIDogISFjYXBzW2NhcF07XG5cdFx0fTtcblx0fSgpKTtcblxuXG5cdHZhciB1YVJlc3VsdCA9IG5ldyBVQVBhcnNlcigpLmdldFJlc3VsdCgpO1xuXG5cblx0dmFyIEVudiA9IHtcblx0XHRjYW46IGNhbixcblxuXHRcdHVhUGFyc2VyOiBVQVBhcnNlcixcblxuXHRcdGJyb3dzZXI6IHVhUmVzdWx0LmJyb3dzZXIubmFtZSxcblx0XHR2ZXJzaW9uOiB1YVJlc3VsdC5icm93c2VyLnZlcnNpb24sXG5cdFx0b3M6IHVhUmVzdWx0Lm9zLm5hbWUsIC8vIGV2ZXJ5Ym9keSBpbnR1aXRpdmVseSB0eXBlcyBpdCBpbiBhIGxvd2VyY2FzZSBmb3Igc29tZSByZWFzb25cblx0XHRvc1ZlcnNpb246IHVhUmVzdWx0Lm9zLnZlcnNpb24sXG5cblx0XHR2ZXJDb21wOiB2ZXJzaW9uX2NvbXBhcmUsXG5cblx0XHRzd2ZfdXJsOiBcIi4uL2ZsYXNoL01veGllLnN3ZlwiLFxuXHRcdHhhcF91cmw6IFwiLi4vc2lsdmVybGlnaHQvTW94aWUueGFwXCIsXG5cdFx0Z2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXI6IFwibW94aWUuY29yZS5FdmVudFRhcmdldC5pbnN0YW5jZS5kaXNwYXRjaEV2ZW50XCJcblx0fTtcblxuXHQvLyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuXHQvLyBAZGVwcmVjYXRlZCBVc2UgYEVudi5vc2AgaW5zdGVhZFxuXHRFbnYuT1MgPSBFbnYub3M7XG5cblx0aWYgKE1YSV9ERUJVRykge1xuXHRcdEVudi5kZWJ1ZyA9IHtcblx0XHRcdHJ1bnRpbWU6IHRydWUsXG5cdFx0XHRldmVudHM6IGZhbHNlXG5cdFx0fTtcblxuXHRcdEVudi5sb2cgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0ZnVuY3Rpb24gbG9nT2JqKGRhdGEpIHtcblx0XHRcdFx0Ly8gVE9ETzogdGhpcyBzaG91bGQgcmVjdXJzaXZlbHkgcHJpbnQgb3V0IHRoZSBvYmplY3QgaW4gYSBwcmV0dHkgd2F5XG5cdFx0XHRcdGNvbnNvbGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGF0YSArIFwiXFxuXCIpKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gaWYgZGVidWdnZXIgcHJlc2VudCwgSUU4IG1pZ2h0IGhhdmUgd2luZG93LmNvbnNvbGUubG9nIG1ldGhvZCwgYnV0IG5vdCBiZSBhYmxlIHRvIGFwcGx5IG9uIGl0ICh3aHkuLi4pXG5cdFx0XHRpZiAod2luZG93ICYmIHdpbmRvdy5jb25zb2xlICYmIHdpbmRvdy5jb25zb2xlLmxvZyAmJiB3aW5kb3cuY29uc29sZS5sb2cuYXBwbHkpIHtcblx0XHRcdFx0d2luZG93LmNvbnNvbGUubG9nLmFwcGx5KHdpbmRvdy5jb25zb2xlLCBhcmd1bWVudHMpO1xuXHRcdFx0fSBlbHNlIGlmIChkb2N1bWVudCkge1xuXHRcdFx0XHR2YXIgY29uc29sZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb3hpZS1jb25zb2xlJyk7XG5cdFx0XHRcdGlmICghY29uc29sZSkge1xuXHRcdFx0XHRcdGNvbnNvbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwcmUnKTtcblx0XHRcdFx0XHRjb25zb2xlLmlkID0gJ21veGllLWNvbnNvbGUnO1xuXHRcdFx0XHRcdC8vY29uc29sZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29uc29sZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgZGF0YSA9IGFyZ3VtZW50c1swXTtcblx0XHRcdFx0aWYgKEJhc2ljLnR5cGVPZihkYXRhKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRkYXRhID0gQmFzaWMuc3ByaW50Zi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKEJhc2ljLmluQXJyYXkoQmFzaWMudHlwZU9mKGRhdGEpLCBbJ29iamVjdCcsICdhcnJheSddKSAhPT0gLTEpIHtcblx0XHRcdFx0XHRsb2dPYmooZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc29sZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhICsgXCJcXG5cIikpO1xuXHRcdFx0fVxuXHRcdH07XG5cdH1cblxuXHRyZXR1cm4gRW52O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2NvcmUvRXhjZXB0aW9ucy5qc1xuXG4vKipcbiAqIEV4Y2VwdGlvbnMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9jb3JlL0V4Y2VwdGlvbnMnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJ1xuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblx0XG5cdGZ1bmN0aW9uIF9maW5kS2V5KG9iaiwgdmFsdWUpIHtcblx0XHR2YXIga2V5O1xuXHRcdGZvciAoa2V5IGluIG9iaikge1xuXHRcdFx0aWYgKG9ialtrZXldID09PSB2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4ga2V5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHRAY2xhc3MgbW94aWUvY29yZS9FeGNlcHRpb25cblx0Ki9cblx0cmV0dXJuIHtcblx0XHRSdW50aW1lRXJyb3I6IChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBuYW1lY29kZXMgPSB7XG5cdFx0XHRcdE5PVF9JTklUX0VSUjogMSxcblx0XHRcdFx0RVhDRVBUSU9OX0VSUjogMyxcblx0XHRcdFx0Tk9UX1NVUFBPUlRFRF9FUlI6IDksXG5cdFx0XHRcdEpTX0VSUjogNFxuXHRcdFx0fTtcblxuXHRcdFx0ZnVuY3Rpb24gUnVudGltZUVycm9yKGNvZGUsIG1lc3NhZ2UpIHtcblx0XHRcdFx0dGhpcy5jb2RlID0gY29kZTtcblx0XHRcdFx0dGhpcy5uYW1lID0gX2ZpbmRLZXkobmFtZWNvZGVzLCBjb2RlKTtcblx0XHRcdFx0dGhpcy5tZXNzYWdlID0gdGhpcy5uYW1lICsgKG1lc3NhZ2UgfHwgXCI6IFJ1bnRpbWVFcnJvciBcIiArIHRoaXMuY29kZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdEJhc2ljLmV4dGVuZChSdW50aW1lRXJyb3IsIG5hbWVjb2Rlcyk7XG5cdFx0XHRSdW50aW1lRXJyb3IucHJvdG90eXBlID0gRXJyb3IucHJvdG90eXBlO1xuXHRcdFx0cmV0dXJuIFJ1bnRpbWVFcnJvcjtcblx0XHR9KCkpLFxuXHRcdFxuXHRcdE9wZXJhdGlvbk5vdEFsbG93ZWRFeGNlcHRpb246IChmdW5jdGlvbigpIHtcblx0XHRcdFxuXHRcdFx0ZnVuY3Rpb24gT3BlcmF0aW9uTm90QWxsb3dlZEV4Y2VwdGlvbihjb2RlKSB7XG5cdFx0XHRcdHRoaXMuY29kZSA9IGNvZGU7XG5cdFx0XHRcdHRoaXMubmFtZSA9ICdPcGVyYXRpb25Ob3RBbGxvd2VkRXhjZXB0aW9uJztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0QmFzaWMuZXh0ZW5kKE9wZXJhdGlvbk5vdEFsbG93ZWRFeGNlcHRpb24sIHtcblx0XHRcdFx0Tk9UX0FMTE9XRURfRVJSOiAxXG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0T3BlcmF0aW9uTm90QWxsb3dlZEV4Y2VwdGlvbi5wcm90b3R5cGUgPSBFcnJvci5wcm90b3R5cGU7XG5cdFx0XHRcblx0XHRcdHJldHVybiBPcGVyYXRpb25Ob3RBbGxvd2VkRXhjZXB0aW9uO1xuXHRcdH0oKSksXG5cblx0XHRJbWFnZUVycm9yOiAoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmFtZWNvZGVzID0ge1xuXHRcdFx0XHRXUk9OR19GT1JNQVQ6IDEsXG5cdFx0XHRcdE1BWF9SRVNPTFVUSU9OX0VSUjogMixcblx0XHRcdFx0SU5WQUxJRF9NRVRBX0VSUjogM1xuXHRcdFx0fTtcblxuXHRcdFx0ZnVuY3Rpb24gSW1hZ2VFcnJvcihjb2RlKSB7XG5cdFx0XHRcdHRoaXMuY29kZSA9IGNvZGU7XG5cdFx0XHRcdHRoaXMubmFtZSA9IF9maW5kS2V5KG5hbWVjb2RlcywgY29kZSk7XG5cdFx0XHRcdHRoaXMubWVzc2FnZSA9IHRoaXMubmFtZSArIFwiOiBJbWFnZUVycm9yIFwiICsgdGhpcy5jb2RlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoSW1hZ2VFcnJvciwgbmFtZWNvZGVzKTtcblx0XHRcdEltYWdlRXJyb3IucHJvdG90eXBlID0gRXJyb3IucHJvdG90eXBlO1xuXG5cdFx0XHRyZXR1cm4gSW1hZ2VFcnJvcjtcblx0XHR9KCkpLFxuXG5cdFx0RmlsZUV4Y2VwdGlvbjogKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5hbWVjb2RlcyA9IHtcblx0XHRcdFx0Tk9UX0ZPVU5EX0VSUjogMSxcblx0XHRcdFx0U0VDVVJJVFlfRVJSOiAyLFxuXHRcdFx0XHRBQk9SVF9FUlI6IDMsXG5cdFx0XHRcdE5PVF9SRUFEQUJMRV9FUlI6IDQsXG5cdFx0XHRcdEVOQ09ESU5HX0VSUjogNSxcblx0XHRcdFx0Tk9fTU9ESUZJQ0FUSU9OX0FMTE9XRURfRVJSOiA2LFxuXHRcdFx0XHRJTlZBTElEX1NUQVRFX0VSUjogNyxcblx0XHRcdFx0U1lOVEFYX0VSUjogOFxuXHRcdFx0fTtcblxuXHRcdFx0ZnVuY3Rpb24gRmlsZUV4Y2VwdGlvbihjb2RlKSB7XG5cdFx0XHRcdHRoaXMuY29kZSA9IGNvZGU7XG5cdFx0XHRcdHRoaXMubmFtZSA9IF9maW5kS2V5KG5hbWVjb2RlcywgY29kZSk7XG5cdFx0XHRcdHRoaXMubWVzc2FnZSA9IHRoaXMubmFtZSArIFwiOiBGaWxlRXhjZXB0aW9uIFwiICsgdGhpcy5jb2RlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoRmlsZUV4Y2VwdGlvbiwgbmFtZWNvZGVzKTtcblx0XHRcdEZpbGVFeGNlcHRpb24ucHJvdG90eXBlID0gRXJyb3IucHJvdG90eXBlO1xuXHRcdFx0cmV0dXJuIEZpbGVFeGNlcHRpb247XG5cdFx0fSgpKSxcblx0XHRcblx0XHRET01FeGNlcHRpb246IChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBuYW1lY29kZXMgPSB7XG5cdFx0XHRcdElOREVYX1NJWkVfRVJSOiAxLFxuXHRcdFx0XHRET01TVFJJTkdfU0laRV9FUlI6IDIsXG5cdFx0XHRcdEhJRVJBUkNIWV9SRVFVRVNUX0VSUjogMyxcblx0XHRcdFx0V1JPTkdfRE9DVU1FTlRfRVJSOiA0LFxuXHRcdFx0XHRJTlZBTElEX0NIQVJBQ1RFUl9FUlI6IDUsXG5cdFx0XHRcdE5PX0RBVEFfQUxMT1dFRF9FUlI6IDYsXG5cdFx0XHRcdE5PX01PRElGSUNBVElPTl9BTExPV0VEX0VSUjogNyxcblx0XHRcdFx0Tk9UX0ZPVU5EX0VSUjogOCxcblx0XHRcdFx0Tk9UX1NVUFBPUlRFRF9FUlI6IDksXG5cdFx0XHRcdElOVVNFX0FUVFJJQlVURV9FUlI6IDEwLFxuXHRcdFx0XHRJTlZBTElEX1NUQVRFX0VSUjogMTEsXG5cdFx0XHRcdFNZTlRBWF9FUlI6IDEyLFxuXHRcdFx0XHRJTlZBTElEX01PRElGSUNBVElPTl9FUlI6IDEzLFxuXHRcdFx0XHROQU1FU1BBQ0VfRVJSOiAxNCxcblx0XHRcdFx0SU5WQUxJRF9BQ0NFU1NfRVJSOiAxNSxcblx0XHRcdFx0VkFMSURBVElPTl9FUlI6IDE2LFxuXHRcdFx0XHRUWVBFX01JU01BVENIX0VSUjogMTcsXG5cdFx0XHRcdFNFQ1VSSVRZX0VSUjogMTgsXG5cdFx0XHRcdE5FVFdPUktfRVJSOiAxOSxcblx0XHRcdFx0QUJPUlRfRVJSOiAyMCxcblx0XHRcdFx0VVJMX01JU01BVENIX0VSUjogMjEsXG5cdFx0XHRcdFFVT1RBX0VYQ0VFREVEX0VSUjogMjIsXG5cdFx0XHRcdFRJTUVPVVRfRVJSOiAyMyxcblx0XHRcdFx0SU5WQUxJRF9OT0RFX1RZUEVfRVJSOiAyNCxcblx0XHRcdFx0REFUQV9DTE9ORV9FUlI6IDI1XG5cdFx0XHR9O1xuXG5cdFx0XHRmdW5jdGlvbiBET01FeGNlcHRpb24oY29kZSkge1xuXHRcdFx0XHR0aGlzLmNvZGUgPSBjb2RlO1xuXHRcdFx0XHR0aGlzLm5hbWUgPSBfZmluZEtleShuYW1lY29kZXMsIGNvZGUpO1xuXHRcdFx0XHR0aGlzLm1lc3NhZ2UgPSB0aGlzLm5hbWUgKyBcIjogRE9NRXhjZXB0aW9uIFwiICsgdGhpcy5jb2RlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoRE9NRXhjZXB0aW9uLCBuYW1lY29kZXMpO1xuXHRcdFx0RE9NRXhjZXB0aW9uLnByb3RvdHlwZSA9IEVycm9yLnByb3RvdHlwZTtcblx0XHRcdHJldHVybiBET01FeGNlcHRpb247XG5cdFx0fSgpKSxcblx0XHRcblx0XHRFdmVudEV4Y2VwdGlvbjogKGZ1bmN0aW9uKCkge1xuXHRcdFx0ZnVuY3Rpb24gRXZlbnRFeGNlcHRpb24oY29kZSkge1xuXHRcdFx0XHR0aGlzLmNvZGUgPSBjb2RlO1xuXHRcdFx0XHR0aGlzLm5hbWUgPSAnRXZlbnRFeGNlcHRpb24nO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoRXZlbnRFeGNlcHRpb24sIHtcblx0XHRcdFx0VU5TUEVDSUZJRURfRVZFTlRfVFlQRV9FUlI6IDBcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRFdmVudEV4Y2VwdGlvbi5wcm90b3R5cGUgPSBFcnJvci5wcm90b3R5cGU7XG5cdFx0XHRcblx0XHRcdHJldHVybiBFdmVudEV4Y2VwdGlvbjtcblx0XHR9KCkpXG5cdH07XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvY29yZS91dGlscy9Eb20uanNcblxuLyoqXG4gKiBEb20uanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvY29yZS91dGlscy9Eb21cbkBwdWJsaWNcbkBzdGF0aWNcbiovXG5cbmRlZmluZSgnbW94aWUvY29yZS91dGlscy9Eb20nLCBbJ21veGllL2NvcmUvdXRpbHMvRW52J10sIGZ1bmN0aW9uKEVudikge1xuXG5cdC8qKlxuXHRHZXQgRE9NIEVsZW1lbnQgYnkgaXQncyBpZC5cblxuXHRAbWV0aG9kIGdldFxuXHRAcGFyYW0ge1N0cmluZ30gaWQgSWRlbnRpZmllciBvZiB0aGUgRE9NIEVsZW1lbnRcblx0QHJldHVybiB7RE9NRWxlbWVudH1cblx0Ki9cblx0dmFyIGdldCA9IGZ1bmN0aW9uKGlkKSB7XG5cdFx0aWYgKHR5cGVvZiBpZCAhPT0gJ3N0cmluZycpIHtcblx0XHRcdHJldHVybiBpZDtcblx0XHR9XG5cdFx0cmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcblx0fTtcblxuXHQvKipcblx0Q2hlY2tzIGlmIHNwZWNpZmllZCBET00gZWxlbWVudCBoYXMgc3BlY2lmaWVkIGNsYXNzLlxuXG5cdEBtZXRob2QgaGFzQ2xhc3Ncblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IGxpa2Ugb2JqZWN0IHRvIGFkZCBoYW5kbGVyIHRvLlxuXHRAcGFyYW0ge1N0cmluZ30gbmFtZSBDbGFzcyBuYW1lXG5cdCovXG5cdHZhciBoYXNDbGFzcyA9IGZ1bmN0aW9uKG9iaiwgbmFtZSkge1xuXHRcdGlmICghb2JqLmNsYXNzTmFtZSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHZhciByZWdFeHAgPSBuZXcgUmVnRXhwKFwiKF58XFxcXHMrKVwiK25hbWUrXCIoXFxcXHMrfCQpXCIpO1xuXHRcdHJldHVybiByZWdFeHAudGVzdChvYmouY2xhc3NOYW1lKTtcblx0fTtcblxuXHQvKipcblx0QWRkcyBzcGVjaWZpZWQgY2xhc3NOYW1lIHRvIHNwZWNpZmllZCBET00gZWxlbWVudC5cblxuXHRAbWV0aG9kIGFkZENsYXNzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgQ2xhc3MgbmFtZVxuXHQqL1xuXHR2YXIgYWRkQ2xhc3MgPSBmdW5jdGlvbihvYmosIG5hbWUpIHtcblx0XHRpZiAoIWhhc0NsYXNzKG9iaiwgbmFtZSkpIHtcblx0XHRcdG9iai5jbGFzc05hbWUgPSAhb2JqLmNsYXNzTmFtZSA/IG5hbWUgOiBvYmouY2xhc3NOYW1lLnJlcGxhY2UoL1xccyskLywgJycpICsgJyAnICsgbmFtZTtcblx0XHR9XG5cdH07XG5cblx0LyoqXG5cdFJlbW92ZXMgc3BlY2lmaWVkIGNsYXNzTmFtZSBmcm9tIHNwZWNpZmllZCBET00gZWxlbWVudC5cblxuXHRAbWV0aG9kIHJlbW92ZUNsYXNzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgQ2xhc3MgbmFtZVxuXHQqL1xuXHR2YXIgcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihvYmosIG5hbWUpIHtcblx0XHRpZiAob2JqLmNsYXNzTmFtZSkge1xuXHRcdFx0dmFyIHJlZ0V4cCA9IG5ldyBSZWdFeHAoXCIoXnxcXFxccyspXCIrbmFtZStcIihcXFxccyt8JClcIik7XG5cdFx0XHRvYmouY2xhc3NOYW1lID0gb2JqLmNsYXNzTmFtZS5yZXBsYWNlKHJlZ0V4cCwgZnVuY3Rpb24oJDAsICQxLCAkMikge1xuXHRcdFx0XHRyZXR1cm4gJDEgPT09ICcgJyAmJiAkMiA9PT0gJyAnID8gJyAnIDogJyc7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0LyoqXG5cdFJldHVybnMgYSBnaXZlbiBjb21wdXRlZCBzdHlsZSBvZiBhIERPTSBlbGVtZW50LlxuXG5cdEBtZXRob2QgZ2V0U3R5bGVcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IGxpa2Ugb2JqZWN0LlxuXHRAcGFyYW0ge1N0cmluZ30gbmFtZSBTdHlsZSB5b3Ugd2FudCB0byBnZXQgZnJvbSB0aGUgRE9NIGVsZW1lbnRcblx0Ki9cblx0dmFyIGdldFN0eWxlID0gZnVuY3Rpb24ob2JqLCBuYW1lKSB7XG5cdFx0aWYgKG9iai5jdXJyZW50U3R5bGUpIHtcblx0XHRcdHJldHVybiBvYmouY3VycmVudFN0eWxlW25hbWVdO1xuXHRcdH0gZWxzZSBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcblx0XHRcdHJldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShvYmosIG51bGwpW25hbWVdO1xuXHRcdH1cblx0fTtcblxuXG5cdC8qKlxuXHRSZXR1cm5zIHRoZSBhYnNvbHV0ZSB4LCB5IHBvc2l0aW9uIG9mIGFuIEVsZW1lbnQuIFRoZSBwb3NpdGlvbiB3aWxsIGJlIHJldHVybmVkIGluIGEgb2JqZWN0IHdpdGggeCwgeSBmaWVsZHMuXG5cblx0QG1ldGhvZCBnZXRQb3Ncblx0QHN0YXRpY1xuXHRAcGFyYW0ge0VsZW1lbnR9IG5vZGUgSFRNTCBlbGVtZW50IG9yIGVsZW1lbnQgaWQgdG8gZ2V0IHgsIHkgcG9zaXRpb24gZnJvbS5cblx0QHBhcmFtIHtFbGVtZW50fSByb290IE9wdGlvbmFsIHJvb3QgZWxlbWVudCB0byBzdG9wIGNhbGN1bGF0aW9ucyBhdC5cblx0QHJldHVybiB7b2JqZWN0fSBBYnNvbHV0ZSBwb3NpdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgb2JqZWN0IHdpdGggeCwgeSBmaWVsZHMuXG5cdCovXG5cdHZhciBnZXRQb3MgPSBmdW5jdGlvbihub2RlLCByb290KSB7XG5cdFx0dmFyIHggPSAwLCB5ID0gMCwgcGFyZW50LCBkb2MgPSBkb2N1bWVudCwgbm9kZVJlY3QsIHJvb3RSZWN0O1xuXG5cdFx0bm9kZSA9IG5vZGU7XG5cdFx0cm9vdCA9IHJvb3QgfHwgZG9jLmJvZHk7XG5cblx0XHQvLyBSZXR1cm5zIHRoZSB4LCB5IGNvcmRpbmF0ZSBmb3IgYW4gZWxlbWVudCBvbiBJRSA2IGFuZCBJRSA3XG5cdFx0ZnVuY3Rpb24gZ2V0SUVQb3Mobm9kZSkge1xuXHRcdFx0dmFyIGJvZHlFbG0sIHJlY3QsIHggPSAwLCB5ID0gMDtcblxuXHRcdFx0aWYgKG5vZGUpIHtcblx0XHRcdFx0cmVjdCA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRcdGJvZHlFbG0gPSBkb2MuY29tcGF0TW9kZSA9PT0gXCJDU1MxQ29tcGF0XCIgPyBkb2MuZG9jdW1lbnRFbGVtZW50IDogZG9jLmJvZHk7XG5cdFx0XHRcdHggPSByZWN0LmxlZnQgKyBib2R5RWxtLnNjcm9sbExlZnQ7XG5cdFx0XHRcdHkgPSByZWN0LnRvcCArIGJvZHlFbG0uc2Nyb2xsVG9wO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4IDogeCxcblx0XHRcdFx0eSA6IHlcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Ly8gVXNlIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBvbiBJRSA2IGFuZCBJRSA3IGJ1dCBub3Qgb24gSUUgOCBpbiBzdGFuZGFyZHMgbW9kZVxuXHRcdGlmIChub2RlICYmIG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ICYmIEVudi5icm93c2VyID09PSAnSUUnICYmICghZG9jLmRvY3VtZW50TW9kZSB8fCBkb2MuZG9jdW1lbnRNb2RlIDwgOCkpIHtcblx0XHRcdG5vZGVSZWN0ID0gZ2V0SUVQb3Mobm9kZSk7XG5cdFx0XHRyb290UmVjdCA9IGdldElFUG9zKHJvb3QpO1xuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4IDogbm9kZVJlY3QueCAtIHJvb3RSZWN0LngsXG5cdFx0XHRcdHkgOiBub2RlUmVjdC55IC0gcm9vdFJlY3QueVxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRwYXJlbnQgPSBub2RlO1xuXHRcdHdoaWxlIChwYXJlbnQgJiYgcGFyZW50ICE9IHJvb3QgJiYgcGFyZW50Lm5vZGVUeXBlKSB7XG5cdFx0XHR4ICs9IHBhcmVudC5vZmZzZXRMZWZ0IHx8IDA7XG5cdFx0XHR5ICs9IHBhcmVudC5vZmZzZXRUb3AgfHwgMDtcblx0XHRcdHBhcmVudCA9IHBhcmVudC5vZmZzZXRQYXJlbnQ7XG5cdFx0fVxuXG5cdFx0cGFyZW50ID0gbm9kZS5wYXJlbnROb2RlO1xuXHRcdHdoaWxlIChwYXJlbnQgJiYgcGFyZW50ICE9IHJvb3QgJiYgcGFyZW50Lm5vZGVUeXBlKSB7XG5cdFx0XHR4IC09IHBhcmVudC5zY3JvbGxMZWZ0IHx8IDA7XG5cdFx0XHR5IC09IHBhcmVudC5zY3JvbGxUb3AgfHwgMDtcblx0XHRcdHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlO1xuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHR4IDogeCxcblx0XHRcdHkgOiB5XG5cdFx0fTtcblx0fTtcblxuXHQvKipcblx0UmV0dXJucyB0aGUgc2l6ZSBvZiB0aGUgc3BlY2lmaWVkIG5vZGUgaW4gcGl4ZWxzLlxuXG5cdEBtZXRob2QgZ2V0U2l6ZVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7Tm9kZX0gbm9kZSBOb2RlIHRvIGdldCB0aGUgc2l6ZSBvZi5cblx0QHJldHVybiB7T2JqZWN0fSBPYmplY3Qgd2l0aCBhIHcgYW5kIGggcHJvcGVydHkuXG5cdCovXG5cdHZhciBnZXRTaXplID0gZnVuY3Rpb24obm9kZSkge1xuXHRcdHJldHVybiB7XG5cdFx0XHR3IDogbm9kZS5vZmZzZXRXaWR0aCB8fCBub2RlLmNsaWVudFdpZHRoLFxuXHRcdFx0aCA6IG5vZGUub2Zmc2V0SGVpZ2h0IHx8IG5vZGUuY2xpZW50SGVpZ2h0XG5cdFx0fTtcblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdGdldDogZ2V0LFxuXHRcdGhhc0NsYXNzOiBoYXNDbGFzcyxcblx0XHRhZGRDbGFzczogYWRkQ2xhc3MsXG5cdFx0cmVtb3ZlQ2xhc3M6IHJlbW92ZUNsYXNzLFxuXHRcdGdldFN0eWxlOiBnZXRTdHlsZSxcblx0XHRnZXRQb3M6IGdldFBvcyxcblx0XHRnZXRTaXplOiBnZXRTaXplXG5cdH07XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvY29yZS9FdmVudFRhcmdldC5qc1xuXG4vKipcbiAqIEV2ZW50VGFyZ2V0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbmRlZmluZSgnbW94aWUvY29yZS9FdmVudFRhcmdldCcsIFtcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2NvcmUvRXhjZXB0aW9ucycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJ1xuXSwgZnVuY3Rpb24oRW52LCB4LCBCYXNpYykge1xuXG5cdC8vIGhhc2ggb2YgZXZlbnQgbGlzdGVuZXJzIGJ5IG9iamVjdCB1aWRcblx0dmFyIGV2ZW50cG9vbCA9IHt9O1xuXG5cdC8qKlxuXHRQYXJlbnQgb2JqZWN0IGZvciBhbGwgZXZlbnQgZGlzcGF0Y2hpbmcgY29tcG9uZW50cyBhbmQgb2JqZWN0c1xuXG5cdEBjbGFzcyBtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XG5cdEBjb25zdHJ1Y3RvciBFdmVudFRhcmdldFxuXHQqL1xuXHRmdW5jdGlvbiBFdmVudFRhcmdldCgpIHtcblx0XHQvKipcblx0XHRVbmlxdWUgaWQgb2YgdGhlIGV2ZW50IGRpc3BhdGNoZXIsIHVzdWFsbHkgb3ZlcnJpZGVuIGJ5IGNoaWxkcmVuXG5cblx0XHRAcHJvcGVydHkgdWlkXG5cdFx0QHR5cGUgU3RyaW5nXG5cdFx0Ki9cblx0XHR0aGlzLnVpZCA9IEJhc2ljLmd1aWQoKTtcblx0fVxuXG5cblx0QmFzaWMuZXh0ZW5kKEV2ZW50VGFyZ2V0LnByb3RvdHlwZSwge1xuXG5cdFx0LyoqXG5cdFx0Q2FuIGJlIGNhbGxlZCBmcm9tIHdpdGhpbiBhIGNoaWxkICBpbiBvcmRlciB0byBhY3F1aXJlIHVuaXFpZSBpZCBpbiBhdXRvbWF0ZWQgbWFubmVyXG5cblx0XHRAbWV0aG9kIGluaXRcblx0XHQqL1xuXHRcdGluaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCF0aGlzLnVpZCkge1xuXHRcdFx0XHR0aGlzLnVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0UmVnaXN0ZXIgYSBoYW5kbGVyIHRvIGEgc3BlY2lmaWMgZXZlbnQgZGlzcGF0Y2hlZCBieSB0aGUgb2JqZWN0XG5cblx0XHRAbWV0aG9kIGFkZEV2ZW50TGlzdGVuZXJcblx0XHRAcGFyYW0ge1N0cmluZ30gdHlwZSBUeXBlIG9yIGJhc2ljYWxseSBhIG5hbWUgb2YgdGhlIGV2ZW50IHRvIHN1YnNjcmliZSB0b1xuXHRcdEBwYXJhbSB7RnVuY3Rpb259IGZuIENhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiBldmVudCBoYXBwZW5zXG5cdFx0QHBhcmFtIHtOdW1iZXJ9IFtwcmlvcml0eT0wXSBQcmlvcml0eSBvZiB0aGUgZXZlbnQgaGFuZGxlciAtIGhhbmRsZXJzIHdpdGggaGlnaGVyIHByaW9yaXRpZXMgd2lsbCBiZSBjYWxsZWQgZmlyc3Rcblx0XHRAcGFyYW0ge09iamVjdH0gW3Njb3BlPXRoaXNdIEEgc2NvcGUgdG8gaW52b2tlIGV2ZW50IGhhbmRsZXIgaW5cblx0XHQqL1xuXHRcdGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKHR5cGUsIGZuLCBwcmlvcml0eSwgc2NvcGUpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcywgbGlzdDtcblxuXHRcdFx0Ly8gd2l0aG91dCB1aWQgbm8gZXZlbnQgaGFuZGxlcnMgY2FuIGJlIGFkZGVkLCBzbyBtYWtlIHN1cmUgd2UgZ290IG9uZVxuXHRcdFx0aWYgKCF0aGlzLmhhc093blByb3BlcnR5KCd1aWQnKSkge1xuXHRcdFx0XHR0aGlzLnVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblx0XHRcdH1cblxuXHRcdFx0dHlwZSA9IEJhc2ljLnRyaW0odHlwZSk7XG5cblx0XHRcdGlmICgvXFxzLy50ZXN0KHR5cGUpKSB7XG5cdFx0XHRcdC8vIG11bHRpcGxlIGV2ZW50IHR5cGVzIHdlcmUgcGFzc2VkIGZvciBvbmUgaGFuZGxlclxuXHRcdFx0XHRCYXNpYy5lYWNoKHR5cGUuc3BsaXQoL1xccysvKSwgZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0XHRcdHNlbGYuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgcHJpb3JpdHksIHNjb3BlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0dHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcblx0XHRcdHByaW9yaXR5ID0gcGFyc2VJbnQocHJpb3JpdHksIDEwKSB8fCAwO1xuXG5cdFx0XHRsaXN0ID0gZXZlbnRwb29sW3RoaXMudWlkXSAmJiBldmVudHBvb2xbdGhpcy51aWRdW3R5cGVdIHx8IFtdO1xuXHRcdFx0bGlzdC5wdXNoKHtmbiA6IGZuLCBwcmlvcml0eSA6IHByaW9yaXR5LCBzY29wZSA6IHNjb3BlIHx8IHRoaXN9KTtcblxuXHRcdFx0aWYgKCFldmVudHBvb2xbdGhpcy51aWRdKSB7XG5cdFx0XHRcdGV2ZW50cG9vbFt0aGlzLnVpZF0gPSB7fTtcblx0XHRcdH1cblx0XHRcdGV2ZW50cG9vbFt0aGlzLnVpZF1bdHlwZV0gPSBsaXN0O1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHRDaGVjayBpZiBhbnkgaGFuZGxlcnMgd2VyZSByZWdpc3RlcmVkIHRvIHRoZSBzcGVjaWZpZWQgZXZlbnRcblxuXHRcdEBtZXRob2QgaGFzRXZlbnRMaXN0ZW5lclxuXHRcdEBwYXJhbSB7U3RyaW5nfSBbdHlwZV0gVHlwZSBvciBiYXNpY2FsbHkgYSBuYW1lIG9mIHRoZSBldmVudCB0byBjaGVja1xuXHRcdEByZXR1cm4ge01peGVkfSBSZXR1cm5zIGEgaGFuZGxlciBpZiBpdCB3YXMgZm91bmQgYW5kIGZhbHNlLCBpZiAtIG5vdFxuXHRcdCovXG5cdFx0aGFzRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0dmFyIGxpc3Q7XG5cdFx0XHRpZiAodHlwZSkge1xuXHRcdFx0XHR0eXBlID0gdHlwZS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRsaXN0ID0gZXZlbnRwb29sW3RoaXMudWlkXSAmJiBldmVudHBvb2xbdGhpcy51aWRdW3R5cGVdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bGlzdCA9IGV2ZW50cG9vbFt0aGlzLnVpZF07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbGlzdCA/IGxpc3QgOiBmYWxzZTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0VW5yZWdpc3RlciB0aGUgaGFuZGxlciBmcm9tIHRoZSBldmVudCwgb3IgaWYgZm9ybWVyIHdhcyBub3Qgc3BlY2lmaWVkIC0gdW5yZWdpc3RlciBhbGwgaGFuZGxlcnNcblxuXHRcdEBtZXRob2QgcmVtb3ZlRXZlbnRMaXN0ZW5lclxuXHRcdEBwYXJhbSB7U3RyaW5nfSB0eXBlIFR5cGUgb3IgYmFzaWNhbGx5IGEgbmFtZSBvZiB0aGUgZXZlbnRcblx0XHRAcGFyYW0ge0Z1bmN0aW9ufSBbZm5dIEhhbmRsZXIgdG8gdW5yZWdpc3RlclxuXHRcdCovXG5cdFx0cmVtb3ZlRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24odHlwZSwgZm4pIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcywgbGlzdCwgaTtcblxuXHRcdFx0dHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0aWYgKC9cXHMvLnRlc3QodHlwZSkpIHtcblx0XHRcdFx0Ly8gbXVsdGlwbGUgZXZlbnQgdHlwZXMgd2VyZSBwYXNzZWQgZm9yIG9uZSBoYW5kbGVyXG5cdFx0XHRcdEJhc2ljLmVhY2godHlwZS5zcGxpdCgvXFxzKy8pLCBmdW5jdGlvbih0eXBlKSB7XG5cdFx0XHRcdFx0c2VsZi5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGZuKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0bGlzdCA9IGV2ZW50cG9vbFt0aGlzLnVpZF0gJiYgZXZlbnRwb29sW3RoaXMudWlkXVt0eXBlXTtcblxuXHRcdFx0aWYgKGxpc3QpIHtcblx0XHRcdFx0aWYgKGZuKSB7XG5cdFx0XHRcdFx0Zm9yIChpID0gbGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0XHRcdFx0aWYgKGxpc3RbaV0uZm4gPT09IGZuKSB7XG5cdFx0XHRcdFx0XHRcdGxpc3Quc3BsaWNlKGksIDEpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bGlzdCA9IFtdO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gZGVsZXRlIGV2ZW50IGxpc3QgaWYgaXQgaGFzIGJlY29tZSBlbXB0eVxuXHRcdFx0XHRpZiAoIWxpc3QubGVuZ3RoKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIGV2ZW50cG9vbFt0aGlzLnVpZF1bdHlwZV07XG5cblx0XHRcdFx0XHQvLyBhbmQgb2JqZWN0IHNwZWNpZmljIGVudHJ5IGluIGEgaGFzaCBpZiBpdCBoYXMgbm8gbW9yZSBsaXN0ZW5lcnMgYXR0YWNoZWRcblx0XHRcdFx0XHRpZiAoQmFzaWMuaXNFbXB0eU9iaihldmVudHBvb2xbdGhpcy51aWRdKSkge1xuXHRcdFx0XHRcdFx0ZGVsZXRlIGV2ZW50cG9vbFt0aGlzLnVpZF07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdFJlbW92ZSBhbGwgZXZlbnQgaGFuZGxlcnMgZnJvbSB0aGUgb2JqZWN0XG5cblx0XHRAbWV0aG9kIHJlbW92ZUFsbEV2ZW50TGlzdGVuZXJzXG5cdFx0Ki9cblx0XHRyZW1vdmVBbGxFdmVudExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoZXZlbnRwb29sW3RoaXMudWlkXSkge1xuXHRcdFx0XHRkZWxldGUgZXZlbnRwb29sW3RoaXMudWlkXTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2ggdGhlIGV2ZW50XG5cblx0XHRAbWV0aG9kIGRpc3BhdGNoRXZlbnRcblx0XHRAcGFyYW0ge1N0cmluZy9PYmplY3R9IFR5cGUgb2YgZXZlbnQgb3IgZXZlbnQgb2JqZWN0IHRvIGRpc3BhdGNoXG5cdFx0QHBhcmFtIHtNaXhlZH0gWy4uLl0gVmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cyB0byBiZSBwYXNzZWQgdG8gYSBoYW5kbGVyc1xuXHRcdEByZXR1cm4ge0Jvb2xlYW59IHRydWUgYnkgZGVmYXVsdCBhbmQgZmFsc2UgaWYgYW55IGhhbmRsZXIgcmV0dXJuZWQgZmFsc2Vcblx0XHQqL1xuXHRcdGRpc3BhdGNoRXZlbnQ6IGZ1bmN0aW9uKHR5cGUpIHtcblx0XHRcdHZhciB1aWQsIGxpc3QsIGFyZ3MsIHRtcEV2dCwgZXZ0ID0ge30sIHJlc3VsdCA9IHRydWUsIHVuZGVmO1xuXG5cdFx0XHRpZiAoQmFzaWMudHlwZU9mKHR5cGUpICE9PSAnc3RyaW5nJykge1xuXHRcdFx0XHQvLyB3ZSBjYW4ndCB1c2Ugb3JpZ2luYWwgb2JqZWN0IGRpcmVjdGx5IChiZWNhdXNlIG9mIFNpbHZlcmxpZ2h0KVxuXHRcdFx0XHR0bXBFdnQgPSB0eXBlO1xuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YodG1wRXZ0LnR5cGUpID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHR5cGUgPSB0bXBFdnQudHlwZTtcblxuXHRcdFx0XHRcdGlmICh0bXBFdnQudG90YWwgIT09IHVuZGVmICYmIHRtcEV2dC5sb2FkZWQgIT09IHVuZGVmKSB7IC8vIHByb2dyZXNzIGV2ZW50XG5cdFx0XHRcdFx0XHRldnQudG90YWwgPSB0bXBFdnQudG90YWw7XG5cdFx0XHRcdFx0XHRldnQubG9hZGVkID0gdG1wRXZ0LmxvYWRlZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZXZ0LmFzeW5jID0gdG1wRXZ0LmFzeW5jIHx8IGZhbHNlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkV2ZW50RXhjZXB0aW9uKHguRXZlbnRFeGNlcHRpb24uVU5TUEVDSUZJRURfRVZFTlRfVFlQRV9FUlIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNoZWNrIGlmIGV2ZW50IGlzIG1lYW50IHRvIGJlIGRpc3BhdGNoZWQgb24gYW4gb2JqZWN0IGhhdmluZyBzcGVjaWZpYyB1aWRcblx0XHRcdGlmICh0eXBlLmluZGV4T2YoJzo6JykgIT09IC0xKSB7XG5cdFx0XHRcdChmdW5jdGlvbihhcnIpIHtcblx0XHRcdFx0XHR1aWQgPSBhcnJbMF07XG5cdFx0XHRcdFx0dHlwZSA9IGFyclsxXTtcblx0XHRcdFx0fSh0eXBlLnNwbGl0KCc6OicpKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR1aWQgPSB0aGlzLnVpZDtcblx0XHRcdH1cblxuXHRcdFx0dHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0bGlzdCA9IGV2ZW50cG9vbFt1aWRdICYmIGV2ZW50cG9vbFt1aWRdW3R5cGVdO1xuXG5cdFx0XHRpZiAobGlzdCkge1xuXHRcdFx0XHQvLyBzb3J0IGV2ZW50IGxpc3QgYnkgcHJvcml0eVxuXHRcdFx0XHRsaXN0LnNvcnQoZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYi5wcmlvcml0eSAtIGEucHJpb3JpdHk7IH0pO1xuXG5cdFx0XHRcdGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0Ly8gZmlyc3QgYXJndW1lbnQgd2lsbCBiZSBwc2V1ZG8tZXZlbnQgb2JqZWN0XG5cdFx0XHRcdGFyZ3Muc2hpZnQoKTtcblx0XHRcdFx0ZXZ0LnR5cGUgPSB0eXBlO1xuXHRcdFx0XHRhcmdzLnVuc2hpZnQoZXZ0KTtcblxuXHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ldmVudHMpIHtcblx0XHRcdFx0XHRFbnYubG9nKFwiJWNFdmVudCAnJXMnIGZpcmVkIG9uICVzXCIsICdjb2xvcjogIzk5OTsnLCBldnQudHlwZSwgKHRoaXMuY3Rvck5hbWUgPyB0aGlzLmN0b3JOYW1lICsgJzo6JyA6ICcnKSArIHVpZCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBEaXNwYXRjaCBldmVudCB0byBhbGwgbGlzdGVuZXJzXG5cdFx0XHRcdHZhciBxdWV1ZSA9IFtdO1xuXHRcdFx0XHRCYXNpYy5lYWNoKGxpc3QsIGZ1bmN0aW9uKGhhbmRsZXIpIHtcblx0XHRcdFx0XHQvLyBleHBsaWNpdGx5IHNldCB0aGUgdGFyZ2V0LCBvdGhlcndpc2UgZXZlbnRzIGZpcmVkIGZyb20gc2hpbXMgZG8gbm90IGdldCBpdFxuXHRcdFx0XHRcdGFyZ3NbMF0udGFyZ2V0ID0gaGFuZGxlci5zY29wZTtcblx0XHRcdFx0XHQvLyBpZiBldmVudCBpcyBtYXJrZWQgYXMgYXN5bmMsIGRldGFjaCB0aGUgaGFuZGxlclxuXHRcdFx0XHRcdGlmIChldnQuYXN5bmMpIHtcblx0XHRcdFx0XHRcdHF1ZXVlLnB1c2goZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRjYihoYW5kbGVyLmZuLmFwcGx5KGhhbmRsZXIuc2NvcGUsIGFyZ3MpID09PSBmYWxzZSk7XG5cdFx0XHRcdFx0XHRcdH0sIDEpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHF1ZXVlLnB1c2goZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0XHRcdFx0Y2IoaGFuZGxlci5mbi5hcHBseShoYW5kbGVyLnNjb3BlLCBhcmdzKSA9PT0gZmFsc2UpOyAvLyBpZiBoYW5kbGVyIHJldHVybnMgZmFsc2Ugc3RvcCBwcm9wYWdhdGlvblxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHF1ZXVlLmxlbmd0aCkge1xuXHRcdFx0XHRcdEJhc2ljLmluU2VyaWVzKHF1ZXVlLCBmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdHJlc3VsdCA9ICFlcnI7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdFJlZ2lzdGVyIGEgaGFuZGxlciB0byB0aGUgZXZlbnQgdHlwZSB0aGF0IHdpbGwgcnVuIG9ubHkgb25jZVxuXG5cdFx0QG1ldGhvZCBiaW5kT25jZVxuXHRcdEBzaW5jZSA+MS40LjFcblx0XHRAcGFyYW0ge1N0cmluZ30gdHlwZSBUeXBlIG9yIGJhc2ljYWxseSBhIG5hbWUgb2YgdGhlIGV2ZW50IHRvIHN1YnNjcmliZSB0b1xuXHRcdEBwYXJhbSB7RnVuY3Rpb259IGZuIENhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiBldmVudCBoYXBwZW5zXG5cdFx0QHBhcmFtIHtOdW1iZXJ9IFtwcmlvcml0eT0wXSBQcmlvcml0eSBvZiB0aGUgZXZlbnQgaGFuZGxlciAtIGhhbmRsZXJzIHdpdGggaGlnaGVyIHByaW9yaXRpZXMgd2lsbCBiZSBjYWxsZWQgZmlyc3Rcblx0XHRAcGFyYW0ge09iamVjdH0gW3Njb3BlPXRoaXNdIEEgc2NvcGUgdG8gaW52b2tlIGV2ZW50IGhhbmRsZXIgaW5cblx0XHQqL1xuXHRcdGJpbmRPbmNlOiBmdW5jdGlvbih0eXBlLCBmbiwgcHJpb3JpdHksIHNjb3BlKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRzZWxmLmJpbmQuY2FsbCh0aGlzLCB0eXBlLCBmdW5jdGlvbiBjYigpIHtcblx0XHRcdFx0c2VsZi51bmJpbmQodHlwZSwgY2IpO1xuXHRcdFx0XHRyZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sIHByaW9yaXR5LCBzY29wZSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdEFsaWFzIGZvciBhZGRFdmVudExpc3RlbmVyXG5cblx0XHRAbWV0aG9kIGJpbmRcblx0XHRAcHJvdGVjdGVkXG5cdFx0Ki9cblx0XHRiaW5kOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHRBbGlhcyBmb3IgcmVtb3ZlRXZlbnRMaXN0ZW5lclxuXG5cdFx0QG1ldGhvZCB1bmJpbmRcblx0XHRAcHJvdGVjdGVkXG5cdFx0Ki9cblx0XHR1bmJpbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5yZW1vdmVFdmVudExpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdEFsaWFzIGZvciByZW1vdmVBbGxFdmVudExpc3RlbmVyc1xuXG5cdFx0QG1ldGhvZCB1bmJpbmRBbGxcblx0XHRAcHJvdGVjdGVkXG5cdFx0Ki9cblx0XHR1bmJpbmRBbGw6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVycy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHRBbGlhcyBmb3IgZGlzcGF0Y2hFdmVudFxuXG5cdFx0QG1ldGhvZCB0cmlnZ2VyXG5cdFx0QHByb3RlY3RlZFxuXHRcdCovXG5cdFx0dHJpZ2dlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5kaXNwYXRjaEV2ZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0fSxcblxuXG5cdFx0LyoqXG5cdFx0SGFuZGxlIHByb3BlcnRpZXMgb2Ygb25bZXZlbnRdIHR5cGUuXG5cblx0XHRAbWV0aG9kIGhhbmRsZUV2ZW50UHJvcHNcblx0XHRAcHJpdmF0ZVxuXHRcdCovXG5cdFx0aGFuZGxlRXZlbnRQcm9wczogZnVuY3Rpb24oZGlzcGF0Y2hlcykge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHR0aGlzLmJpbmQoZGlzcGF0Y2hlcy5qb2luKCcgJyksIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0dmFyIHByb3AgPSAnb24nICsgZS50eXBlLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YodGhpc1twcm9wXSkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHR0aGlzW3Byb3BdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBvYmplY3QgbXVzdCBoYXZlIGRlZmluZWQgZXZlbnQgcHJvcGVydGllcywgZXZlbiBpZiBpdCBkb2Vzbid0IG1ha2UgdXNlIG9mIHRoZW1cblx0XHRcdEJhc2ljLmVhY2goZGlzcGF0Y2hlcywgZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0XHRwcm9wID0gJ29uJyArIHByb3AudG9Mb3dlckNhc2UocHJvcCk7XG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2Yoc2VsZltwcm9wXSkgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0c2VsZltwcm9wXSA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHR9KTtcblxuXG5cdEV2ZW50VGFyZ2V0Lmluc3RhbmNlID0gbmV3IEV2ZW50VGFyZ2V0KCk7XG5cblx0cmV0dXJuIEV2ZW50VGFyZ2V0O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1bnRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9ydW50aW1lL1J1bnRpbWUnLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9FbnZcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCJcbl0sIGZ1bmN0aW9uKEVudiwgQmFzaWMsIERvbSwgRXZlbnRUYXJnZXQpIHtcblx0dmFyIHJ1bnRpbWVDb25zdHJ1Y3RvcnMgPSB7fSwgcnVudGltZXMgPSB7fTtcblxuXHQvKipcblx0Q29tbW9uIHNldCBvZiBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzIGZvciBldmVyeSBydW50aW1lIGluc3RhbmNlXG5cblx0QGNsYXNzIG1veGllL3J1bnRpbWUvUnVudGltZVxuXG5cdEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG5cdEBwYXJhbSB7U3RyaW5nfSB0eXBlIFNhbml0aXplZCBuYW1lIG9mIHRoZSBydW50aW1lXG5cdEBwYXJhbSB7T2JqZWN0fSBbY2Fwc10gU2V0IG9mIGNhcGFiaWxpdGllcyB0aGF0IGRpZmZlcmVudGlhdGUgc3BlY2lmaWVkIHJ1bnRpbWVcblx0QHBhcmFtIHtPYmplY3R9IFttb2RlQ2Fwc10gU2V0IG9mIGNhcGFiaWxpdGllcyB0aGF0IGRvIHJlcXVpcmUgc3BlY2lmaWMgb3BlcmF0aW9uYWwgbW9kZVxuXHRAcGFyYW0ge1N0cmluZ30gW3ByZWZlcnJlZE1vZGU9J2Jyb3dzZXInXSBQcmVmZXJyZWQgb3BlcmF0aW9uYWwgbW9kZSB0byBjaG9vc2UgaWYgbm8gcmVxdWlyZWQgY2FwYWJpbGl0aWVzIHdlcmUgcmVxdWVzdGVkXG5cdCovXG5cdGZ1bmN0aW9uIFJ1bnRpbWUob3B0aW9ucywgdHlwZSwgY2FwcywgbW9kZUNhcHMsIHByZWZlcnJlZE1vZGUpIHtcblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gcnVudGltZSBpcyBpbml0aWFsaXplZCBhbmQgcmVhZHkuXG5cdFx0UmVzdWx0cyBpbiBSdW50aW1lSW5pdCBvbiBhIGNvbm5lY3RlZCBjb21wb25lbnQuXG5cblx0XHRAZXZlbnQgSW5pdFxuXHRcdCovXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gcnVudGltZSBmYWlscyB0byBpbml0aWFsaXplLlxuXHRcdFJlc3VsdHMgaW4gUnVudGltZUVycm9yIG9uIGEgY29ubmVjdGVkIGNvbXBvbmVudC5cblxuXHRcdEBldmVudCBFcnJvclxuXHRcdCovXG5cblx0XHR2YXIgc2VsZiA9IHRoaXNcblx0XHQsIF9zaGltXG5cdFx0LCBfdWlkID0gQmFzaWMuZ3VpZCh0eXBlICsgJ18nKVxuXHRcdCwgZGVmYXVsdE1vZGUgPSBwcmVmZXJyZWRNb2RlIHx8ICdicm93c2VyJ1xuXHRcdDtcblxuXHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdFx0Ly8gcmVnaXN0ZXIgcnVudGltZSBpbiBwcml2YXRlIGhhc2hcblx0XHRydW50aW1lc1tfdWlkXSA9IHRoaXM7XG5cblx0XHQvKipcblx0XHREZWZhdWx0IHNldCBvZiBjYXBhYmlsaXRpZXMsIHdoaWNoIGNhbiBiZSByZWRpZmluZWQgbGF0ZXIgYnkgc3BlY2lmaWMgcnVudGltZVxuXG5cdFx0QHByaXZhdGVcblx0XHRAcHJvcGVydHkgY2Fwc1xuXHRcdEB0eXBlIE9iamVjdFxuXHRcdCovXG5cdFx0Y2FwcyA9IEJhc2ljLmV4dGVuZCh7XG5cdFx0XHQvLyBSdW50aW1lIGNhbjogXG5cdFx0XHQvLyBwcm92aWRlIGFjY2VzcyB0byByYXcgYmluYXJ5IGRhdGEgb2YgdGhlIGZpbGVcblx0XHRcdGFjY2Vzc19iaW5hcnk6IGZhbHNlLFxuXHRcdFx0Ly8gcHJvdmlkZSBhY2Nlc3MgdG8gcmF3IGJpbmFyeSBkYXRhIG9mIHRoZSBpbWFnZSAoaW1hZ2UgZXh0ZW5zaW9uIGlzIG9wdGlvbmFsKSBcblx0XHRcdGFjY2Vzc19pbWFnZV9iaW5hcnk6IGZhbHNlLFxuXHRcdFx0Ly8gZGlzcGxheSBiaW5hcnkgZGF0YSBhcyB0aHVtYnMgZm9yIGV4YW1wbGVcblx0XHRcdGRpc3BsYXlfbWVkaWE6IGZhbHNlLFxuXHRcdFx0Ly8gbWFrZSBjcm9zcy1kb21haW4gcmVxdWVzdHNcblx0XHRcdGRvX2NvcnM6IGZhbHNlLFxuXHRcdFx0Ly8gYWNjZXB0IGZpbGVzIGRyYWdnZWQgYW5kIGRyb3BwZWQgZnJvbSB0aGUgZGVza3RvcFxuXHRcdFx0ZHJhZ19hbmRfZHJvcDogZmFsc2UsXG5cdFx0XHQvLyBmaWx0ZXIgZmlsZXMgaW4gc2VsZWN0aW9uIGRpYWxvZyBieSB0aGVpciBleHRlbnNpb25zXG5cdFx0XHRmaWx0ZXJfYnlfZXh0ZW5zaW9uOiB0cnVlLFxuXHRcdFx0Ly8gcmVzaXplIGltYWdlIChhbmQgbWFuaXB1bGF0ZSBpdCByYXcgZGF0YSBvZiBhbnkgZmlsZSBpbiBnZW5lcmFsKVxuXHRcdFx0cmVzaXplX2ltYWdlOiBmYWxzZSxcblx0XHRcdC8vIHBlcmlvZGljYWxseSByZXBvcnQgaG93IG1hbnkgYnl0ZXMgb2YgdG90YWwgaW4gdGhlIGZpbGUgd2VyZSB1cGxvYWRlZCAobG9hZGVkKVxuXHRcdFx0cmVwb3J0X3VwbG9hZF9wcm9ncmVzczogZmFsc2UsXG5cdFx0XHQvLyBwcm92aWRlIGFjY2VzcyB0byB0aGUgaGVhZGVycyBvZiBodHRwIHJlc3BvbnNlIFxuXHRcdFx0cmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6IGZhbHNlLFxuXHRcdFx0Ly8gc3VwcG9ydCByZXNwb25zZSBvZiBzcGVjaWZpYyB0eXBlLCB3aGljaCBzaG91bGQgYmUgcGFzc2VkIGFzIGFuIGFyZ3VtZW50XG5cdFx0XHQvLyBlLmcuIHJ1bnRpbWUuY2FuKCdyZXR1cm5fcmVzcG9uc2VfdHlwZScsICdibG9iJylcblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmYWxzZSxcblx0XHRcdC8vIHJldHVybiBodHRwIHN0YXR1cyBjb2RlIG9mIHRoZSByZXNwb25zZVxuXHRcdFx0cmV0dXJuX3N0YXR1c19jb2RlOiB0cnVlLFxuXHRcdFx0Ly8gc2VuZCBjdXN0b20gaHR0cCBoZWFkZXIgd2l0aCB0aGUgcmVxdWVzdFxuXHRcdFx0c2VuZF9jdXN0b21faGVhZGVyczogZmFsc2UsXG5cdFx0XHQvLyBwaWNrIHVwIHRoZSBmaWxlcyBmcm9tIGEgZGlhbG9nXG5cdFx0XHRzZWxlY3RfZmlsZTogZmFsc2UsXG5cdFx0XHQvLyBzZWxlY3Qgd2hvbGUgZm9sZGVyIGluIGZpbGUgYnJvd3NlIGRpYWxvZ1xuXHRcdFx0c2VsZWN0X2ZvbGRlcjogZmFsc2UsXG5cdFx0XHQvLyBzZWxlY3QgbXVsdGlwbGUgZmlsZXMgYXQgb25jZSBpbiBmaWxlIGJyb3dzZSBkaWFsb2dcblx0XHRcdHNlbGVjdF9tdWx0aXBsZTogdHJ1ZSxcblx0XHRcdC8vIHNlbmQgcmF3IGJpbmFyeSBkYXRhLCB0aGF0IGlzIGdlbmVyYXRlZCBhZnRlciBpbWFnZSByZXNpemluZyBvciBtYW5pcHVsYXRpb24gb2Ygb3RoZXIga2luZFxuXHRcdFx0c2VuZF9iaW5hcnlfc3RyaW5nOiBmYWxzZSxcblx0XHRcdC8vIHNlbmQgY29va2llcyB3aXRoIGh0dHAgcmVxdWVzdCBhbmQgdGhlcmVmb3JlIHJldGFpbiBzZXNzaW9uXG5cdFx0XHRzZW5kX2Jyb3dzZXJfY29va2llczogdHJ1ZSxcblx0XHRcdC8vIHNlbmQgZGF0YSBmb3JtYXR0ZWQgYXMgbXVsdGlwYXJ0L2Zvcm0tZGF0YVxuXHRcdFx0c2VuZF9tdWx0aXBhcnQ6IHRydWUsXG5cdFx0XHQvLyBzbGljZSB0aGUgZmlsZSBvciBibG9iIHRvIHNtYWxsZXIgcGFydHNcblx0XHRcdHNsaWNlX2Jsb2I6IGZhbHNlLFxuXHRcdFx0Ly8gdXBsb2FkIGZpbGUgd2l0aG91dCBwcmVsb2FkaW5nIGl0IHRvIG1lbW9yeSwgc3RyZWFtIGl0IG91dCBkaXJlY3RseSBmcm9tIGRpc2tcblx0XHRcdHN0cmVhbV91cGxvYWQ6IGZhbHNlLFxuXHRcdFx0Ly8gcHJvZ3JhbW1hdGljYWxseSB0cmlnZ2VyIGZpbGUgYnJvd3NlIGRpYWxvZ1xuXHRcdFx0c3VtbW9uX2ZpbGVfZGlhbG9nOiBmYWxzZSxcblx0XHRcdC8vIHVwbG9hZCBmaWxlIG9mIHNwZWNpZmljIHNpemUsIHNpemUgc2hvdWxkIGJlIHBhc3NlZCBhcyBhcmd1bWVudFxuXHRcdFx0Ly8gZS5nLiBydW50aW1lLmNhbigndXBsb2FkX2ZpbGVzaXplJywgJzUwMG1iJylcblx0XHRcdHVwbG9hZF9maWxlc2l6ZTogdHJ1ZSxcblx0XHRcdC8vIGluaXRpYXRlIGh0dHAgcmVxdWVzdCB3aXRoIHNwZWNpZmljIGh0dHAgbWV0aG9kLCBtZXRob2Qgc2hvdWxkIGJlIHBhc3NlZCBhcyBhcmd1bWVudFxuXHRcdFx0Ly8gZS5nLiBydW50aW1lLmNhbigndXNlX2h0dHBfbWV0aG9kJywgJ3B1dCcpXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IHRydWVcblx0XHR9LCBjYXBzKTtcblx0XHRcdFxuXHRcblx0XHQvLyBkZWZhdWx0IHRvIHRoZSBtb2RlIHRoYXQgaXMgY29tcGF0aWJsZSB3aXRoIHByZWZlcnJlZCBjYXBzXG5cdFx0aWYgKG9wdGlvbnMucHJlZmVycmVkX2NhcHMpIHtcblx0XHRcdGRlZmF1bHRNb2RlID0gUnVudGltZS5nZXRNb2RlKG1vZGVDYXBzLCBvcHRpb25zLnByZWZlcnJlZF9jYXBzLCBkZWZhdWx0TW9kZSk7XG5cdFx0fVxuXG5cdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0RW52LmxvZyhcIlxcdGRlZmF1bHQgbW9kZTogJXNcIiwgZGVmYXVsdE1vZGUpO1x0XG5cdFx0fVxuXHRcdFxuXHRcdC8vIHNtYWxsIGV4dGVuc2lvbiBmYWN0b3J5IGhlcmUgKGlzIG1lYW50IHRvIGJlIGV4dGVuZGVkIHdpdGggYWN0dWFsIGV4dGVuc2lvbnMgY29uc3RydWN0b3JzKVxuXHRcdF9zaGltID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG9ianBvb2wgPSB7fTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGV4ZWM6IGZ1bmN0aW9uKHVpZCwgY29tcCwgZm4sIGFyZ3MpIHtcblx0XHRcdFx0XHRpZiAoX3NoaW1bY29tcF0pIHtcblx0XHRcdFx0XHRcdGlmICghb2JqcG9vbFt1aWRdKSB7XG5cdFx0XHRcdFx0XHRcdG9ianBvb2xbdWlkXSA9IHtcblx0XHRcdFx0XHRcdFx0XHRjb250ZXh0OiB0aGlzLFxuXHRcdFx0XHRcdFx0XHRcdGluc3RhbmNlOiBuZXcgX3NoaW1bY29tcF0oKVxuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKG9ianBvb2xbdWlkXS5pbnN0YW5jZVtmbl0pIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG9ianBvb2xbdWlkXS5pbnN0YW5jZVtmbl0uYXBwbHkodGhpcywgYXJncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdHJlbW92ZUluc3RhbmNlOiBmdW5jdGlvbih1aWQpIHtcblx0XHRcdFx0XHRkZWxldGUgb2JqcG9vbFt1aWRdO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdHJlbW92ZUFsbEluc3RhbmNlczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdEJhc2ljLmVhY2gob2JqcG9vbCwgZnVuY3Rpb24ob2JqLCB1aWQpIHtcblx0XHRcdFx0XHRcdGlmIChCYXNpYy50eXBlT2Yob2JqLmluc3RhbmNlLmRlc3Ryb3kpID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0XHRcdG9iai5pbnN0YW5jZS5kZXN0cm95LmNhbGwob2JqLmNvbnRleHQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVJbnN0YW5jZSh1aWQpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH0oKSk7XG5cblxuXHRcdC8vIHB1YmxpYyBtZXRob2RzXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdC8qKlxuXHRcdFx0U3BlY2lmaWVzIHdoZXRoZXIgcnVudGltZSBpbnN0YW5jZSB3YXMgaW5pdGlhbGl6ZWQgb3Igbm90XG5cblx0XHRcdEBwcm9wZXJ0eSBpbml0aWFsaXplZFxuXHRcdFx0QHR5cGUge0Jvb2xlYW59XG5cdFx0XHRAZGVmYXVsdCBmYWxzZVxuXHRcdFx0Ki9cblx0XHRcdGluaXRpYWxpemVkOiBmYWxzZSwgLy8gc2hpbXMgcmVxdWlyZSB0aGlzIGZsYWcgdG8gc3RvcCBpbml0aWFsaXphdGlvbiByZXRyaWVzXG5cblx0XHRcdC8qKlxuXHRcdFx0VW5pcXVlIElEIG9mIHRoZSBydW50aW1lXG5cblx0XHRcdEBwcm9wZXJ0eSB1aWRcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0dWlkOiBfdWlkLFxuXG5cdFx0XHQvKipcblx0XHRcdFJ1bnRpbWUgdHlwZSAoZS5nLiBmbGFzaCwgaHRtbDUsIGV0YylcblxuXHRcdFx0QHByb3BlcnR5IHR5cGVcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0dHlwZTogdHlwZSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSdW50aW1lIChub3QgbmF0aXZlIG9uZSkgbWF5IG9wZXJhdGUgaW4gYnJvd3NlciBvciBjbGllbnQgbW9kZS5cblxuXHRcdFx0QHByb3BlcnR5IG1vZGVcblx0XHRcdEBwcml2YXRlXG5cdFx0XHRAdHlwZSB7U3RyaW5nfEJvb2xlYW59IGN1cnJlbnQgbW9kZSBvciBmYWxzZSwgaWYgbm9uZSBwb3NzaWJsZVxuXHRcdFx0Ki9cblx0XHRcdG1vZGU6IFJ1bnRpbWUuZ2V0TW9kZShtb2RlQ2FwcywgKG9wdGlvbnMucmVxdWlyZWRfY2FwcyksIGRlZmF1bHRNb2RlKSxcblxuXHRcdFx0LyoqXG5cdFx0XHRpZCBvZiB0aGUgRE9NIGNvbnRhaW5lciBmb3IgdGhlIHJ1bnRpbWUgKGlmIGF2YWlsYWJsZSlcblxuXHRcdFx0QHByb3BlcnR5IHNoaW1pZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRzaGltaWQ6IF91aWQgKyAnX2NvbnRhaW5lcicsXG5cblx0XHRcdC8qKlxuXHRcdFx0TnVtYmVyIG9mIGNvbm5lY3RlZCBjbGllbnRzLiBJZiBlcXVhbCB0byB6ZXJvLCBydW50aW1lIGNhbiBiZSBkZXN0cm95ZWRcblxuXHRcdFx0QHByb3BlcnR5IGNsaWVudHNcblx0XHRcdEB0eXBlIHtOdW1iZXJ9XG5cdFx0XHQqL1xuXHRcdFx0Y2xpZW50czogMCxcblxuXHRcdFx0LyoqXG5cdFx0XHRSdW50aW1lIGluaXRpYWxpemF0aW9uIG9wdGlvbnNcblxuXHRcdFx0QHByb3BlcnR5IG9wdGlvbnNcblx0XHRcdEB0eXBlIHtPYmplY3R9XG5cdFx0XHQqL1xuXHRcdFx0b3B0aW9uczogb3B0aW9ucyxcblxuXHRcdFx0LyoqXG5cdFx0XHRDaGVja3MgaWYgdGhlIHJ1bnRpbWUgaGFzIHNwZWNpZmljIGNhcGFiaWxpdHlcblxuXHRcdFx0QG1ldGhvZCBjYW5cblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBjYXAgTmFtZSBvZiBjYXBhYmlsaXR5IHRvIGNoZWNrXG5cdFx0XHRAcGFyYW0ge01peGVkfSBbdmFsdWVdIElmIHBhc3NlZCwgY2FwYWJpbGl0eSBzaG91bGQgc29tZWhvdyBjb3JyZWxhdGUgdG8gdGhlIHZhbHVlXG5cdFx0XHRAcGFyYW0ge09iamVjdH0gW3JlZkNhcHNdIFNldCBvZiBjYXBhYmlsaXRpZXMgdG8gY2hlY2sgdGhlIHNwZWNpZmllZCBjYXAgYWdhaW5zdCAoZGVmYXVsdHMgdG8gaW50ZXJuYWwgc2V0KVxuXHRcdFx0QHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBydW50aW1lIGhhcyBzdWNoIGNhcGFiaWxpdHkgYW5kIGZhbHNlLCBpZiAtIG5vdFxuXHRcdFx0Ki9cblx0XHRcdGNhbjogZnVuY3Rpb24oY2FwLCB2YWx1ZSkge1xuXHRcdFx0XHR2YXIgcmVmQ2FwcyA9IGFyZ3VtZW50c1syXSB8fCBjYXBzO1xuXG5cdFx0XHRcdC8vIGlmIGNhcCB2YXIgaXMgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBjYXBzLCBjb252ZXJ0IGl0IHRvIG9iamVjdCAoa2V5L3ZhbHVlKVxuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKGNhcCkgPT09ICdzdHJpbmcnICYmIEJhc2ljLnR5cGVPZih2YWx1ZSkgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0Y2FwID0gUnVudGltZS5wYXJzZUNhcHMoY2FwKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoY2FwKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gY2FwKSB7XG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMuY2FuKGtleSwgY2FwW2tleV0sIHJlZkNhcHMpKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjaGVjayB0aGUgaW5kaXZpZHVhbCBjYXBcblx0XHRcdFx0aWYgKEJhc2ljLnR5cGVPZihyZWZDYXBzW2NhcF0pID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlZkNhcHNbY2FwXS5jYWxsKHRoaXMsIHZhbHVlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gKHZhbHVlID09PSByZWZDYXBzW2NhcF0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgY29udGFpbmVyIGZvciB0aGUgcnVudGltZSBhcyBET00gZWxlbWVudFxuXG5cdFx0XHRAbWV0aG9kIGdldFNoaW1Db250YWluZXJcblx0XHRcdEByZXR1cm4ge0RPTUVsZW1lbnR9XG5cdFx0XHQqL1xuXHRcdFx0Z2V0U2hpbUNvbnRhaW5lcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBjb250YWluZXIsIHNoaW1Db250YWluZXIgPSBEb20uZ2V0KHRoaXMuc2hpbWlkKTtcblxuXHRcdFx0XHQvLyBpZiBubyBjb250YWluZXIgZm9yIHNoaW0sIGNyZWF0ZSBvbmVcblx0XHRcdFx0aWYgKCFzaGltQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0Y29udGFpbmVyID0gRG9tLmdldCh0aGlzLm9wdGlvbnMuY29udGFpbmVyKSB8fCBkb2N1bWVudC5ib2R5O1xuXG5cdFx0XHRcdFx0Ly8gY3JlYXRlIHNoaW0gY29udGFpbmVyIGFuZCBpbnNlcnQgaXQgYXQgYW4gYWJzb2x1dGUgcG9zaXRpb24gaW50byB0aGUgb3V0ZXIgY29udGFpbmVyXG5cdFx0XHRcdFx0c2hpbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0XHRcdHNoaW1Db250YWluZXIuaWQgPSB0aGlzLnNoaW1pZDtcblx0XHRcdFx0XHRzaGltQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdtb3hpZS1zaGltIG1veGllLXNoaW0tJyArIHRoaXMudHlwZTtcblxuXHRcdFx0XHRcdEJhc2ljLmV4dGVuZChzaGltQ29udGFpbmVyLnN0eWxlLCB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbjogJ2Fic29sdXRlJyxcblx0XHRcdFx0XHRcdHRvcDogJzBweCcsXG5cdFx0XHRcdFx0XHRsZWZ0OiAnMHB4Jyxcblx0XHRcdFx0XHRcdHdpZHRoOiAnMXB4Jyxcblx0XHRcdFx0XHRcdGhlaWdodDogJzFweCcsXG5cdFx0XHRcdFx0XHRvdmVyZmxvdzogJ2hpZGRlbidcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZChzaGltQ29udGFpbmVyKTtcblx0XHRcdFx0XHRjb250YWluZXIgPSBudWxsO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHNoaW1Db250YWluZXI7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgcnVudGltZSBhcyBET00gZWxlbWVudCAoaWYgYXBwcm9wcmlhdGUpXG5cblx0XHRcdEBtZXRob2QgZ2V0U2hpbVxuXHRcdFx0QHJldHVybiB7RE9NRWxlbWVudH1cblx0XHRcdCovXG5cdFx0XHRnZXRTaGltOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9zaGltO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRJbnZva2VzIGEgbWV0aG9kIHdpdGhpbiB0aGUgcnVudGltZSBpdHNlbGYgKG1pZ2h0IGRpZmZlciBhY3Jvc3MgdGhlIHJ1bnRpbWVzKVxuXG5cdFx0XHRAbWV0aG9kIHNoaW1FeGVjXG5cdFx0XHRAcGFyYW0ge01peGVkfSBbXVxuXHRcdFx0QHByb3RlY3RlZFxuXHRcdFx0QHJldHVybiB7TWl4ZWR9IERlcGVuZHMgb24gdGhlIGFjdGlvbiBhbmQgY29tcG9uZW50XG5cdFx0XHQqL1xuXHRcdFx0c2hpbUV4ZWM6IGZ1bmN0aW9uKGNvbXBvbmVudCwgYWN0aW9uKSB7XG5cdFx0XHRcdHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuXHRcdFx0XHRyZXR1cm4gc2VsZi5nZXRTaGltKCkuZXhlYy5jYWxsKHRoaXMsIHRoaXMudWlkLCBjb21wb25lbnQsIGFjdGlvbiwgYXJncyk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdE9wZXJhaW9uYWwgaW50ZXJmYWNlIHRoYXQgaXMgdXNlZCBieSBjb21wb25lbnRzIHRvIGludm9rZSBzcGVjaWZpYyBhY3Rpb25zIG9uIHRoZSBydW50aW1lXG5cdFx0XHQoaXMgaW52b2tlZCBpbiB0aGUgc2NvcGUgb2YgY29tcG9uZW50KVxuXG5cdFx0XHRAbWV0aG9kIGV4ZWNcblx0XHRcdEBwYXJhbSB7TWl4ZWR9IFtdKlxuXHRcdFx0QHByb3RlY3RlZFxuXHRcdFx0QHJldHVybiB7TWl4ZWR9IERlcGVuZHMgb24gdGhlIGFjdGlvbiBhbmQgY29tcG9uZW50XG5cdFx0XHQqL1xuXHRcdFx0ZXhlYzogZnVuY3Rpb24oY29tcG9uZW50LCBhY3Rpb24pIHsgLy8gdGhpcyBpcyBjYWxsZWQgaW4gdGhlIGNvbnRleHQgb2YgY29tcG9uZW50LCBub3QgcnVudGltZVxuXHRcdFx0XHR2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcblxuXHRcdFx0XHRpZiAoc2VsZltjb21wb25lbnRdICYmIHNlbGZbY29tcG9uZW50XVthY3Rpb25dKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHNlbGZbY29tcG9uZW50XVthY3Rpb25dLmFwcGx5KHRoaXMsIGFyZ3MpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBzZWxmLnNoaW1FeGVjLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdERlc3Ryb3lzIHRoZSBydW50aW1lIChyZW1vdmVzIGFsbCBldmVudHMgYW5kIGRlbGV0ZXMgRE9NIHN0cnVjdHVyZXMpXG5cblx0XHRcdEBtZXRob2QgZGVzdHJveVxuXHRcdFx0Ki9cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIXNlbGYpIHtcblx0XHRcdFx0XHRyZXR1cm47IC8vIG9idmlvdXNseSBhbHJlYWR5IGRlc3Ryb3llZFxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIHNoaW1Db250YWluZXIgPSBEb20uZ2V0KHRoaXMuc2hpbWlkKTtcblx0XHRcdFx0aWYgKHNoaW1Db250YWluZXIpIHtcblx0XHRcdFx0XHRzaGltQ29udGFpbmVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2hpbUNvbnRhaW5lcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoX3NoaW0pIHtcblx0XHRcdFx0XHRfc2hpbS5yZW1vdmVBbGxJbnN0YW5jZXMoKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMudW5iaW5kQWxsKCk7XG5cdFx0XHRcdGRlbGV0ZSBydW50aW1lc1t0aGlzLnVpZF07XG5cdFx0XHRcdHRoaXMudWlkID0gbnVsbDsgLy8gbWFyayB0aGlzIHJ1bnRpbWUgYXMgZGVzdHJveWVkXG5cdFx0XHRcdF91aWQgPSBzZWxmID0gX3NoaW0gPSBzaGltQ29udGFpbmVyID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIG9uY2Ugd2UgZ290IHRoZSBtb2RlLCB0ZXN0IGFnYWluc3QgYWxsIGNhcHNcblx0XHRpZiAodGhpcy5tb2RlICYmIG9wdGlvbnMucmVxdWlyZWRfY2FwcyAmJiAhdGhpcy5jYW4ob3B0aW9ucy5yZXF1aXJlZF9jYXBzKSkge1xuXHRcdFx0dGhpcy5tb2RlID0gZmFsc2U7XG5cdFx0fVx0XG5cdH1cblxuXG5cdC8qKlxuXHREZWZhdWx0IG9yZGVyIHRvIHRyeSBkaWZmZXJlbnQgcnVudGltZSB0eXBlc1xuXG5cdEBwcm9wZXJ0eSBvcmRlclxuXHRAdHlwZSBTdHJpbmdcblx0QHN0YXRpY1xuXHQqL1xuXHRSdW50aW1lLm9yZGVyID0gJ2h0bWw1LGZsYXNoLHNpbHZlcmxpZ2h0LGh0bWw0JztcblxuXG5cdC8qKlxuXHRSZXRyaWV2ZXMgcnVudGltZSBmcm9tIHByaXZhdGUgaGFzaCBieSBpdCdzIHVpZFxuXG5cdEBtZXRob2QgZ2V0UnVudGltZVxuXHRAcHJpdmF0ZVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSB1aWQgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHJ1bnRpbWVcblx0QHJldHVybiB7UnVudGltZXxCb29sZWFufSBSZXR1cm5zIHJ1bnRpbWUsIGlmIGl0IGV4aXN0cyBhbmQgZmFsc2UsIGlmIC0gbm90XG5cdCovXG5cdFJ1bnRpbWUuZ2V0UnVudGltZSA9IGZ1bmN0aW9uKHVpZCkge1xuXHRcdHJldHVybiBydW50aW1lc1t1aWRdID8gcnVudGltZXNbdWlkXSA6IGZhbHNlO1xuXHR9O1xuXG5cblx0LyoqXG5cdFJlZ2lzdGVyIGNvbnN0cnVjdG9yIGZvciB0aGUgUnVudGltZSBvZiBuZXcgKG9yIHBlcmhhcHMgbW9kaWZpZWQpIHR5cGVcblxuXHRAbWV0aG9kIGFkZENvbnN0cnVjdG9yXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHR5cGUgUnVudGltZSB0eXBlIChlLmcuIGZsYXNoLCBodG1sNSwgZXRjKVxuXHRAcGFyYW0ge0Z1bmN0aW9ufSBjb25zdHJ1Y3QgQ29uc3RydWN0b3IgZm9yIHRoZSBSdW50aW1lIHR5cGVcblx0Ki9cblx0UnVudGltZS5hZGRDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKHR5cGUsIGNvbnN0cnVjdG9yKSB7XG5cdFx0Y29uc3RydWN0b3IucHJvdG90eXBlID0gRXZlbnRUYXJnZXQuaW5zdGFuY2U7XG5cdFx0cnVudGltZUNvbnN0cnVjdG9yc1t0eXBlXSA9IGNvbnN0cnVjdG9yO1xuXHR9O1xuXG5cblx0LyoqXG5cdEdldCB0aGUgY29uc3RydWN0b3IgZm9yIHRoZSBzcGVjaWZpZWQgdHlwZS5cblxuXHRtZXRob2QgZ2V0Q29uc3RydWN0b3Jcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gdHlwZSBSdW50aW1lIHR5cGUgKGUuZy4gZmxhc2gsIGh0bWw1LCBldGMpXG5cdEByZXR1cm4ge0Z1bmN0aW9ufSBDb25zdHJ1Y3RvciBmb3IgdGhlIFJ1bnRpbWUgdHlwZVxuXHQqL1xuXHRSdW50aW1lLmdldENvbnN0cnVjdG9yID0gZnVuY3Rpb24odHlwZSkge1xuXHRcdHJldHVybiBydW50aW1lQ29uc3RydWN0b3JzW3R5cGVdIHx8IG51bGw7XG5cdH07XG5cblxuXHQvKipcblx0R2V0IGluZm8gYWJvdXQgdGhlIHJ1bnRpbWUgKHVpZCwgdHlwZSwgY2FwYWJpbGl0aWVzKVxuXG5cdEBtZXRob2QgZ2V0SW5mb1xuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSB1aWQgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHJ1bnRpbWVcblx0QHJldHVybiB7TWl4ZWR9IEluZm8gb2JqZWN0IG9yIG51bGwgaWYgcnVudGltZSBkb2Vzbid0IGV4aXN0XG5cdCovXG5cdFJ1bnRpbWUuZ2V0SW5mbyA9IGZ1bmN0aW9uKHVpZCkge1xuXHRcdHZhciBydW50aW1lID0gUnVudGltZS5nZXRSdW50aW1lKHVpZCk7XG5cblx0XHRpZiAocnVudGltZSkge1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dWlkOiBydW50aW1lLnVpZCxcblx0XHRcdFx0dHlwZTogcnVudGltZS50eXBlLFxuXHRcdFx0XHRtb2RlOiBydW50aW1lLm1vZGUsXG5cdFx0XHRcdGNhbjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJ1bnRpbWUuY2FuLmFwcGx5KHJ1bnRpbWUsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cblx0LyoqXG5cdENvbnZlcnQgY2FwcyByZXByZXNlbnRlZCBieSBhIGNvbW1hLXNlcGFyYXRlZCBzdHJpbmcgdG8gdGhlIG9iamVjdCByZXByZXNlbnRhdGlvbi5cblxuXHRAbWV0aG9kIHBhcnNlQ2Fwc1xuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSBjYXBTdHIgQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgY2FwYWJpbGl0aWVzXG5cdEByZXR1cm4ge09iamVjdH1cblx0Ki9cblx0UnVudGltZS5wYXJzZUNhcHMgPSBmdW5jdGlvbihjYXBTdHIpIHtcblx0XHR2YXIgY2FwT2JqID0ge307XG5cblx0XHRpZiAoQmFzaWMudHlwZU9mKGNhcFN0cikgIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRyZXR1cm4gY2FwU3RyIHx8IHt9O1xuXHRcdH1cblxuXHRcdEJhc2ljLmVhY2goY2FwU3RyLnNwbGl0KCcsJyksIGZ1bmN0aW9uKGtleSkge1xuXHRcdFx0Y2FwT2JqW2tleV0gPSB0cnVlOyAvLyB3ZSBhc3N1bWUgaXQgdG8gYmUgLSB0cnVlXG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gY2FwT2JqO1xuXHR9O1xuXG5cdC8qKlxuXHRUZXN0IHRoZSBzcGVjaWZpZWQgcnVudGltZSBmb3Igc3BlY2lmaWMgY2FwYWJpbGl0aWVzLlxuXG5cdEBtZXRob2QgY2FuXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHR5cGUgUnVudGltZSB0eXBlIChlLmcuIGZsYXNoLCBodG1sNSwgZXRjKVxuXHRAcGFyYW0ge1N0cmluZ3xPYmplY3R9IGNhcHMgU2V0IG9mIGNhcGFiaWxpdGllcyB0byBjaGVja1xuXHRAcmV0dXJuIHtCb29sZWFufSBSZXN1bHQgb2YgdGhlIHRlc3Rcblx0Ki9cblx0UnVudGltZS5jYW4gPSBmdW5jdGlvbih0eXBlLCBjYXBzKSB7XG5cdFx0dmFyIHJ1bnRpbWVcblx0XHQsIGNvbnN0cnVjdG9yID0gUnVudGltZS5nZXRDb25zdHJ1Y3Rvcih0eXBlKVxuXHRcdCwgbW9kZVxuXHRcdDtcblx0XHRpZiAoY29uc3RydWN0b3IpIHtcblx0XHRcdHJ1bnRpbWUgPSBuZXcgY29uc3RydWN0b3Ioe1xuXHRcdFx0XHRyZXF1aXJlZF9jYXBzOiBjYXBzXG5cdFx0XHR9KTtcblx0XHRcdG1vZGUgPSBydW50aW1lLm1vZGU7XG5cdFx0XHRydW50aW1lLmRlc3Ryb3koKTtcblx0XHRcdHJldHVybiAhIW1vZGU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXG5cdC8qKlxuXHRGaWd1cmUgb3V0IGEgcnVudGltZSB0aGF0IHN1cHBvcnRzIHNwZWNpZmllZCBjYXBhYmlsaXRpZXMuXG5cblx0QG1ldGhvZCB0aGF0Q2FuXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd8T2JqZWN0fSBjYXBzIFNldCBvZiBjYXBhYmlsaXRpZXMgdG8gY2hlY2tcblx0QHBhcmFtIHtTdHJpbmd9IFtydW50aW1lT3JkZXJdIENvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHJ1bnRpbWVzIHRvIGNoZWNrIGFnYWluc3Rcblx0QHJldHVybiB7U3RyaW5nfSBVc2FibGUgcnVudGltZSBpZGVudGlmaWVyIG9yIG51bGxcblx0Ki9cblx0UnVudGltZS50aGF0Q2FuID0gZnVuY3Rpb24oY2FwcywgcnVudGltZU9yZGVyKSB7XG5cdFx0dmFyIHR5cGVzID0gKHJ1bnRpbWVPcmRlciB8fCBSdW50aW1lLm9yZGVyKS5zcGxpdCgvXFxzKixcXHMqLyk7XG5cdFx0Zm9yICh2YXIgaSBpbiB0eXBlcykge1xuXHRcdFx0aWYgKFJ1bnRpbWUuY2FuKHR5cGVzW2ldLCBjYXBzKSkge1xuXHRcdFx0XHRyZXR1cm4gdHlwZXNbaV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cblx0LyoqXG5cdEZpZ3VyZSBvdXQgYW4gb3BlcmF0aW9uYWwgbW9kZSBmb3IgdGhlIHNwZWNpZmllZCBzZXQgb2YgY2FwYWJpbGl0aWVzLlxuXG5cdEBtZXRob2QgZ2V0TW9kZVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7T2JqZWN0fSBtb2RlQ2FwcyBTZXQgb2YgY2FwYWJpbGl0aWVzIHRoYXQgZGVwZW5kIG9uIHBhcnRpY3VsYXIgcnVudGltZSBtb2RlXG5cdEBwYXJhbSB7T2JqZWN0fSBbcmVxdWlyZWRDYXBzXSBTdXBwbGllZCBzZXQgb2YgY2FwYWJpbGl0aWVzIHRvIGZpbmQgb3BlcmF0aW9uYWwgbW9kZSBmb3Jcblx0QHBhcmFtIHtTdHJpbmd8Qm9vbGVhbn0gW2RlZmF1bHRNb2RlPSdicm93c2VyJ10gRGVmYXVsdCBtb2RlIHRvIHVzZSBcblx0QHJldHVybiB7U3RyaW5nfEJvb2xlYW59IENvbXBhdGlibGUgb3BlcmF0aW9uYWwgbW9kZVxuXHQqL1xuXHRSdW50aW1lLmdldE1vZGUgPSBmdW5jdGlvbihtb2RlQ2FwcywgcmVxdWlyZWRDYXBzLCBkZWZhdWx0TW9kZSkge1xuXHRcdHZhciBtb2RlID0gbnVsbDtcblxuXHRcdGlmIChCYXNpYy50eXBlT2YoZGVmYXVsdE1vZGUpID09PSAndW5kZWZpbmVkJykgeyAvLyBvbmx5IGlmIG5vdCBzcGVjaWZpZWRcblx0XHRcdGRlZmF1bHRNb2RlID0gJ2Jyb3dzZXInO1xuXHRcdH1cblxuXHRcdGlmIChyZXF1aXJlZENhcHMgJiYgIUJhc2ljLmlzRW1wdHlPYmoobW9kZUNhcHMpKSB7XG5cdFx0XHQvLyBsb29wIG92ZXIgcmVxdWlyZWQgY2FwcyBhbmQgY2hlY2sgaWYgdGhleSBkbyByZXF1aXJlIHRoZSBzYW1lIG1vZGVcblx0XHRcdEJhc2ljLmVhY2gocmVxdWlyZWRDYXBzLCBmdW5jdGlvbih2YWx1ZSwgY2FwKSB7XG5cdFx0XHRcdGlmIChtb2RlQ2Fwcy5oYXNPd25Qcm9wZXJ0eShjYXApKSB7XG5cdFx0XHRcdFx0dmFyIGNhcE1vZGUgPSBtb2RlQ2Fwc1tjYXBdKHZhbHVlKTtcblxuXHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB3ZSBhbHdheXMgaGF2ZSBhbiBhcnJheVxuXHRcdFx0XHRcdGlmICh0eXBlb2YoY2FwTW9kZSkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRjYXBNb2RlID0gW2NhcE1vZGVdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoIW1vZGUpIHtcblx0XHRcdFx0XHRcdG1vZGUgPSBjYXBNb2RlO1x0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoIShtb2RlID0gQmFzaWMuYXJyYXlJbnRlcnNlY3QobW9kZSwgY2FwTW9kZSkpKSB7XG5cdFx0XHRcdFx0XHQvLyBpZiBjYXAgcmVxdWlyZXMgY29uZmxpY3RpbmcgbW9kZSAtIHJ1bnRpbWUgY2Fubm90IGZ1bGZpbGwgcmVxdWlyZWQgY2Fwc1xuXG5cdFx0XHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRcdEVudi5sb2coXCJcXHRcXHQlczogJXMgKGNvbmZsaWN0aW5nIG1vZGUgcmVxdWVzdGVkOiAlcylcIiwgY2FwLCB2YWx1ZSwgY2FwTW9kZSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiAobW9kZSA9IGZhbHNlKTtcblx0XHRcdFx0XHR9XHRcdFx0XHRcdFxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0XHRcdEVudi5sb2coXCJcXHRcXHQlczogJXMgKGNvbXBhdGlibGUgbW9kZXM6ICVzKVwiLCBjYXAsIHZhbHVlLCBtb2RlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChtb2RlKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5pbkFycmF5KGRlZmF1bHRNb2RlLCBtb2RlKSAhPT0gLTEgPyBkZWZhdWx0TW9kZSA6IG1vZGVbMF07XG5cdFx0XHR9IGVsc2UgaWYgKG1vZGUgPT09IGZhbHNlKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIGRlZmF1bHRNb2RlOyBcblx0fTtcblxuXG5cdC8qKlxuXHQgKiBUaGlyZCBwYXJ0eSBzaGltcyAoRmxhc2ggYW5kIFNpbHZlcmxpZ2h0KSByZXF1aXJlIGdsb2JhbCBldmVudCB0YXJnZXQgYWdhaW5zdCB3aGljaCB0aGV5XG5cdCAqIHdpbGwgZmlyZSB0aGVpciBldmVudHMuIEhvd2V2ZXIgd2hlbiBtb3hpZSBpcyBub3QgbG9hZGVkIHRvIGdsb2JhbCBuYW1lc3BhY2UsIGRlZmF1bHRcblx0ICogZXZlbnQgdGFyZ2V0IGlzIG5vdCBhY2Nlc3NpYmxlIGFuZCB3ZSBoYXZlIHRvIGNyZWF0ZSBhcnRpZmljaWFsIG9uZXMuXG5cdCAqXG5cdCAqIEBtZXRob2QgZ2V0R2xvYmFsRXZlbnRUYXJnZXRcblx0ICogQHN0YXRpY1xuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IE5hbWUgb2YgdGhlIGdsb2JhbCBldmVudCB0YXJnZXRcblx0ICovXG5cdFJ1bnRpbWUuZ2V0R2xvYmFsRXZlbnRUYXJnZXQgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAoL15tb3hpZVxcLi8udGVzdChFbnYuZ2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXIpICYmICFFbnYuY2FuKCdhY2Nlc3NfZ2xvYmFsX25zJykpIHtcblx0XHRcdHZhciB1bmlxdWVDYWxsYmFja05hbWUgPSBCYXNpYy5ndWlkKCdtb3hpZV9ldmVudF90YXJnZXRfJyk7XG5cblx0XHRcdHdpbmRvd1t1bmlxdWVDYWxsYmFja05hbWVdID0gZnVuY3Rpb24oZSwgZGF0YSkge1xuXHRcdFx0XHRFdmVudFRhcmdldC5pbnN0YW5jZS5kaXNwYXRjaEV2ZW50KGUsIGRhdGEpO1xuXHRcdFx0fTtcblxuXHRcdFx0RW52Lmdsb2JhbF9ldmVudF9kaXNwYXRjaGVyID0gdW5pcXVlQ2FsbGJhY2tOYW1lO1xuXHRcdH1cblxuXHRcdHJldHVybiBFbnYuZ2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXI7XG5cdH07XG5cblxuXHQvKipcblx0Q2FwYWJpbGl0eSBjaGVjayB0aGF0IGFsd2F5cyByZXR1cm5zIHRydWVcblxuXHRAcHJpdmF0ZVxuXHRAc3RhdGljXG5cdEByZXR1cm4ge1RydWV9XG5cdCovXG5cdFJ1bnRpbWUuY2FwVHJ1ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9O1xuXG5cdC8qKlxuXHRDYXBhYmlsaXR5IGNoZWNrIHRoYXQgYWx3YXlzIHJldHVybnMgZmFsc2VcblxuXHRAcHJpdmF0ZVxuXHRAc3RhdGljXG5cdEByZXR1cm4ge0ZhbHNlfVxuXHQqL1xuXHRSdW50aW1lLmNhcEZhbHNlID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9O1xuXG5cdC8qKlxuXHRFdmFsdWF0ZSB0aGUgZXhwcmVzc2lvbiB0byBib29sZWFuIHZhbHVlIGFuZCBjcmVhdGUgYSBmdW5jdGlvbiB0aGF0IGFsd2F5cyByZXR1cm5zIGl0LlxuXG5cdEBwcml2YXRlXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtNaXhlZH0gZXhwciBFeHByZXNzaW9uIHRvIGV2YWx1YXRlXG5cdEByZXR1cm4ge0Z1bmN0aW9ufSBGdW5jdGlvbiByZXR1cm5pbmcgdGhlIHJlc3VsdCBvZiBldmFsdWF0aW9uXG5cdCovXG5cdFJ1bnRpbWUuY2FwVGVzdCA9IGZ1bmN0aW9uKGV4cHIpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gISFleHByO1xuXHRcdH07XG5cdH07XG5cblx0cmV0dXJuIFJ1bnRpbWU7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9SdW50aW1lQ2xpZW50LmpzXG5cbi8qKlxuICogUnVudGltZUNsaWVudC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoJ21veGllL3J1bnRpbWUvUnVudGltZUNsaWVudCcsIFtcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2NvcmUvRXhjZXB0aW9ucycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL3J1bnRpbWUvUnVudGltZSdcbl0sIGZ1bmN0aW9uKEVudiwgeCwgQmFzaWMsIFJ1bnRpbWUpIHtcblx0LyoqXG5cdFNldCBvZiBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzLCByZXF1aXJlZCBieSBhIGNvbXBvbmVudCB0byBhY3F1aXJlIGFiaWxpdHkgdG8gY29ubmVjdCB0byBhIHJ1bnRpbWVcblxuXHRAY2xhc3MgbW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50XG5cdCovXG5cdHJldHVybiBmdW5jdGlvbiBSdW50aW1lQ2xpZW50KCkge1xuXHRcdHZhciBydW50aW1lO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdC8qKlxuXHRcdFx0Q29ubmVjdHMgdG8gdGhlIHJ1bnRpbWUgc3BlY2lmaWVkIGJ5IHRoZSBvcHRpb25zLiBXaWxsIGVpdGhlciBjb25uZWN0IHRvIGV4aXN0aW5nIHJ1bnRpbWUgb3IgY3JlYXRlIGEgbmV3IG9uZS5cblx0XHRcdEluY3JlbWVudHMgbnVtYmVyIG9mIGNsaWVudHMgY29ubmVjdGVkIHRvIHRoZSBzcGVjaWZpZWQgcnVudGltZS5cblxuXHRcdFx0QHByaXZhdGVcblx0XHRcdEBtZXRob2QgY29ubmVjdFJ1bnRpbWVcblx0XHRcdEBwYXJhbSB7TWl4ZWR9IG9wdGlvbnMgQ2FuIGJlIGEgcnVudG1lIHVpZCBvciBhIHNldCBvZiBrZXktdmFsdWUgcGFpcnMgZGVmaW5pbmcgcmVxdWlyZW1lbnRzIGFuZCBwcmUtcmVxdWlzaXRlc1xuXHRcdFx0Ki9cblx0XHRcdGNvbm5lY3RSdW50aW1lOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjb21wID0gdGhpcywgcnVpZDtcblxuXHRcdFx0XHRmdW5jdGlvbiBpbml0aWFsaXplKGl0ZW1zKSB7XG5cdFx0XHRcdFx0dmFyIHR5cGUsIGNvbnN0cnVjdG9yO1xuXG5cdFx0XHRcdFx0Ly8gaWYgd2UgcmFuIG91dCBvZiBydW50aW1lc1xuXHRcdFx0XHRcdGlmICghaXRlbXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ1J1bnRpbWVFcnJvcicsIG5ldyB4LlJ1bnRpbWVFcnJvcih4LlJ1bnRpbWVFcnJvci5OT1RfSU5JVF9FUlIpKTtcblx0XHRcdFx0XHRcdHJ1bnRpbWUgPSBudWxsO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHR5cGUgPSBpdGVtcy5zaGlmdCgpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0Y29uc3RydWN0b3IgPSBSdW50aW1lLmdldENvbnN0cnVjdG9yKHR5cGUpO1xuXHRcdFx0XHRcdGlmICghY29uc3RydWN0b3IpIHtcblx0XHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0RW52LmxvZyhcIkNvbnN0cnVjdG9yIGZvciAnJXMnIHJ1bnRpbWUgaXMgbm90IGF2YWlsYWJsZS5cIiwgdHlwZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpbml0aWFsaXplKGl0ZW1zKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRFbnYubG9nKFwiVHJ5aW5nIHJ1bnRpbWU6ICVzXCIsIHR5cGUpO1xuXHRcdFx0XHRcdFx0RW52LmxvZyhvcHRpb25zKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyB0cnkgaW5pdGlhbGl6aW5nIHRoZSBydW50aW1lXG5cdFx0XHRcdFx0cnVudGltZSA9IG5ldyBjb25zdHJ1Y3RvcihvcHRpb25zKTtcblxuXHRcdFx0XHRcdHJ1bnRpbWUuYmluZCgnSW5pdCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Ly8gbWFyayBydW50aW1lIGFzIGluaXRpYWxpemVkXG5cdFx0XHRcdFx0XHRydW50aW1lLmluaXRpYWxpemVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0XHRcdFx0XHRFbnYubG9nKFwiUnVudGltZSAnJXMnIGluaXRpYWxpemVkXCIsIHJ1bnRpbWUudHlwZSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGphaWxicmVhayAuLi5cblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdHJ1bnRpbWUuY2xpZW50cysrO1xuXHRcdFx0XHRcdFx0XHRjb21wLnJ1aWQgPSBydW50aW1lLnVpZDtcblx0XHRcdFx0XHRcdFx0Ly8gdGhpcyB3aWxsIGJlIHRyaWdnZXJlZCBvbiBjb21wb25lbnRcblx0XHRcdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdSdW50aW1lSW5pdCcsIHJ1bnRpbWUpO1xuXHRcdFx0XHRcdFx0fSwgMSk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRydW50aW1lLmJpbmQoJ0Vycm9yJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRcdEVudi5sb2coXCJSdW50aW1lICclcycgZmFpbGVkIHRvIGluaXRpYWxpemVcIiwgcnVudGltZS50eXBlKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cnVudGltZS5kZXN0cm95KCk7IC8vIHJ1bnRpbWUgY2Fubm90IGRlc3Ryb3kgaXRzZWxmIGZyb20gaW5zaWRlIGF0IGEgcmlnaHQgbW9tZW50LCB0aHVzIHdlIGRvIGl0IGhlcmVcblx0XHRcdFx0XHRcdGluaXRpYWxpemUoaXRlbXMpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0cnVudGltZS5iaW5kKCdFeGNlcHRpb24nLCBmdW5jdGlvbihlLCBlcnIpIHtcblx0XHRcdFx0XHRcdHZhciBtZXNzYWdlID0gZXJyLm5hbWUgKyBcIigjXCIgKyBlcnIuY29kZSArIFwiKVwiICsgKGVyci5tZXNzYWdlID8gXCIsIGZyb206IFwiICsgZXJyLm1lc3NhZ2UgOiAnJyk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0RW52LmxvZyhcIlJ1bnRpbWUgJyVzJyBoYXMgdGhyb3duIGFuIGV4Y2VwdGlvbjogJXNcIiwgdGhpcy50eXBlLCBtZXNzYWdlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcignUnVudGltZUVycm9yJywgbmV3IHguUnVudGltZUVycm9yKHguUnVudGltZUVycm9yLkVYQ0VQVElPTl9FUlIsIG1lc3NhZ2UpKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdEVudi5sb2coXCJcXHRzZWxlY3RlZCBtb2RlOiAlc1wiLCBydW50aW1lLm1vZGUpO1x0XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gY2hlY2sgaWYgcnVudGltZSBtYW5hZ2VkIHRvIHBpY2stdXAgb3BlcmF0aW9uYWwgbW9kZVxuXHRcdFx0XHRcdGlmICghcnVudGltZS5tb2RlKSB7XG5cdFx0XHRcdFx0XHRydW50aW1lLnRyaWdnZXIoJ0Vycm9yJyk7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cnVudGltZS5pbml0KCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjaGVjayBpZiBhIHBhcnRpY3VsYXIgcnVudGltZSB3YXMgcmVxdWVzdGVkXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2Yob3B0aW9ucykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cnVpZCA9IG9wdGlvbnM7XG5cdFx0XHRcdH0gZWxzZSBpZiAoQmFzaWMudHlwZU9mKG9wdGlvbnMucnVpZCkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cnVpZCA9IG9wdGlvbnMucnVpZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChydWlkKSB7XG5cdFx0XHRcdFx0cnVudGltZSA9IFJ1bnRpbWUuZ2V0UnVudGltZShydWlkKTtcblx0XHRcdFx0XHRpZiAocnVudGltZSkge1xuXHRcdFx0XHRcdFx0Y29tcC5ydWlkID0gcnVpZDtcblx0XHRcdFx0XHRcdHJ1bnRpbWUuY2xpZW50cysrO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJ1bnRpbWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIHRoZXJlIHNob3VsZCBiZSBhIHJ1bnRpbWUgYW5kIHRoZXJlJ3Mgbm9uZSAtIHdlaXJkIGNhc2Vcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LlJ1bnRpbWVFcnJvcih4LlJ1bnRpbWVFcnJvci5OT1RfSU5JVF9FUlIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIGluaXRpYWxpemUgYSBmcmVzaCBvbmUsIHRoYXQgZml0cyBydW50aW1lIGxpc3QgYW5kIHJlcXVpcmVkIGZlYXR1cmVzIGJlc3Rcblx0XHRcdFx0aW5pdGlhbGl6ZSgob3B0aW9ucy5ydW50aW1lX29yZGVyIHx8IFJ1bnRpbWUub3JkZXIpLnNwbGl0KC9cXHMqLFxccyovKSk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdC8qKlxuXHRcdFx0RGlzY29ubmVjdHMgZnJvbSB0aGUgcnVudGltZS4gRGVjcmVtZW50cyBudW1iZXIgb2YgY2xpZW50cyBjb25uZWN0ZWQgdG8gdGhlIHNwZWNpZmllZCBydW50aW1lLlxuXG5cdFx0XHRAcHJpdmF0ZVxuXHRcdFx0QG1ldGhvZCBkaXNjb25uZWN0UnVudGltZVxuXHRcdFx0Ki9cblx0XHRcdGRpc2Nvbm5lY3RSdW50aW1lOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKHJ1bnRpbWUgJiYgLS1ydW50aW1lLmNsaWVudHMgPD0gMCkge1xuXHRcdFx0XHRcdHJ1bnRpbWUuZGVzdHJveSgpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gb25jZSB0aGUgY29tcG9uZW50IGlzIGRpc2Nvbm5lY3RlZCwgaXQgc2hvdWxkbid0IGhhdmUgYWNjZXNzIHRvIHRoZSBydW50aW1lXG5cdFx0XHRcdHJ1bnRpbWUgPSBudWxsO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgdGhlIHJ1bnRpbWUgdG8gd2hpY2ggdGhlIGNsaWVudCBpcyBjdXJyZW50bHkgY29ubmVjdGVkLlxuXG5cdFx0XHRAbWV0aG9kIGdldFJ1bnRpbWVcblx0XHRcdEByZXR1cm4ge1J1bnRpbWV9IFJ1bnRpbWUgb3IgbnVsbCBpZiBjbGllbnQgaXMgbm90IGNvbm5lY3RlZFxuXHRcdFx0Ki9cblx0XHRcdGdldFJ1bnRpbWU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAocnVudGltZSAmJiBydW50aW1lLnVpZCkge1xuXHRcdFx0XHRcdHJldHVybiBydW50aW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBydW50aW1lID0gbnVsbDsgLy8gbWFrZSBzdXJlIHdlIGRvIG5vdCBsZWF2ZSB6b21iaWVzIHJhbWJsaW5nIGFyb3VuZFxuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdEhhbmR5IHNob3J0Y3V0IHRvIHNhZmVseSBpbnZva2UgcnVudGltZSBleHRlbnNpb24gbWV0aG9kcy5cblx0XHRcdFxuXHRcdFx0QHByaXZhdGVcblx0XHRcdEBtZXRob2QgZXhlY1xuXHRcdFx0QHJldHVybiB7TWl4ZWR9IFdoYXRldmVyIHJ1bnRpbWUgZXh0ZW5zaW9uIG1ldGhvZCByZXR1cm5zXG5cdFx0XHQqL1xuXHRcdFx0ZXhlYzogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBydW50aW1lID8gcnVudGltZS5leGVjLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiBudWxsO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFRlc3QgcnVudGltZSBjbGllbnQgZm9yIHNwZWNpZmljIGNhcGFiaWxpdHlcblx0XHRcdFxuXHRcdFx0QG1ldGhvZCBjYW5cblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBjYXBcblx0XHRcdEByZXR1cm4ge0Jvb2x9XG5cdFx0XHQqL1xuXHRcdFx0Y2FuOiBmdW5jdGlvbihjYXApIHtcblx0XHRcdFx0cmV0dXJuIHJ1bnRpbWUgPyBydW50aW1lLmNhbihjYXApIDogZmFsc2U7XG5cdFx0XHR9XG5cblx0XHR9KTtcblx0fTtcblxuXG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvZmlsZS9CbG9iLmpzXG5cbi8qKlxuICogQmxvYi5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoJ21veGllL2ZpbGUvQmxvYicsIFtcblx0J21veGllL2NvcmUvdXRpbHMvQmFzaWMnLFxuXHQnbW94aWUvY29yZS91dGlscy9FbmNvZGUnLFxuXHQnbW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50J1xuXSwgZnVuY3Rpb24oQmFzaWMsIEVuY29kZSwgUnVudGltZUNsaWVudCkge1xuXHRcblx0dmFyIGJsb2Jwb29sID0ge307XG5cblx0LyoqXG5cdEBjbGFzcyBtb3hpZS9maWxlL0Jsb2Jcblx0QGNvbnN0cnVjdG9yXG5cdEBwYXJhbSB7U3RyaW5nfSBydWlkIFVuaXF1ZSBpZCBvZiB0aGUgcnVudGltZSwgdG8gd2hpY2ggdGhpcyBibG9iIGJlbG9uZ3MgdG9cblx0QHBhcmFtIHtPYmplY3R9IGJsb2IgT2JqZWN0IFwiTmF0aXZlXCIgYmxvYiBvYmplY3QsIGFzIGl0IGlzIHJlcHJlc2VudGVkIGluIHRoZSBydW50aW1lXG5cdCovXG5cdGZ1bmN0aW9uIEJsb2IocnVpZCwgYmxvYikge1xuXG5cdFx0ZnVuY3Rpb24gX3NsaWNlRGV0YWNoZWQoc3RhcnQsIGVuZCwgdHlwZSkge1xuXHRcdFx0dmFyIGJsb2IsIGRhdGEgPSBibG9icG9vbFt0aGlzLnVpZF07XG5cblx0XHRcdGlmIChCYXNpYy50eXBlT2YoZGF0YSkgIT09ICdzdHJpbmcnIHx8ICFkYXRhLmxlbmd0aCkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gb3IgdGhyb3cgZXhjZXB0aW9uXG5cdFx0XHR9XG5cblx0XHRcdGJsb2IgPSBuZXcgQmxvYihudWxsLCB7XG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdHNpemU6IGVuZCAtIHN0YXJ0XG5cdFx0XHR9KTtcblx0XHRcdGJsb2IuZGV0YWNoKGRhdGEuc3Vic3RyKHN0YXJ0LCBibG9iLnNpemUpKTtcblxuXHRcdFx0cmV0dXJuIGJsb2I7XG5cdFx0fVxuXG5cdFx0UnVudGltZUNsaWVudC5jYWxsKHRoaXMpO1xuXG5cdFx0aWYgKHJ1aWQpIHtcdFxuXHRcdFx0dGhpcy5jb25uZWN0UnVudGltZShydWlkKTtcblx0XHR9XG5cblx0XHRpZiAoIWJsb2IpIHtcblx0XHRcdGJsb2IgPSB7fTtcblx0XHR9IGVsc2UgaWYgKEJhc2ljLnR5cGVPZihibG9iKSA9PT0gJ3N0cmluZycpIHsgLy8gZGF0YVVybCBvciBiaW5hcnkgc3RyaW5nXG5cdFx0XHRibG9iID0geyBkYXRhOiBibG9iIH07XG5cdFx0fVxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHRVbmlxdWUgaWQgb2YgdGhlIGNvbXBvbmVudFxuXG5cdFx0XHRAcHJvcGVydHkgdWlkXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0Ki9cblx0XHRcdHVpZDogYmxvYi51aWQgfHwgQmFzaWMuZ3VpZCgndWlkXycpLFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29ubmVjdGVkIHJ1bnRpbWUsIGlmIGZhbHN5LCB0aGVuIHJ1bnRpbWUgd2lsbCBoYXZlIHRvIGJlIGluaXRpYWxpemVkIFxuXHRcdFx0YmVmb3JlIHRoaXMgQmxvYiBjYW4gYmUgdXNlZCwgbW9kaWZpZWQgb3Igc2VudFxuXG5cdFx0XHRAcHJvcGVydHkgcnVpZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRydWlkOiBydWlkLFxuXHRcblx0XHRcdC8qKlxuXHRcdFx0U2l6ZSBvZiBibG9iXG5cblx0XHRcdEBwcm9wZXJ0eSBzaXplXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgMFxuXHRcdFx0Ki9cblx0XHRcdHNpemU6IGJsb2Iuc2l6ZSB8fCAwLFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdE1pbWUgdHlwZSBvZiBibG9iXG5cblx0XHRcdEBwcm9wZXJ0eSB0eXBlXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0QGRlZmF1bHQgJydcblx0XHRcdCovXG5cdFx0XHR0eXBlOiBibG9iLnR5cGUgfHwgJycsXG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0QG1ldGhvZCBzbGljZVxuXHRcdFx0QHBhcmFtIHtOdW1iZXJ9IFtzdGFydD0wXVxuXHRcdFx0Ki9cblx0XHRcdHNsaWNlOiBmdW5jdGlvbihzdGFydCwgZW5kLCB0eXBlKSB7XHRcdFxuXHRcdFx0XHRpZiAodGhpcy5pc0RldGFjaGVkKCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gX3NsaWNlRGV0YWNoZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKHRoaXMsICdCbG9iJywgJ3NsaWNlJywgdGhpcy5nZXRTb3VyY2UoKSwgc3RhcnQsIGVuZCwgdHlwZSk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgXCJuYXRpdmVcIiBibG9iIG9iamVjdCAoYXMgaXQgaXMgcmVwcmVzZW50ZWQgaW4gY29ubmVjdGVkIHJ1bnRpbWUpIG9yIG51bGwgaWYgbm90IGZvdW5kXG5cblx0XHRcdEBtZXRob2QgZ2V0U291cmNlXG5cdFx0XHRAcmV0dXJuIHtCbG9ifSBSZXR1cm5zIFwibmF0aXZlXCIgYmxvYiBvYmplY3Qgb3IgbnVsbCBpZiBub3QgZm91bmRcblx0XHRcdCovXG5cdFx0XHRnZXRTb3VyY2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIWJsb2Jwb29sW3RoaXMudWlkXSkge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1x0XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGJsb2Jwb29sW3RoaXMudWlkXTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKiBcblx0XHRcdERldGFjaGVzIGJsb2IgZnJvbSBhbnkgcnVudGltZSB0aGF0IGl0IGRlcGVuZHMgb24gYW5kIGluaXRpYWxpemUgd2l0aCBzdGFuZGFsb25lIHZhbHVlXG5cblx0XHRcdEBtZXRob2QgZGV0YWNoXG5cdFx0XHRAcHJvdGVjdGVkXG5cdFx0XHRAcGFyYW0ge0RPTVN0cmluZ30gW2RhdGE9JyddIFN0YW5kYWxvbmUgdmFsdWVcblx0XHRcdCovXG5cdFx0XHRkZXRhY2g6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0aWYgKHRoaXMucnVpZCkge1xuXHRcdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmV4ZWMuY2FsbCh0aGlzLCAnQmxvYicsICdkZXN0cm95Jyk7XG5cdFx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHRcdHRoaXMucnVpZCA9IG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRkYXRhID0gZGF0YSB8fCAnJztcblxuXHRcdFx0XHQvLyBpZiBkYXRhVXJsLCBjb252ZXJ0IHRvIGJpbmFyeSBzdHJpbmdcblx0XHRcdFx0aWYgKGRhdGEuc3Vic3RyKDAsIDUpID09ICdkYXRhOicpIHtcblx0XHRcdFx0XHR2YXIgYmFzZTY0T2Zmc2V0ID0gZGF0YS5pbmRleE9mKCc7YmFzZTY0LCcpO1xuXHRcdFx0XHRcdHRoaXMudHlwZSA9IGRhdGEuc3Vic3RyaW5nKDUsIGJhc2U2NE9mZnNldCk7XG5cdFx0XHRcdFx0ZGF0YSA9IEVuY29kZS5hdG9iKGRhdGEuc3Vic3RyaW5nKGJhc2U2NE9mZnNldCArIDgpKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuc2l6ZSA9IGRhdGEubGVuZ3RoO1xuXG5cdFx0XHRcdGJsb2Jwb29sW3RoaXMudWlkXSA9IGRhdGE7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdENoZWNrcyBpZiBibG9iIGlzIHN0YW5kYWxvbmUgKGRldGFjaGVkIG9mIGFueSBydW50aW1lKVxuXHRcdFx0XG5cdFx0XHRAbWV0aG9kIGlzRGV0YWNoZWRcblx0XHRcdEBwcm90ZWN0ZWRcblx0XHRcdEByZXR1cm4ge0Jvb2xlYW59XG5cdFx0XHQqL1xuXHRcdFx0aXNEZXRhY2hlZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAhdGhpcy5ydWlkICYmIEJhc2ljLnR5cGVPZihibG9icG9vbFt0aGlzLnVpZF0pID09PSAnc3RyaW5nJztcblx0XHRcdH0sXG5cdFx0XHRcblx0XHRcdC8qKiBcblx0XHRcdERlc3Ryb3kgQmxvYiBhbmQgZnJlZSBhbnkgcmVzb3VyY2VzIGl0IHdhcyB1c2luZ1xuXG5cdFx0XHRAbWV0aG9kIGRlc3Ryb3lcblx0XHRcdCovXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5kZXRhY2goKTtcblx0XHRcdFx0ZGVsZXRlIGJsb2Jwb29sW3RoaXMudWlkXTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdFxuXHRcdGlmIChibG9iLmRhdGEpIHtcblx0XHRcdHRoaXMuZGV0YWNoKGJsb2IuZGF0YSk7IC8vIGF1dG8tZGV0YWNoIGlmIHBheWxvYWQgaGFzIGJlZW4gcGFzc2VkXG5cdFx0fSBlbHNlIHtcblx0XHRcdGJsb2Jwb29sW3RoaXMudWlkXSA9IGJsb2I7XHRcblx0XHR9XG5cdH1cblx0XG5cdHJldHVybiBCbG9iO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2NvcmUvSTE4bi5qc1xuXG4vKipcbiAqIEkxOG4uanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKFwibW94aWUvY29yZS9JMThuXCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKEJhc2ljKSB7XG5cdHZhciBpMThuID0ge307XG5cblx0LyoqXG5cdEBjbGFzcyBtb3hpZS9jb3JlL0kxOG5cblx0Ki9cblx0cmV0dXJuIHtcblx0XHQvKipcblx0XHQgKiBFeHRlbmRzIHRoZSBsYW5ndWFnZSBwYWNrIG9iamVjdCB3aXRoIG5ldyBpdGVtcy5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrIExhbmd1YWdlIHBhY2sgaXRlbXMgdG8gYWRkLlxuXHRcdCAqIEByZXR1cm4ge09iamVjdH0gRXh0ZW5kZWQgbGFuZ3VhZ2UgcGFjayBvYmplY3QuXG5cdFx0ICovXG5cdFx0YWRkSTE4bjogZnVuY3Rpb24ocGFjaykge1xuXHRcdFx0cmV0dXJuIEJhc2ljLmV4dGVuZChpMThuLCBwYWNrKTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogVHJhbnNsYXRlcyB0aGUgc3BlY2lmaWVkIHN0cmluZyBieSBjaGVja2luZyBmb3IgdGhlIGVuZ2xpc2ggc3RyaW5nIGluIHRoZSBsYW5ndWFnZSBwYWNrIGxvb2t1cC5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgU3RyaW5nIHRvIGxvb2sgZm9yLlxuXHRcdCAqIEByZXR1cm4ge1N0cmluZ30gVHJhbnNsYXRlZCBzdHJpbmcgb3IgdGhlIGlucHV0IHN0cmluZyBpZiBpdCB3YXNuJ3QgZm91bmQuXG5cdFx0ICovXG5cdFx0dHJhbnNsYXRlOiBmdW5jdGlvbihzdHIpIHtcblx0XHRcdHJldHVybiBpMThuW3N0cl0gfHwgc3RyO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBTaG9ydGN1dCBmb3IgdHJhbnNsYXRlIGZ1bmN0aW9uXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBsb29rIGZvci5cblx0XHQgKiBAcmV0dXJuIHtTdHJpbmd9IFRyYW5zbGF0ZWQgc3RyaW5nIG9yIHRoZSBpbnB1dCBzdHJpbmcgaWYgaXQgd2Fzbid0IGZvdW5kLlxuXHRcdCAqL1xuXHRcdF86IGZ1bmN0aW9uKHN0cikge1xuXHRcdFx0cmV0dXJuIHRoaXMudHJhbnNsYXRlKHN0cik7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFBzZXVkbyBzcHJpbnRmIGltcGxlbWVudGF0aW9uIC0gc2ltcGxlIHdheSB0byByZXBsYWNlIHRva2VucyB3aXRoIHNwZWNpZmllZCB2YWx1ZXMuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB3aXRoIHRva2Vuc1xuXHRcdCAqIEByZXR1cm4ge1N0cmluZ30gU3RyaW5nIHdpdGggcmVwbGFjZWQgdG9rZW5zXG5cdFx0ICovXG5cdFx0c3ByaW50ZjogZnVuY3Rpb24oc3RyKSB7XG5cdFx0XHR2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcblxuXHRcdFx0cmV0dXJuIHN0ci5yZXBsYWNlKC8lW2Etel0vZywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciB2YWx1ZSA9IGFyZ3Muc2hpZnQoKTtcblx0XHRcdFx0cmV0dXJuIEJhc2ljLnR5cGVPZih2YWx1ZSkgIT09ICd1bmRlZmluZWQnID8gdmFsdWUgOiAnJztcblx0XHRcdH0pO1xuXHRcdH1cblx0fTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL01pbWUuanNcblxuLyoqXG4gKiBNaW1lLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL2NvcmUvdXRpbHMvTWltZVxuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKFwibW94aWUvY29yZS91dGlscy9NaW1lXCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS9JMThuXCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCBJMThuKSB7XG5cblx0dmFyIG1pbWVEYXRhID0gXCJcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi9tc3dvcmQsZG9jIGRvdCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi9wZGYscGRmLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3BncC1zaWduYXR1cmUscGdwLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3Bvc3RzY3JpcHQscHMgYWkgZXBzLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3J0ZixydGYsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsLHhscyB4bGIgeGx0IHhsYSxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludCxwcHQgcHBzIHBvdCBwcGEsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vemlwLHppcCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaCxzd2Ygc3dmbCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCxkb2N4LFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLnRlbXBsYXRlLGRvdHgsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQseGxzeCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQucHJlc2VudGF0aW9ubWwucHJlc2VudGF0aW9uLHBwdHgsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnByZXNlbnRhdGlvbm1sLnRlbXBsYXRlLHBvdHgsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnByZXNlbnRhdGlvbm1sLnNsaWRlc2hvdyxwcHN4LFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3gtamF2YXNjcmlwdCxqcyxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi9qc29uLGpzb24sXCIgK1xuXHRcdFwiYXVkaW8vbXBlZyxtcDMgbXBnYSBtcGVnYSBtcDIsXCIgK1xuXHRcdFwiYXVkaW8veC13YXYsd2F2LFwiICtcblx0XHRcImF1ZGlvL3gtbTRhLG00YSxcIiArXG5cdFx0XCJhdWRpby9vZ2csb2dhIG9nZyxcIiArXG5cdFx0XCJhdWRpby9haWZmLGFpZmYgYWlmLFwiICtcblx0XHRcImF1ZGlvL2ZsYWMsZmxhYyxcIiArXG5cdFx0XCJhdWRpby9hYWMsYWFjLFwiICtcblx0XHRcImF1ZGlvL2FjMyxhYzMsXCIgK1xuXHRcdFwiYXVkaW8veC1tcy13bWEsd21hLFwiICtcblx0XHRcImltYWdlL2JtcCxibXAsXCIgK1xuXHRcdFwiaW1hZ2UvZ2lmLGdpZixcIiArXG5cdFx0XCJpbWFnZS9qcGVnLGpwZyBqcGVnIGpwZSxcIiArXG5cdFx0XCJpbWFnZS9waG90b3Nob3AscHNkLFwiICtcblx0XHRcImltYWdlL3BuZyxwbmcsXCIgK1xuXHRcdFwiaW1hZ2Uvc3ZnK3htbCxzdmcgc3ZneixcIiArXG5cdFx0XCJpbWFnZS90aWZmLHRpZmYgdGlmLFwiICtcblx0XHRcInRleHQvcGxhaW4sYXNjIHR4dCB0ZXh0IGRpZmYgbG9nLFwiICtcblx0XHRcInRleHQvaHRtbCxodG0gaHRtbCB4aHRtbCxcIiArXG5cdFx0XCJ0ZXh0L2Nzcyxjc3MsXCIgK1xuXHRcdFwidGV4dC9jc3YsY3N2LFwiICtcblx0XHRcInRleHQvcnRmLHJ0ZixcIiArXG5cdFx0XCJ2aWRlby9tcGVnLG1wZWcgbXBnIG1wZSBtMnYsXCIgK1xuXHRcdFwidmlkZW8vcXVpY2t0aW1lLHF0IG1vdixcIiArXG5cdFx0XCJ2aWRlby9tcDQsbXA0LFwiICtcblx0XHRcInZpZGVvL3gtbTR2LG00dixcIiArXG5cdFx0XCJ2aWRlby94LWZsdixmbHYsXCIgK1xuXHRcdFwidmlkZW8veC1tcy13bXYsd212LFwiICtcblx0XHRcInZpZGVvL2F2aSxhdmksXCIgK1xuXHRcdFwidmlkZW8vd2VibSx3ZWJtLFwiICtcblx0XHRcInZpZGVvLzNncHAsM2dwcCAzZ3AsXCIgK1xuXHRcdFwidmlkZW8vM2dwcDIsM2cyLFwiICtcblx0XHRcInZpZGVvL3ZuZC5ybi1yZWFsdmlkZW8scnYsXCIgK1xuXHRcdFwidmlkZW8vb2dnLG9ndixcIiArXG5cdFx0XCJ2aWRlby94LW1hdHJvc2thLG1rdixcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LmZvcm11bGEtdGVtcGxhdGUsb3RmLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSxleGVcIjtcblxuXG5cdC8qKlxuXHQgKiBNYXAgb2YgbWltZXMgdG8gZXh0ZW5zaW9uc1xuXHQgKlxuXHQgKiBAcHJvcGVydHkgbWltZXNcblx0ICogQHR5cGUge09iamVjdH1cblx0ICovXG5cdHZhciBtaW1lcyA9IHt9O1xuXG5cdC8qKlxuXHQgKiBNYXAgb2YgZXh0ZW5zaW9ucyB0byBtaW1lc1xuXHQgKlxuXHQgKiBAcHJvcGVydHkgZXh0ZW5zaW9uc1xuXHQgKiBAdHlwZSB7T2JqZWN0fVxuXHQgKi9cblx0dmFyIGV4dGVuc2lvbnMgPSB7fTtcblxuXG5cdC8qKlxuXHQqIFBhcnNlcyBtaW1lRGF0YSBzdHJpbmcgaW50byBhIG1pbWVzIGFuZCBleHRlbnNpb25zIGxvb2t1cCBtYXBzLiBTdHJpbmcgc2hvdWxkIGhhdmUgdGhlXG5cdCogZm9sbG93aW5nIGZvcm1hdDpcblx0KlxuXHQqIGFwcGxpY2F0aW9uL21zd29yZCxkb2MgZG90LGFwcGxpY2F0aW9uL3BkZixwZGYsIC4uLlxuXHQqXG5cdCogc28gbWltZS10eXBlIGZvbGxvd2VkIGJ5IGNvbW1hIGFuZCBmb2xsb3dlZCBieSBzcGFjZS1zZXBhcmF0ZWQgbGlzdCBvZiBhc3NvY2lhdGVkIGV4dGVuc2lvbnMsXG5cdCogdGhlbiBjb21tYSBhZ2FpbiBhbmQgdGhlbiBhbm90aGVyIG1pbWUtdHlwZSwgZXRjLlxuXHQqXG5cdCogSWYgaW52b2tlZCBleHRlcm5hbGx5IHdpbGwgcmVwbGFjZSBvdmVycmlkZSBpbnRlcm5hbCBsb29rdXAgbWFwcyB3aXRoIHVzZXItcHJvdmlkZWQgZGF0YS5cblx0KlxuXHQqIEBtZXRob2QgYWRkTWltZVR5cGVcblx0KiBAcGFyYW0ge1N0cmluZ30gbWltZURhdGFcblx0Ki9cblx0dmFyIGFkZE1pbWVUeXBlID0gZnVuY3Rpb24gKG1pbWVEYXRhKSB7XG5cdFx0dmFyIGl0ZW1zID0gbWltZURhdGEuc3BsaXQoLywvKSwgaSwgaWksIGV4dDtcblxuXHRcdGZvciAoaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gMikge1xuXHRcdFx0ZXh0ID0gaXRlbXNbaSArIDFdLnNwbGl0KC8gLyk7XG5cblx0XHRcdC8vIGV4dGVuc2lvbiB0byBtaW1lIGxvb2t1cFxuXHRcdFx0Zm9yIChpaSA9IDA7IGlpIDwgZXh0Lmxlbmd0aDsgaWkrKykge1xuXHRcdFx0XHRtaW1lc1tleHRbaWldXSA9IGl0ZW1zW2ldO1xuXHRcdFx0fVxuXHRcdFx0Ly8gbWltZSB0byBleHRlbnNpb24gbG9va3VwXG5cdFx0XHRleHRlbnNpb25zW2l0ZW1zW2ldXSA9IGV4dDtcblx0XHR9XG5cdH07XG5cblxuXHR2YXIgZXh0TGlzdDJtaW1lcyA9IGZ1bmN0aW9uIChmaWx0ZXJzLCBhZGRNaXNzaW5nRXh0ZW5zaW9ucykge1xuXHRcdHZhciBleHQsIGksIGlpLCB0eXBlLCBtaW1lcyA9IFtdO1xuXG5cdFx0Ly8gY29udmVydCBleHRlbnNpb25zIHRvIG1pbWUgdHlwZXMgbGlzdFxuXHRcdGZvciAoaSA9IDA7IGkgPCBmaWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRleHQgPSBmaWx0ZXJzW2ldLmV4dGVuc2lvbnMudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKixcXHMqLyk7XG5cblx0XHRcdGZvciAoaWkgPSAwOyBpaSA8IGV4dC5sZW5ndGg7IGlpKyspIHtcblxuXHRcdFx0XHQvLyBpZiB0aGVyZSdzIGFuIGFzdGVyaXNrIGluIHRoZSBsaXN0LCB0aGVuIGFjY2VwdCBhdHRyaWJ1dGUgaXMgbm90IHJlcXVpcmVkXG5cdFx0XHRcdGlmIChleHRbaWldID09PSAnKicpIHtcblx0XHRcdFx0XHRyZXR1cm4gW107XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0eXBlID0gbWltZXNbZXh0W2lpXV07XG5cblx0XHRcdFx0Ly8gZnV0dXJlIGJyb3dzZXJzIHNob3VsZCBmaWx0ZXIgYnkgZXh0ZW5zaW9uLCBmaW5hbGx5XG5cdFx0XHRcdGlmIChhZGRNaXNzaW5nRXh0ZW5zaW9ucyAmJiAvXlxcdyskLy50ZXN0KGV4dFtpaV0pKSB7XG5cdFx0XHRcdFx0bWltZXMucHVzaCgnLicgKyBleHRbaWldKTtcblx0XHRcdFx0fSBlbHNlIGlmICh0eXBlICYmIEJhc2ljLmluQXJyYXkodHlwZSwgbWltZXMpID09PSAtMSkge1xuXHRcdFx0XHRcdG1pbWVzLnB1c2godHlwZSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIXR5cGUpIHtcblx0XHRcdFx0XHQvLyBpZiB3ZSBoYXZlIG5vIHR5cGUgaW4gb3VyIG1hcCwgdGhlbiBhY2NlcHQgYWxsXG5cdFx0XHRcdFx0cmV0dXJuIFtdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBtaW1lcztcblx0fTtcblxuXG5cdHZhciBtaW1lczJleHRzID0gZnVuY3Rpb24obWltZXMpIHtcblx0XHR2YXIgZXh0cyA9IFtdO1xuXG5cdFx0QmFzaWMuZWFjaChtaW1lcywgZnVuY3Rpb24obWltZSkge1xuXHRcdFx0bWltZSA9IG1pbWUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0aWYgKG1pbWUgPT09ICcqJykge1xuXHRcdFx0XHRleHRzID0gW107XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gY2hlY2sgaWYgdGhpcyB0aGluZyBsb29rcyBsaWtlIG1pbWUgdHlwZVxuXHRcdFx0dmFyIG0gPSBtaW1lLm1hdGNoKC9eKFxcdyspXFwvKFxcKnxcXHcrKSQvKTtcblx0XHRcdGlmIChtKSB7XG5cdFx0XHRcdGlmIChtWzJdID09PSAnKicpIHtcblx0XHRcdFx0XHQvLyB3aWxkY2FyZCBtaW1lIHR5cGUgZGV0ZWN0ZWRcblx0XHRcdFx0XHRCYXNpYy5lYWNoKGV4dGVuc2lvbnMsIGZ1bmN0aW9uKGFyciwgbWltZSkge1xuXHRcdFx0XHRcdFx0aWYgKChuZXcgUmVnRXhwKCdeJyArIG1bMV0gKyAnLycpKS50ZXN0KG1pbWUpKSB7XG5cdFx0XHRcdFx0XHRcdFtdLnB1c2guYXBwbHkoZXh0cywgZXh0ZW5zaW9uc1ttaW1lXSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZXh0ZW5zaW9uc1ttaW1lXSkge1xuXHRcdFx0XHRcdFtdLnB1c2guYXBwbHkoZXh0cywgZXh0ZW5zaW9uc1ttaW1lXSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gZXh0cztcblx0fTtcblxuXG5cdHZhciBtaW1lczJleHRMaXN0ID0gZnVuY3Rpb24obWltZXMpIHtcblx0XHR2YXIgYWNjZXB0ID0gW10sIGV4dHMgPSBbXTtcblxuXHRcdGlmIChCYXNpYy50eXBlT2YobWltZXMpID09PSAnc3RyaW5nJykge1xuXHRcdFx0bWltZXMgPSBCYXNpYy50cmltKG1pbWVzKS5zcGxpdCgvXFxzKixcXHMqLyk7XG5cdFx0fVxuXG5cdFx0ZXh0cyA9IG1pbWVzMmV4dHMobWltZXMpO1xuXG5cdFx0YWNjZXB0LnB1c2goe1xuXHRcdFx0dGl0bGU6IEkxOG4udHJhbnNsYXRlKCdGaWxlcycpLFxuXHRcdFx0ZXh0ZW5zaW9uczogZXh0cy5sZW5ndGggPyBleHRzLmpvaW4oJywnKSA6ICcqJ1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGFjY2VwdDtcblx0fTtcblxuXHQvKipcblx0ICogRXh0cmFjdCBleHRlbnNpb24gZnJvbSB0aGUgZ2l2ZW4gZmlsZW5hbWVcblx0ICpcblx0ICogQG1ldGhvZCBnZXRGaWxlRXh0ZW5zaW9uXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBmaWxlTmFtZVxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IEZpbGUgZXh0ZW5zaW9uXG5cdCAqL1xuXHR2YXIgZ2V0RmlsZUV4dGVuc2lvbiA9IGZ1bmN0aW9uKGZpbGVOYW1lKSB7XG5cdFx0dmFyIG1hdGNoZXMgPSBmaWxlTmFtZSAmJiBmaWxlTmFtZS5tYXRjaCgvXFwuKFteLl0rKSQvKTtcblx0XHRpZiAobWF0Y2hlcykge1xuXHRcdFx0cmV0dXJuIG1hdGNoZXNbMV0udG9Mb3dlckNhc2UoKTtcblx0XHR9XG5cdFx0cmV0dXJuICcnO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIEdldCBmaWxlIG1pbWUtdHlwZSBmcm9tIGl0J3MgZmlsZW5hbWUgLSB3aWxsIHRyeSB0byBtYXRjaCB0aGUgZXh0ZW5zaW9uXG5cdCAqIGFnYWluc3QgaW50ZXJuYWwgbWltZS10eXBlIGxvb2t1cCBtYXBcblx0ICpcblx0ICogQG1ldGhvZCBnZXRGaWxlTWltZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gZmlsZU5hbWVcblx0ICogQHJldHVybiBGaWxlIG1pbWUtdHlwZSBpZiBmb3VuZCBvciBhbiBlbXB0eSBzdHJpbmcgaWYgbm90XG5cdCAqL1xuXHR2YXIgZ2V0RmlsZU1pbWUgPSBmdW5jdGlvbihmaWxlTmFtZSkge1xuXHRcdHJldHVybiBtaW1lc1tnZXRGaWxlRXh0ZW5zaW9uKGZpbGVOYW1lKV0gfHwgJyc7XG5cdH07XG5cblxuXHRhZGRNaW1lVHlwZShtaW1lRGF0YSk7XG5cblx0cmV0dXJuIHtcblx0XHRtaW1lczogbWltZXMsXG5cdFx0ZXh0ZW5zaW9uczogZXh0ZW5zaW9ucyxcblx0XHRhZGRNaW1lVHlwZTogYWRkTWltZVR5cGUsXG5cdFx0ZXh0TGlzdDJtaW1lczogZXh0TGlzdDJtaW1lcyxcblx0XHRtaW1lczJleHRzOiBtaW1lczJleHRzLFxuXHRcdG1pbWVzMmV4dExpc3Q6IG1pbWVzMmV4dExpc3QsXG5cdFx0Z2V0RmlsZUV4dGVuc2lvbjogZ2V0RmlsZUV4dGVuc2lvbixcblx0XHRnZXRGaWxlTWltZTogZ2V0RmlsZU1pbWVcblx0fVxufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbmRlZmluZSgnbW94aWUvZmlsZS9GaWxlSW5wdXQnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2NvcmUvdXRpbHMvTWltZScsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0RvbScsXG5cdCdtb3hpZS9jb3JlL0V4Y2VwdGlvbnMnLFxuXHQnbW94aWUvY29yZS9FdmVudFRhcmdldCcsXG5cdCdtb3hpZS9jb3JlL0kxOG4nLFxuXHQnbW94aWUvcnVudGltZS9SdW50aW1lJyxcblx0J21veGllL3J1bnRpbWUvUnVudGltZUNsaWVudCdcbl0sIGZ1bmN0aW9uKEJhc2ljLCBFbnYsIE1pbWUsIERvbSwgeCwgRXZlbnRUYXJnZXQsIEkxOG4sIFJ1bnRpbWUsIFJ1bnRpbWVDbGllbnQpIHtcblx0LyoqXG5cdFByb3ZpZGVzIGEgY29udmVuaWVudCB3YXkgdG8gY3JlYXRlIGNyb3NzLWJyb3dzZXIgZmlsZS1waWNrZXIuIEdlbmVyYXRlcyBmaWxlIHNlbGVjdGlvbiBkaWFsb2cgb24gY2xpY2ssXG5cdGNvbnZlcnRzIHNlbGVjdGVkIGZpbGVzIHRvIF9GaWxlXyBvYmplY3RzLCB0byBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggX0ltYWdlXywgcHJlbG9hZGVkIGluIG1lbW9yeVxuXHR3aXRoIF9GaWxlUmVhZGVyXyBvciB1cGxvYWRlZCB0byBhIHNlcnZlciB0aHJvdWdoIF9YTUxIdHRwUmVxdWVzdF8uXG5cblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZUlucHV0XG5cdEBjb25zdHJ1Y3RvclxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdEBwYXJhbSB7T2JqZWN0fFN0cmluZ3xET01FbGVtZW50fSBvcHRpb25zIElmIG9wdGlvbnMgaXMgc3RyaW5nIG9yIG5vZGUsIGFyZ3VtZW50IGlzIGNvbnNpZGVyZWQgYXMgX2Jyb3dzZVxcX2J1dHRvbl8uXG5cdFx0QHBhcmFtIHtTdHJpbmd8RE9NRWxlbWVudH0gb3B0aW9ucy5icm93c2VfYnV0dG9uIERPTSBFbGVtZW50IHRvIHR1cm4gaW50byBmaWxlIHBpY2tlci5cblx0XHRAcGFyYW0ge0FycmF5fSBbb3B0aW9ucy5hY2NlcHRdIEFycmF5IG9mIG1pbWUgdHlwZXMgdG8gYWNjZXB0LiBCeSBkZWZhdWx0IGFjY2VwdHMgYWxsLlxuXHRcdEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMubXVsdGlwbGU9ZmFsc2VdIEVuYWJsZSBzZWxlY3Rpb24gb2YgbXVsdGlwbGUgZmlsZXMuXG5cdFx0QHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5kaXJlY3Rvcnk9ZmFsc2VdIFR1cm4gZmlsZSBpbnB1dCBpbnRvIHRoZSBmb2xkZXIgaW5wdXQgKGNhbm5vdCBiZSBib3RoIGF0IHRoZSBzYW1lIHRpbWUpLlxuXHRcdEBwYXJhbSB7U3RyaW5nfERPTUVsZW1lbnR9IFtvcHRpb25zLmNvbnRhaW5lcl0gRE9NIEVsZW1lbnQgdG8gdXNlIGFzIGEgY29udGFpbmVyIGZvciBmaWxlLXBpY2tlci4gRGVmYXVsdHMgdG8gcGFyZW50Tm9kZVxuXHRcdGZvciBfYnJvd3NlXFxfYnV0dG9uXy5cblx0XHRAcGFyYW0ge09iamVjdHxTdHJpbmd9IFtvcHRpb25zLnJlcXVpcmVkX2NhcHNdIFNldCBvZiByZXF1aXJlZCBjYXBhYmlsaXRpZXMsIHRoYXQgY2hvc2VuIHJ1bnRpbWUgbXVzdCBzdXBwb3J0LlxuXG5cdEBleGFtcGxlXG5cdFx0PGRpdiBpZD1cImNvbnRhaW5lclwiPlxuXHRcdFx0PGEgaWQ9XCJmaWxlLXBpY2tlclwiIGhyZWY9XCJqYXZhc2NyaXB0OjtcIj5Ccm93c2UuLi48L2E+XG5cdFx0PC9kaXY+XG5cblx0XHQ8c2NyaXB0PlxuXHRcdFx0dmFyIGZpbGVJbnB1dCA9IG5ldyBtb3hpZS5maWxlLkZpbGVJbnB1dCh7XG5cdFx0XHRcdGJyb3dzZV9idXR0b246ICdmaWxlLXBpY2tlcicsIC8vIG9yIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlLXBpY2tlcicpXG5cdFx0XHRcdGNvbnRhaW5lcjogJ2NvbnRhaW5lcicsXG5cdFx0XHRcdGFjY2VwdDogW1xuXHRcdFx0XHRcdHt0aXRsZTogXCJJbWFnZSBmaWxlc1wiLCBleHRlbnNpb25zOiBcImpwZyxnaWYscG5nXCJ9IC8vIGFjY2VwdCBvbmx5IGltYWdlc1xuXHRcdFx0XHRdLFxuXHRcdFx0XHRtdWx0aXBsZTogdHJ1ZSAvLyBhbGxvdyBtdWx0aXBsZSBmaWxlIHNlbGVjdGlvblxuXHRcdFx0fSk7XG5cblx0XHRcdGZpbGVJbnB1dC5vbmNoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0Ly8gZG8gc29tZXRoaW5nIHRvIGZpbGVzIGFycmF5XG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhlLnRhcmdldC5maWxlcyk7IC8vIG9yIHRoaXMuZmlsZXMgb3IgZmlsZUlucHV0LmZpbGVzXG5cdFx0XHR9O1xuXG5cdFx0XHRmaWxlSW5wdXQuaW5pdCgpOyAvLyBpbml0aWFsaXplXG5cdFx0PC9zY3JpcHQ+XG5cdCovXG5cdHZhciBkaXNwYXRjaGVzID0gW1xuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBydW50aW1lIGlzIGNvbm5lY3RlZCBhbmQgZmlsZS1waWNrZXIgaXMgcmVhZHkgdG8gYmUgdXNlZC5cblxuXHRcdEBldmVudCByZWFkeVxuXHRcdEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHRcdCovXG5cdFx0J3JlYWR5JyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgcmlnaHQgYWZ0ZXIgW3JlYWR5XSgjZXZlbnRfcmVhZHkpIGV2ZW50LCBhbmQgd2hlbmV2ZXIgW3JlZnJlc2goKV0oI21ldGhvZF9yZWZyZXNoKSBpcyBpbnZva2VkLlxuXHRcdENoZWNrIFtjb3JyZXNwb25kaW5nIGRvY3VtZW50YXRpb24gZW50cnldKCNtZXRob2RfcmVmcmVzaCkgZm9yIG1vcmUgaW5mby5cblxuXHRcdEBldmVudCByZWZyZXNoXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBzZWxlY3Rpb24gb2YgZmlsZXMgaW4gdGhlIGRpYWxvZyBpcyBjb21wbGV0ZS5cblxuXHRcdEBldmVudCBjaGFuZ2Vcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdjaGFuZ2UnLFxuXG5cdFx0J2NhbmNlbCcsIC8vIFRPRE86IG1pZ2h0IGJlIHVzZWZ1bFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIG1vdXNlIGN1cnNvciBlbnRlcnMgZmlsZS1waWNrZXIgYXJlYS4gQ2FuIGJlIHVzZWQgdG8gc3R5bGUgZWxlbWVudFxuXHRcdGFjY29yZGluZ2x5LlxuXG5cdFx0QGV2ZW50IG1vdXNlZW50ZXJcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdtb3VzZWVudGVyJyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBtb3VzZSBjdXJzb3IgbGVhdmVzIGZpbGUtcGlja2VyIGFyZWEuIENhbiBiZSB1c2VkIHRvIHN0eWxlIGVsZW1lbnRcblx0XHRhY2NvcmRpbmdseS5cblxuXHRcdEBldmVudCBtb3VzZWxlYXZlXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnbW91c2VsZWF2ZScsXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gZnVuY3Rpb25hbCBtb3VzZSBidXR0b24gaXMgcHJlc3NlZCBvbiB0b3Agb2YgZmlsZS1waWNrZXIgYXJlYS5cblxuXHRcdEBldmVudCBtb3VzZWRvd25cblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdtb3VzZWRvd24nLFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIGZ1bmN0aW9uYWwgbW91c2UgYnV0dG9uIGlzIHJlbGVhc2VkIG9uIHRvcCBvZiBmaWxlLXBpY2tlciBhcmVhLlxuXG5cdFx0QGV2ZW50IG1vdXNldXBcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdtb3VzZXVwJ1xuXHRdO1xuXG5cdGZ1bmN0aW9uIEZpbGVJbnB1dChvcHRpb25zKSB7XG5cdFx0aWYgKE1YSV9ERUJVRykge1xuXHRcdFx0RW52LmxvZyhcIkluc3RhbnRpYXRpbmcgRmlsZUlucHV0Li4uXCIpO1xuXHRcdH1cblxuXHRcdHZhciBjb250YWluZXIsIGJyb3dzZUJ1dHRvbiwgZGVmYXVsdHM7XG5cblx0XHQvLyBpZiBmbGF0IGFyZ3VtZW50IHBhc3NlZCBpdCBzaG91bGQgYmUgYnJvd3NlX2J1dHRvbiBpZFxuXHRcdGlmIChCYXNpYy5pbkFycmF5KEJhc2ljLnR5cGVPZihvcHRpb25zKSwgWydzdHJpbmcnLCAnbm9kZSddKSAhPT0gLTEpIHtcblx0XHRcdG9wdGlvbnMgPSB7IGJyb3dzZV9idXR0b24gOiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0Ly8gdGhpcyB3aWxsIGhlbHAgdXMgdG8gZmluZCBwcm9wZXIgZGVmYXVsdCBjb250YWluZXJcblx0XHRicm93c2VCdXR0b24gPSBEb20uZ2V0KG9wdGlvbnMuYnJvd3NlX2J1dHRvbik7XG5cdFx0aWYgKCFicm93c2VCdXR0b24pIHtcblx0XHRcdC8vIGJyb3dzZSBidXR0b24gaXMgcmVxdWlyZWRcblx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5OT1RfRk9VTkRfRVJSKTtcblx0XHR9XG5cblx0XHQvLyBmaWd1cmUgb3V0IHRoZSBvcHRpb25zXG5cdFx0ZGVmYXVsdHMgPSB7XG5cdFx0XHRhY2NlcHQ6IFt7XG5cdFx0XHRcdHRpdGxlOiBJMThuLnRyYW5zbGF0ZSgnQWxsIEZpbGVzJyksXG5cdFx0XHRcdGV4dGVuc2lvbnM6ICcqJ1xuXHRcdFx0fV0sXG5cdFx0XHRtdWx0aXBsZTogZmFsc2UsXG5cdFx0XHRyZXF1aXJlZF9jYXBzOiBmYWxzZSxcblx0XHRcdGNvbnRhaW5lcjogYnJvd3NlQnV0dG9uLnBhcmVudE5vZGUgfHwgZG9jdW1lbnQuYm9keVxuXHRcdH07XG5cblx0XHRvcHRpb25zID0gQmFzaWMuZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7XG5cblx0XHQvLyBjb252ZXJ0IHRvIG9iamVjdCByZXByZXNlbnRhdGlvblxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucy5yZXF1aXJlZF9jYXBzKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdG9wdGlvbnMucmVxdWlyZWRfY2FwcyA9IFJ1bnRpbWUucGFyc2VDYXBzKG9wdGlvbnMucmVxdWlyZWRfY2Fwcyk7XG5cdFx0fVxuXG5cdFx0Ly8gbm9ybWFsaXplIGFjY2VwdCBvcHRpb24gKGNvdWxkIGJlIGxpc3Qgb2YgbWltZSB0eXBlcyBvciBhcnJheSBvZiB0aXRsZS9leHRlbnNpb25zIHBhaXJzKVxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucy5hY2NlcHQpID09PSAnc3RyaW5nJykge1xuXHRcdFx0b3B0aW9ucy5hY2NlcHQgPSBNaW1lLm1pbWVzMmV4dExpc3Qob3B0aW9ucy5hY2NlcHQpO1xuXHRcdH1cblxuXHRcdGNvbnRhaW5lciA9IERvbS5nZXQob3B0aW9ucy5jb250YWluZXIpO1xuXHRcdC8vIG1ha2Ugc3VyZSB3ZSBoYXZlIGNvbnRhaW5lclxuXHRcdGlmICghY29udGFpbmVyKSB7XG5cdFx0XHRjb250YWluZXIgPSBkb2N1bWVudC5ib2R5O1xuXHRcdH1cblxuXHRcdC8vIG1ha2UgY29udGFpbmVyIHJlbGF0aXZlLCBpZiBpdCdzIG5vdFxuXHRcdGlmIChEb20uZ2V0U3R5bGUoY29udGFpbmVyLCAncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHtcblx0XHRcdGNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0fVxuXG5cdFx0Y29udGFpbmVyID0gYnJvd3NlQnV0dG9uID0gbnVsbDsgLy8gSUVcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29tcG9uZW50XG5cblx0XHRcdEBwcm9wZXJ0eSB1aWRcblx0XHRcdEBwcm90ZWN0ZWRcblx0XHRcdEByZWFkT25seVxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0IFVJRFxuXHRcdFx0Ki9cblx0XHRcdHVpZDogQmFzaWMuZ3VpZCgndWlkXycpLFxuXG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29ubmVjdGVkIHJ1bnRpbWUsIGlmIGFueS5cblxuXHRcdFx0QHByb3BlcnR5IHJ1aWRcblx0XHRcdEBwcm90ZWN0ZWRcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0cnVpZDogbnVsbCxcblxuXHRcdFx0LyoqXG5cdFx0XHRVbmlxdWUgaWQgb2YgdGhlIHJ1bnRpbWUgY29udGFpbmVyLiBVc2VmdWwgdG8gZ2V0IGhvbGQgb2YgaXQgZm9yIHZhcmlvdXMgbWFuaXB1bGF0aW9ucy5cblxuXHRcdFx0QHByb3BlcnR5IHNoaW1pZFxuXHRcdFx0QHByb3RlY3RlZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRzaGltaWQ6IG51bGwsXG5cblx0XHRcdC8qKlxuXHRcdFx0QXJyYXkgb2Ygc2VsZWN0ZWQgbW94aWUuZmlsZS5GaWxlIG9iamVjdHNcblxuXHRcdFx0QHByb3BlcnR5IGZpbGVzXG5cdFx0XHRAdHlwZSB7QXJyYXl9XG5cdFx0XHRAZGVmYXVsdCBudWxsXG5cdFx0XHQqL1xuXHRcdFx0ZmlsZXM6IG51bGwsXG5cblx0XHRcdC8qKlxuXHRcdFx0SW5pdGlhbGl6ZXMgdGhlIGZpbGUtcGlja2VyLCBjb25uZWN0cyBpdCB0byBydW50aW1lIGFuZCBkaXNwYXRjaGVzIGV2ZW50IHJlYWR5IHdoZW4gZG9uZS5cblxuXHRcdFx0QG1ldGhvZCBpbml0XG5cdFx0XHQqL1xuXHRcdFx0aW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRzZWxmLmJpbmQoJ1J1bnRpbWVJbml0JywgZnVuY3Rpb24oZSwgcnVudGltZSkge1xuXHRcdFx0XHRcdHNlbGYucnVpZCA9IHJ1bnRpbWUudWlkO1xuXHRcdFx0XHRcdHNlbGYuc2hpbWlkID0gcnVudGltZS5zaGltaWQ7XG5cblx0XHRcdFx0XHRzZWxmLmJpbmQoXCJSZWFkeVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHNlbGYudHJpZ2dlcihcIlJlZnJlc2hcIik7XG5cdFx0XHRcdFx0fSwgOTk5KTtcblxuXHRcdFx0XHRcdC8vIHJlLXBvc2l0aW9uIGFuZCByZXNpemUgc2hpbSBjb250YWluZXJcblx0XHRcdFx0XHRzZWxmLmJpbmQoJ1JlZnJlc2gnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHZhciBwb3MsIHNpemUsIGJyb3dzZUJ1dHRvbiwgc2hpbUNvbnRhaW5lciwgekluZGV4O1xuXG5cdFx0XHRcdFx0XHRicm93c2VCdXR0b24gPSBEb20uZ2V0KG9wdGlvbnMuYnJvd3NlX2J1dHRvbik7XG5cdFx0XHRcdFx0XHRzaGltQ29udGFpbmVyID0gRG9tLmdldChydW50aW1lLnNoaW1pZCk7IC8vIGRvIG5vdCB1c2UgcnVudGltZS5nZXRTaGltQ29udGFpbmVyKCksIHNpbmNlIGl0IHdpbGwgY3JlYXRlIGNvbnRhaW5lciBpZiBpdCBkb2Vzbid0IGV4aXN0XG5cblx0XHRcdFx0XHRcdGlmIChicm93c2VCdXR0b24pIHtcblx0XHRcdFx0XHRcdFx0cG9zID0gRG9tLmdldFBvcyhicm93c2VCdXR0b24sIERvbS5nZXQob3B0aW9ucy5jb250YWluZXIpKTtcblx0XHRcdFx0XHRcdFx0c2l6ZSA9IERvbS5nZXRTaXplKGJyb3dzZUJ1dHRvbik7XG5cdFx0XHRcdFx0XHRcdHpJbmRleCA9IHBhcnNlSW50KERvbS5nZXRTdHlsZShicm93c2VCdXR0b24sICd6LWluZGV4JyksIDEwKSB8fCAwO1xuXG5cdFx0XHRcdFx0XHRcdGlmIChzaGltQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0QmFzaWMuZXh0ZW5kKHNoaW1Db250YWluZXIuc3R5bGUsIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRvcDogcG9zLnkgKyAncHgnLFxuXHRcdFx0XHRcdFx0XHRcdFx0bGVmdDogcG9zLnggKyAncHgnLFxuXHRcdFx0XHRcdFx0XHRcdFx0d2lkdGg6IHNpemUudyArICdweCcsXG5cdFx0XHRcdFx0XHRcdFx0XHRoZWlnaHQ6IHNpemUuaCArICdweCcsXG5cdFx0XHRcdFx0XHRcdFx0XHR6SW5kZXg6IHpJbmRleCArIDFcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0c2hpbUNvbnRhaW5lciA9IGJyb3dzZUJ1dHRvbiA9IG51bGw7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRydW50aW1lLmV4ZWMuY2FsbChzZWxmLCAnRmlsZUlucHV0JywgJ2luaXQnLCBvcHRpb25zKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gcnVudGltZSBuZWVkczogb3B0aW9ucy5yZXF1aXJlZF9mZWF0dXJlcywgb3B0aW9ucy5ydW50aW1lX29yZGVyIGFuZCBvcHRpb25zLmNvbnRhaW5lclxuXHRcdFx0XHRzZWxmLmNvbm5lY3RSdW50aW1lKEJhc2ljLmV4dGVuZCh7fSwgb3B0aW9ucywge1xuXHRcdFx0XHRcdHJlcXVpcmVkX2NhcHM6IHtcblx0XHRcdFx0XHRcdHNlbGVjdF9maWxlOiB0cnVlXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdC8qKlxuXHRcdFx0ICogR2V0IGN1cnJlbnQgb3B0aW9uIHZhbHVlIGJ5IGl0cyBuYW1lXG5cdFx0XHQgKlxuXHRcdFx0ICogQG1ldGhvZCBnZXRPcHRpb25cblx0XHRcdCAqIEBwYXJhbSBuYW1lXG5cdFx0XHQgKiBAcmV0dXJuIHtNaXhlZH1cblx0XHRcdCAqL1xuXHRcdFx0Z2V0T3B0aW9uOiBmdW5jdGlvbihuYW1lKSB7XG5cdFx0XHRcdHJldHVybiBvcHRpb25zW25hbWVdO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgYSBuZXcgdmFsdWUgZm9yIHRoZSBvcHRpb24gc3BlY2lmaWVkIGJ5IG5hbWVcblx0XHRcdCAqXG5cdFx0XHQgKiBAbWV0aG9kIHNldE9wdGlvblxuXHRcdFx0ICogQHBhcmFtIG5hbWVcblx0XHRcdCAqIEBwYXJhbSB2YWx1ZVxuXHRcdFx0ICovXG5cdFx0XHRzZXRPcHRpb246IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG5cdFx0XHRcdGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBvbGRWYWx1ZSA9IG9wdGlvbnNbbmFtZV07XG5cblx0XHRcdFx0c3dpdGNoIChuYW1lKSB7XG5cdFx0XHRcdFx0Y2FzZSAnYWNjZXB0Jzpcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YodmFsdWUpID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IE1pbWUubWltZXMyZXh0TGlzdCh2YWx1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgJ2NvbnRhaW5lcic6XG5cdFx0XHRcdFx0Y2FzZSAncmVxdWlyZWRfY2Fwcyc6XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5GaWxlRXhjZXB0aW9uKHguRmlsZUV4Y2VwdGlvbi5OT19NT0RJRklDQVRJT05fQUxMT1dFRF9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0b3B0aW9uc1tuYW1lXSA9IHZhbHVlO1xuXHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVJbnB1dCcsICdzZXRPcHRpb24nLCBuYW1lLCB2YWx1ZSk7XG5cblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdPcHRpb25DaGFuZ2VkJywgbmFtZSwgdmFsdWUsIG9sZFZhbHVlKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0RGlzYWJsZXMgZmlsZS1waWNrZXIgZWxlbWVudCwgc28gdGhhdCBpdCBkb2Vzbid0IHJlYWN0IHRvIG1vdXNlIGNsaWNrcy5cblxuXHRcdFx0QG1ldGhvZCBkaXNhYmxlXG5cdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtzdGF0ZT10cnVlXSBEaXNhYmxlIGNvbXBvbmVudCBpZiAtIHRydWUsIGVuYWJsZSBpZiAtIGZhbHNlXG5cdFx0XHQqL1xuXHRcdFx0ZGlzYWJsZTogZnVuY3Rpb24oc3RhdGUpIHtcblx0XHRcdFx0dmFyIHJ1bnRpbWUgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblx0XHRcdFx0aWYgKHJ1bnRpbWUpIHtcblx0XHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVJbnB1dCcsICdkaXNhYmxlJywgQmFzaWMudHlwZU9mKHN0YXRlKSA9PT0gJ3VuZGVmaW5lZCcgPyB0cnVlIDogc3RhdGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdC8qKlxuXHRcdFx0UmVwb3NpdGlvbiBhbmQgcmVzaXplIGRpYWxvZyB0cmlnZ2VyIHRvIG1hdGNoIHRoZSBwb3NpdGlvbiBhbmQgc2l6ZSBvZiBicm93c2VfYnV0dG9uIGVsZW1lbnQuXG5cblx0XHRcdEBtZXRob2QgcmVmcmVzaFxuXHRcdFx0Ki9cblx0XHRcdHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoXCJSZWZyZXNoXCIpO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdERlc3Ryb3kgY29tcG9uZW50LlxuXG5cdFx0XHRAbWV0aG9kIGRlc3Ryb3lcblx0XHRcdCovXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHJ1bnRpbWUgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblx0XHRcdFx0aWYgKHJ1bnRpbWUpIHtcblx0XHRcdFx0XHRydW50aW1lLmV4ZWMuY2FsbCh0aGlzLCAnRmlsZUlucHV0JywgJ2Rlc3Ryb3knKTtcblx0XHRcdFx0XHR0aGlzLmRpc2Nvbm5lY3RSdW50aW1lKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKHRoaXMuZmlsZXMpID09PSAnYXJyYXknKSB7XG5cdFx0XHRcdFx0Ly8gbm8gc2Vuc2UgaW4gbGVhdmluZyBhc3NvY2lhdGVkIGZpbGVzIGJlaGluZFxuXHRcdFx0XHRcdEJhc2ljLmVhY2godGhpcy5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0XHRcdFx0ZmlsZS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5maWxlcyA9IG51bGw7XG5cblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzKTtcblx0fVxuXG5cdEZpbGVJbnB1dC5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gRmlsZUlucHV0O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2ZpbGUvRmlsZS5qc1xuXG4vKipcbiAqIEZpbGUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9maWxlL0ZpbGUnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL2NvcmUvdXRpbHMvTWltZScsXG5cdCdtb3hpZS9maWxlL0Jsb2InXG5dLCBmdW5jdGlvbihCYXNpYywgTWltZSwgQmxvYikge1xuXHQvKipcblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZVxuXHRAZXh0ZW5kcyBCbG9iXG5cdEBjb25zdHJ1Y3RvclxuXHRAcGFyYW0ge1N0cmluZ30gcnVpZCBVbmlxdWUgaWQgb2YgdGhlIHJ1bnRpbWUsIHRvIHdoaWNoIHRoaXMgYmxvYiBiZWxvbmdzIHRvXG5cdEBwYXJhbSB7T2JqZWN0fSBmaWxlIE9iamVjdCBcIk5hdGl2ZVwiIGZpbGUgb2JqZWN0LCBhcyBpdCBpcyByZXByZXNlbnRlZCBpbiB0aGUgcnVudGltZVxuXHQqL1xuXHRmdW5jdGlvbiBGaWxlKHJ1aWQsIGZpbGUpIHtcblx0XHRpZiAoIWZpbGUpIHsgLy8gYXZvaWQgZXh0cmEgZXJyb3JzIGluIGNhc2Ugd2Ugb3Zlcmxvb2tlZCBzb21ldGhpbmdcblx0XHRcdGZpbGUgPSB7fTtcblx0XHR9XG5cblx0XHRCbG9iLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRpZiAoIXRoaXMudHlwZSkge1xuXHRcdFx0dGhpcy50eXBlID0gTWltZS5nZXRGaWxlTWltZShmaWxlLm5hbWUpO1xuXHRcdH1cblxuXHRcdC8vIHNhbml0aXplIGZpbGUgbmFtZSBvciBnZW5lcmF0ZSBuZXcgb25lXG5cdFx0dmFyIG5hbWU7XG5cdFx0aWYgKGZpbGUubmFtZSkge1xuXHRcdFx0bmFtZSA9IGZpbGUubmFtZS5yZXBsYWNlKC9cXFxcL2csICcvJyk7XG5cdFx0XHRuYW1lID0gbmFtZS5zdWJzdHIobmFtZS5sYXN0SW5kZXhPZignLycpICsgMSk7XG5cdFx0fSBlbHNlIGlmICh0aGlzLnR5cGUpIHtcblx0XHRcdHZhciBwcmVmaXggPSB0aGlzLnR5cGUuc3BsaXQoJy8nKVswXTtcblx0XHRcdG5hbWUgPSBCYXNpYy5ndWlkKChwcmVmaXggIT09ICcnID8gcHJlZml4IDogJ2ZpbGUnKSArICdfJyk7XG5cdFx0XHRcblx0XHRcdGlmIChNaW1lLmV4dGVuc2lvbnNbdGhpcy50eXBlXSkge1xuXHRcdFx0XHRuYW1lICs9ICcuJyArIE1pbWUuZXh0ZW5zaW9uc1t0aGlzLnR5cGVdWzBdOyAvLyBhcHBlbmQgcHJvcGVyIGV4dGVuc2lvbiBpZiBwb3NzaWJsZVxuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRcblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0LyoqXG5cdFx0XHRGaWxlIG5hbWVcblxuXHRcdFx0QHByb3BlcnR5IG5hbWVcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHRAZGVmYXVsdCBVSURcblx0XHRcdCovXG5cdFx0XHRuYW1lOiBuYW1lIHx8IEJhc2ljLmd1aWQoJ2ZpbGVfJyksXG5cblx0XHRcdC8qKlxuXHRcdFx0UmVsYXRpdmUgcGF0aCB0byB0aGUgZmlsZSBpbnNpZGUgYSBkaXJlY3RvcnlcblxuXHRcdFx0QHByb3BlcnR5IHJlbGF0aXZlUGF0aFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0ICcnXG5cdFx0XHQqL1xuXHRcdFx0cmVsYXRpdmVQYXRoOiAnJyxcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHREYXRlIG9mIGxhc3QgbW9kaWZpY2F0aW9uXG5cblx0XHRcdEBwcm9wZXJ0eSBsYXN0TW9kaWZpZWREYXRlXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0QGRlZmF1bHQgbm93XG5cdFx0XHQqL1xuXHRcdFx0bGFzdE1vZGlmaWVkRGF0ZTogZmlsZS5sYXN0TW9kaWZpZWREYXRlIHx8IChuZXcgRGF0ZSgpKS50b0xvY2FsZVN0cmluZygpIC8vIFRodSBBdWcgMjMgMjAxMiAxOTo0MDowMCBHTVQrMDQwMCAoR0VUKVxuXHRcdH0pO1xuXHR9XG5cblx0RmlsZS5wcm90b3R5cGUgPSBCbG9iLnByb3RvdHlwZTtcblxuXHRyZXR1cm4gRmlsZTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9maWxlL0ZpbGVEcm9wLmpzXG5cbi8qKlxuICogRmlsZURyb3AuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9maWxlL0ZpbGVEcm9wJywgW1xuXHQnbW94aWUvY29yZS9JMThuJyxcblx0J21veGllL2NvcmUvdXRpbHMvRG9tJyxcblx0J21veGllL2NvcmUvRXhjZXB0aW9ucycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2ZpbGUvRmlsZScsXG5cdCdtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnQnLFxuXHQnbW94aWUvY29yZS9FdmVudFRhcmdldCcsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL01pbWUnXG5dLCBmdW5jdGlvbihJMThuLCBEb20sIHgsIEJhc2ljLCBFbnYsIEZpbGUsIFJ1bnRpbWVDbGllbnQsIEV2ZW50VGFyZ2V0LCBNaW1lKSB7XG5cdC8qKlxuXHRUdXJuIGFyYml0cmFyeSBET00gZWxlbWVudCB0byBhIGRyb3Agem9uZSBhY2NlcHRpbmcgZmlsZXMuIENvbnZlcnRzIHNlbGVjdGVkIGZpbGVzIHRvIF9GaWxlXyBvYmplY3RzLCB0byBiZSB1c2VkIFxuXHRpbiBjb25qdW5jdGlvbiB3aXRoIF9JbWFnZV8sIHByZWxvYWRlZCBpbiBtZW1vcnkgd2l0aCBfRmlsZVJlYWRlcl8gb3IgdXBsb2FkZWQgdG8gYSBzZXJ2ZXIgdGhyb3VnaCBcblx0X1hNTEh0dHBSZXF1ZXN0Xy5cblxuXHRAZXhhbXBsZVxuXHRcdDxkaXYgaWQ9XCJkcm9wX3pvbmVcIj5cblx0XHRcdERyb3AgZmlsZXMgaGVyZVxuXHRcdDwvZGl2PlxuXHRcdDxiciAvPlxuXHRcdDxkaXYgaWQ9XCJmaWxlbGlzdFwiPjwvZGl2PlxuXG5cdFx0PHNjcmlwdCB0eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI+XG5cdFx0XHR2YXIgZmlsZURyb3AgPSBuZXcgbW94aWUuZmlsZS5GaWxlRHJvcCgnZHJvcF96b25lJyksIGZpbGVMaXN0ID0gbW94aWUudXRpbHMuRG9tLmdldCgnZmlsZWxpc3QnKTtcblxuXHRcdFx0ZmlsZURyb3Aub25kcm9wID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdG1veGllLnV0aWxzLkJhc2ljLmVhY2godGhpcy5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0XHRcdGZpbGVMaXN0LmlubmVySFRNTCArPSAnPGRpdj4nICsgZmlsZS5uYW1lICsgJzwvZGl2Pic7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblxuXHRcdFx0ZmlsZURyb3AuaW5pdCgpO1xuXHRcdDwvc2NyaXB0PlxuXG5cdEBjbGFzcyBtb3hpZS9maWxlL0ZpbGVEcm9wXG5cdEBjb25zdHJ1Y3RvclxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gb3B0aW9ucyBJZiBvcHRpb25zIGhhcyB0eXBlb2Ygc3RyaW5nLCBhcmd1bWVudCBpcyBjb25zaWRlcmVkIGFzIG9wdGlvbnMuZHJvcF96b25lXG5cdFx0QHBhcmFtIHtTdHJpbmd8RE9NRWxlbWVudH0gb3B0aW9ucy5kcm9wX3pvbmUgRE9NIEVsZW1lbnQgdG8gdHVybiBpbnRvIGEgZHJvcCB6b25lXG5cdFx0QHBhcmFtIHtBcnJheX0gW29wdGlvbnMuYWNjZXB0XSBBcnJheSBvZiBtaW1lIHR5cGVzIHRvIGFjY2VwdC4gQnkgZGVmYXVsdCBhY2NlcHRzIGFsbFxuXHRcdEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gW29wdGlvbnMucmVxdWlyZWRfY2Fwc10gU2V0IG9mIHJlcXVpcmVkIGNhcGFiaWxpdGllcywgdGhhdCBjaG9zZW4gcnVudGltZSBtdXN0IHN1cHBvcnRcblx0Ki9cblx0dmFyIGRpc3BhdGNoZXMgPSBbXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHJ1bnRpbWUgaXMgY29ubmVjdGVkIGFuZCBkcm9wIHpvbmUgaXMgcmVhZHkgdG8gYWNjZXB0IGZpbGVzLlxuXG5cdFx0QGV2ZW50IHJlYWR5XG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQncmVhZHknLCBcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBkcmFnZ2luZyBjdXJzb3IgZW50ZXJzIHRoZSBkcm9wIHpvbmUuXG5cblx0XHRAZXZlbnQgZHJhZ2VudGVyXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnZHJhZ2VudGVyJyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBkcmFnZ2luZyBjdXJzb3IgbGVhdmVzIHRoZSBkcm9wIHpvbmUuXG5cblx0XHRAZXZlbnQgZHJhZ2xlYXZlXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnZHJhZ2xlYXZlJywgXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gZmlsZSBpcyBkcm9wcGVkIG9udG8gdGhlIGRyb3Agem9uZS5cblxuXHRcdEBldmVudCBkcm9wXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnZHJvcCcsIFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCBpZiBlcnJvciBvY2N1cnMuXG5cblx0XHRAZXZlbnQgZXJyb3Jcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdlcnJvcidcblx0XTtcblxuXHRmdW5jdGlvbiBGaWxlRHJvcChvcHRpb25zKSB7XG5cdFx0aWYgKE1YSV9ERUJVRykge1xuXHRcdFx0RW52LmxvZyhcIkluc3RhbnRpYXRpbmcgRmlsZURyb3AuLi5cIik7XHRcblx0XHR9XG5cblx0XHR2YXIgc2VsZiA9IHRoaXMsIGRlZmF1bHRzO1xuXG5cdFx0Ly8gaWYgZmxhdCBhcmd1bWVudCBwYXNzZWQgaXQgc2hvdWxkIGJlIGRyb3Bfem9uZSBpZFxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRvcHRpb25zID0geyBkcm9wX3pvbmUgOiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0Ly8gZmlndXJlIG91dCB0aGUgb3B0aW9uc1xuXHRcdGRlZmF1bHRzID0ge1xuXHRcdFx0YWNjZXB0OiBbe1xuXHRcdFx0XHR0aXRsZTogSTE4bi50cmFuc2xhdGUoJ0FsbCBGaWxlcycpLFxuXHRcdFx0XHRleHRlbnNpb25zOiAnKidcblx0XHRcdH1dLFxuXHRcdFx0cmVxdWlyZWRfY2Fwczoge1xuXHRcdFx0XHRkcmFnX2FuZF9kcm9wOiB0cnVlXG5cdFx0XHR9XG5cdFx0fTtcblx0XHRcblx0XHRvcHRpb25zID0gdHlwZW9mKG9wdGlvbnMpID09PSAnb2JqZWN0JyA/IEJhc2ljLmV4dGVuZCh7fSwgZGVmYXVsdHMsIG9wdGlvbnMpIDogZGVmYXVsdHM7XG5cblx0XHQvLyB0aGlzIHdpbGwgaGVscCB1cyB0byBmaW5kIHByb3BlciBkZWZhdWx0IGNvbnRhaW5lclxuXHRcdG9wdGlvbnMuY29udGFpbmVyID0gRG9tLmdldChvcHRpb25zLmRyb3Bfem9uZSkgfHwgZG9jdW1lbnQuYm9keTtcblxuXHRcdC8vIG1ha2UgY29udGFpbmVyIHJlbGF0aXZlLCBpZiBpdCBpcyBub3Rcblx0XHRpZiAoRG9tLmdldFN0eWxlKG9wdGlvbnMuY29udGFpbmVyLCAncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHtcblx0XHRcdG9wdGlvbnMuY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcblx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0Ly8gbm9ybWFsaXplIGFjY2VwdCBvcHRpb24gKGNvdWxkIGJlIGxpc3Qgb2YgbWltZSB0eXBlcyBvciBhcnJheSBvZiB0aXRsZS9leHRlbnNpb25zIHBhaXJzKVxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucy5hY2NlcHQpID09PSAnc3RyaW5nJykge1xuXHRcdFx0b3B0aW9ucy5hY2NlcHQgPSBNaW1lLm1pbWVzMmV4dExpc3Qob3B0aW9ucy5hY2NlcHQpO1xuXHRcdH1cblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbChzZWxmKTtcblxuXHRcdEJhc2ljLmV4dGVuZChzZWxmLCB7XG5cdFx0XHR1aWQ6IEJhc2ljLmd1aWQoJ3VpZF8nKSxcblxuXHRcdFx0cnVpZDogbnVsbCxcblxuXHRcdFx0ZmlsZXM6IG51bGwsXG5cblx0XHRcdGluaXQ6IGZ1bmN0aW9uKCkge1x0XHRcblx0XHRcdFx0c2VsZi5iaW5kKCdSdW50aW1lSW5pdCcsIGZ1bmN0aW9uKGUsIHJ1bnRpbWUpIHtcblx0XHRcdFx0XHRzZWxmLnJ1aWQgPSBydW50aW1lLnVpZDtcblx0XHRcdFx0XHRydW50aW1lLmV4ZWMuY2FsbChzZWxmLCAnRmlsZURyb3AnLCAnaW5pdCcsIG9wdGlvbnMpO1xuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgncmVhZHknKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHQvLyBydW50aW1lIG5lZWRzOiBvcHRpb25zLnJlcXVpcmVkX2ZlYXR1cmVzLCBvcHRpb25zLnJ1bnRpbWVfb3JkZXIgYW5kIG9wdGlvbnMuY29udGFpbmVyXG5cdFx0XHRcdHNlbGYuY29ubmVjdFJ1bnRpbWUob3B0aW9ucyk7IC8vIHRocm93cyBSdW50aW1lRXJyb3Jcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgcnVudGltZSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0XHRpZiAocnVudGltZSkge1xuXHRcdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKHRoaXMsICdGaWxlRHJvcCcsICdkZXN0cm95Jyk7XG5cdFx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuZmlsZXMgPSBudWxsO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzKTtcblx0fVxuXG5cdEZpbGVEcm9wLnByb3RvdHlwZSA9IEV2ZW50VGFyZ2V0Lmluc3RhbmNlO1xuXG5cdHJldHVybiBGaWxlRHJvcDtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9maWxlL0ZpbGVSZWFkZXIuanNcblxuLyoqXG4gKiBGaWxlUmVhZGVyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbmRlZmluZSgnbW94aWUvZmlsZS9GaWxlUmVhZGVyJywgW1xuXHQnbW94aWUvY29yZS91dGlscy9CYXNpYycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0VuY29kZScsXG5cdCdtb3hpZS9jb3JlL0V4Y2VwdGlvbnMnLFxuXHQnbW94aWUvY29yZS9FdmVudFRhcmdldCcsXG5cdCdtb3hpZS9maWxlL0Jsb2InLFxuXHQnbW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50J1xuXSwgZnVuY3Rpb24oQmFzaWMsIEVuY29kZSwgeCwgRXZlbnRUYXJnZXQsIEJsb2IsIFJ1bnRpbWVDbGllbnQpIHtcblx0LyoqXG5cdFV0aWxpdHkgZm9yIHByZWxvYWRpbmcgby5CbG9iL28uRmlsZSBvYmplY3RzIGluIG1lbW9yeS4gQnkgZGVzaWduIGNsb3NlbHkgZm9sbG93cyBbVzNDIEZpbGVSZWFkZXJdKGh0dHA6Ly93d3cudzMub3JnL1RSL0ZpbGVBUEkvI2Rmbi1maWxlcmVhZGVyKVxuXHRpbnRlcmZhY2UuIFdoZXJlIHBvc3NpYmxlIHVzZXMgbmF0aXZlIEZpbGVSZWFkZXIsIHdoZXJlIC0gbm90IGZhbGxzIGJhY2sgdG8gc2hpbXMuXG5cblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZVJlYWRlclxuXHRAY29uc3RydWN0b3IgRmlsZVJlYWRlclxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdCovXG5cdHZhciBkaXNwYXRjaGVzID0gW1xuXG5cdFx0LyoqIFxuXHRcdERpc3BhdGNoZWQgd2hlbiB0aGUgcmVhZCBzdGFydHMuXG5cblx0XHRAZXZlbnQgbG9hZHN0YXJ0XG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnbG9hZHN0YXJ0JywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGlsZSByZWFkaW5nIChhbmQgZGVjb2RpbmcpIGJsb2IsIGFuZCByZXBvcnRpbmcgcGFydGlhbCBCbG9iIGRhdGEgKHByb2dlc3MubG9hZGVkL3Byb2dyZXNzLnRvdGFsKS5cblxuXHRcdEBldmVudCBwcm9ncmVzc1xuXHRcdEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHRcdCovXG5cdFx0J3Byb2dyZXNzJywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHRoZSByZWFkIGhhcyBzdWNjZXNzZnVsbHkgY29tcGxldGVkLlxuXG5cdFx0QGV2ZW50IGxvYWRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdsb2FkJywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHRoZSByZWFkIGhhcyBiZWVuIGFib3J0ZWQuIEZvciBpbnN0YW5jZSwgYnkgaW52b2tpbmcgdGhlIGFib3J0KCkgbWV0aG9kLlxuXG5cdFx0QGV2ZW50IGFib3J0XG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnYWJvcnQnLCBcblxuXHRcdC8qKiBcblx0XHREaXNwYXRjaGVkIHdoZW4gdGhlIHJlYWQgaGFzIGZhaWxlZC5cblxuXHRcdEBldmVudCBlcnJvclxuXHRcdEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHRcdCovXG5cdFx0J2Vycm9yJywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHRoZSByZXF1ZXN0IGhhcyBjb21wbGV0ZWQgKGVpdGhlciBpbiBzdWNjZXNzIG9yIGZhaWx1cmUpLlxuXG5cdFx0QGV2ZW50IGxvYWRlbmRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdsb2FkZW5kJ1xuXHRdO1xuXHRcblx0ZnVuY3Rpb24gRmlsZVJlYWRlcigpIHtcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHQvKipcblx0XHRcdFVJRCBvZiB0aGUgY29tcG9uZW50IGluc3RhbmNlLlxuXG5cdFx0XHRAcHJvcGVydHkgdWlkXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0Ki9cblx0XHRcdHVpZDogQmFzaWMuZ3VpZCgndWlkXycpLFxuXG5cdFx0XHQvKipcblx0XHRcdENvbnRhaW5zIGN1cnJlbnQgc3RhdGUgb2YgRmlsZVJlYWRlciBvYmplY3QuIENhbiB0YWtlIHZhbHVlcyBvZiBGaWxlUmVhZGVyLkVNUFRZLCBGaWxlUmVhZGVyLkxPQURJTkdcblx0XHRcdGFuZCBGaWxlUmVhZGVyLkRPTkUuXG5cblx0XHRcdEBwcm9wZXJ0eSByZWFkeVN0YXRlXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgRmlsZVJlYWRlci5FTVBUWVxuXHRcdFx0Ki9cblx0XHRcdHJlYWR5U3RhdGU6IEZpbGVSZWFkZXIuRU1QVFksXG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0UmVzdWx0IG9mIHRoZSBzdWNjZXNzZnVsIHJlYWQgb3BlcmF0aW9uLlxuXG5cdFx0XHRAcHJvcGVydHkgcmVzdWx0XG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0Ki9cblx0XHRcdHJlc3VsdDogbnVsbCxcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHRTdG9yZXMgdGhlIGVycm9yIG9mIGZhaWxlZCBhc3luY2hyb25vdXMgcmVhZCBvcGVyYXRpb24uXG5cblx0XHRcdEBwcm9wZXJ0eSBlcnJvclxuXHRcdFx0QHR5cGUge0RPTUVycm9yfVxuXHRcdFx0Ki9cblx0XHRcdGVycm9yOiBudWxsLFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdEluaXRpYXRlcyByZWFkaW5nIG9mIEZpbGUvQmxvYiBvYmplY3QgY29udGVudHMgdG8gYmluYXJ5IHN0cmluZy5cblxuXHRcdFx0QG1ldGhvZCByZWFkQXNCaW5hcnlTdHJpbmdcblx0XHRcdEBwYXJhbSB7QmxvYnxGaWxlfSBibG9iIE9iamVjdCB0byBwcmVsb2FkXG5cdFx0XHQqL1xuXHRcdFx0cmVhZEFzQmluYXJ5U3RyaW5nOiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdF9yZWFkLmNhbGwodGhpcywgJ3JlYWRBc0JpbmFyeVN0cmluZycsIGJsb2IpO1xuXHRcdFx0fSxcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHRJbml0aWF0ZXMgcmVhZGluZyBvZiBGaWxlL0Jsb2Igb2JqZWN0IGNvbnRlbnRzIHRvIGRhdGFVUkwgc3RyaW5nLlxuXG5cdFx0XHRAbWV0aG9kIHJlYWRBc0RhdGFVUkxcblx0XHRcdEBwYXJhbSB7QmxvYnxGaWxlfSBibG9iIE9iamVjdCB0byBwcmVsb2FkXG5cdFx0XHQqL1xuXHRcdFx0cmVhZEFzRGF0YVVSTDogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0XHRfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNEYXRhVVJMJywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdEluaXRpYXRlcyByZWFkaW5nIG9mIEZpbGUvQmxvYiBvYmplY3QgY29udGVudHMgdG8gc3RyaW5nLlxuXG5cdFx0XHRAbWV0aG9kIHJlYWRBc1RleHRcblx0XHRcdEBwYXJhbSB7QmxvYnxGaWxlfSBibG9iIE9iamVjdCB0byBwcmVsb2FkXG5cdFx0XHQqL1xuXHRcdFx0cmVhZEFzVGV4dDogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0XHRfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNUZXh0JywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdEFib3J0cyBwcmVsb2FkaW5nIHByb2Nlc3MuXG5cblx0XHRcdEBtZXRob2QgYWJvcnRcblx0XHRcdCovXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMucmVzdWx0ID0gbnVsbDtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChCYXNpYy5pbkFycmF5KHRoaXMucmVhZHlTdGF0ZSwgW0ZpbGVSZWFkZXIuRU1QVFksIEZpbGVSZWFkZXIuRE9ORV0pICE9PSAtMSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fSBlbHNlIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IEZpbGVSZWFkZXIuTE9BRElORykge1xuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuZXhlYygnRmlsZVJlYWRlcicsICdhYm9ydCcpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdhYm9ydCcpO1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoJ2xvYWRlbmQnKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0RGVzdHJveSBjb21wb25lbnQgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuXG5cdFx0XHRAbWV0aG9kIGRlc3Ryb3lcblx0XHRcdCovXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5hYm9ydCgpO1xuXHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVSZWFkZXInLCAnZGVzdHJveScpO1xuXHRcdFx0XHR0aGlzLmRpc2Nvbm5lY3RSdW50aW1lKCk7XG5cdFx0XHRcdHRoaXMudW5iaW5kQWxsKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyB1aWQgbXVzdCBhbHJlYWR5IGJlIGFzc2lnbmVkXG5cdFx0dGhpcy5oYW5kbGVFdmVudFByb3BzKGRpc3BhdGNoZXMpO1xuXG5cdFx0dGhpcy5iaW5kKCdFcnJvcicsIGZ1bmN0aW9uKGUsIGVycikge1xuXHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gRmlsZVJlYWRlci5ET05FO1xuXHRcdFx0dGhpcy5lcnJvciA9IGVycjtcblx0XHR9LCA5OTkpO1xuXHRcdFxuXHRcdHRoaXMuYmluZCgnTG9hZCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTtcblx0XHR9LCA5OTkpO1xuXG5cdFx0XG5cdFx0ZnVuY3Rpb24gX3JlYWQob3AsIGJsb2IpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcdFx0XHRcblxuXHRcdFx0dGhpcy50cmlnZ2VyKCdsb2Fkc3RhcnQnKTtcblxuXHRcdFx0aWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gRmlsZVJlYWRlci5MT0FESU5HKSB7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcignZXJyb3InLCBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpKTtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdsb2FkZW5kJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gaWYgc291cmNlIGlzIG5vdCBvLkJsb2Ivby5GaWxlXG5cdFx0XHRpZiAoIShibG9iIGluc3RhbmNlb2YgQmxvYikpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdlcnJvcicsIG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5OT1RfRk9VTkRfRVJSKSk7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcignbG9hZGVuZCcpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMucmVzdWx0ID0gbnVsbDtcblx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuTE9BRElORztcblx0XHRcdFxuXHRcdFx0aWYgKGJsb2IuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdHZhciBzcmMgPSBibG9iLmdldFNvdXJjZSgpO1xuXHRcdFx0XHRzd2l0Y2ggKG9wKSB7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzVGV4dCc6XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzQmluYXJ5U3RyaW5nJzpcblx0XHRcdFx0XHRcdHRoaXMucmVzdWx0ID0gc3JjO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzRGF0YVVSTCc6XG5cdFx0XHRcdFx0XHR0aGlzLnJlc3VsdCA9ICdkYXRhOicgKyBibG9iLnR5cGUgKyAnO2Jhc2U2NCwnICsgRW5jb2RlLmJ0b2Eoc3JjKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdsb2FkJyk7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcignbG9hZGVuZCcpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5jb25uZWN0UnVudGltZShibG9iLnJ1aWQpO1xuXHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVSZWFkZXInLCAncmVhZCcsIG9wLCBibG9iKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8qKlxuXHRJbml0aWFsIEZpbGVSZWFkZXIgc3RhdGVcblxuXHRAcHJvcGVydHkgRU1QVFlcblx0QHR5cGUge051bWJlcn1cblx0QGZpbmFsXG5cdEBzdGF0aWNcblx0QGRlZmF1bHQgMFxuXHQqL1xuXHRGaWxlUmVhZGVyLkVNUFRZID0gMDtcblxuXHQvKipcblx0RmlsZVJlYWRlciBzd2l0Y2hlcyB0byB0aGlzIHN0YXRlIHdoZW4gaXQgaXMgcHJlbG9hZGluZyB0aGUgc291cmNlXG5cblx0QHByb3BlcnR5IExPQURJTkdcblx0QHR5cGUge051bWJlcn1cblx0QGZpbmFsXG5cdEBzdGF0aWNcblx0QGRlZmF1bHQgMVxuXHQqL1xuXHRGaWxlUmVhZGVyLkxPQURJTkcgPSAxO1xuXG5cdC8qKlxuXHRQcmVsb2FkaW5nIGlzIGNvbXBsZXRlLCB0aGlzIGlzIGEgZmluYWwgc3RhdGVcblxuXHRAcHJvcGVydHkgRE9ORVxuXHRAdHlwZSB7TnVtYmVyfVxuXHRAZmluYWxcblx0QHN0YXRpY1xuXHRAZGVmYXVsdCAyXG5cdCovXG5cdEZpbGVSZWFkZXIuRE9ORSA9IDI7XG5cblx0RmlsZVJlYWRlci5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gRmlsZVJlYWRlcjtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL1VybC5qc1xuXG4vKipcbiAqIFVybC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9jb3JlL3V0aWxzL1VybFxuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKCdtb3hpZS9jb3JlL3V0aWxzL1VybCcsIFtcblx0J21veGllL2NvcmUvdXRpbHMvQmFzaWMnXG5dLCBmdW5jdGlvbihCYXNpYykge1xuXHQvKipcblx0UGFyc2UgdXJsIGludG8gc2VwYXJhdGUgY29tcG9uZW50cyBhbmQgZmlsbCBpbiBhYnNlbnQgcGFydHMgd2l0aCBwYXJ0cyBmcm9tIGN1cnJlbnQgdXJsLFxuXHRiYXNlZCBvbiBodHRwczovL3Jhdy5naXRodWIuY29tL2t2ei9waHBqcy9tYXN0ZXIvZnVuY3Rpb25zL3VybC9wYXJzZV91cmwuanNcblxuXHRAbWV0aG9kIHBhcnNlVXJsXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHVybCBVcmwgdG8gcGFyc2UgKGRlZmF1bHRzIHRvIGVtcHR5IHN0cmluZyBpZiB1bmRlZmluZWQpXG5cdEByZXR1cm4ge09iamVjdH0gSGFzaCBjb250YWluaW5nIGV4dHJhY3RlZCB1cmkgY29tcG9uZW50c1xuXHQqL1xuXHR2YXIgcGFyc2VVcmwgPSBmdW5jdGlvbih1cmwsIGN1cnJlbnRVcmwpIHtcblx0XHR2YXIga2V5ID0gWydzb3VyY2UnLCAnc2NoZW1lJywgJ2F1dGhvcml0eScsICd1c2VySW5mbycsICd1c2VyJywgJ3Bhc3MnLCAnaG9zdCcsICdwb3J0JywgJ3JlbGF0aXZlJywgJ3BhdGgnLCAnZGlyZWN0b3J5JywgJ2ZpbGUnLCAncXVlcnknLCAnZnJhZ21lbnQnXVxuXHRcdCwgaSA9IGtleS5sZW5ndGhcblx0XHQsIHBvcnRzID0ge1xuXHRcdFx0aHR0cDogODAsXG5cdFx0XHRodHRwczogNDQzXG5cdFx0fVxuXHRcdCwgdXJpID0ge31cblx0XHQsIHJlZ2V4ID0gL14oPzooW146XFwvPyNdKyk6KT8oPzpcXC9cXC8oKSg/Oig/OigpKD86KFteOkBcXC9dKik6PyhbXjpAXFwvXSopKT9AKT8oXFxbW1xcZGEtZkEtRjpdK1xcXXxbXjpcXC8/I10qKSg/OjooXFxkKikpPykpPygpKD86KCgpKD86KD86W14/I1xcL10qXFwvKSopKCkoPzpbXj8jXSopKSg/OlxcXFw/KFteI10qKSk/KD86IyguKikpPykvXG5cdFx0LCBtID0gcmVnZXguZXhlYyh1cmwgfHwgJycpXG5cdFx0LCBpc1JlbGF0aXZlXG5cdFx0LCBpc1NjaGVtZUxlc3MgPSAvXlxcL1xcL1xcdy8udGVzdCh1cmwpXG5cdFx0O1xuXG5cdFx0c3dpdGNoIChCYXNpYy50eXBlT2YoY3VycmVudFVybCkpIHtcblx0XHRcdGNhc2UgJ3VuZGVmaW5lZCc6XG5cdFx0XHRcdGN1cnJlbnRVcmwgPSBwYXJzZVVybChkb2N1bWVudC5sb2NhdGlvbi5ocmVmLCBmYWxzZSk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlICdzdHJpbmcnOlxuXHRcdFx0XHRjdXJyZW50VXJsID0gcGFyc2VVcmwoY3VycmVudFVybCwgZmFsc2UpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHR3aGlsZSAoaS0tKSB7XG5cdFx0XHRpZiAobVtpXSkge1xuXHRcdFx0XHR1cmlba2V5W2ldXSA9IG1baV07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aXNSZWxhdGl2ZSA9ICFpc1NjaGVtZUxlc3MgJiYgIXVyaS5zY2hlbWU7XG5cblx0XHRpZiAoaXNTY2hlbWVMZXNzIHx8IGlzUmVsYXRpdmUpIHtcblx0XHRcdHVyaS5zY2hlbWUgPSBjdXJyZW50VXJsLnNjaGVtZTtcblx0XHR9XG5cblx0XHQvLyB3aGVuIHVybCBpcyByZWxhdGl2ZSwgd2Ugc2V0IHRoZSBvcmlnaW4gYW5kIHRoZSBwYXRoIG91cnNlbHZlc1xuXHRcdGlmIChpc1JlbGF0aXZlKSB7XG5cdFx0XHR1cmkuaG9zdCA9IGN1cnJlbnRVcmwuaG9zdDtcblx0XHRcdHVyaS5wb3J0ID0gY3VycmVudFVybC5wb3J0O1xuXG5cdFx0XHR2YXIgcGF0aCA9ICcnO1xuXHRcdFx0Ly8gZm9yIHVybHMgd2l0aG91dCB0cmFpbGluZyBzbGFzaCB3ZSBuZWVkIHRvIGZpZ3VyZSBvdXQgdGhlIHBhdGhcblx0XHRcdGlmICgvXlteXFwvXS8udGVzdCh1cmkucGF0aCkpIHtcblx0XHRcdFx0cGF0aCA9IGN1cnJlbnRVcmwucGF0aDtcblx0XHRcdFx0Ly8gaWYgcGF0aCBlbmRzIHdpdGggYSBmaWxlbmFtZSwgc3RyaXAgaXRcblx0XHRcdFx0aWYgKC9cXC9bXlxcL10qXFwuW15cXC9dKiQvLnRlc3QocGF0aCkpIHtcblx0XHRcdFx0XHRwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC9bXlxcL10rJC8sICcvJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gYXZvaWQgZG91YmxlIHNsYXNoIGF0IHRoZSBlbmQgKHNlZSAjMTI3KVxuXHRcdFx0XHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLz8kLywgJy8nKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dXJpLnBhdGggPSBwYXRoICsgKHVyaS5wYXRoIHx8ICcnKTsgLy8gc2l0ZSBtYXkgcmVzaWRlIGF0IGRvbWFpbi5jb20gb3IgZG9tYWluLmNvbS9zdWJkaXJcblx0XHR9XG5cblx0XHRpZiAoIXVyaS5wb3J0KSB7XG5cdFx0XHR1cmkucG9ydCA9IHBvcnRzW3VyaS5zY2hlbWVdIHx8IDgwO1xuXHRcdH1cblxuXHRcdHVyaS5wb3J0ID0gcGFyc2VJbnQodXJpLnBvcnQsIDEwKTtcblxuXHRcdGlmICghdXJpLnBhdGgpIHtcblx0XHRcdHVyaS5wYXRoID0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0ZGVsZXRlIHVyaS5zb3VyY2U7XG5cblx0XHRyZXR1cm4gdXJpO1xuXHR9O1xuXG5cdC8qKlxuXHRSZXNvbHZlIHVybCAtIGFtb25nIG90aGVyIHRoaW5ncyB3aWxsIHR1cm4gcmVsYXRpdmUgdXJsIHRvIGFic29sdXRlXG5cblx0QG1ldGhvZCByZXNvbHZlVXJsXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd8T2JqZWN0fSB1cmwgRWl0aGVyIGFic29sdXRlIG9yIHJlbGF0aXZlLCBvciBhIHJlc3VsdCBvZiBwYXJzZVVybCBjYWxsXG5cdEByZXR1cm4ge1N0cmluZ30gUmVzb2x2ZWQsIGFic29sdXRlIHVybFxuXHQqL1xuXHR2YXIgcmVzb2x2ZVVybCA9IGZ1bmN0aW9uKHVybCkge1xuXHRcdHZhciBwb3J0cyA9IHsgLy8gd2UgaWdub3JlIGRlZmF1bHQgcG9ydHNcblx0XHRcdGh0dHA6IDgwLFxuXHRcdFx0aHR0cHM6IDQ0M1xuXHRcdH1cblx0XHQsIHVybHAgPSB0eXBlb2YodXJsKSA9PT0gJ29iamVjdCcgPyB1cmwgOiBwYXJzZVVybCh1cmwpO1xuXHRcdDtcblxuXHRcdHJldHVybiB1cmxwLnNjaGVtZSArICc6Ly8nICsgdXJscC5ob3N0ICsgKHVybHAucG9ydCAhPT0gcG9ydHNbdXJscC5zY2hlbWVdID8gJzonICsgdXJscC5wb3J0IDogJycpICsgdXJscC5wYXRoICsgKHVybHAucXVlcnkgPyB1cmxwLnF1ZXJ5IDogJycpO1xuXHR9O1xuXG5cdC8qKlxuXHRDaGVjayBpZiBzcGVjaWZpZWQgdXJsIGhhcyB0aGUgc2FtZSBvcmlnaW4gYXMgdGhlIGN1cnJlbnQgZG9jdW1lbnRcblxuXHRAbWV0aG9kIGhhc1NhbWVPcmlnaW5cblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ3xPYmplY3R9IHVybFxuXHRAcmV0dXJuIHtCb29sZWFufVxuXHQqL1xuXHR2YXIgaGFzU2FtZU9yaWdpbiA9IGZ1bmN0aW9uKHVybCkge1xuXHRcdGZ1bmN0aW9uIG9yaWdpbih1cmwpIHtcblx0XHRcdHJldHVybiBbdXJsLnNjaGVtZSwgdXJsLmhvc3QsIHVybC5wb3J0XS5qb2luKCcvJyk7XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiB1cmwgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHR1cmwgPSBwYXJzZVVybCh1cmwpO1xuXHRcdH1cblxuXHRcdHJldHVybiBvcmlnaW4ocGFyc2VVcmwoKSkgPT09IG9yaWdpbih1cmwpO1xuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0cGFyc2VVcmw6IHBhcnNlVXJsLFxuXHRcdHJlc29sdmVVcmw6IHJlc29sdmVVcmwsXG5cdFx0aGFzU2FtZU9yaWdpbjogaGFzU2FtZU9yaWdpblxuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvUnVudGltZVRhcmdldC5qc1xuXG4vKipcbiAqIFJ1bnRpbWVUYXJnZXQuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9ydW50aW1lL1J1bnRpbWVUYXJnZXQnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL3J1bnRpbWUvUnVudGltZUNsaWVudCcsXG5cdFwibW94aWUvY29yZS9FdmVudFRhcmdldFwiXG5dLCBmdW5jdGlvbihCYXNpYywgUnVudGltZUNsaWVudCwgRXZlbnRUYXJnZXQpIHtcblx0LyoqXG5cdEluc3RhbmNlIG9mIHRoaXMgY2xhc3MgY2FuIGJlIHVzZWQgYXMgYSB0YXJnZXQgZm9yIHRoZSBldmVudHMgZGlzcGF0Y2hlZCBieSBzaGltcyxcblx0d2hlbiBhbGxvd2luZyB0aGVtIG9udG8gY29tcG9uZW50cyBpcyBmb3IgZWl0aGVyIHJlYXNvbiBpbmFwcHJvcHJpYXRlXG5cblx0QGNsYXNzIG1veGllL3J1bnRpbWUvUnVudGltZVRhcmdldFxuXHRAY29uc3RydWN0b3Jcblx0QHByb3RlY3RlZFxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHQqL1xuXHRmdW5jdGlvbiBSdW50aW1lVGFyZ2V0KCkge1xuXHRcdHRoaXMudWlkID0gQmFzaWMuZ3VpZCgndWlkXycpO1xuXHRcdFxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHR9O1xuXHR9XG5cblx0UnVudGltZVRhcmdldC5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gUnVudGltZVRhcmdldDtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9maWxlL0ZpbGVSZWFkZXJTeW5jLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlclN5bmMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9maWxlL0ZpbGVSZWFkZXJTeW5jJywgW1xuXHQnbW94aWUvY29yZS91dGlscy9CYXNpYycsXG5cdCdtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnQnLFxuXHQnbW94aWUvY29yZS91dGlscy9FbmNvZGUnXG5dLCBmdW5jdGlvbihCYXNpYywgUnVudGltZUNsaWVudCwgRW5jb2RlKSB7XG5cdC8qKlxuXHRTeW5jaHJvbm91cyBGaWxlUmVhZGVyIGltcGxlbWVudGF0aW9uLiBTb21ldGhpbmcgbGlrZSB0aGlzIGlzIGF2YWlsYWJsZSBpbiBXZWJXb3JrZXJzIGVudmlyb25tZW50LCBoZXJlXG5cdGl0IGNhbiBiZSB1c2VkIHRvIHJlYWQgb25seSBwcmVsb2FkZWQgYmxvYnMvZmlsZXMgYW5kIG9ubHkgYmVsb3cgY2VydGFpbiBzaXplIChub3QgeWV0IHN1cmUgd2hhdCB0aGF0J2QgYmUsXG5cdGJ1dCBwcm9iYWJseSA8IDFtYikuIE5vdCBtZWFudCB0byBiZSB1c2VkIGRpcmVjdGx5IGJ5IHVzZXIuXG5cblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcblx0QHByaXZhdGVcblx0QGNvbnN0cnVjdG9yXG5cdCovXG5cdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRSdW50aW1lQ2xpZW50LmNhbGwodGhpcyk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0dWlkOiBCYXNpYy5ndWlkKCd1aWRfJyksXG5cblx0XHRcdHJlYWRBc0JpbmFyeVN0cmluZzogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0XHRyZXR1cm4gX3JlYWQuY2FsbCh0aGlzLCAncmVhZEFzQmluYXJ5U3RyaW5nJywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHRyZWFkQXNEYXRhVVJMOiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdHJldHVybiBfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNEYXRhVVJMJywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHQvKnJlYWRBc0FycmF5QnVmZmVyOiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdHJldHVybiBfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNBcnJheUJ1ZmZlcicsIGJsb2IpO1xuXHRcdFx0fSwqL1xuXHRcdFx0XG5cdFx0XHRyZWFkQXNUZXh0OiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdHJldHVybiBfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNUZXh0JywgYmxvYik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBfcmVhZChvcCwgYmxvYikge1xuXHRcdFx0aWYgKGJsb2IuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdHZhciBzcmMgPSBibG9iLmdldFNvdXJjZSgpO1xuXHRcdFx0XHRzd2l0Y2ggKG9wKSB7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzQmluYXJ5U3RyaW5nJzpcblx0XHRcdFx0XHRcdHJldHVybiBzcmM7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzRGF0YVVSTCc6XG5cdFx0XHRcdFx0XHRyZXR1cm4gJ2RhdGE6JyArIGJsb2IudHlwZSArICc7YmFzZTY0LCcgKyBFbmNvZGUuYnRvYShzcmMpO1xuXHRcdFx0XHRcdGNhc2UgJ3JlYWRBc1RleHQnOlxuXHRcdFx0XHRcdFx0dmFyIHR4dCA9ICcnO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IHNyYy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHR0eHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzcmNbaV0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIHR4dDtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IHRoaXMuY29ubmVjdFJ1bnRpbWUoYmxvYi5ydWlkKS5leGVjLmNhbGwodGhpcywgJ0ZpbGVSZWFkZXJTeW5jJywgJ3JlYWQnLCBvcCwgYmxvYik7XG5cdFx0XHRcdHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKTtcblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdH1cblx0XHR9XG5cdH07XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQveGhyL0Zvcm1EYXRhLmpzXG5cbi8qKlxuICogRm9ybURhdGEuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKFwibW94aWUveGhyL0Zvcm1EYXRhXCIsIFtcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvZmlsZS9CbG9iXCJcbl0sIGZ1bmN0aW9uKHgsIEJhc2ljLCBCbG9iKSB7XG5cdC8qKlxuXHRGb3JtRGF0YVxuXG5cdEBjbGFzcyBtb3hpZS94aHIvRm9ybURhdGFcblx0QGNvbnN0cnVjdG9yXG5cdCovXG5cdGZ1bmN0aW9uIEZvcm1EYXRhKCkge1xuXHRcdHZhciBfYmxvYiwgX2ZpZWxkcyA9IFtdO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdC8qKlxuXHRcdFx0QXBwZW5kIGFub3RoZXIga2V5LXZhbHVlIHBhaXIgdG8gdGhlIEZvcm1EYXRhIG9iamVjdFxuXG5cdFx0XHRAbWV0aG9kIGFwcGVuZFxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBmb3IgdGhlIG5ldyBmaWVsZFxuXHRcdFx0QHBhcmFtIHtTdHJpbmd8QmxvYnxBcnJheXxPYmplY3R9IHZhbHVlIFZhbHVlIGZvciB0aGUgZmllbGRcblx0XHRcdCovXG5cdFx0XHRhcHBlbmQ6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcywgdmFsdWVUeXBlID0gQmFzaWMudHlwZU9mKHZhbHVlKTtcblxuXHRcdFx0XHQvLyBhY2NvcmRpbmcgdG8gc3BlY3MgdmFsdWUgbWlnaHQgYmUgZWl0aGVyIEJsb2Igb3IgU3RyaW5nXG5cdFx0XHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRfYmxvYiA9IHtcblx0XHRcdFx0XHRcdG5hbWU6IG5hbWUsXG5cdFx0XHRcdFx0XHR2YWx1ZTogdmFsdWUgLy8gdW5mb3J0dW5hdGVseSB3ZSBjYW4gb25seSBzZW5kIHNpbmdsZSBCbG9iIGluIG9uZSBGb3JtRGF0YVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoJ2FycmF5JyA9PT0gdmFsdWVUeXBlKSB7XG5cdFx0XHRcdFx0bmFtZSArPSAnW10nO1xuXG5cdFx0XHRcdFx0QmFzaWMuZWFjaCh2YWx1ZSwgZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0XHRcdHNlbGYuYXBwZW5kKG5hbWUsIHZhbHVlKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIGlmICgnb2JqZWN0JyA9PT0gdmFsdWVUeXBlKSB7XG5cdFx0XHRcdFx0QmFzaWMuZWFjaCh2YWx1ZSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHRcdFx0XHRcdFx0c2VsZi5hcHBlbmQobmFtZSArICdbJyArIGtleSArICddJywgdmFsdWUpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCdudWxsJyA9PT0gdmFsdWVUeXBlIHx8ICd1bmRlZmluZWQnID09PSB2YWx1ZVR5cGUgfHwgJ251bWJlcicgPT09IHZhbHVlVHlwZSAmJiBpc05hTih2YWx1ZSkpIHtcblx0XHRcdFx0XHRzZWxmLmFwcGVuZChuYW1lLCBcImZhbHNlXCIpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF9maWVsZHMucHVzaCh7XG5cdFx0XHRcdFx0XHRuYW1lOiBuYW1lLFxuXHRcdFx0XHRcdFx0dmFsdWU6IHZhbHVlLnRvU3RyaW5nKClcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRDaGVja3MgaWYgRm9ybURhdGEgY29udGFpbnMgQmxvYi5cblxuXHRcdFx0QG1ldGhvZCBoYXNCbG9iXG5cdFx0XHRAcmV0dXJuIHtCb29sZWFufVxuXHRcdFx0Ki9cblx0XHRcdGhhc0Jsb2I6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gISF0aGlzLmdldEJsb2IoKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0UmV0cmlldmVzIGJsb2IuXG5cblx0XHRcdEBtZXRob2QgZ2V0QmxvYlxuXHRcdFx0QHJldHVybiB7T2JqZWN0fSBFaXRoZXIgQmxvYiBpZiBmb3VuZCBvciBudWxsXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QmxvYjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBfYmxvYiAmJiBfYmxvYi52YWx1ZSB8fCBudWxsO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSZXRyaWV2ZXMgYmxvYiBmaWVsZCBuYW1lLlxuXG5cdFx0XHRAbWV0aG9kIGdldEJsb2JOYW1lXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IEVpdGhlciBCbG9iIGZpZWxkIG5hbWUgb3IgbnVsbFxuXHRcdFx0Ki9cblx0XHRcdGdldEJsb2JOYW1lOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9ibG9iICYmIF9ibG9iLm5hbWUgfHwgbnVsbDtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0TG9vcCBvdmVyIHRoZSBmaWVsZHMgaW4gRm9ybURhdGEgYW5kIGludm9rZSB0aGUgY2FsbGJhY2sgZm9yIGVhY2ggb2YgdGhlbS5cblxuXHRcdFx0QG1ldGhvZCBlYWNoXG5cdFx0XHRAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjayB0byBjYWxsIGZvciBlYWNoIGZpZWxkXG5cdFx0XHQqL1xuXHRcdFx0ZWFjaDogZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0QmFzaWMuZWFjaChfZmllbGRzLCBmdW5jdGlvbihmaWVsZCkge1xuXHRcdFx0XHRcdGNiKGZpZWxkLnZhbHVlLCBmaWVsZC5uYW1lKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKF9ibG9iKSB7XG5cdFx0XHRcdFx0Y2IoX2Jsb2IudmFsdWUsIF9ibG9iLm5hbWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0X2Jsb2IgPSBudWxsO1xuXHRcdFx0XHRfZmllbGRzID0gW107XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gRm9ybURhdGE7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQveGhyL1hNTEh0dHBSZXF1ZXN0LmpzXG5cbi8qKlxuICogWE1MSHR0cFJlcXVlc3QuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKFwibW94aWUveGhyL1hNTEh0dHBSZXF1ZXN0XCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS9FdmVudFRhcmdldFwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW5jb2RlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9VcmxcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVUYXJnZXRcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVSZWFkZXJTeW5jXCIsXG5cdFwibW94aWUveGhyL0Zvcm1EYXRhXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbnZcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIlxuXSwgZnVuY3Rpb24oQmFzaWMsIHgsIEV2ZW50VGFyZ2V0LCBFbmNvZGUsIFVybCwgUnVudGltZSwgUnVudGltZVRhcmdldCwgQmxvYiwgRmlsZVJlYWRlclN5bmMsIEZvcm1EYXRhLCBFbnYsIE1pbWUpIHtcblxuXHR2YXIgaHR0cENvZGUgPSB7XG5cdFx0MTAwOiAnQ29udGludWUnLFxuXHRcdDEwMTogJ1N3aXRjaGluZyBQcm90b2NvbHMnLFxuXHRcdDEwMjogJ1Byb2Nlc3NpbmcnLFxuXG5cdFx0MjAwOiAnT0snLFxuXHRcdDIwMTogJ0NyZWF0ZWQnLFxuXHRcdDIwMjogJ0FjY2VwdGVkJyxcblx0XHQyMDM6ICdOb24tQXV0aG9yaXRhdGl2ZSBJbmZvcm1hdGlvbicsXG5cdFx0MjA0OiAnTm8gQ29udGVudCcsXG5cdFx0MjA1OiAnUmVzZXQgQ29udGVudCcsXG5cdFx0MjA2OiAnUGFydGlhbCBDb250ZW50Jyxcblx0XHQyMDc6ICdNdWx0aS1TdGF0dXMnLFxuXHRcdDIyNjogJ0lNIFVzZWQnLFxuXG5cdFx0MzAwOiAnTXVsdGlwbGUgQ2hvaWNlcycsXG5cdFx0MzAxOiAnTW92ZWQgUGVybWFuZW50bHknLFxuXHRcdDMwMjogJ0ZvdW5kJyxcblx0XHQzMDM6ICdTZWUgT3RoZXInLFxuXHRcdDMwNDogJ05vdCBNb2RpZmllZCcsXG5cdFx0MzA1OiAnVXNlIFByb3h5Jyxcblx0XHQzMDY6ICdSZXNlcnZlZCcsXG5cdFx0MzA3OiAnVGVtcG9yYXJ5IFJlZGlyZWN0JyxcblxuXHRcdDQwMDogJ0JhZCBSZXF1ZXN0Jyxcblx0XHQ0MDE6ICdVbmF1dGhvcml6ZWQnLFxuXHRcdDQwMjogJ1BheW1lbnQgUmVxdWlyZWQnLFxuXHRcdDQwMzogJ0ZvcmJpZGRlbicsXG5cdFx0NDA0OiAnTm90IEZvdW5kJyxcblx0XHQ0MDU6ICdNZXRob2QgTm90IEFsbG93ZWQnLFxuXHRcdDQwNjogJ05vdCBBY2NlcHRhYmxlJyxcblx0XHQ0MDc6ICdQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCcsXG5cdFx0NDA4OiAnUmVxdWVzdCBUaW1lb3V0Jyxcblx0XHQ0MDk6ICdDb25mbGljdCcsXG5cdFx0NDEwOiAnR29uZScsXG5cdFx0NDExOiAnTGVuZ3RoIFJlcXVpcmVkJyxcblx0XHQ0MTI6ICdQcmVjb25kaXRpb24gRmFpbGVkJyxcblx0XHQ0MTM6ICdSZXF1ZXN0IEVudGl0eSBUb28gTGFyZ2UnLFxuXHRcdDQxNDogJ1JlcXVlc3QtVVJJIFRvbyBMb25nJyxcblx0XHQ0MTU6ICdVbnN1cHBvcnRlZCBNZWRpYSBUeXBlJyxcblx0XHQ0MTY6ICdSZXF1ZXN0ZWQgUmFuZ2UgTm90IFNhdGlzZmlhYmxlJyxcblx0XHQ0MTc6ICdFeHBlY3RhdGlvbiBGYWlsZWQnLFxuXHRcdDQyMjogJ1VucHJvY2Vzc2FibGUgRW50aXR5Jyxcblx0XHQ0MjM6ICdMb2NrZWQnLFxuXHRcdDQyNDogJ0ZhaWxlZCBEZXBlbmRlbmN5Jyxcblx0XHQ0MjY6ICdVcGdyYWRlIFJlcXVpcmVkJyxcblxuXHRcdDUwMDogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsXG5cdFx0NTAxOiAnTm90IEltcGxlbWVudGVkJyxcblx0XHQ1MDI6ICdCYWQgR2F0ZXdheScsXG5cdFx0NTAzOiAnU2VydmljZSBVbmF2YWlsYWJsZScsXG5cdFx0NTA0OiAnR2F0ZXdheSBUaW1lb3V0Jyxcblx0XHQ1MDU6ICdIVFRQIFZlcnNpb24gTm90IFN1cHBvcnRlZCcsXG5cdFx0NTA2OiAnVmFyaWFudCBBbHNvIE5lZ290aWF0ZXMnLFxuXHRcdDUwNzogJ0luc3VmZmljaWVudCBTdG9yYWdlJyxcblx0XHQ1MTA6ICdOb3QgRXh0ZW5kZWQnXG5cdH07XG5cblx0ZnVuY3Rpb24gWE1MSHR0cFJlcXVlc3RVcGxvYWQoKSB7XG5cdFx0dGhpcy51aWQgPSBCYXNpYy5ndWlkKCd1aWRfJyk7XG5cdH1cblxuXHRYTUxIdHRwUmVxdWVzdFVwbG9hZC5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHQvKipcblx0SW1wbGVtZW50YXRpb24gb2YgWE1MSHR0cFJlcXVlc3RcblxuXHRAY2xhc3MgbW94aWUveGhyL1hNTEh0dHBSZXF1ZXN0XG5cdEBjb25zdHJ1Y3RvclxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdEBleHRlbmRzIEV2ZW50VGFyZ2V0XG5cdCovXG5cdHZhciBkaXNwYXRjaGVzID0gW1xuXHRcdCdsb2Fkc3RhcnQnLFxuXG5cdFx0J3Byb2dyZXNzJyxcblxuXHRcdCdhYm9ydCcsXG5cblx0XHQnZXJyb3InLFxuXG5cdFx0J2xvYWQnLFxuXG5cdFx0J3RpbWVvdXQnLFxuXG5cdFx0J2xvYWRlbmQnXG5cblx0XHQvLyByZWFkeXN0YXRlY2hhbmdlIChmb3IgaGlzdG9yaWNhbCByZWFzb25zKVxuXHRdO1xuXG5cdHZhciBOQVRJVkUgPSAxLCBSVU5USU1FID0gMjtcblxuXHRmdW5jdGlvbiBYTUxIdHRwUmVxdWVzdCgpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHQvLyB0aGlzICh0b2dldGhlciB3aXRoIF9wKCkgQHNlZSBiZWxvdykgaXMgaGVyZSB0byBncmFjZWZ1bGx5IHVwZ3JhZGUgdG8gc2V0dGVyL2dldHRlciBzeW50YXggd2hlcmUgcG9zc2libGVcblx0XHRcdHByb3BzID0ge1xuXHRcdFx0XHQvKipcblx0XHRcdFx0VGhlIGFtb3VudCBvZiBtaWxsaXNlY29uZHMgYSByZXF1ZXN0IGNhbiB0YWtlIGJlZm9yZSBiZWluZyB0ZXJtaW5hdGVkLiBJbml0aWFsbHkgemVyby4gWmVybyBtZWFucyB0aGVyZSBpcyBubyB0aW1lb3V0LlxuXG5cdFx0XHRcdEBwcm9wZXJ0eSB0aW1lb3V0XG5cdFx0XHRcdEB0eXBlIE51bWJlclxuXHRcdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHRcdCovXG5cdFx0XHRcdHRpbWVvdXQ6IDAsXG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdEN1cnJlbnQgc3RhdGUsIGNhbiB0YWtlIGZvbGxvd2luZyB2YWx1ZXM6XG5cdFx0XHRcdFVOU0VOVCAobnVtZXJpYyB2YWx1ZSAwKVxuXHRcdFx0XHRUaGUgb2JqZWN0IGhhcyBiZWVuIGNvbnN0cnVjdGVkLlxuXG5cdFx0XHRcdE9QRU5FRCAobnVtZXJpYyB2YWx1ZSAxKVxuXHRcdFx0XHRUaGUgb3BlbigpIG1ldGhvZCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgaW52b2tlZC4gRHVyaW5nIHRoaXMgc3RhdGUgcmVxdWVzdCBoZWFkZXJzIGNhbiBiZSBzZXQgdXNpbmcgc2V0UmVxdWVzdEhlYWRlcigpIGFuZCB0aGUgcmVxdWVzdCBjYW4gYmUgbWFkZSB1c2luZyB0aGUgc2VuZCgpIG1ldGhvZC5cblxuXHRcdFx0XHRIRUFERVJTX1JFQ0VJVkVEIChudW1lcmljIHZhbHVlIDIpXG5cdFx0XHRcdEFsbCByZWRpcmVjdHMgKGlmIGFueSkgaGF2ZSBiZWVuIGZvbGxvd2VkIGFuZCBhbGwgSFRUUCBoZWFkZXJzIG9mIHRoZSBmaW5hbCByZXNwb25zZSBoYXZlIGJlZW4gcmVjZWl2ZWQuIFNldmVyYWwgcmVzcG9uc2UgbWVtYmVycyBvZiB0aGUgb2JqZWN0IGFyZSBub3cgYXZhaWxhYmxlLlxuXG5cdFx0XHRcdExPQURJTkcgKG51bWVyaWMgdmFsdWUgMylcblx0XHRcdFx0VGhlIHJlc3BvbnNlIGVudGl0eSBib2R5IGlzIGJlaW5nIHJlY2VpdmVkLlxuXG5cdFx0XHRcdERPTkUgKG51bWVyaWMgdmFsdWUgNClcblxuXHRcdFx0XHRAcHJvcGVydHkgcmVhZHlTdGF0ZVxuXHRcdFx0XHRAdHlwZSBOdW1iZXJcblx0XHRcdFx0QGRlZmF1bHQgMCAoVU5TRU5UKVxuXHRcdFx0XHQqL1xuXHRcdFx0XHRyZWFkeVN0YXRlOiBYTUxIdHRwUmVxdWVzdC5VTlNFTlQsXG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdFRydWUgd2hlbiB1c2VyIGNyZWRlbnRpYWxzIGFyZSB0byBiZSBpbmNsdWRlZCBpbiBhIGNyb3NzLW9yaWdpbiByZXF1ZXN0LiBGYWxzZSB3aGVuIHRoZXkgYXJlIHRvIGJlIGV4Y2x1ZGVkXG5cdFx0XHRcdGluIGEgY3Jvc3Mtb3JpZ2luIHJlcXVlc3QgYW5kIHdoZW4gY29va2llcyBhcmUgdG8gYmUgaWdub3JlZCBpbiBpdHMgcmVzcG9uc2UuIEluaXRpYWxseSBmYWxzZS5cblxuXHRcdFx0XHRAcHJvcGVydHkgd2l0aENyZWRlbnRpYWxzXG5cdFx0XHRcdEB0eXBlIEJvb2xlYW5cblx0XHRcdFx0QGRlZmF1bHQgZmFsc2Vcblx0XHRcdFx0Ki9cblx0XHRcdFx0d2l0aENyZWRlbnRpYWxzOiBmYWxzZSxcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgSFRUUCBzdGF0dXMgY29kZS5cblxuXHRcdFx0XHRAcHJvcGVydHkgc3RhdHVzXG5cdFx0XHRcdEB0eXBlIE51bWJlclxuXHRcdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHRcdCovXG5cdFx0XHRcdHN0YXR1czogMCxcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgSFRUUCBzdGF0dXMgdGV4dC5cblxuXHRcdFx0XHRAcHJvcGVydHkgc3RhdHVzVGV4dFxuXHRcdFx0XHRAdHlwZSBTdHJpbmdcblx0XHRcdFx0Ki9cblx0XHRcdFx0c3RhdHVzVGV4dDogXCJcIixcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgcmVzcG9uc2UgdHlwZS4gQ2FuIGJlIHNldCB0byBjaGFuZ2UgdGhlIHJlc3BvbnNlIHR5cGUuIFZhbHVlcyBhcmU6XG5cdFx0XHRcdHRoZSBlbXB0eSBzdHJpbmcgKGRlZmF1bHQpLCBcImFycmF5YnVmZmVyXCIsIFwiYmxvYlwiLCBcImRvY3VtZW50XCIsIFwianNvblwiLCBhbmQgXCJ0ZXh0XCIuXG5cblx0XHRcdFx0QHByb3BlcnR5IHJlc3BvbnNlVHlwZVxuXHRcdFx0XHRAdHlwZSBTdHJpbmdcblx0XHRcdFx0Ki9cblx0XHRcdFx0cmVzcG9uc2VUeXBlOiBcIlwiLFxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHRSZXR1cm5zIHRoZSBkb2N1bWVudCByZXNwb25zZSBlbnRpdHkgYm9keS5cblxuXHRcdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkU3RhdGVFcnJvclwiIGV4Y2VwdGlvbiBpZiByZXNwb25zZVR5cGUgaXMgbm90IHRoZSBlbXB0eSBzdHJpbmcgb3IgXCJkb2N1bWVudFwiLlxuXG5cdFx0XHRcdEBwcm9wZXJ0eSByZXNwb25zZVhNTFxuXHRcdFx0XHRAdHlwZSBEb2N1bWVudFxuXHRcdFx0XHQqL1xuXHRcdFx0XHRyZXNwb25zZVhNTDogbnVsbCxcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgdGV4dCByZXNwb25zZSBlbnRpdHkgYm9keS5cblxuXHRcdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkU3RhdGVFcnJvclwiIGV4Y2VwdGlvbiBpZiByZXNwb25zZVR5cGUgaXMgbm90IHRoZSBlbXB0eSBzdHJpbmcgb3IgXCJ0ZXh0XCIuXG5cblx0XHRcdFx0QHByb3BlcnR5IHJlc3BvbnNlVGV4dFxuXHRcdFx0XHRAdHlwZSBTdHJpbmdcblx0XHRcdFx0Ki9cblx0XHRcdFx0cmVzcG9uc2VUZXh0OiBudWxsLFxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHRSZXR1cm5zIHRoZSByZXNwb25zZSBlbnRpdHkgYm9keSAoaHR0cDovL3d3dy53My5vcmcvVFIvWE1MSHR0cFJlcXVlc3QvI3Jlc3BvbnNlLWVudGl0eS1ib2R5KS5cblx0XHRcdFx0Q2FuIGJlY29tZTogQXJyYXlCdWZmZXIsIEJsb2IsIERvY3VtZW50LCBKU09OLCBUZXh0XG5cblx0XHRcdFx0QHByb3BlcnR5IHJlc3BvbnNlXG5cdFx0XHRcdEB0eXBlIE1peGVkXG5cdFx0XHRcdCovXG5cdFx0XHRcdHJlc3BvbnNlOiBudWxsXG5cdFx0XHR9LFxuXG5cdFx0XHRfYXN5bmMgPSB0cnVlLFxuXHRcdFx0X3VybCxcblx0XHRcdF9tZXRob2QsXG5cdFx0XHRfaGVhZGVycyA9IHt9LFxuXHRcdFx0X3VzZXIsXG5cdFx0XHRfcGFzc3dvcmQsXG5cdFx0XHRfZW5jb2RpbmcgPSBudWxsLFxuXHRcdFx0X21pbWVUeXBlID0gbnVsbCxcblxuXHRcdFx0Ly8gZmxhZ3Ncblx0XHRcdF9zeW5jX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF9zZW5kX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF91cGxvYWRfZXZlbnRzX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF91cGxvYWRfY29tcGxldGVfZmxhZyA9IGZhbHNlLFxuXHRcdFx0X2Vycm9yX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF9zYW1lX29yaWdpbl9mbGFnID0gZmFsc2UsXG5cblx0XHRcdC8vIHRpbWVzXG5cdFx0XHRfc3RhcnRfdGltZSxcblx0XHRcdF90aW1lb3V0c2V0X3RpbWUsXG5cblx0XHRcdF9maW5hbE1pbWUgPSBudWxsLFxuXHRcdFx0X2ZpbmFsQ2hhcnNldCA9IG51bGwsXG5cblx0XHRcdF9vcHRpb25zID0ge30sXG5cdFx0XHRfeGhyLFxuXHRcdFx0X3Jlc3BvbnNlSGVhZGVycyA9ICcnLFxuXHRcdFx0X3Jlc3BvbnNlSGVhZGVyc0JhZ1xuXHRcdFx0O1xuXG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywgcHJvcHMsIHtcblx0XHRcdC8qKlxuXHRcdFx0VW5pcXVlIGlkIG9mIHRoZSBjb21wb25lbnRcblxuXHRcdFx0QHByb3BlcnR5IHVpZFxuXHRcdFx0QHR5cGUgU3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0dWlkOiBCYXNpYy5ndWlkKCd1aWRfJyksXG5cblx0XHRcdC8qKlxuXHRcdFx0VGFyZ2V0IGZvciBVcGxvYWQgZXZlbnRzXG5cblx0XHRcdEBwcm9wZXJ0eSB1cGxvYWRcblx0XHRcdEB0eXBlIFhNTEh0dHBSZXF1ZXN0VXBsb2FkXG5cdFx0XHQqL1xuXHRcdFx0dXBsb2FkOiBuZXcgWE1MSHR0cFJlcXVlc3RVcGxvYWQoKSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFNldHMgdGhlIHJlcXVlc3QgbWV0aG9kLCByZXF1ZXN0IFVSTCwgc3luY2hyb25vdXMgZmxhZywgcmVxdWVzdCB1c2VybmFtZSwgYW5kIHJlcXVlc3QgcGFzc3dvcmQuXG5cblx0XHRcdFRocm93cyBhIFwiU3ludGF4RXJyb3JcIiBleGNlcHRpb24gaWYgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcblxuXHRcdFx0bWV0aG9kIGlzIG5vdCBhIHZhbGlkIEhUVFAgbWV0aG9kLlxuXHRcdFx0dXJsIGNhbm5vdCBiZSByZXNvbHZlZC5cblx0XHRcdHVybCBjb250YWlucyB0aGUgXCJ1c2VyOnBhc3N3b3JkXCIgZm9ybWF0IGluIHRoZSB1c2VyaW5mbyBwcm9kdWN0aW9uLlxuXHRcdFx0VGhyb3dzIGEgXCJTZWN1cml0eUVycm9yXCIgZXhjZXB0aW9uIGlmIG1ldGhvZCBpcyBhIGNhc2UtaW5zZW5zaXRpdmUgbWF0Y2ggZm9yIENPTk5FQ1QsIFRSQUNFIG9yIFRSQUNLLlxuXG5cdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkQWNjZXNzRXJyb3JcIiBleGNlcHRpb24gaWYgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcblxuXHRcdFx0RWl0aGVyIHVzZXIgb3IgcGFzc3dvcmQgaXMgcGFzc2VkIGFzIGFyZ3VtZW50IGFuZCB0aGUgb3JpZ2luIG9mIHVybCBkb2VzIG5vdCBtYXRjaCB0aGUgWE1MSHR0cFJlcXVlc3Qgb3JpZ2luLlxuXHRcdFx0VGhlcmUgaXMgYW4gYXNzb2NpYXRlZCBYTUxIdHRwUmVxdWVzdCBkb2N1bWVudCBhbmQgZWl0aGVyIHRoZSB0aW1lb3V0IGF0dHJpYnV0ZSBpcyBub3QgemVybyxcblx0XHRcdHRoZSB3aXRoQ3JlZGVudGlhbHMgYXR0cmlidXRlIGlzIHRydWUsIG9yIHRoZSByZXNwb25zZVR5cGUgYXR0cmlidXRlIGlzIG5vdCB0aGUgZW1wdHkgc3RyaW5nLlxuXG5cblx0XHRcdEBtZXRob2Qgb3BlblxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IG1ldGhvZCBIVFRQIG1ldGhvZCB0byB1c2Ugb24gcmVxdWVzdFxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IHVybCBVUkwgdG8gcmVxdWVzdFxuXHRcdFx0QHBhcmFtIHtCb29sZWFufSBbYXN5bmM9dHJ1ZV0gSWYgZmFsc2UgcmVxdWVzdCB3aWxsIGJlIGRvbmUgaW4gc3luY2hyb25vdXMgbWFubmVyLiBBc3luY2hyb25vdXMgYnkgZGVmYXVsdC5cblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBbdXNlcl0gVXNlcm5hbWUgdG8gdXNlIGluIEhUVFAgYXV0aGVudGljYXRpb24gcHJvY2VzcyBvbiBzZXJ2ZXItc2lkZVxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IFtwYXNzd29yZF0gUGFzc3dvcmQgdG8gdXNlIGluIEhUVFAgYXV0aGVudGljYXRpb24gcHJvY2VzcyBvbiBzZXJ2ZXItc2lkZVxuXHRcdFx0Ki9cblx0XHRcdG9wZW46IGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlciwgcGFzc3dvcmQpIHtcblx0XHRcdFx0dmFyIHVybHA7XG5cblx0XHRcdFx0Ly8gZmlyc3QgdHdvIGFyZ3VtZW50cyBhcmUgcmVxdWlyZWRcblx0XHRcdFx0aWYgKCFtZXRob2QgfHwgIXVybCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDIgLSBjaGVjayBpZiBhbnkgY29kZSBwb2ludCBpbiBtZXRob2QgaXMgaGlnaGVyIHRoYW4gVSswMEZGIG9yIGFmdGVyIGRlZmxhdGluZyBtZXRob2QgaXQgZG9lcyBub3QgbWF0Y2ggdGhlIG1ldGhvZFxuXHRcdFx0XHRpZiAoL1tcXHUwMTAwLVxcdWZmZmZdLy50ZXN0KG1ldGhvZCkgfHwgRW5jb2RlLnV0ZjhfZW5jb2RlKG1ldGhvZCkgIT09IG1ldGhvZCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDNcblx0XHRcdFx0aWYgKCEhfkJhc2ljLmluQXJyYXkobWV0aG9kLnRvVXBwZXJDYXNlKCksIFsnQ09OTkVDVCcsICdERUxFVEUnLCAnR0VUJywgJ0hFQUQnLCAnT1BUSU9OUycsICdQT1NUJywgJ1BVVCcsICdUUkFDRScsICdUUkFDSyddKSkge1xuXHRcdFx0XHRcdF9tZXRob2QgPSBtZXRob2QudG9VcHBlckNhc2UoKTtcblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0Ly8gNCAtIGFsbG93aW5nIHRoZXNlIG1ldGhvZHMgcG9zZXMgYSBzZWN1cml0eSByaXNrXG5cdFx0XHRcdGlmICghIX5CYXNpYy5pbkFycmF5KF9tZXRob2QsIFsnQ09OTkVDVCcsICdUUkFDRScsICdUUkFDSyddKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TRUNVUklUWV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gNVxuXHRcdFx0XHR1cmwgPSBFbmNvZGUudXRmOF9lbmNvZGUodXJsKTtcblxuXHRcdFx0XHQvLyA2IC0gUmVzb2x2ZSB1cmwgcmVsYXRpdmUgdG8gdGhlIFhNTEh0dHBSZXF1ZXN0IGJhc2UgVVJMLiBJZiB0aGUgYWxnb3JpdGhtIHJldHVybnMgYW4gZXJyb3IsIHRocm93IGEgXCJTeW50YXhFcnJvclwiLlxuXHRcdFx0XHR1cmxwID0gVXJsLnBhcnNlVXJsKHVybCk7XG5cblx0XHRcdFx0X3NhbWVfb3JpZ2luX2ZsYWcgPSBVcmwuaGFzU2FtZU9yaWdpbih1cmxwKTtcblxuXHRcdFx0XHQvLyA3IC0gbWFudWFsbHkgYnVpbGQgdXAgYWJzb2x1dGUgdXJsXG5cdFx0XHRcdF91cmwgPSBVcmwucmVzb2x2ZVVybCh1cmwpO1xuXG5cdFx0XHRcdC8vIDktMTAsIDEyLTEzXG5cdFx0XHRcdGlmICgodXNlciB8fCBwYXNzd29yZCkgJiYgIV9zYW1lX29yaWdpbl9mbGFnKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfQUNDRVNTX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRfdXNlciA9IHVzZXIgfHwgdXJscC51c2VyO1xuXHRcdFx0XHRfcGFzc3dvcmQgPSBwYXNzd29yZCB8fCB1cmxwLnBhc3M7XG5cblx0XHRcdFx0Ly8gMTFcblx0XHRcdFx0X2FzeW5jID0gYXN5bmMgfHwgdHJ1ZTtcblxuXHRcdFx0XHRpZiAoX2FzeW5jID09PSBmYWxzZSAmJiAoX3AoJ3RpbWVvdXQnKSB8fCBfcCgnd2l0aENyZWRlbnRpYWxzJykgfHwgX3AoJ3Jlc3BvbnNlVHlwZScpICE9PSBcIlwiKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX0FDQ0VTU19FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gMTQgLSB0ZXJtaW5hdGUgYWJvcnQoKVxuXG5cdFx0XHRcdC8vIDE1IC0gdGVybWluYXRlIHNlbmQoKVxuXG5cdFx0XHRcdC8vIDE4XG5cdFx0XHRcdF9zeW5jX2ZsYWcgPSAhX2FzeW5jO1xuXHRcdFx0XHRfc2VuZF9mbGFnID0gZmFsc2U7XG5cdFx0XHRcdF9oZWFkZXJzID0ge307XG5cdFx0XHRcdF9yZXNldC5jYWxsKHRoaXMpO1xuXG5cdFx0XHRcdC8vIDE5XG5cdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuT1BFTkVEKTtcblxuXHRcdFx0XHQvLyAyMFxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXZlbnQoJ3JlYWR5c3RhdGVjaGFuZ2UnKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0QXBwZW5kcyBhbiBoZWFkZXIgdG8gdGhlIGxpc3Qgb2YgYXV0aG9yIHJlcXVlc3QgaGVhZGVycywgb3IgaWYgaGVhZGVyIGlzIGFscmVhZHlcblx0XHRcdGluIHRoZSBsaXN0IG9mIGF1dGhvciByZXF1ZXN0IGhlYWRlcnMsIGNvbWJpbmVzIGl0cyB2YWx1ZSB3aXRoIHZhbHVlLlxuXG5cdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkU3RhdGVFcnJvclwiIGV4Y2VwdGlvbiBpZiB0aGUgc3RhdGUgaXMgbm90IE9QRU5FRCBvciBpZiB0aGUgc2VuZCgpIGZsYWcgaXMgc2V0LlxuXHRcdFx0VGhyb3dzIGEgXCJTeW50YXhFcnJvclwiIGV4Y2VwdGlvbiBpZiBoZWFkZXIgaXMgbm90IGEgdmFsaWQgSFRUUCBoZWFkZXIgZmllbGQgbmFtZSBvciBpZiB2YWx1ZVxuXHRcdFx0aXMgbm90IGEgdmFsaWQgSFRUUCBoZWFkZXIgZmllbGQgdmFsdWUuXG5cblx0XHRcdEBtZXRob2Qgc2V0UmVxdWVzdEhlYWRlclxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IGhlYWRlclxuXHRcdFx0QHBhcmFtIHtTdHJpbmd8TnVtYmVyfSB2YWx1ZVxuXHRcdFx0Ki9cblx0XHRcdHNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uKGhlYWRlciwgdmFsdWUpIHtcblx0XHRcdFx0dmFyIHVhSGVhZGVycyA9IFsgLy8gdGhlc2UgaGVhZGVycyBhcmUgY29udHJvbGxlZCBieSB0aGUgdXNlciBhZ2VudFxuXHRcdFx0XHRcdFx0XCJhY2NlcHQtY2hhcnNldFwiLFxuXHRcdFx0XHRcdFx0XCJhY2NlcHQtZW5jb2RpbmdcIixcblx0XHRcdFx0XHRcdFwiYWNjZXNzLWNvbnRyb2wtcmVxdWVzdC1oZWFkZXJzXCIsXG5cdFx0XHRcdFx0XHRcImFjY2Vzcy1jb250cm9sLXJlcXVlc3QtbWV0aG9kXCIsXG5cdFx0XHRcdFx0XHRcImNvbm5lY3Rpb25cIixcblx0XHRcdFx0XHRcdFwiY29udGVudC1sZW5ndGhcIixcblx0XHRcdFx0XHRcdFwiY29va2llXCIsXG5cdFx0XHRcdFx0XHRcImNvb2tpZTJcIixcblx0XHRcdFx0XHRcdFwiY29udGVudC10cmFuc2Zlci1lbmNvZGluZ1wiLFxuXHRcdFx0XHRcdFx0XCJkYXRlXCIsXG5cdFx0XHRcdFx0XHRcImV4cGVjdFwiLFxuXHRcdFx0XHRcdFx0XCJob3N0XCIsXG5cdFx0XHRcdFx0XHRcImtlZXAtYWxpdmVcIixcblx0XHRcdFx0XHRcdFwib3JpZ2luXCIsXG5cdFx0XHRcdFx0XHRcInJlZmVyZXJcIixcblx0XHRcdFx0XHRcdFwidGVcIixcblx0XHRcdFx0XHRcdFwidHJhaWxlclwiLFxuXHRcdFx0XHRcdFx0XCJ0cmFuc2Zlci1lbmNvZGluZ1wiLFxuXHRcdFx0XHRcdFx0XCJ1cGdyYWRlXCIsXG5cdFx0XHRcdFx0XHRcInVzZXItYWdlbnRcIixcblx0XHRcdFx0XHRcdFwidmlhXCJcblx0XHRcdFx0XHRdO1xuXG5cdFx0XHRcdC8vIDEtMlxuXHRcdFx0XHRpZiAoX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuT1BFTkVEIHx8IF9zZW5kX2ZsYWcpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gM1xuXHRcdFx0XHRpZiAoL1tcXHUwMTAwLVxcdWZmZmZdLy50ZXN0KGhlYWRlcikgfHwgRW5jb2RlLnV0ZjhfZW5jb2RlKGhlYWRlcikgIT09IGhlYWRlcikge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDRcblx0XHRcdFx0LyogdGhpcyBzdGVwIGlzIHNlZW1pbmdseSBieXBhc3NlZCBpbiBicm93c2VycywgcHJvYmFibHkgdG8gYWxsb3cgdmFyaW91cyB1bmljb2RlIGNoYXJhY3RlcnMgaW4gaGVhZGVyIHZhbHVlc1xuXHRcdFx0XHRpZiAoL1tcXHUwMTAwLVxcdWZmZmZdLy50ZXN0KHZhbHVlKSB8fCBFbmNvZGUudXRmOF9lbmNvZGUodmFsdWUpICE9PSB2YWx1ZSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fSovXG5cblx0XHRcdFx0aGVhZGVyID0gQmFzaWMudHJpbShoZWFkZXIpLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdFx0Ly8gc2V0dGluZyBvZiBwcm94eS0qIGFuZCBzZWMtKiBoZWFkZXJzIGlzIHByb2hpYml0ZWQgYnkgc3BlY1xuXHRcdFx0XHRpZiAoISF+QmFzaWMuaW5BcnJheShoZWFkZXIsIHVhSGVhZGVycykgfHwgL14ocHJveHlcXC18c2VjXFwtKS8udGVzdChoZWFkZXIpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gY2FtZWxpemVcblx0XHRcdFx0Ly8gYnJvd3NlcnMgbG93ZXJjYXNlIGhlYWRlciBuYW1lcyAoYXQgbGVhc3QgZm9yIGN1c3RvbSBvbmVzKVxuXHRcdFx0XHQvLyBoZWFkZXIgPSBoZWFkZXIucmVwbGFjZSgvXFxiXFx3L2csIGZ1bmN0aW9uKCQxKSB7IHJldHVybiAkMS50b1VwcGVyQ2FzZSgpOyB9KTtcblxuXHRcdFx0XHRpZiAoIV9oZWFkZXJzW2hlYWRlcl0pIHtcblx0XHRcdFx0XHRfaGVhZGVyc1toZWFkZXJdID0gdmFsdWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMjYxNiNzZWN0aW9uLTQuMiAobGFzdCBwYXJhZ3JhcGgpXG5cdFx0XHRcdFx0X2hlYWRlcnNbaGVhZGVyXSArPSAnLCAnICsgdmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFRlc3QgaWYgdGhlIHNwZWNpZmllZCBoZWFkZXIgaXMgYWxyZWFkeSBzZXQgb24gdGhpcyByZXF1ZXN0LlxuXHRcdFx0ICogUmV0dXJucyBhIGhlYWRlciB2YWx1ZSBvciBib29sZWFuIGZhbHNlIGlmIGl0J3Mgbm90IHlldCBzZXQuXG5cdFx0XHQgKlxuXHRcdFx0ICogQG1ldGhvZCBoYXNSZXF1ZXN0SGVhZGVyXG5cdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gaGVhZGVyIE5hbWUgb2YgdGhlIGhlYWRlciB0byB0ZXN0XG5cdFx0XHQgKiBAcmV0dXJuIHtCb29sZWFufFN0cmluZ31cblx0XHRcdCAqL1xuXHRcdFx0aGFzUmVxdWVzdEhlYWRlcjogZnVuY3Rpb24oaGVhZGVyKSB7XG5cdFx0XHRcdHJldHVybiBoZWFkZXIgJiYgX2hlYWRlcnNbaGVhZGVyLnRvTG93ZXJDYXNlKCldIHx8IGZhbHNlO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSZXR1cm5zIGFsbCBoZWFkZXJzIGZyb20gdGhlIHJlc3BvbnNlLCB3aXRoIHRoZSBleGNlcHRpb24gb2YgdGhvc2Ugd2hvc2UgZmllbGQgbmFtZSBpcyBTZXQtQ29va2llIG9yIFNldC1Db29raWUyLlxuXG5cdFx0XHRAbWV0aG9kIGdldEFsbFJlc3BvbnNlSGVhZGVyc1xuXHRcdFx0QHJldHVybiB7U3RyaW5nfSByZXBvbnNlIGhlYWRlcnMgb3IgZW1wdHkgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9yZXNwb25zZUhlYWRlcnMgfHwgJyc7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgdGhlIGhlYWRlciBmaWVsZCB2YWx1ZSBmcm9tIHRoZSByZXNwb25zZSBvZiB3aGljaCB0aGUgZmllbGQgbmFtZSBtYXRjaGVzIGhlYWRlcixcblx0XHRcdHVubGVzcyB0aGUgZmllbGQgbmFtZSBpcyBTZXQtQ29va2llIG9yIFNldC1Db29raWUyLlxuXG5cdFx0XHRAbWV0aG9kIGdldFJlc3BvbnNlSGVhZGVyXG5cdFx0XHRAcGFyYW0ge1N0cmluZ30gaGVhZGVyXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IHZhbHVlKHMpIGZvciB0aGUgc3BlY2lmaWVkIGhlYWRlciBvciBudWxsXG5cdFx0XHQqL1xuXHRcdFx0Z2V0UmVzcG9uc2VIZWFkZXI6IGZ1bmN0aW9uKGhlYWRlcikge1xuXHRcdFx0XHRoZWFkZXIgPSBoZWFkZXIudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0XHRpZiAoX2Vycm9yX2ZsYWcgfHwgISF+QmFzaWMuaW5BcnJheShoZWFkZXIsIFsnc2V0LWNvb2tpZScsICdzZXQtY29va2llMiddKSkge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKF9yZXNwb25zZUhlYWRlcnMgJiYgX3Jlc3BvbnNlSGVhZGVycyAhPT0gJycpIHtcblx0XHRcdFx0XHQvLyBpZiB3ZSBkaWRuJ3QgcGFyc2UgcmVzcG9uc2UgaGVhZGVycyB1bnRpbCBub3csIGRvIGl0IGFuZCBrZWVwIGZvciBsYXRlclxuXHRcdFx0XHRcdGlmICghX3Jlc3BvbnNlSGVhZGVyc0JhZykge1xuXHRcdFx0XHRcdFx0X3Jlc3BvbnNlSGVhZGVyc0JhZyA9IHt9O1xuXHRcdFx0XHRcdFx0QmFzaWMuZWFjaChfcmVzcG9uc2VIZWFkZXJzLnNwbGl0KC9cXHJcXG4vKSwgZnVuY3Rpb24obGluZSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgcGFpciA9IGxpbmUuc3BsaXQoLzpcXHMrLyk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYWlyLmxlbmd0aCA9PT0gMikgeyAvLyBsYXN0IGxpbmUgbWlnaHQgYmUgZW1wdHksIG9taXRcblx0XHRcdFx0XHRcdFx0XHRwYWlyWzBdID0gQmFzaWMudHJpbShwYWlyWzBdKTsgLy8ganVzdCBpbiBjYXNlXG5cdFx0XHRcdFx0XHRcdFx0X3Jlc3BvbnNlSGVhZGVyc0JhZ1twYWlyWzBdLnRvTG93ZXJDYXNlKCldID0geyAvLyBzaW1wbHkgdG8gcmV0YWluIGhlYWRlciBuYW1lIGluIG9yaWdpbmFsIGZvcm1cblx0XHRcdFx0XHRcdFx0XHRcdGhlYWRlcjogcGFpclswXSxcblx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlOiBCYXNpYy50cmltKHBhaXJbMV0pXG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChfcmVzcG9uc2VIZWFkZXJzQmFnLmhhc093blByb3BlcnR5KGhlYWRlcikpIHtcblx0XHRcdFx0XHRcdHJldHVybiBfcmVzcG9uc2VIZWFkZXJzQmFnW2hlYWRlcl0uaGVhZGVyICsgJzogJyArIF9yZXNwb25zZUhlYWRlcnNCYWdbaGVhZGVyXS52YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFNldHMgdGhlIENvbnRlbnQtVHlwZSBoZWFkZXIgZm9yIHRoZSByZXNwb25zZSB0byBtaW1lLlxuXHRcdFx0VGhyb3dzIGFuIFwiSW52YWxpZFN0YXRlRXJyb3JcIiBleGNlcHRpb24gaWYgdGhlIHN0YXRlIGlzIExPQURJTkcgb3IgRE9ORS5cblx0XHRcdFRocm93cyBhIFwiU3ludGF4RXJyb3JcIiBleGNlcHRpb24gaWYgbWltZSBpcyBub3QgYSB2YWxpZCBtZWRpYSB0eXBlLlxuXG5cdFx0XHRAbWV0aG9kIG92ZXJyaWRlTWltZVR5cGVcblx0XHRcdEBwYXJhbSBTdHJpbmcgbWltZSBNaW1lIHR5cGUgdG8gc2V0XG5cdFx0XHQqL1xuXHRcdFx0b3ZlcnJpZGVNaW1lVHlwZTogZnVuY3Rpb24obWltZSkge1xuXHRcdFx0XHR2YXIgbWF0Y2hlcywgY2hhcnNldDtcblxuXHRcdFx0XHQvLyAxXG5cdFx0XHRcdGlmICghIX5CYXNpYy5pbkFycmF5KF9wKCdyZWFkeVN0YXRlJyksIFtYTUxIdHRwUmVxdWVzdC5MT0FESU5HLCBYTUxIdHRwUmVxdWVzdC5ET05FXSkpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gMlxuXHRcdFx0XHRtaW1lID0gQmFzaWMudHJpbShtaW1lLnRvTG93ZXJDYXNlKCkpO1xuXG5cdFx0XHRcdGlmICgvOy8udGVzdChtaW1lKSAmJiAobWF0Y2hlcyA9IG1pbWUubWF0Y2goL14oW147XSspKD86O1xcc2NoYXJzZXRcXD0pPyguKikkLykpKSB7XG5cdFx0XHRcdFx0bWltZSA9IG1hdGNoZXNbMV07XG5cdFx0XHRcdFx0aWYgKG1hdGNoZXNbMl0pIHtcblx0XHRcdFx0XHRcdGNoYXJzZXQgPSBtYXRjaGVzWzJdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICghTWltZS5taW1lc1ttaW1lXSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDMtNFxuXHRcdFx0XHRfZmluYWxNaW1lID0gbWltZTtcblx0XHRcdFx0X2ZpbmFsQ2hhcnNldCA9IGNoYXJzZXQ7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdEluaXRpYXRlcyB0aGUgcmVxdWVzdC4gVGhlIG9wdGlvbmFsIGFyZ3VtZW50IHByb3ZpZGVzIHRoZSByZXF1ZXN0IGVudGl0eSBib2R5LlxuXHRcdFx0VGhlIGFyZ3VtZW50IGlzIGlnbm9yZWQgaWYgcmVxdWVzdCBtZXRob2QgaXMgR0VUIG9yIEhFQUQuXG5cblx0XHRcdFRocm93cyBhbiBcIkludmFsaWRTdGF0ZUVycm9yXCIgZXhjZXB0aW9uIGlmIHRoZSBzdGF0ZSBpcyBub3QgT1BFTkVEIG9yIGlmIHRoZSBzZW5kKCkgZmxhZyBpcyBzZXQuXG5cblx0XHRcdEBtZXRob2Qgc2VuZFxuXHRcdFx0QHBhcmFtIHtCbG9ifERvY3VtZW50fFN0cmluZ3xGb3JtRGF0YX0gW2RhdGFdIFJlcXVlc3QgZW50aXR5IGJvZHlcblx0XHRcdEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gU2V0IG9mIHJlcXVpcmVtZW50cyBhbmQgcHJlLXJlcXVpc2l0aWVzIGZvciBydW50aW1lIGluaXRpYWxpemF0aW9uXG5cdFx0XHQqL1xuXHRcdFx0c2VuZDogZnVuY3Rpb24oZGF0YSwgb3B0aW9ucykge1xuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKG9wdGlvbnMpID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdF9vcHRpb25zID0geyBydWlkOiBvcHRpb25zIH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoIW9wdGlvbnMpIHtcblx0XHRcdFx0XHRfb3B0aW9ucyA9IHt9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF9vcHRpb25zID0gb3B0aW9ucztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDEtMlxuXHRcdFx0XHRpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBYTUxIdHRwUmVxdWVzdC5PUEVORUQgfHwgX3NlbmRfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAzXG5cdFx0XHRcdC8vIHNlbmRpbmcgQmxvYlxuXHRcdFx0XHRpZiAoZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRfb3B0aW9ucy5ydWlkID0gZGF0YS5ydWlkO1xuXHRcdFx0XHRcdF9taW1lVHlwZSA9IGRhdGEudHlwZSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvcm1EYXRhXG5cdFx0XHRcdGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXHRcdFx0XHRcdGlmIChkYXRhLmhhc0Jsb2IoKSkge1xuXHRcdFx0XHRcdFx0dmFyIGJsb2IgPSBkYXRhLmdldEJsb2IoKTtcblx0XHRcdFx0XHRcdF9vcHRpb25zLnJ1aWQgPSBibG9iLnJ1aWQ7XG5cdFx0XHRcdFx0XHRfbWltZVR5cGUgPSBibG9iLnR5cGUgfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRE9NU3RyaW5nXG5cdFx0XHRcdGVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdF9lbmNvZGluZyA9ICdVVEYtOCc7XG5cdFx0XHRcdFx0X21pbWVUeXBlID0gJ3RleHQvcGxhaW47Y2hhcnNldD1VVEYtOCc7XG5cblx0XHRcdFx0XHQvLyBkYXRhIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gVW5pY29kZSBhbmQgZW5jb2RlZCBhcyBVVEYtOFxuXHRcdFx0XHRcdGRhdGEgPSBFbmNvZGUudXRmOF9lbmNvZGUoZGF0YSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBpZiB3aXRoQ3JlZGVudGlhbHMgbm90IHNldCwgYnV0IHJlcXVlc3RlZCwgc2V0IGl0IGF1dG9tYXRpY2FsbHlcblx0XHRcdFx0aWYgKCF0aGlzLndpdGhDcmVkZW50aWFscykge1xuXHRcdFx0XHRcdHRoaXMud2l0aENyZWRlbnRpYWxzID0gKF9vcHRpb25zLnJlcXVpcmVkX2NhcHMgJiYgX29wdGlvbnMucmVxdWlyZWRfY2Fwcy5zZW5kX2Jyb3dzZXJfY29va2llcykgJiYgIV9zYW1lX29yaWdpbl9mbGFnO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gNCAtIHN0b3JhZ2UgbXV0ZXhcblx0XHRcdFx0Ly8gNVxuXHRcdFx0XHRfdXBsb2FkX2V2ZW50c19mbGFnID0gKCFfc3luY19mbGFnICYmIHRoaXMudXBsb2FkLmhhc0V2ZW50TGlzdGVuZXIoKSk7IC8vIERTQVBcblx0XHRcdFx0Ly8gNlxuXHRcdFx0XHRfZXJyb3JfZmxhZyA9IGZhbHNlO1xuXHRcdFx0XHQvLyA3XG5cdFx0XHRcdF91cGxvYWRfY29tcGxldGVfZmxhZyA9ICFkYXRhO1xuXHRcdFx0XHQvLyA4IC0gQXN5bmNocm9ub3VzIHN0ZXBzXG5cdFx0XHRcdGlmICghX3N5bmNfZmxhZykge1xuXHRcdFx0XHRcdC8vIDguMVxuXHRcdFx0XHRcdF9zZW5kX2ZsYWcgPSB0cnVlO1xuXHRcdFx0XHRcdC8vIDguMlxuXHRcdFx0XHRcdC8vIHRoaXMuZGlzcGF0Y2hFdmVudCgnbG9hZHN0YXJ0Jyk7IC8vIHdpbGwgYmUgZGlzcGF0Y2hlZCBlaXRoZXIgYnkgbmF0aXZlIG9yIHJ1bnRpbWUgeGhyXG5cdFx0XHRcdFx0Ly8gOC4zXG5cdFx0XHRcdFx0Ly9pZiAoIV91cGxvYWRfY29tcGxldGVfZmxhZykge1xuXHRcdFx0XHRcdFx0Ly8gdGhpcy51cGxvYWQuZGlzcGF0Y2hFdmVudCgnbG9hZHN0YXJ0Jyk7XHQvLyB3aWxsIGJlIGRpc3BhdGNoZWQgZWl0aGVyIGJ5IG5hdGl2ZSBvciBydW50aW1lIHhoclxuXHRcdFx0XHRcdC8vfVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIDguNSAtIFJldHVybiB0aGUgc2VuZCgpIG1ldGhvZCBjYWxsLCBidXQgY29udGludWUgcnVubmluZyB0aGUgc3RlcHMgaW4gdGhpcyBhbGdvcml0aG0uXG5cdFx0XHRcdF9kb1hIUi5jYWxsKHRoaXMsIGRhdGEpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRDYW5jZWxzIGFueSBuZXR3b3JrIGFjdGl2aXR5LlxuXG5cdFx0XHRAbWV0aG9kIGFib3J0XG5cdFx0XHQqL1xuXHRcdFx0YWJvcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfZXJyb3JfZmxhZyA9IHRydWU7XG5cdFx0XHRcdF9zeW5jX2ZsYWcgPSBmYWxzZTtcblxuXHRcdFx0XHRpZiAoIX5CYXNpYy5pbkFycmF5KF9wKCdyZWFkeVN0YXRlJyksIFtYTUxIdHRwUmVxdWVzdC5VTlNFTlQsIFhNTEh0dHBSZXF1ZXN0Lk9QRU5FRCwgWE1MSHR0cFJlcXVlc3QuRE9ORV0pKSB7XG5cdFx0XHRcdFx0X3AoJ3JlYWR5U3RhdGUnLCBYTUxIdHRwUmVxdWVzdC5ET05FKTtcblx0XHRcdFx0XHRfc2VuZF9mbGFnID0gZmFsc2U7XG5cblx0XHRcdFx0XHRpZiAoX3hocikge1xuXHRcdFx0XHRcdFx0X3hoci5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdhYm9ydCcsIF91cGxvYWRfY29tcGxldGVfZmxhZyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0X3VwbG9hZF9jb21wbGV0ZV9mbGFnID0gdHJ1ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRfcCgncmVhZHlTdGF0ZScsIFhNTEh0dHBSZXF1ZXN0LlVOU0VOVCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoX3hocikge1xuXHRcdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoX3hoci5kZXN0cm95KSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0X3hoci5kZXN0cm95KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdF94aHIgPSBudWxsO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblxuXHRcdFx0XHRpZiAodGhpcy51cGxvYWQpIHtcblx0XHRcdFx0XHR0aGlzLnVwbG9hZC51bmJpbmRBbGwoKTtcblx0XHRcdFx0XHR0aGlzLnVwbG9hZCA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzLmNvbmNhdChbJ3JlYWR5c3RhdGVjaGFuZ2UnXSkpOyAvLyBmb3IgaGlzdG9yaWNhbCByZWFzb25zXG5cdFx0dGhpcy51cGxvYWQuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzKTtcblxuXHRcdC8qIHRoaXMgaXMgbmljZSwgYnV0IG1heWJlIHRvbyBsZW5ndGh5XG5cblx0XHQvLyBpZiBzdXBwb3J0ZWQgYnkgSlMgdmVyc2lvbiwgc2V0IGdldHRlcnMvc2V0dGVycyBmb3Igc3BlY2lmaWMgcHJvcGVydGllc1xuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3JlYWR5U3RhdGUnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gX3AoJ3JlYWR5U3RhdGUnKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3RpbWVvdXQnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gX3AoJ3RpbWVvdXQnKTtcblx0XHRcdH0sXG5cblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblxuXHRcdFx0XHRpZiAoX3N5bmNfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX0FDQ0VTU19FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gdGltZW91dCBzdGlsbCBzaG91bGQgYmUgbWVhc3VyZWQgcmVsYXRpdmUgdG8gdGhlIHN0YXJ0IHRpbWUgb2YgcmVxdWVzdFxuXHRcdFx0XHRfdGltZW91dHNldF90aW1lID0gKG5ldyBEYXRlKS5nZXRUaW1lKCk7XG5cblx0XHRcdFx0X3AoJ3RpbWVvdXQnLCB2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyB0aGUgd2l0aENyZWRlbnRpYWxzIGF0dHJpYnV0ZSBoYXMgbm8gZWZmZWN0IHdoZW4gZmV0Y2hpbmcgc2FtZS1vcmlnaW4gcmVzb3VyY2VzXG5cdFx0by5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnd2l0aENyZWRlbnRpYWxzJywge1xuXHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcblxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9wKCd3aXRoQ3JlZGVudGlhbHMnKTtcblx0XHRcdH0sXG5cblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0Ly8gMS0yXG5cdFx0XHRcdGlmICghfm8uaW5BcnJheShfcCgncmVhZHlTdGF0ZScpLCBbWE1MSHR0cFJlcXVlc3QuVU5TRU5ULCBYTUxIdHRwUmVxdWVzdC5PUEVORURdKSB8fCBfc2VuZF9mbGFnKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDMtNFxuXHRcdFx0XHRpZiAoX2Fub255bW91c19mbGFnIHx8IF9zeW5jX2ZsYWcpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9BQ0NFU1NfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDVcblx0XHRcdFx0X3AoJ3dpdGhDcmVkZW50aWFscycsIHZhbHVlKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3N0YXR1cycsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG5cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBfcCgnc3RhdHVzJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvLmRlZmluZVByb3BlcnR5KHRoaXMsICdzdGF0dXNUZXh0Jywge1xuXHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcblxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9wKCdzdGF0dXNUZXh0Jyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvLmRlZmluZVByb3BlcnR5KHRoaXMsICdyZXNwb25zZVR5cGUnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlVHlwZScpO1xuXHRcdFx0fSxcblxuXHRcdFx0c2V0OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHQvLyAxXG5cdFx0XHRcdGlmICghIX5vLmluQXJyYXkoX3AoJ3JlYWR5U3RhdGUnKSwgW1hNTEh0dHBSZXF1ZXN0LkxPQURJTkcsIFhNTEh0dHBSZXF1ZXN0LkRPTkVdKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAyXG5cdFx0XHRcdGlmIChfc3luY19mbGFnKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfQUNDRVNTX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAzXG5cdFx0XHRcdF9wKCdyZXNwb25zZVR5cGUnLCB2YWx1ZS50b0xvd2VyQ2FzZSgpKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3Jlc3BvbnNlVGV4dCcsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG5cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIDFcblx0XHRcdFx0aWYgKCF+by5pbkFycmF5KF9wKCdyZXNwb25zZVR5cGUnKSwgWycnLCAndGV4dCddKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAyLTNcblx0XHRcdFx0aWYgKF9wKCdyZWFkeVN0YXRlJykgIT09IFhNTEh0dHBSZXF1ZXN0LkRPTkUgJiYgX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuTE9BRElORyB8fCBfZXJyb3JfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlVGV4dCcpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0by5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAncmVzcG9uc2VYTUwnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyAxXG5cdFx0XHRcdGlmICghfm8uaW5BcnJheShfcCgncmVzcG9uc2VUeXBlJyksIFsnJywgJ2RvY3VtZW50J10pKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDItM1xuXHRcdFx0XHRpZiAoX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuRE9ORSB8fCBfZXJyb3JfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlWE1MJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvLmRlZmluZVByb3BlcnR5KHRoaXMsICdyZXNwb25zZScsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG5cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghIX5vLmluQXJyYXkoX3AoJ3Jlc3BvbnNlVHlwZScpLCBbJycsICd0ZXh0J10pKSB7XG5cdFx0XHRcdFx0aWYgKF9wKCdyZWFkeVN0YXRlJykgIT09IFhNTEh0dHBSZXF1ZXN0LkRPTkUgJiYgX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuTE9BRElORyB8fCBfZXJyb3JfZmxhZykge1xuXHRcdFx0XHRcdFx0cmV0dXJuICcnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChfcCgncmVhZHlTdGF0ZScpICE9PSBYTUxIdHRwUmVxdWVzdC5ET05FIHx8IF9lcnJvcl9mbGFnKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQqL1xuXG5cdFx0ZnVuY3Rpb24gX3AocHJvcCwgdmFsdWUpIHtcblx0XHRcdGlmICghcHJvcHMuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHsgLy8gZ2V0XG5cdFx0XHRcdHJldHVybiBFbnYuY2FuKCdkZWZpbmVfcHJvcGVydHknKSA/IHByb3BzW3Byb3BdIDogc2VsZltwcm9wXTtcblx0XHRcdH0gZWxzZSB7IC8vIHNldFxuXHRcdFx0XHRpZiAoRW52LmNhbignZGVmaW5lX3Byb3BlcnR5JykpIHtcblx0XHRcdFx0XHRwcm9wc1twcm9wXSA9IHZhbHVlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlbGZbcHJvcF0gPSB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qXG5cdFx0ZnVuY3Rpb24gX3RvQVNDSUkoc3RyLCBBbGxvd1VuYXNzaWduZWQsIFVzZVNURDNBU0NJSVJ1bGVzKSB7XG5cdFx0XHQvLyBUT0RPOiBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNDkwI3NlY3Rpb24tNC4xXG5cdFx0XHRyZXR1cm4gc3RyLnRvTG93ZXJDYXNlKCk7XG5cdFx0fVxuXHRcdCovXG5cblxuXHRcdGZ1bmN0aW9uIF9kb1hIUihkYXRhKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdF9zdGFydF90aW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cblx0XHRcdF94aHIgPSBuZXcgUnVudGltZVRhcmdldCgpO1xuXG5cdFx0XHRmdW5jdGlvbiBsb2FkRW5kKCkge1xuXHRcdFx0XHRpZiAoX3hocikgeyAvLyBpdCBjb3VsZCBoYXZlIGJlZW4gZGVzdHJveWVkIGJ5IG5vd1xuXHRcdFx0XHRcdF94aHIuZGVzdHJveSgpO1xuXHRcdFx0XHRcdF94aHIgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgnbG9hZGVuZCcpO1xuXHRcdFx0XHRzZWxmID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gZXhlYyhydW50aW1lKSB7XG5cdFx0XHRcdF94aHIuYmluZCgnTG9hZFN0YXJ0JywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuTE9BRElORyk7XG5cdFx0XHRcdFx0c2VsZi5kaXNwYXRjaEV2ZW50KCdyZWFkeXN0YXRlY2hhbmdlJyk7XG5cblx0XHRcdFx0XHRzZWxmLmRpc3BhdGNoRXZlbnQoZSk7XG5cblx0XHRcdFx0XHRpZiAoX3VwbG9hZF9ldmVudHNfZmxhZykge1xuXHRcdFx0XHRcdFx0c2VsZi51cGxvYWQuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF94aHIuYmluZCgnUHJvZ3Jlc3MnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0aWYgKF9wKCdyZWFkeVN0YXRlJykgIT09IFhNTEh0dHBSZXF1ZXN0LkxPQURJTkcpIHtcblx0XHRcdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuTE9BRElORyk7IC8vIExvYWRTdGFydCB1bnJlbGlhYmxlIChpbiBGbGFzaCBmb3IgZXhhbXBsZSlcblx0XHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgncmVhZHlzdGF0ZWNoYW5nZScpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRzZWxmLmRpc3BhdGNoRXZlbnQoZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF94aHIuYmluZCgnVXBsb2FkUHJvZ3Jlc3MnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0aWYgKF91cGxvYWRfZXZlbnRzX2ZsYWcpIHtcblx0XHRcdFx0XHRcdHNlbGYudXBsb2FkLmRpc3BhdGNoRXZlbnQoe1xuXHRcdFx0XHRcdFx0XHR0eXBlOiAncHJvZ3Jlc3MnLFxuXHRcdFx0XHRcdFx0XHRsZW5ndGhDb21wdXRhYmxlOiBmYWxzZSxcblx0XHRcdFx0XHRcdFx0dG90YWw6IGUudG90YWwsXG5cdFx0XHRcdFx0XHRcdGxvYWRlZDogZS5sb2FkZWRcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X3hoci5iaW5kKCdMb2FkJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuRE9ORSk7XG5cdFx0XHRcdFx0X3AoJ3N0YXR1cycsIE51bWJlcihydW50aW1lLmV4ZWMuY2FsbChfeGhyLCAnWE1MSHR0cFJlcXVlc3QnLCAnZ2V0U3RhdHVzJykgfHwgMCkpO1xuXHRcdFx0XHRcdF9wKCdzdGF0dXNUZXh0JywgaHR0cENvZGVbX3AoJ3N0YXR1cycpXSB8fCBcIlwiKTtcblxuXHRcdFx0XHRcdF9wKCdyZXNwb25zZScsIHJ1bnRpbWUuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdnZXRSZXNwb25zZScsIF9wKCdyZXNwb25zZVR5cGUnKSkpO1xuXG5cdFx0XHRcdFx0aWYgKCEhfkJhc2ljLmluQXJyYXkoX3AoJ3Jlc3BvbnNlVHlwZScpLCBbJ3RleHQnLCAnJ10pKSB7XG5cdFx0XHRcdFx0XHRfcCgncmVzcG9uc2VUZXh0JywgX3AoJ3Jlc3BvbnNlJykpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoX3AoJ3Jlc3BvbnNlVHlwZScpID09PSAnZG9jdW1lbnQnKSB7XG5cdFx0XHRcdFx0XHRfcCgncmVzcG9uc2VYTUwnLCBfcCgncmVzcG9uc2UnKSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0X3Jlc3BvbnNlSGVhZGVycyA9IHJ1bnRpbWUuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdnZXRBbGxSZXNwb25zZUhlYWRlcnMnKTtcblxuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgncmVhZHlzdGF0ZWNoYW5nZScpO1xuXG5cdFx0XHRcdFx0aWYgKF9wKCdzdGF0dXMnKSA+IDApIHsgLy8gc3RhdHVzIDAgdXN1YWxseSBtZWFucyB0aGF0IHNlcnZlciBpcyB1bnJlYWNoYWJsZVxuXHRcdFx0XHRcdFx0aWYgKF91cGxvYWRfZXZlbnRzX2ZsYWcpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi51cGxvYWQuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X2Vycm9yX2ZsYWcgPSB0cnVlO1xuXHRcdFx0XHRcdFx0c2VsZi5kaXNwYXRjaEV2ZW50KCdlcnJvcicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRsb2FkRW5kKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF94aHIuYmluZCgnQWJvcnQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0c2VsZi5kaXNwYXRjaEV2ZW50KGUpO1xuXHRcdFx0XHRcdGxvYWRFbmQoKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X3hoci5iaW5kKCdFcnJvcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRfZXJyb3JfZmxhZyA9IHRydWU7XG5cdFx0XHRcdFx0X3AoJ3JlYWR5U3RhdGUnLCBYTUxIdHRwUmVxdWVzdC5ET05FKTtcblx0XHRcdFx0XHRzZWxmLmRpc3BhdGNoRXZlbnQoJ3JlYWR5c3RhdGVjaGFuZ2UnKTtcblx0XHRcdFx0XHRfdXBsb2FkX2NvbXBsZXRlX2ZsYWcgPSB0cnVlO1xuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHRsb2FkRW5kKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdzZW5kJywge1xuXHRcdFx0XHRcdHVybDogX3VybCxcblx0XHRcdFx0XHRtZXRob2Q6IF9tZXRob2QsXG5cdFx0XHRcdFx0YXN5bmM6IF9hc3luYyxcblx0XHRcdFx0XHR1c2VyOiBfdXNlcixcblx0XHRcdFx0XHRwYXNzd29yZDogX3Bhc3N3b3JkLFxuXHRcdFx0XHRcdGhlYWRlcnM6IF9oZWFkZXJzLFxuXHRcdFx0XHRcdG1pbWVUeXBlOiBfbWltZVR5cGUsXG5cdFx0XHRcdFx0ZW5jb2Rpbmc6IF9lbmNvZGluZyxcblx0XHRcdFx0XHRyZXNwb25zZVR5cGU6IHNlbGYucmVzcG9uc2VUeXBlLFxuXHRcdFx0XHRcdHdpdGhDcmVkZW50aWFsczogc2VsZi53aXRoQ3JlZGVudGlhbHMsXG5cdFx0XHRcdFx0b3B0aW9uczogX29wdGlvbnNcblx0XHRcdFx0fSwgZGF0YSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNsYXJpZnkgb3VyIHJlcXVpcmVtZW50c1xuXHRcdFx0aWYgKHR5cGVvZihfb3B0aW9ucy5yZXF1aXJlZF9jYXBzKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0X29wdGlvbnMucmVxdWlyZWRfY2FwcyA9IFJ1bnRpbWUucGFyc2VDYXBzKF9vcHRpb25zLnJlcXVpcmVkX2NhcHMpO1xuXHRcdFx0fVxuXG5cdFx0XHRfb3B0aW9ucy5yZXF1aXJlZF9jYXBzID0gQmFzaWMuZXh0ZW5kKHt9LCBfb3B0aW9ucy5yZXF1aXJlZF9jYXBzLCB7XG5cdFx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBzZWxmLnJlc3BvbnNlVHlwZVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEpIHtcblx0XHRcdFx0X29wdGlvbnMucmVxdWlyZWRfY2Fwcy5zZW5kX211bHRpcGFydCA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghQmFzaWMuaXNFbXB0eU9iaihfaGVhZGVycykpIHtcblx0XHRcdFx0X29wdGlvbnMucmVxdWlyZWRfY2Fwcy5zZW5kX2N1c3RvbV9oZWFkZXJzID0gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFfc2FtZV9vcmlnaW5fZmxhZykge1xuXHRcdFx0XHRfb3B0aW9ucy5yZXF1aXJlZF9jYXBzLmRvX2NvcnMgPSB0cnVlO1xuXHRcdFx0fVxuXG5cblx0XHRcdGlmIChfb3B0aW9ucy5ydWlkKSB7IC8vIHdlIGRvIG5vdCBuZWVkIHRvIHdhaXQgaWYgd2UgY2FuIGNvbm5lY3QgZGlyZWN0bHlcblx0XHRcdFx0ZXhlYyhfeGhyLmNvbm5lY3RSdW50aW1lKF9vcHRpb25zKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfeGhyLmJpbmQoJ1J1bnRpbWVJbml0JywgZnVuY3Rpb24oZSwgcnVudGltZSkge1xuXHRcdFx0XHRcdGV4ZWMocnVudGltZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRfeGhyLmJpbmQoJ1J1bnRpbWVFcnJvcicsIGZ1bmN0aW9uKGUsIGVycikge1xuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgnUnVudGltZUVycm9yJywgZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdF94aHIuY29ubmVjdFJ1bnRpbWUoX29wdGlvbnMpO1xuXHRcdFx0fVxuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3Jlc2V0KCkge1xuXHRcdFx0X3AoJ3Jlc3BvbnNlVGV4dCcsIFwiXCIpO1xuXHRcdFx0X3AoJ3Jlc3BvbnNlWE1MJywgbnVsbCk7XG5cdFx0XHRfcCgncmVzcG9uc2UnLCBudWxsKTtcblx0XHRcdF9wKCdzdGF0dXMnLCAwKTtcblx0XHRcdF9wKCdzdGF0dXNUZXh0JywgXCJcIik7XG5cdFx0XHRfc3RhcnRfdGltZSA9IF90aW1lb3V0c2V0X3RpbWUgPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdFhNTEh0dHBSZXF1ZXN0LlVOU0VOVCA9IDA7XG5cdFhNTEh0dHBSZXF1ZXN0Lk9QRU5FRCA9IDE7XG5cdFhNTEh0dHBSZXF1ZXN0LkhFQURFUlNfUkVDRUlWRUQgPSAyO1xuXHRYTUxIdHRwUmVxdWVzdC5MT0FESU5HID0gMztcblx0WE1MSHR0cFJlcXVlc3QuRE9ORSA9IDQ7XG5cblx0WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlID0gRXZlbnRUYXJnZXQuaW5zdGFuY2U7XG5cblx0cmV0dXJuIFhNTEh0dHBSZXF1ZXN0O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvVHJhbnNwb3J0ZXIuanNcblxuLyoqXG4gKiBUcmFuc3BvcnRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL1RyYW5zcG9ydGVyXCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnRcIixcblx0XCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCBFbmNvZGUsIFJ1bnRpbWVDbGllbnQsIEV2ZW50VGFyZ2V0KSB7XG5cblx0LyoqXG5cdEBjbGFzcyBtb3hpZS9ydW50aW1lL1RyYW5zcG9ydGVyXG5cdEBwcml2YXRlXG5cdEBjb25zdHJ1Y3RvclxuXHQqL1xuXHRmdW5jdGlvbiBUcmFuc3BvcnRlcigpIHtcblx0XHR2YXIgbW9kLCBfcnVudGltZSwgX2RhdGEsIF9zaXplLCBfcG9zLCBfY2h1bmtfc2l6ZTtcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHR1aWQ6IEJhc2ljLmd1aWQoJ3VpZF8nKSxcblxuXHRcdFx0c3RhdGU6IFRyYW5zcG9ydGVyLklETEUsXG5cblx0XHRcdHJlc3VsdDogbnVsbCxcblxuXHRcdFx0dHJhbnNwb3J0OiBmdW5jdGlvbihkYXRhLCB0eXBlLCBvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRvcHRpb25zID0gQmFzaWMuZXh0ZW5kKHtcblx0XHRcdFx0XHRjaHVua19zaXplOiAyMDQ3OThcblx0XHRcdFx0fSwgb3B0aW9ucyk7XG5cblx0XHRcdFx0Ly8gc2hvdWxkIGRpdmlkZSBieSB0aHJlZSwgYmFzZTY0IHJlcXVpcmVzIHRoaXNcblx0XHRcdFx0aWYgKChtb2QgPSBvcHRpb25zLmNodW5rX3NpemUgJSAzKSkge1xuXHRcdFx0XHRcdG9wdGlvbnMuY2h1bmtfc2l6ZSArPSAzIC0gbW9kO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0X2NodW5rX3NpemUgPSBvcHRpb25zLmNodW5rX3NpemU7XG5cblx0XHRcdFx0X3Jlc2V0LmNhbGwodGhpcyk7XG5cdFx0XHRcdF9kYXRhID0gZGF0YTtcblx0XHRcdFx0X3NpemUgPSBkYXRhLmxlbmd0aDtcblxuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKG9wdGlvbnMpID09PSAnc3RyaW5nJyB8fCBvcHRpb25zLnJ1aWQpIHtcblx0XHRcdFx0XHRfcnVuLmNhbGwoc2VsZiwgdHlwZSwgdGhpcy5jb25uZWN0UnVudGltZShvcHRpb25zKSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gd2UgcmVxdWlyZSB0aGlzIHRvIHJ1biBvbmx5IG9uY2Vcblx0XHRcdFx0XHR2YXIgY2IgPSBmdW5jdGlvbihlLCBydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnVuYmluZChcIlJ1bnRpbWVJbml0XCIsIGNiKTtcblx0XHRcdFx0XHRcdF9ydW4uY2FsbChzZWxmLCB0eXBlLCBydW50aW1lKTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdHRoaXMuYmluZChcIlJ1bnRpbWVJbml0XCIsIGNiKTtcblx0XHRcdFx0XHR0aGlzLmNvbm5lY3RSdW50aW1lKG9wdGlvbnMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRzZWxmLnN0YXRlID0gVHJhbnNwb3J0ZXIuSURMRTtcblx0XHRcdFx0aWYgKF9ydW50aW1lKSB7XG5cdFx0XHRcdFx0X3J1bnRpbWUuZXhlYy5jYWxsKHNlbGYsICdUcmFuc3BvcnRlcicsICdjbGVhcicpO1xuXHRcdFx0XHRcdHNlbGYudHJpZ2dlcihcIlRyYW5zcG9ydGluZ0Fib3J0ZWRcIik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRfcmVzZXQuY2FsbChzZWxmKTtcblx0XHRcdH0sXG5cblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMudW5iaW5kQWxsKCk7XG5cdFx0XHRcdF9ydW50aW1lID0gbnVsbDtcblx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHRfcmVzZXQuY2FsbCh0aGlzKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGZ1bmN0aW9uIF9yZXNldCgpIHtcblx0XHRcdF9zaXplID0gX3BvcyA9IDA7XG5cdFx0XHRfZGF0YSA9IHRoaXMucmVzdWx0ID0gbnVsbDtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBfcnVuKHR5cGUsIHJ1bnRpbWUpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0X3J1bnRpbWUgPSBydW50aW1lO1xuXG5cdFx0XHQvL3NlbGYudW5iaW5kKFwiUnVudGltZUluaXRcIik7XG5cblx0XHRcdHNlbGYuYmluZChcIlRyYW5zcG9ydGluZ1Byb2dyZXNzXCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0X3BvcyA9IGUubG9hZGVkO1xuXG5cdFx0XHRcdGlmIChfcG9zIDwgX3NpemUgJiYgQmFzaWMuaW5BcnJheShzZWxmLnN0YXRlLCBbVHJhbnNwb3J0ZXIuSURMRSwgVHJhbnNwb3J0ZXIuRE9ORV0pID09PSAtMSkge1xuXHRcdFx0XHRcdF90cmFuc3BvcnQuY2FsbChzZWxmKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgOTk5KTtcblxuXHRcdFx0c2VsZi5iaW5kKFwiVHJhbnNwb3J0aW5nQ29tcGxldGVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9wb3MgPSBfc2l6ZTtcblx0XHRcdFx0c2VsZi5zdGF0ZSA9IFRyYW5zcG9ydGVyLkRPTkU7XG5cdFx0XHRcdF9kYXRhID0gbnVsbDsgLy8gY2xlYW4gYSBiaXRcblx0XHRcdFx0c2VsZi5yZXN1bHQgPSBfcnVudGltZS5leGVjLmNhbGwoc2VsZiwgJ1RyYW5zcG9ydGVyJywgJ2dldEFzQmxvYicsIHR5cGUgfHwgJycpO1xuXHRcdFx0fSwgOTk5KTtcblxuXHRcdFx0c2VsZi5zdGF0ZSA9IFRyYW5zcG9ydGVyLkJVU1k7XG5cdFx0XHRzZWxmLnRyaWdnZXIoXCJUcmFuc3BvcnRpbmdTdGFydGVkXCIpO1xuXHRcdFx0X3RyYW5zcG9ydC5jYWxsKHNlbGYpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIF90cmFuc3BvcnQoKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdGNodW5rLFxuXHRcdFx0XHRieXRlc0xlZnQgPSBfc2l6ZSAtIF9wb3M7XG5cblx0XHRcdGlmIChfY2h1bmtfc2l6ZSA+IGJ5dGVzTGVmdCkge1xuXHRcdFx0XHRfY2h1bmtfc2l6ZSA9IGJ5dGVzTGVmdDtcblx0XHRcdH1cblxuXHRcdFx0Y2h1bmsgPSBFbmNvZGUuYnRvYShfZGF0YS5zdWJzdHIoX3BvcywgX2NodW5rX3NpemUpKTtcblx0XHRcdF9ydW50aW1lLmV4ZWMuY2FsbChzZWxmLCAnVHJhbnNwb3J0ZXInLCAncmVjZWl2ZScsIGNodW5rLCBfc2l6ZSk7XG5cdFx0fVxuXHR9XG5cblx0VHJhbnNwb3J0ZXIuSURMRSA9IDA7XG5cdFRyYW5zcG9ydGVyLkJVU1kgPSAxO1xuXHRUcmFuc3BvcnRlci5ET05FID0gMjtcblxuXHRUcmFuc3BvcnRlci5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gVHJhbnNwb3J0ZXI7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvaW1hZ2UvSW1hZ2UuanNcblxuLyoqXG4gKiBJbWFnZS5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoXCJtb3hpZS9pbWFnZS9JbWFnZVwiLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlUmVhZGVyU3luY1wiLFxuXHRcIm1veGllL3hoci9YTUxIdHRwUmVxdWVzdFwiLFxuXHRcIm1veGllL3J1bnRpbWUvUnVudGltZVwiLFxuXHRcIm1veGllL3J1bnRpbWUvUnVudGltZUNsaWVudFwiLFxuXHRcIm1veGllL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFxuXHRcIm1veGllL2NvcmUvRXZlbnRUYXJnZXRcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VuY29kZVwiXG5dLCBmdW5jdGlvbihCYXNpYywgRG9tLCB4LCBGaWxlUmVhZGVyU3luYywgWE1MSHR0cFJlcXVlc3QsIFJ1bnRpbWUsIFJ1bnRpbWVDbGllbnQsIFRyYW5zcG9ydGVyLCBFbnYsIEV2ZW50VGFyZ2V0LCBCbG9iLCBGaWxlLCBFbmNvZGUpIHtcblx0LyoqXG5cdEltYWdlIHByZWxvYWRpbmcgYW5kIG1hbmlwdWxhdGlvbiB1dGlsaXR5LiBBZGRpdGlvbmFsbHkgaXQgcHJvdmlkZXMgYWNjZXNzIHRvIGltYWdlIG1ldGEgaW5mbyAoRXhpZiwgR1BTKSBhbmQgcmF3IGJpbmFyeSBkYXRhLlxuXG5cdEBjbGFzcyBtb3hpZS9pbWFnZS9JbWFnZVxuXHRAY29uc3RydWN0b3Jcblx0QGV4dGVuZHMgRXZlbnRUYXJnZXRcblx0Ki9cblx0dmFyIGRpc3BhdGNoZXMgPSBbXG5cdFx0J3Byb2dyZXNzJyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBsb2FkaW5nIGlzIGNvbXBsZXRlLlxuXG5cdFx0QGV2ZW50IGxvYWRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdsb2FkJyxcblxuXHRcdCdlcnJvcicsXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gcmVzaXplIG9wZXJhdGlvbiBpcyBjb21wbGV0ZS5cblxuXHRcdEBldmVudCByZXNpemVcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdyZXNpemUnLFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHZpc3VhbCByZXByZXNlbnRhdGlvbiBvZiB0aGUgaW1hZ2UgaXMgc3VjY2Vzc2Z1bGx5IGVtYmVkZGVkXG5cdFx0aW50byB0aGUgY29ycmVzcG9uc2luZyBjb250YWluZXIuXG5cblx0XHRAZXZlbnQgZW1iZWRkZWRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdlbWJlZGRlZCdcblx0XTtcblxuXHRmdW5jdGlvbiBJbWFnZSgpIHtcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29tcG9uZW50XG5cblx0XHRcdEBwcm9wZXJ0eSB1aWRcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0dWlkOiBCYXNpYy5ndWlkKCd1aWRfJyksXG5cblx0XHRcdC8qKlxuXHRcdFx0VW5pcXVlIGlkIG9mIHRoZSBjb25uZWN0ZWQgcnVudGltZSwgaWYgYW55LlxuXG5cdFx0XHRAcHJvcGVydHkgcnVpZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRydWlkOiBudWxsLFxuXG5cdFx0XHQvKipcblx0XHRcdE5hbWUgb2YgdGhlIGZpbGUsIHRoYXQgd2FzIHVzZWQgdG8gY3JlYXRlIGFuIGltYWdlLCBpZiBhdmFpbGFibGUuIElmIG5vdCBlcXVhbHMgdG8gZW1wdHkgc3RyaW5nLlxuXG5cdFx0XHRAcHJvcGVydHkgbmFtZVxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0IFwiXCJcblx0XHRcdCovXG5cdFx0XHRuYW1lOiBcIlwiLFxuXG5cdFx0XHQvKipcblx0XHRcdFNpemUgb2YgdGhlIGltYWdlIGluIGJ5dGVzLiBBY3R1YWwgdmFsdWUgaXMgc2V0IG9ubHkgYWZ0ZXIgaW1hZ2UgaXMgcHJlbG9hZGVkLlxuXG5cdFx0XHRAcHJvcGVydHkgc2l6ZVxuXHRcdFx0QHR5cGUge051bWJlcn1cblx0XHRcdEBkZWZhdWx0IDBcblx0XHRcdCovXG5cdFx0XHRzaXplOiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdFdpZHRoIG9mIHRoZSBpbWFnZS4gQWN0dWFsIHZhbHVlIGlzIHNldCBvbmx5IGFmdGVyIGltYWdlIGlzIHByZWxvYWRlZC5cblxuXHRcdFx0QHByb3BlcnR5IHdpZHRoXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgMFxuXHRcdFx0Ki9cblx0XHRcdHdpZHRoOiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdEhlaWdodCBvZiB0aGUgaW1hZ2UuIEFjdHVhbCB2YWx1ZSBpcyBzZXQgb25seSBhZnRlciBpbWFnZSBpcyBwcmVsb2FkZWQuXG5cblx0XHRcdEBwcm9wZXJ0eSBoZWlnaHRcblx0XHRcdEB0eXBlIHtOdW1iZXJ9XG5cdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHQqL1xuXHRcdFx0aGVpZ2h0OiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdE1pbWUgdHlwZSBvZiB0aGUgaW1hZ2UuIEN1cnJlbnRseSBvbmx5IGltYWdlL2pwZWcgYW5kIGltYWdlL3BuZyBhcmUgc3VwcG9ydGVkLiBBY3R1YWwgdmFsdWUgaXMgc2V0IG9ubHkgYWZ0ZXIgaW1hZ2UgaXMgcHJlbG9hZGVkLlxuXG5cdFx0XHRAcHJvcGVydHkgdHlwZVxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0IFwiXCJcblx0XHRcdCovXG5cdFx0XHR0eXBlOiBcIlwiLFxuXG5cdFx0XHQvKipcblx0XHRcdEhvbGRzIG1ldGEgaW5mbyAoRXhpZiwgR1BTKS4gSXMgcG9wdWxhdGVkIG9ubHkgZm9yIGltYWdlL2pwZWcuIEFjdHVhbCB2YWx1ZSBpcyBzZXQgb25seSBhZnRlciBpbWFnZSBpcyBwcmVsb2FkZWQuXG5cblx0XHRcdEBwcm9wZXJ0eSBtZXRhXG5cdFx0XHRAdHlwZSB7T2JqZWN0fVxuXHRcdFx0QGRlZmF1bHQge31cblx0XHRcdCovXG5cdFx0XHRtZXRhOiB7fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRBbGlhcyBmb3IgbG9hZCBtZXRob2QsIHRoYXQgdGFrZXMgYW5vdGhlciBtb3hpZS5pbWFnZS5JbWFnZSBvYmplY3QgYXMgYSBzb3VyY2UgKHNlZSBsb2FkKS5cblxuXHRcdFx0QG1ldGhvZCBjbG9uZVxuXHRcdFx0QHBhcmFtIHtJbWFnZX0gc3JjIFNvdXJjZSBmb3IgdGhlIGltYWdlXG5cdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtleGFjdD1mYWxzZV0gV2hldGhlciB0byBhY3RpdmF0ZSBpbi1kZXB0aCBjbG9uZSBtb2RlXG5cdFx0XHQqL1xuXHRcdFx0Y2xvbmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmxvYWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0TG9hZHMgaW1hZ2UgZnJvbSB2YXJpb3VzIHNvdXJjZXMuIEN1cnJlbnRseSB0aGUgc291cmNlIGZvciBuZXcgaW1hZ2UgY2FuIGJlOiBtb3hpZS5pbWFnZS5JbWFnZSxcblx0XHRcdG1veGllLmZpbGUuQmxvYi9tb3hpZS5maWxlLkZpbGUsIG5hdGl2ZSBCbG9iL0ZpbGUsIGRhdGFVcmwgb3IgVVJMLiBEZXBlbmRpbmcgb24gdGhlIHR5cGUgb2YgdGhlXG5cdFx0XHRzb3VyY2UsIGFyZ3VtZW50cyAtIGRpZmZlci4gV2hlbiBzb3VyY2UgaXMgVVJMLCBJbWFnZSB3aWxsIGJlIGRvd25sb2FkZWQgZnJvbSByZW1vdGUgZGVzdGluYXRpb25cblx0XHRcdGFuZCBsb2FkZWQgaW4gbWVtb3J5LlxuXG5cdFx0XHRAZXhhbXBsZVxuXHRcdFx0XHR2YXIgaW1nID0gbmV3IG1veGllLmltYWdlLkltYWdlKCk7XG5cdFx0XHRcdGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgYmxvYiA9IGltZy5nZXRBc0Jsb2IoKTtcblxuXHRcdFx0XHRcdHZhciBmb3JtRGF0YSA9IG5ldyBtb3hpZS54aHIuRm9ybURhdGEoKTtcblx0XHRcdFx0XHRmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBibG9iKTtcblxuXHRcdFx0XHRcdHZhciB4aHIgPSBuZXcgbW94aWUueGhyLlhNTEh0dHBSZXF1ZXN0KCk7XG5cdFx0XHRcdFx0eGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Ly8gdXBsb2FkIGNvbXBsZXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR4aHIub3BlbigncG9zdCcsICd1cGxvYWQucGhwJyk7XG5cdFx0XHRcdFx0eGhyLnNlbmQoZm9ybURhdGEpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRpbWcubG9hZChcImh0dHA6Ly93d3cubW94aWVjb2RlLmNvbS9pbWFnZXMvbW94LWxvZ28uanBnXCIpOyAvLyBub3RpY2UgZmlsZSBleHRlbnNpb24gKC5qcGcpXG5cblxuXHRcdFx0QG1ldGhvZCBsb2FkXG5cdFx0XHRAcGFyYW0ge0ltYWdlfEJsb2J8RmlsZXxTdHJpbmd9IHNyYyBTb3VyY2UgZm9yIHRoZSBpbWFnZVxuXHRcdFx0QHBhcmFtIHtCb29sZWFufE9iamVjdH0gW21peGVkXVxuXHRcdFx0Ki9cblx0XHRcdGxvYWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfbG9hZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFJlc2l6ZXMgdGhlIGltYWdlIHRvIGZpdCB0aGUgc3BlY2lmaWVkIHdpZHRoL2hlaWdodC4gSWYgY3JvcCBpcyBzcGVjaWZpZWQsIGltYWdlIHdpbGwgYWxzbyBiZVxuXHRcdFx0Y3JvcHBlZCB0byB0aGUgZXhhY3QgZGltZW5zaW9ucy5cblxuXHRcdFx0QG1ldGhvZCByZXNpemVcblx0XHRcdEBzaW5jZSAzLjBcblx0XHRcdEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG5cdFx0XHRcdEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLndpZHRoIFJlc3VsdGluZyB3aWR0aFxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuaGVpZ2h0PXdpZHRoXSBSZXN1bHRpbmcgaGVpZ2h0IChvcHRpb25hbCwgaWYgbm90IHN1cHBsaWVkIHdpbGwgZGVmYXVsdCB0byB3aWR0aClcblx0XHRcdFx0QHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnR5cGU9J2ltYWdlL2pwZWcnXSBNSU1FIHR5cGUgb2YgdGhlIHJlc3VsdGluZyBpbWFnZVxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucXVhbGl0eT05MF0gSW4gdGhlIGNhc2Ugb2YgSlBFRywgY29udHJvbHMgdGhlIHF1YWxpdHkgb2YgcmVzdWx0aW5nIGltYWdlXG5cdFx0XHRcdEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuY3JvcD0nY2MnXSBJZiBub3QgZmFsc3ksIGltYWdlIHdpbGwgYmUgY3JvcHBlZCwgYnkgZGVmYXVsdCBmcm9tIGNlbnRlclxuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmZpdD10cnVlXSBXaGV0aGVyIHRvIHVwc2NhbGUgdGhlIGltYWdlIHRvIGZpdCB0aGUgZXhhY3QgZGltZW5zaW9uc1xuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnByZXNlcnZlSGVhZGVycz10cnVlXSBXaGV0aGVyIHRvIHByZXNlcnZlIG1ldGEgaGVhZGVycyAob24gSlBFR3MgYWZ0ZXIgcmVzaXplKVxuXHRcdFx0XHRAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMucmVzYW1wbGU9J2RlZmF1bHQnXSBSZXNhbXBsaW5nIGFsZ29yaXRobSB0byB1c2UgZHVyaW5nIHJlc2l6ZVxuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLm11bHRpcGFzcz10cnVlXSBXaGV0aGVyIHRvIHNjYWxlIHRoZSBpbWFnZSBpbiBzdGVwcyAocmVzdWx0cyBpbiBiZXR0ZXIgcXVhbGl0eSlcblx0XHRcdCovXG5cdFx0XHRyZXNpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHR2YXIgb3JpZW50YXRpb247XG5cdFx0XHRcdHZhciBzY2FsZTtcblxuXHRcdFx0XHR2YXIgc3JjUmVjdCA9IHtcblx0XHRcdFx0XHR4OiAwLFxuXHRcdFx0XHRcdHk6IDAsXG5cdFx0XHRcdFx0d2lkdGg6IHNlbGYud2lkdGgsXG5cdFx0XHRcdFx0aGVpZ2h0OiBzZWxmLmhlaWdodFxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHZhciBvcHRzID0gQmFzaWMuZXh0ZW5kSWYoe1xuXHRcdFx0XHRcdHdpZHRoOiBzZWxmLndpZHRoLFxuXHRcdFx0XHRcdGhlaWdodDogc2VsZi5oZWlnaHQsXG5cdFx0XHRcdFx0dHlwZTogc2VsZi50eXBlIHx8ICdpbWFnZS9qcGVnJyxcblx0XHRcdFx0XHRxdWFsaXR5OiA5MCxcblx0XHRcdFx0XHRjcm9wOiBmYWxzZSxcblx0XHRcdFx0XHRmaXQ6IHRydWUsXG5cdFx0XHRcdFx0cHJlc2VydmVIZWFkZXJzOiB0cnVlLFxuXHRcdFx0XHRcdHJlc2FtcGxlOiAnZGVmYXVsdCcsXG5cdFx0XHRcdFx0bXVsdGlwYXNzOiB0cnVlXG5cdFx0XHRcdH0sIG9wdGlvbnMpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0aWYgKCFzZWxmLnNpemUpIHsgLy8gb25seSBwcmVsb2FkZWQgaW1hZ2Ugb2JqZWN0cyBjYW4gYmUgdXNlZCBhcyBzb3VyY2Vcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gbm8gd2F5IHRvIHJlbGlhYmx5IGludGVyY2VwdCB0aGUgY3Jhc2ggZHVlIHRvIGhpZ2ggcmVzb2x1dGlvbiwgc28gd2Ugc2ltcGx5IGF2b2lkIGl0XG5cdFx0XHRcdFx0aWYgKHNlbGYud2lkdGggPiBJbWFnZS5NQVhfUkVTSVpFX1dJRFRIIHx8IHNlbGYuaGVpZ2h0ID4gSW1hZ2UuTUFYX1JFU0laRV9IRUlHSFQpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLk1BWF9SRVNPTFVUSU9OX0VSUik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gdGFrZSBpbnRvIGFjY291bnQgb3JpZW50YXRpb24gdGFnXG5cdFx0XHRcdFx0b3JpZW50YXRpb24gPSAoc2VsZi5tZXRhICYmIHNlbGYubWV0YS50aWZmICYmIHNlbGYubWV0YS50aWZmLk9yaWVudGF0aW9uKSB8fCAxO1xuXG5cdFx0XHRcdFx0aWYgKEJhc2ljLmluQXJyYXkob3JpZW50YXRpb24sIFs1LDYsNyw4XSkgIT09IC0xKSB7IC8vIHZhbHVlcyB0aGF0IHJlcXVpcmUgOTAgZGVncmVlIHJvdGF0aW9uXG5cdFx0XHRcdFx0XHR2YXIgdG1wID0gb3B0cy53aWR0aDtcblx0XHRcdFx0XHRcdG9wdHMud2lkdGggPSBvcHRzLmhlaWdodDtcblx0XHRcdFx0XHRcdG9wdHMuaGVpZ2h0ID0gdG1wO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChvcHRzLmNyb3ApIHtcblx0XHRcdFx0XHRcdHNjYWxlID0gTWF0aC5tYXgob3B0cy53aWR0aC9zZWxmLndpZHRoLCBvcHRzLmhlaWdodC9zZWxmLmhlaWdodCk7XG5cblx0XHRcdFx0XHRcdGlmIChvcHRpb25zLmZpdCkge1xuXHRcdFx0XHRcdFx0XHQvLyBmaXJzdCBzY2FsZSBpdCB1cCBvciBkb3duIHRvIGZpdCB0aGUgb3JpZ2luYWwgaW1hZ2Vcblx0XHRcdFx0XHRcdFx0c3JjUmVjdC53aWR0aCA9IE1hdGgubWluKE1hdGguY2VpbChvcHRzLndpZHRoL3NjYWxlKSwgc2VsZi53aWR0aCk7XG5cdFx0XHRcdFx0XHRcdHNyY1JlY3QuaGVpZ2h0ID0gTWF0aC5taW4oTWF0aC5jZWlsKG9wdHMuaGVpZ2h0L3NjYWxlKSwgc2VsZi5oZWlnaHQpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIHJlY2FsY3VsYXRlIHRoZSBzY2FsZSBmb3IgYWRhcHRlZCBkaW1lbnNpb25zXG5cdFx0XHRcdFx0XHRcdHNjYWxlID0gb3B0cy53aWR0aC9zcmNSZWN0LndpZHRoO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0c3JjUmVjdC53aWR0aCA9IE1hdGgubWluKG9wdHMud2lkdGgsIHNlbGYud2lkdGgpO1xuXHRcdFx0XHRcdFx0XHRzcmNSZWN0LmhlaWdodCA9IE1hdGgubWluKG9wdHMuaGVpZ2h0LCBzZWxmLmhlaWdodCk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gbm93IHdlIGRvIG5vdCBuZWVkIHRvIHNjYWxlIGl0IGFueSBmdXJ0aGVyXG5cdFx0XHRcdFx0XHRcdHNjYWxlID0gMTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZihvcHRzLmNyb3ApID09PSAnYm9vbGVhbicpIHtcblx0XHRcdFx0XHRcdFx0b3B0cy5jcm9wID0gJ2NjJztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0c3dpdGNoIChvcHRzLmNyb3AudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fLywgJy0nKSkge1xuXHRcdFx0XHRcdFx0XHRjYXNlICdyYic6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ3JpZ2h0LWJvdHRvbSc6XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC54ID0gc2VsZi53aWR0aCAtIHNyY1JlY3Qud2lkdGg7XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gc2VsZi5oZWlnaHQgLSBzcmNSZWN0LmhlaWdodDtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRjYXNlICdjYic6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2NlbnRlci1ib3R0b20nOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IE1hdGguZmxvb3IoKHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoKSAvIDIpO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IHNlbGYuaGVpZ2h0IC0gc3JjUmVjdC5oZWlnaHQ7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0Y2FzZSAnbGInOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdsZWZ0LWJvdHRvbSc6XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC54ID0gMDtcblx0XHRcdFx0XHRcdFx0XHRzcmNSZWN0LnkgPSBzZWxmLmhlaWdodCAtIHNyY1JlY3QuaGVpZ2h0O1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2x0Jzpcblx0XHRcdFx0XHRcdFx0Y2FzZSAnbGVmdC10b3AnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gMDtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRjYXNlICdjdCc6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2NlbnRlci10b3AnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IE1hdGguZmxvb3IoKHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoKSAvIDIpO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0Y2FzZSAncnQnOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdyaWdodC10b3AnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0Y2FzZSAncmMnOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdyaWdodC1jZW50ZXInOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdyaWdodC1taWRkbGUnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IE1hdGguZmxvb3IoKHNlbGYuaGVpZ2h0IC0gc3JjUmVjdC5oZWlnaHQpIC8gMik7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblxuXHRcdFx0XHRcdFx0XHRjYXNlICdsYyc6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2xlZnQtY2VudGVyJzpcblx0XHRcdFx0XHRcdFx0Y2FzZSAnbGVmdC1taWRkbGUnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gTWF0aC5mbG9vcigoc2VsZi5oZWlnaHQgLSBzcmNSZWN0LmhlaWdodCkgLyAyKTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRjYXNlICdjYyc6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2NlbnRlci1jZW50ZXInOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdjZW50ZXItbWlkZGxlJzpcblx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0XHRzcmNSZWN0LnggPSBNYXRoLmZsb29yKChzZWxmLndpZHRoIC0gc3JjUmVjdC53aWR0aCkgLyAyKTtcblx0XHRcdFx0XHRcdFx0XHRzcmNSZWN0LnkgPSBNYXRoLmZsb29yKChzZWxmLmhlaWdodCAtIHNyY1JlY3QuaGVpZ2h0KSAvIDIpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBvcmlnaW5hbCBpbWFnZSBtaWdodCBiZSBzbWFsbGVyIHRoYW4gcmVxdWVzdGVkIGNyb3AsIHNvIC0gYXZvaWQgbmVnYXRpdmUgdmFsdWVzXG5cdFx0XHRcdFx0XHRzcmNSZWN0LnggPSBNYXRoLm1heChzcmNSZWN0LngsIDApO1xuXHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gTWF0aC5tYXgoc3JjUmVjdC55LCAwKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0c2NhbGUgPSBNYXRoLm1pbihvcHRzLndpZHRoL3NlbGYud2lkdGgsIG9wdHMuaGVpZ2h0L3NlbGYuaGVpZ2h0KTtcblxuXHRcdFx0XHRcdFx0Ly8gZG8gbm90IHVwc2NhbGUgaWYgd2Ugd2VyZSBhc2tlZCB0byBub3QgZml0IGl0XG5cdFx0XHRcdFx0XHRpZiAoc2NhbGUgPiAxICYmICFvcHRzLmZpdCkge1xuXHRcdFx0XHRcdFx0XHRzY2FsZSA9IDE7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dGhpcy5leGVjKCdJbWFnZScsICdyZXNpemUnLCBzcmNSZWN0LCBzY2FsZSwgb3B0cyk7XG5cdFx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0XHQvLyBmb3Igbm93IHNpbXBseSB0cmlnZ2VyIGVycm9yIGV2ZW50XG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyKCdlcnJvcicsIGV4LmNvZGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdERvd25zaXplcyB0aGUgaW1hZ2UgdG8gZml0IHRoZSBzcGVjaWZpZWQgd2lkdGgvaGVpZ2h0LiBJZiBjcm9wIGlzIHN1cHBsaWVkLCBpbWFnZSB3aWxsIGJlIGNyb3BwZWQgdG8gZXhhY3QgZGltZW5zaW9ucy5cblxuXHRcdFx0QG1ldGhvZCBkb3duc2l6ZVxuXHRcdFx0QGRlcHJlY2F0ZWQgdXNlIHJlc2l6ZSgpXG5cdFx0XHQqL1xuXHRcdFx0ZG93bnNpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdFx0dmFyIGRlZmF1bHRzID0ge1xuXHRcdFx0XHRcdHdpZHRoOiB0aGlzLndpZHRoLFxuXHRcdFx0XHRcdGhlaWdodDogdGhpcy5oZWlnaHQsXG5cdFx0XHRcdFx0dHlwZTogdGhpcy50eXBlIHx8ICdpbWFnZS9qcGVnJyxcblx0XHRcdFx0XHRxdWFsaXR5OiA5MCxcblx0XHRcdFx0XHRjcm9wOiBmYWxzZSxcblx0XHRcdFx0XHRmaXQ6IGZhbHNlLFxuXHRcdFx0XHRcdHByZXNlcnZlSGVhZGVyczogdHJ1ZSxcblx0XHRcdFx0XHRyZXNhbXBsZTogJ2RlZmF1bHQnXG5cdFx0XHRcdH0sIG9wdHM7XG5cblx0XHRcdFx0aWYgKHR5cGVvZihvcHRpb25zKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRvcHRzID0gQmFzaWMuZXh0ZW5kKGRlZmF1bHRzLCBvcHRpb25zKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuXHRcdFx0XHRcdG9wdHMgPSBCYXNpYy5leHRlbmQoZGVmYXVsdHMsIHtcblx0XHRcdFx0XHRcdHdpZHRoOiBhcmd1bWVudHNbMF0sXG5cdFx0XHRcdFx0XHRoZWlnaHQ6IGFyZ3VtZW50c1sxXSxcblx0XHRcdFx0XHRcdGNyb3A6IGFyZ3VtZW50c1syXSxcblx0XHRcdFx0XHRcdHByZXNlcnZlSGVhZGVyczogYXJndW1lbnRzWzNdXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLnJlc2l6ZShvcHRzKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0QWxpYXMgZm9yIGRvd25zaXplKHdpZHRoLCBoZWlnaHQsIHRydWUpLiAoc2VlIGRvd25zaXplKVxuXG5cdFx0XHRAbWV0aG9kIGNyb3Bcblx0XHRcdEBwYXJhbSB7TnVtYmVyfSB3aWR0aCBSZXN1bHRpbmcgd2lkdGhcblx0XHRcdEBwYXJhbSB7TnVtYmVyfSBbaGVpZ2h0PXdpZHRoXSBSZXN1bHRpbmcgaGVpZ2h0IChvcHRpb25hbCwgaWYgbm90IHN1cHBsaWVkIHdpbGwgZGVmYXVsdCB0byB3aWR0aClcblx0XHRcdEBwYXJhbSB7Qm9vbGVhbn0gW3ByZXNlcnZlSGVhZGVycz10cnVlXSBXaGV0aGVyIHRvIHByZXNlcnZlIG1ldGEgaGVhZGVycyAob24gSlBFR3MgYWZ0ZXIgcmVzaXplKVxuXHRcdFx0Ki9cblx0XHRcdGNyb3A6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIHByZXNlcnZlSGVhZGVycykge1xuXHRcdFx0XHR0aGlzLmRvd25zaXplKHdpZHRoLCBoZWlnaHQsIHRydWUsIHByZXNlcnZlSGVhZGVycyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRBc0NhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghRW52LmNhbignY3JlYXRlX2NhbnZhcycpKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguUnVudGltZUVycm9yKHguUnVudGltZUVycm9yLk5PVF9TVVBQT1JURURfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5leGVjKCdJbWFnZScsICdnZXRBc0NhbnZhcycpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSZXRyaWV2ZXMgaW1hZ2UgaW4gaXQncyBjdXJyZW50IHN0YXRlIGFzIG1veGllLmZpbGUuQmxvYiBvYmplY3QuIENhbm5vdCBiZSBydW4gb24gZW1wdHkgb3IgaW1hZ2UgaW4gcHJvZ3Jlc3MgKHRocm93c1xuXHRcdFx0RE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKS5cblxuXHRcdFx0QG1ldGhvZCBnZXRBc0Jsb2Jcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBbdHlwZT1cImltYWdlL2pwZWdcIl0gTWltZSB0eXBlIG9mIHJlc3VsdGluZyBibG9iLiBDYW4gZWl0aGVyIGJlIGltYWdlL2pwZWcgb3IgaW1hZ2UvcG5nXG5cdFx0XHRAcGFyYW0ge051bWJlcn0gW3F1YWxpdHk9OTBdIEFwcGxpY2FibGUgb25seSB0b2dldGhlciB3aXRoIG1pbWUgdHlwZSBpbWFnZS9qcGVnXG5cdFx0XHRAcmV0dXJuIHtCbG9ifSBJbWFnZSBhcyBCbG9iXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QXNCbG9iOiBmdW5jdGlvbih0eXBlLCBxdWFsaXR5KSB7XG5cdFx0XHRcdGlmICghdGhpcy5zaXplKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5leGVjKCdJbWFnZScsICdnZXRBc0Jsb2InLCB0eXBlIHx8ICdpbWFnZS9qcGVnJywgcXVhbGl0eSB8fCA5MCk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHJpZXZlcyBpbWFnZSBpbiBpdCdzIGN1cnJlbnQgc3RhdGUgYXMgZGF0YVVSTCBzdHJpbmcuIENhbm5vdCBiZSBydW4gb24gZW1wdHkgb3IgaW1hZ2UgaW4gcHJvZ3Jlc3MgKHRocm93c1xuXHRcdFx0RE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKS5cblxuXHRcdFx0QG1ldGhvZCBnZXRBc0RhdGFVUkxcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBbdHlwZT1cImltYWdlL2pwZWdcIl0gTWltZSB0eXBlIG9mIHJlc3VsdGluZyBibG9iLiBDYW4gZWl0aGVyIGJlIGltYWdlL2pwZWcgb3IgaW1hZ2UvcG5nXG5cdFx0XHRAcGFyYW0ge051bWJlcn0gW3F1YWxpdHk9OTBdIEFwcGxpY2FibGUgb25seSB0b2dldGhlciB3aXRoIG1pbWUgdHlwZSBpbWFnZS9qcGVnXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IEltYWdlIGFzIGRhdGFVUkwgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QXNEYXRhVVJMOiBmdW5jdGlvbih0eXBlLCBxdWFsaXR5KSB7XG5cdFx0XHRcdGlmICghdGhpcy5zaXplKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5leGVjKCdJbWFnZScsICdnZXRBc0RhdGFVUkwnLCB0eXBlIHx8ICdpbWFnZS9qcGVnJywgcXVhbGl0eSB8fCA5MCk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHJpZXZlcyBpbWFnZSBpbiBpdCdzIGN1cnJlbnQgc3RhdGUgYXMgYmluYXJ5IHN0cmluZy4gQ2Fubm90IGJlIHJ1biBvbiBlbXB0eSBvciBpbWFnZSBpbiBwcm9ncmVzcyAodGhyb3dzXG5cdFx0XHRET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpLlxuXG5cdFx0XHRAbWV0aG9kIGdldEFzQmluYXJ5U3RyaW5nXG5cdFx0XHRAcGFyYW0ge1N0cmluZ30gW3R5cGU9XCJpbWFnZS9qcGVnXCJdIE1pbWUgdHlwZSBvZiByZXN1bHRpbmcgYmxvYi4gQ2FuIGVpdGhlciBiZSBpbWFnZS9qcGVnIG9yIGltYWdlL3BuZ1xuXHRcdFx0QHBhcmFtIHtOdW1iZXJ9IFtxdWFsaXR5PTkwXSBBcHBsaWNhYmxlIG9ubHkgdG9nZXRoZXIgd2l0aCBtaW1lIHR5cGUgaW1hZ2UvanBlZ1xuXHRcdFx0QHJldHVybiB7U3RyaW5nfSBJbWFnZSBhcyBiaW5hcnkgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QXNCaW5hcnlTdHJpbmc6IGZ1bmN0aW9uKHR5cGUsIHF1YWxpdHkpIHtcblx0XHRcdFx0dmFyIGRhdGFVcmwgPSB0aGlzLmdldEFzRGF0YVVSTCh0eXBlLCBxdWFsaXR5KTtcblx0XHRcdFx0cmV0dXJuIEVuY29kZS5hdG9iKGRhdGFVcmwuc3Vic3RyaW5nKGRhdGFVcmwuaW5kZXhPZignYmFzZTY0LCcpICsgNykpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRFbWJlZHMgYSB2aXN1YWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIGltYWdlIGludG8gdGhlIHNwZWNpZmllZCBub2RlLiBEZXBlbmRpbmcgb24gdGhlIHJ1bnRpbWUsXG5cdFx0XHRpdCBtaWdodCBiZSBhIGNhbnZhcywgYW4gaW1nIG5vZGUgb3IgYSB0aHJpZCBwYXJ0eSBzaGltIG9iamVjdCAoRmxhc2ggb3IgU2lsdmVyTGlnaHQgLSB2ZXJ5IHJhcmUsXG5cdFx0XHRjYW4gYmUgdXNlZCBpbiBsZWdhY3kgYnJvd3NlcnMgdGhhdCBkbyBub3QgaGF2ZSBjYW52YXMgb3IgcHJvcGVyIGRhdGFVUkkgc3VwcG9ydCkuXG5cblx0XHRcdEBtZXRob2QgZW1iZWRcblx0XHRcdEBwYXJhbSB7RE9NRWxlbWVudH0gZWwgRE9NIGVsZW1lbnQgdG8gaW5zZXJ0IHRoZSBpbWFnZSBvYmplY3QgaW50b1xuXHRcdFx0QHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMud2lkdGhdIFRoZSB3aWR0aCBvZiBhbiBlbWJlZCAoZGVmYXVsdHMgdG8gdGhlIGltYWdlIHdpZHRoKVxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuaGVpZ2h0XSBUaGUgaGVpZ2h0IG9mIGFuIGVtYmVkIChkZWZhdWx0cyB0byB0aGUgaW1hZ2UgaGVpZ2h0KVxuXHRcdFx0XHRAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMudHlwZT1cImltYWdlL2pwZWdcIl0gTWltZSB0eXBlXG5cdFx0XHRcdEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5xdWFsaXR5PTkwXSBRdWFsaXR5IG9mIGFuIGVtYmVkLCBpZiBtaW1lIHR5cGUgaXMgaW1hZ2UvanBlZ1xuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmNyb3A9ZmFsc2VdIFdoZXRoZXIgdG8gY3JvcCBhbiBlbWJlZCB0byB0aGUgc3BlY2lmaWVkIGRpbWVuc2lvbnNcblx0XHRcdFx0QHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5maXQ9dHJ1ZV0gQnkgZGVmYXVsdCB0aHVtYnMgd2lsbCBiZSB1cC0gb3IgZG93bnNjYWxlZCBhcyBuZWNlc3NhcnkgdG8gZml0IHRoZSBkaW1lbnNpb25zXG5cdFx0XHQqL1xuXHRcdFx0ZW1iZWQ6IGZ1bmN0aW9uKGVsLCBvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpc1xuXHRcdFx0XHQsIHJ1bnRpbWUgLy8gdGhpcyBoYXMgdG8gYmUgb3V0c2lkZSBvZiBhbGwgdGhlIGNsb3N1cmVzIHRvIGNvbnRhaW4gcHJvcGVyIHJ1bnRpbWVcblx0XHRcdFx0O1xuXG5cdFx0XHRcdHZhciBvcHRzID0gQmFzaWMuZXh0ZW5kKHtcblx0XHRcdFx0XHR3aWR0aDogdGhpcy53aWR0aCxcblx0XHRcdFx0XHRoZWlnaHQ6IHRoaXMuaGVpZ2h0LFxuXHRcdFx0XHRcdHR5cGU6IHRoaXMudHlwZSB8fCAnaW1hZ2UvanBlZycsXG5cdFx0XHRcdFx0cXVhbGl0eTogOTAsXG5cdFx0XHRcdFx0Zml0OiB0cnVlLFxuXHRcdFx0XHRcdHJlc2FtcGxlOiAnbmVhcmVzdCdcblx0XHRcdFx0fSwgb3B0aW9ucyk7XG5cblxuXHRcdFx0XHRmdW5jdGlvbiByZW5kZXIodHlwZSwgcXVhbGl0eSkge1xuXHRcdFx0XHRcdHZhciBpbWcgPSB0aGlzO1xuXG5cdFx0XHRcdFx0Ly8gaWYgcG9zc2libGUsIGVtYmVkIGEgY2FudmFzIGVsZW1lbnQgZGlyZWN0bHlcblx0XHRcdFx0XHRpZiAoRW52LmNhbignY3JlYXRlX2NhbnZhcycpKSB7XG5cdFx0XHRcdFx0XHR2YXIgY2FudmFzID0gaW1nLmdldEFzQ2FudmFzKCk7XG5cdFx0XHRcdFx0XHRpZiAoY2FudmFzKSB7XG5cdFx0XHRcdFx0XHRcdGVsLmFwcGVuZENoaWxkKGNhbnZhcyk7XG5cdFx0XHRcdFx0XHRcdGNhbnZhcyA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdGltZy5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdHNlbGYudHJpZ2dlcignZW1iZWRkZWQnKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHZhciBkYXRhVXJsID0gaW1nLmdldEFzRGF0YVVSTCh0eXBlLCBxdWFsaXR5KTtcblx0XHRcdFx0XHRpZiAoIWRhdGFVcmwpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLldST05HX0ZPUk1BVCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKEVudi5jYW4oJ3VzZV9kYXRhX3VyaV9vZicsIGRhdGFVcmwubGVuZ3RoKSkge1xuXHRcdFx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gJzxpbWcgc3JjPVwiJyArIGRhdGFVcmwgKyAnXCIgd2lkdGg9XCInICsgaW1nLndpZHRoICsgJ1wiIGhlaWdodD1cIicgKyBpbWcuaGVpZ2h0ICsgJ1wiIGFsdD1cIlwiIC8+Jztcblx0XHRcdFx0XHRcdGltZy5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXIoJ2VtYmVkZGVkJyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHZhciB0ciA9IG5ldyBUcmFuc3BvcnRlcigpO1xuXG5cdFx0XHRcdFx0XHR0ci5iaW5kKFwiVHJhbnNwb3J0aW5nQ29tcGxldGVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdHJ1bnRpbWUgPSBzZWxmLmNvbm5lY3RSdW50aW1lKHRoaXMucmVzdWx0LnJ1aWQpO1xuXG5cdFx0XHRcdFx0XHRcdHNlbGYuYmluZChcIkVtYmVkZGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIHBvc2l0aW9uIGFuZCBzaXplIHByb3Blcmx5XG5cdFx0XHRcdFx0XHRcdFx0QmFzaWMuZXh0ZW5kKHJ1bnRpbWUuZ2V0U2hpbUNvbnRhaW5lcigpLnN0eWxlLCB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvL3Bvc2l0aW9uOiAncmVsYXRpdmUnLFxuXHRcdFx0XHRcdFx0XHRcdFx0dG9wOiAnMHB4Jyxcblx0XHRcdFx0XHRcdFx0XHRcdGxlZnQ6ICcwcHgnLFxuXHRcdFx0XHRcdFx0XHRcdFx0d2lkdGg6IGltZy53aWR0aCArICdweCcsXG5cdFx0XHRcdFx0XHRcdFx0XHRoZWlnaHQ6IGltZy5oZWlnaHQgKyAncHgnXG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBzb21lIHNoaW1zIChGbGFzaC9TaWx2ZXJMaWdodCkgcmVpbml0aWFsaXplLCBpZiBwYXJlbnQgZWxlbWVudCBpcyBoaWRkZW4sIHJlb3JkZXJlZCBvciBpdCdzXG5cdFx0XHRcdFx0XHRcdFx0Ly8gcG9zaXRpb24gdHlwZSBjaGFuZ2VzIChpbiBHZWNrbyksIGJ1dCBzaW5jZSB3ZSBiYXNpY2FsbHkgbmVlZCB0aGlzIG9ubHkgaW4gSUVzIDYvNyBhbmRcblx0XHRcdFx0XHRcdFx0XHQvLyBzb21ldGltZXMgOCBhbmQgdGhleSBkbyBub3QgaGF2ZSB0aGlzIHByb2JsZW0sIHdlIGNhbiBjb21tZW50IHRoaXMgZm9yIG5vd1xuXHRcdFx0XHRcdFx0XHRcdC8qdHIuYmluZChcIlJ1bnRpbWVJbml0XCIsIGZ1bmN0aW9uKGUsIHJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRyLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHRcdHJ1bnRpbWUuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0b25SZXNpemUuY2FsbChzZWxmKTsgLy8gcmUtZmVlZCBvdXIgaW1hZ2UgZGF0YVxuXHRcdFx0XHRcdFx0XHRcdH0pOyovXG5cblx0XHRcdFx0XHRcdFx0XHRydW50aW1lID0gbnVsbDsgLy8gcmVsZWFzZVxuXHRcdFx0XHRcdFx0XHR9LCA5OTkpO1xuXG5cdFx0XHRcdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKHNlbGYsIFwiSW1hZ2VWaWV3XCIsIFwiZGlzcGxheVwiLCB0aGlzLnJlc3VsdC51aWQsIHdpZHRoLCBoZWlnaHQpO1xuXHRcdFx0XHRcdFx0XHRpbWcuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdHRyLnRyYW5zcG9ydChFbmNvZGUuYXRvYihkYXRhVXJsLnN1YnN0cmluZyhkYXRhVXJsLmluZGV4T2YoJ2Jhc2U2NCwnKSArIDcpKSwgdHlwZSwge1xuXHRcdFx0XHRcdFx0XHRyZXF1aXJlZF9jYXBzOiB7XG5cdFx0XHRcdFx0XHRcdFx0ZGlzcGxheV9tZWRpYTogdHJ1ZVxuXHRcdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0XHRydW50aW1lX29yZGVyOiAnZmxhc2gsc2lsdmVybGlnaHQnLFxuXHRcdFx0XHRcdFx0XHRjb250YWluZXI6IGVsXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGlmICghKGVsID0gRG9tLmdldChlbCkpKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9OT0RFX1RZUEVfRVJSKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoIXRoaXMuc2l6ZSkgeyAvLyBvbmx5IHByZWxvYWRlZCBpbWFnZSBvYmplY3RzIGNhbiBiZSB1c2VkIGFzIHNvdXJjZVxuXHRcdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBoaWdoLXJlc29sdXRpb24gaW1hZ2VzIGNhbm5vdCBiZSBjb25zaXN0ZW50bHkgaGFuZGxlZCBhY3Jvc3MgdGhlIHJ1bnRpbWVzXG5cdFx0XHRcdFx0aWYgKHRoaXMud2lkdGggPiBJbWFnZS5NQVhfUkVTSVpFX1dJRFRIIHx8IHRoaXMuaGVpZ2h0ID4gSW1hZ2UuTUFYX1JFU0laRV9IRUlHSFQpIHtcblx0XHRcdFx0XHRcdC8vdGhyb3cgbmV3IHguSW1hZ2VFcnJvcih4LkltYWdlRXJyb3IuTUFYX1JFU09MVVRJT05fRVJSKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR2YXIgaW1nQ29weSA9IG5ldyBJbWFnZSgpO1xuXG5cdFx0XHRcdFx0aW1nQ29weS5iaW5kKFwiUmVzaXplXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmVuZGVyLmNhbGwodGhpcywgb3B0cy50eXBlLCBvcHRzLnF1YWxpdHkpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0aW1nQ29weS5iaW5kKFwiTG9hZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHRoaXMuZG93bnNpemUob3B0cyk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBpZiBlbWJlZGRlZCB0aHVtYiBkYXRhIGlzIGF2YWlsYWJsZSBhbmQgZGltZW5zaW9ucyBhcmUgYmlnIGVub3VnaCwgdXNlIGl0XG5cdFx0XHRcdFx0aWYgKHRoaXMubWV0YS50aHVtYiAmJiB0aGlzLm1ldGEudGh1bWIud2lkdGggPj0gb3B0cy53aWR0aCAmJiB0aGlzLm1ldGEudGh1bWIuaGVpZ2h0ID49IG9wdHMuaGVpZ2h0KSB7XG5cdFx0XHRcdFx0XHRpbWdDb3B5LmxvYWQodGhpcy5tZXRhLnRodW1iLmRhdGEpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpbWdDb3B5LmNsb25lKHRoaXMsIGZhbHNlKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gaW1nQ29weTtcblx0XHRcdFx0fSBjYXRjaChleCkge1xuXHRcdFx0XHRcdC8vIGZvciBub3cgc2ltcGx5IHRyaWdnZXIgZXJyb3IgZXZlbnRcblx0XHRcdFx0XHR0aGlzLnRyaWdnZXIoJ2Vycm9yJywgZXguY29kZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0UHJvcGVybHkgZGVzdHJveXMgdGhlIGltYWdlIGFuZCBmcmVlcyByZXNvdXJjZXMgaW4gdXNlLiBJZiBhbnkuIFJlY29tbWVuZGVkIHdheSB0byBkaXNwb3NlXG5cdFx0XHRtb3hpZS5pbWFnZS5JbWFnZSBvYmplY3QuXG5cblx0XHRcdEBtZXRob2QgZGVzdHJveVxuXHRcdFx0Ki9cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAodGhpcy5ydWlkKSB7XG5cdFx0XHRcdFx0dGhpcy5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdkZXN0cm95Jyk7XG5cdFx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLm1ldGEgJiYgdGhpcy5tZXRhLnRodW1iKSB7XG5cdFx0XHRcdFx0Ly8gdGh1bWIgaXMgYmxvYiwgbWFrZSBzdXJlIHdlIGRlc3Ryb3kgaXQgZmlyc3Rcblx0XHRcdFx0XHR0aGlzLm1ldGEudGh1bWIuZGF0YS5kZXN0cm95KCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0Ly8gdGhpcyBpcyBoZXJlLCBiZWNhdXNlIGluIG9yZGVyIHRvIGJpbmQgcHJvcGVybHksIHdlIG5lZWQgdWlkLCB3aGljaCBpcyBjcmVhdGVkIGFib3ZlXG5cdFx0dGhpcy5oYW5kbGVFdmVudFByb3BzKGRpc3BhdGNoZXMpO1xuXG5cdFx0dGhpcy5iaW5kKCdMb2FkIFJlc2l6ZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIF91cGRhdGVJbmZvLmNhbGwodGhpcyk7IC8vIGlmIG9wZXJhdGlvbiBmYWlscyAoZS5nLiBpbWFnZSBpcyBuZWl0aGVyIFBORyBub3IgSlBFRykgY2FuY2VsIGFsbCBwZW5kaW5nIGV2ZW50c1xuXHRcdH0sIDk5OSk7XG5cblxuXHRcdGZ1bmN0aW9uIF91cGRhdGVJbmZvKGluZm8pIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmICghaW5mbykge1xuXHRcdFx0XHRcdGluZm8gPSB0aGlzLmV4ZWMoJ0ltYWdlJywgJ2dldEluZm8nKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuc2l6ZSA9IGluZm8uc2l6ZTtcblx0XHRcdFx0dGhpcy53aWR0aCA9IGluZm8ud2lkdGg7XG5cdFx0XHRcdHRoaXMuaGVpZ2h0ID0gaW5mby5oZWlnaHQ7XG5cdFx0XHRcdHRoaXMudHlwZSA9IGluZm8udHlwZTtcblx0XHRcdFx0dGhpcy5tZXRhID0gaW5mby5tZXRhO1xuXG5cdFx0XHRcdC8vIHVwZGF0ZSBmaWxlIG5hbWUsIG9ubHkgaWYgZW1wdHlcblx0XHRcdFx0aWYgKHRoaXMubmFtZSA9PT0gJycpIHtcblx0XHRcdFx0XHR0aGlzLm5hbWUgPSBpbmZvLm5hbWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdlcnJvcicsIGV4LmNvZGUpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZChzcmMpIHtcblx0XHRcdHZhciBzcmNUeXBlID0gQmFzaWMudHlwZU9mKHNyYyk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIGlmIHNvdXJjZSBpcyBJbWFnZVxuXHRcdFx0XHRpZiAoc3JjIGluc3RhbmNlb2YgSW1hZ2UpIHtcblx0XHRcdFx0XHRpZiAoIXNyYy5zaXplKSB7IC8vIG9ubHkgcHJlbG9hZGVkIGltYWdlIG9iamVjdHMgY2FuIGJlIHVzZWQgYXMgc291cmNlXG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRfbG9hZEZyb21JbWFnZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGlmIHNvdXJjZSBpcyBvLkJsb2Ivby5GaWxlXG5cdFx0XHRcdGVsc2UgaWYgKHNyYyBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRpZiAoIX5CYXNpYy5pbkFycmF5KHNyYy50eXBlLCBbJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvcG5nJ10pKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRfbG9hZEZyb21CbG9iLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gaWYgbmF0aXZlIGJsb2IvZmlsZVxuXHRcdFx0XHRlbHNlIGlmIChCYXNpYy5pbkFycmF5KHNyY1R5cGUsIFsnYmxvYicsICdmaWxlJ10pICE9PSAtMSkge1xuXHRcdFx0XHRcdF9sb2FkLmNhbGwodGhpcywgbmV3IEZpbGUobnVsbCwgc3JjKSwgYXJndW1lbnRzWzFdKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBpZiBTdHJpbmdcblx0XHRcdFx0ZWxzZSBpZiAoc3JjVHlwZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHQvLyBpZiBkYXRhVXJsIFN0cmluZ1xuXHRcdFx0XHRcdGlmIChzcmMuc3Vic3RyKDAsIDUpID09PSAnZGF0YTonKSB7XG5cdFx0XHRcdFx0XHRfbG9hZC5jYWxsKHRoaXMsIG5ldyBCbG9iKG51bGwsIHsgZGF0YTogc3JjIH0pLCBhcmd1bWVudHNbMV0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvLyBlbHNlIGFzc3VtZSBVcmwsIGVpdGhlciByZWxhdGl2ZSBvciBhYnNvbHV0ZVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0X2xvYWRGcm9tVXJsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGlmIHNvdXJjZSBzZWVtcyB0byBiZSBhbiBpbWcgbm9kZVxuXHRcdFx0XHRlbHNlIGlmIChzcmNUeXBlID09PSAnbm9kZScgJiYgc3JjLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbWcnKSB7XG5cdFx0XHRcdFx0X2xvYWQuY2FsbCh0aGlzLCBzcmMuc3JjLCBhcmd1bWVudHNbMV0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5UWVBFX01JU01BVENIX0VSUik7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0Ly8gZm9yIG5vdyBzaW1wbHkgdHJpZ2dlciBlcnJvciBldmVudFxuXHRcdFx0XHR0aGlzLnRyaWdnZXIoJ2Vycm9yJywgZXguY29kZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZEZyb21JbWFnZShpbWcsIGV4YWN0KSB7XG5cdFx0XHR2YXIgcnVudGltZSA9IHRoaXMuY29ubmVjdFJ1bnRpbWUoaW1nLnJ1aWQpO1xuXHRcdFx0dGhpcy5ydWlkID0gcnVudGltZS51aWQ7XG5cdFx0XHRydW50aW1lLmV4ZWMuY2FsbCh0aGlzLCAnSW1hZ2UnLCAnbG9hZEZyb21JbWFnZScsIGltZywgKEJhc2ljLnR5cGVPZihleGFjdCkgPT09ICd1bmRlZmluZWQnID8gdHJ1ZSA6IGV4YWN0KSk7XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZEZyb21CbG9iKGJsb2IsIG9wdGlvbnMpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0c2VsZi5uYW1lID0gYmxvYi5uYW1lIHx8ICcnO1xuXG5cdFx0XHRmdW5jdGlvbiBleGVjKHJ1bnRpbWUpIHtcblx0XHRcdFx0c2VsZi5ydWlkID0gcnVudGltZS51aWQ7XG5cdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKHNlbGYsICdJbWFnZScsICdsb2FkRnJvbUJsb2InLCBibG9iKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGJsb2IuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdHRoaXMuYmluZCgnUnVudGltZUluaXQnLCBmdW5jdGlvbihlLCBydW50aW1lKSB7XG5cdFx0XHRcdFx0ZXhlYyhydW50aW1lKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gY29udmVydCB0byBvYmplY3QgcmVwcmVzZW50YXRpb25cblx0XHRcdFx0aWYgKG9wdGlvbnMgJiYgdHlwZW9mKG9wdGlvbnMucmVxdWlyZWRfY2FwcykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0b3B0aW9ucy5yZXF1aXJlZF9jYXBzID0gUnVudGltZS5wYXJzZUNhcHMob3B0aW9ucy5yZXF1aXJlZF9jYXBzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuY29ubmVjdFJ1bnRpbWUoQmFzaWMuZXh0ZW5kKHtcblx0XHRcdFx0XHRyZXF1aXJlZF9jYXBzOiB7XG5cdFx0XHRcdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiB0cnVlLFxuXHRcdFx0XHRcdFx0cmVzaXplX2ltYWdlOiB0cnVlXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCBvcHRpb25zKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRleGVjKHRoaXMuY29ubmVjdFJ1bnRpbWUoYmxvYi5ydWlkKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZEZyb21VcmwodXJsLCBvcHRpb25zKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsIHhocjtcblxuXHRcdFx0eGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cblx0XHRcdHhoci5vcGVuKCdnZXQnLCB1cmwpO1xuXHRcdFx0eGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJztcblxuXHRcdFx0eGhyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdHNlbGYudHJpZ2dlcihlKTtcblx0XHRcdH07XG5cblx0XHRcdHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0X2xvYWRGcm9tQmxvYi5jYWxsKHNlbGYsIHhoci5yZXNwb25zZSwgdHJ1ZSk7XG5cdFx0XHR9O1xuXG5cdFx0XHR4aHIub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0c2VsZi50cmlnZ2VyKGUpO1xuXHRcdFx0fTtcblxuXHRcdFx0eGhyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR4aHIuZGVzdHJveSgpO1xuXHRcdFx0fTtcblxuXHRcdFx0eGhyLmJpbmQoJ1J1bnRpbWVFcnJvcicsIGZ1bmN0aW9uKGUsIGVycikge1xuXHRcdFx0XHRzZWxmLnRyaWdnZXIoJ1J1bnRpbWVFcnJvcicsIGVycik7XG5cdFx0XHR9KTtcblxuXHRcdFx0eGhyLnNlbmQobnVsbCwgb3B0aW9ucyk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gdmlydHVhbCB3b3JsZCB3aWxsIGNyYXNoIG9uIHlvdSBpZiBpbWFnZSBoYXMgYSByZXNvbHV0aW9uIGhpZ2hlciB0aGFuIHRoaXM6XG5cdEltYWdlLk1BWF9SRVNJWkVfV0lEVEggPSA4MTkyO1xuXHRJbWFnZS5NQVhfUkVTSVpFX0hFSUdIVCA9IDgxOTI7XG5cblx0SW1hZ2UucHJvdG90eXBlID0gRXZlbnRUYXJnZXQuaW5zdGFuY2U7XG5cblx0cmV0dXJuIEltYWdlO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1bnRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLypnbG9iYWwgRmlsZTp0cnVlICovXG5cbi8qKlxuRGVmaW5lcyBjb25zdHJ1Y3RvciBmb3IgSFRNTDUgcnVudGltZS5cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiXG5dLCBmdW5jdGlvbihCYXNpYywgeCwgUnVudGltZSwgRW52KSB7XG5cdFxuXHR2YXIgdHlwZSA9IFwiaHRtbDVcIiwgZXh0ZW5zaW9ucyA9IHt9O1xuXHRcblx0ZnVuY3Rpb24gSHRtbDVSdW50aW1lKG9wdGlvbnMpIHtcblx0XHR2YXIgSSA9IHRoaXNcblx0XHQsIFRlc3QgPSBSdW50aW1lLmNhcFRlc3Rcblx0XHQsIFRydWUgPSBSdW50aW1lLmNhcFRydWVcblx0XHQ7XG5cblx0XHR2YXIgY2FwcyA9IEJhc2ljLmV4dGVuZCh7XG5cdFx0XHRcdGFjY2Vzc19iaW5hcnk6IFRlc3Qod2luZG93LkZpbGVSZWFkZXIgfHwgd2luZG93LkZpbGUgJiYgd2luZG93LkZpbGUuZ2V0QXNEYXRhVVJMKSxcblx0XHRcdFx0YWNjZXNzX2ltYWdlX2JpbmFyeTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEkuY2FuKCdhY2Nlc3NfYmluYXJ5JykgJiYgISFleHRlbnNpb25zLkltYWdlO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRkaXNwbGF5X21lZGlhOiBUZXN0KFxuXHRcdFx0XHRcdChFbnYuY2FuKCdjcmVhdGVfY2FudmFzJykgfHwgRW52LmNhbigndXNlX2RhdGFfdXJpX292ZXIzMmtiJykpICYmIFxuXHRcdFx0XHRcdGRlZmluZWQoJ21veGllL2ltYWdlL0ltYWdlJylcblx0XHRcdFx0KSxcblx0XHRcdFx0ZG9fY29yczogVGVzdCh3aW5kb3cuWE1MSHR0cFJlcXVlc3QgJiYgJ3dpdGhDcmVkZW50aWFscycgaW4gbmV3IFhNTEh0dHBSZXF1ZXN0KCkpLFxuXHRcdFx0XHRkcmFnX2FuZF9kcm9wOiBUZXN0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIHRoaXMgY29tZXMgZGlyZWN0bHkgZnJvbSBNb2Rlcm5penI6IGh0dHA6Ly93d3cubW9kZXJuaXpyLmNvbS9cblx0XHRcdFx0XHR2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRcdFx0Ly8gSUUgaGFzIHN1cHBvcnQgZm9yIGRyYWcgYW5kIGRyb3Agc2luY2UgdmVyc2lvbiA1LCBidXQgZG9lc24ndCBzdXBwb3J0IGRyb3BwaW5nIGZpbGVzIGZyb20gZGVza3RvcFxuXHRcdFx0XHRcdHJldHVybiAoKCdkcmFnZ2FibGUnIGluIGRpdikgfHwgKCdvbmRyYWdzdGFydCcgaW4gZGl2ICYmICdvbmRyb3AnIGluIGRpdikpICYmIFxuXHRcdFx0XHRcdFx0KEVudi5icm93c2VyICE9PSAnSUUnIHx8IEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA5LCAnPicpKTtcblx0XHRcdFx0fSgpKSxcblx0XHRcdFx0ZmlsdGVyX2J5X2V4dGVuc2lvbjogVGVzdChmdW5jdGlvbigpIHsgLy8gaWYgeW91IGtub3cgaG93IHRvIGZlYXR1cmUtZGV0ZWN0IHRoaXMsIHBsZWFzZSBzdWdnZXN0XG5cdFx0XHRcdFx0cmV0dXJuICEoXG5cdFx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdDaHJvbWUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAyOCwgJzwnKSkgfHwgXG5cdFx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdJRScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDEwLCAnPCcpKSB8fCBcblx0XHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ1NhZmFyaScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDcsICc8JykpIHx8XG5cdFx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdGaXJlZm94JyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMzcsICc8JykpXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSgpKSxcblx0XHRcdFx0cmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6IFRydWUsXG5cdFx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0XHRpZiAocmVzcG9uc2VUeXBlID09PSAnanNvbicgJiYgISF3aW5kb3cuSlNPTikgeyAvLyB3ZSBjYW4gZmFrZSB0aGlzIG9uZSBldmVuIGlmIGl0J3Mgbm90IHN1cHBvcnRlZFxuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBcblx0XHRcdFx0XHRyZXR1cm4gRW52LmNhbigncmV0dXJuX3Jlc3BvbnNlX3R5cGUnLCByZXNwb25zZVR5cGUpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IFRydWUsXG5cdFx0XHRcdHJlcG9ydF91cGxvYWRfcHJvZ3Jlc3M6IFRlc3Qod2luZG93LlhNTEh0dHBSZXF1ZXN0ICYmIG5ldyBYTUxIdHRwUmVxdWVzdCgpLnVwbG9hZCksXG5cdFx0XHRcdHJlc2l6ZV9pbWFnZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEkuY2FuKCdhY2Nlc3NfYmluYXJ5JykgJiYgRW52LmNhbignY3JlYXRlX2NhbnZhcycpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZWxlY3RfZmlsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEVudi5jYW4oJ3VzZV9maWxlaW5wdXQnKSAmJiB3aW5kb3cuRmlsZTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c2VsZWN0X2ZvbGRlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEkuY2FuKCdzZWxlY3RfZmlsZScpICYmIChcblx0XHRcdFx0XHRcdEVudi5icm93c2VyID09PSAnQ2hyb21lJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMjEsICc+PScpIHx8XG5cdFx0XHRcdFx0XHRFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA0MiwgJz49JykgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvRmlyZWZveC9SZWxlYXNlcy80MlxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNlbGVjdF9tdWx0aXBsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly8gaXQgaXMgYnVnZ3kgb24gU2FmYXJpIFdpbmRvd3MgYW5kIGlPU1xuXHRcdFx0XHRcdHJldHVybiBJLmNhbignc2VsZWN0X2ZpbGUnKSAmJlxuXHRcdFx0XHRcdFx0IShFbnYuYnJvd3NlciA9PT0gJ1NhZmFyaScgJiYgRW52Lm9zID09PSAnV2luZG93cycpICYmXG5cdFx0XHRcdFx0XHQhKEVudi5vcyA9PT0gJ2lPUycgJiYgRW52LnZlckNvbXAoRW52Lm9zVmVyc2lvbiwgXCI3LjAuMFwiLCAnPicpICYmIEVudi52ZXJDb21wKEVudi5vc1ZlcnNpb24sIFwiOC4wLjBcIiwgJzwnKSk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNlbmRfYmluYXJ5X3N0cmluZzogVGVzdCh3aW5kb3cuWE1MSHR0cFJlcXVlc3QgJiYgKG5ldyBYTUxIdHRwUmVxdWVzdCgpLnNlbmRBc0JpbmFyeSB8fCAod2luZG93LlVpbnQ4QXJyYXkgJiYgd2luZG93LkFycmF5QnVmZmVyKSkpLFxuXHRcdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBUZXN0KHdpbmRvdy5YTUxIdHRwUmVxdWVzdCksXG5cdFx0XHRcdHNlbmRfbXVsdGlwYXJ0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEod2luZG93LlhNTEh0dHBSZXF1ZXN0ICYmIG5ldyBYTUxIdHRwUmVxdWVzdCgpLnVwbG9hZCAmJiB3aW5kb3cuRm9ybURhdGEpIHx8IEkuY2FuKCdzZW5kX2JpbmFyeV9zdHJpbmcnKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c2xpY2VfYmxvYjogVGVzdCh3aW5kb3cuRmlsZSAmJiAoRmlsZS5wcm90b3R5cGUubW96U2xpY2UgfHwgRmlsZS5wcm90b3R5cGUud2Via2l0U2xpY2UgfHwgRmlsZS5wcm90b3R5cGUuc2xpY2UpKSxcblx0XHRcdFx0c3RyZWFtX3VwbG9hZDogZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRyZXR1cm4gSS5jYW4oJ3NsaWNlX2Jsb2InKSAmJiBJLmNhbignc2VuZF9tdWx0aXBhcnQnKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c3VtbW9uX2ZpbGVfZGlhbG9nOiBmdW5jdGlvbigpIHsgLy8geWVhaC4uLiBzb21lIGRpcnR5IHNuaWZmaW5nIGhlcmUuLi5cblx0XHRcdFx0XHRyZXR1cm4gSS5jYW4oJ3NlbGVjdF9maWxlJykgJiYgIShcblx0XHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA0LCAnPCcpKSB8fFxuXHRcdFx0XHRcdFx0KEVudi5icm93c2VyID09PSAnT3BlcmEnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAxMiwgJzwnKSkgfHxcblx0XHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0lFJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMTAsICc8JykpXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSxcblx0XHRcdFx0dXBsb2FkX2ZpbGVzaXplOiBUcnVlLFxuXHRcdFx0XHR1c2VfaHR0cF9tZXRob2Q6IFRydWVcblx0XHRcdH0sIFxuXHRcdFx0YXJndW1lbnRzWzJdXG5cdFx0KTtcblxuXHRcdFJ1bnRpbWUuY2FsbCh0aGlzLCBvcHRpb25zLCAoYXJndW1lbnRzWzFdIHx8IHR5cGUpLCBjYXBzKTtcblxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblxuXHRcdFx0aW5pdCA6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoXCJJbml0XCIpO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogKGZ1bmN0aW9uKGRlc3Ryb3kpIHsgLy8gZXh0ZW5kIGRlZmF1bHQgZGVzdHJveSBtZXRob2Rcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGRlc3Ryb3kuY2FsbChJKTtcblx0XHRcdFx0XHRkZXN0cm95ID0gSSA9IG51bGw7XG5cdFx0XHRcdH07XG5cdFx0XHR9KHRoaXMuZGVzdHJveSkpXG5cdFx0fSk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcy5nZXRTaGltKCksIGV4dGVuc2lvbnMpO1xuXHR9XG5cblx0UnVudGltZS5hZGRDb25zdHJ1Y3Rvcih0eXBlLCBIdG1sNVJ1bnRpbWUpO1xuXG5cdHJldHVybiBleHRlbnNpb25zO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9CbG9iLmpzXG5cbi8qKlxuICogQmxvYi5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvQmxvYlxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvQmxvYlwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9CbG9iXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJsb2IpIHtcblxuXHRmdW5jdGlvbiBIVE1MNUJsb2IoKSB7XG5cdFx0ZnVuY3Rpb24gdzNjQmxvYlNsaWNlKGJsb2IsIHN0YXJ0LCBlbmQpIHtcblx0XHRcdHZhciBibG9iU2xpY2U7XG5cblx0XHRcdGlmICh3aW5kb3cuRmlsZS5wcm90b3R5cGUuc2xpY2UpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRibG9iLnNsaWNlKCk7XHQvLyBkZXByaWNhdGVkIHZlcnNpb24gd2lsbCB0aHJvdyBXUk9OR19BUkdVTUVOVFNfRVJSIGV4Y2VwdGlvblxuXHRcdFx0XHRcdHJldHVybiBibG9iLnNsaWNlKHN0YXJ0LCBlbmQpO1xuXHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0Ly8gZGVwcmljYXRlZCBzbGljZSBtZXRob2Rcblx0XHRcdFx0XHRyZXR1cm4gYmxvYi5zbGljZShzdGFydCwgZW5kIC0gc3RhcnQpO1xuXHRcdFx0XHR9XG5cdFx0XHQvLyBzbGljZSBtZXRob2QgZ290IHByZWZpeGVkOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02NDk2NzJcblx0XHRcdH0gZWxzZSBpZiAoKGJsb2JTbGljZSA9IHdpbmRvdy5GaWxlLnByb3RvdHlwZS53ZWJraXRTbGljZSB8fCB3aW5kb3cuRmlsZS5wcm90b3R5cGUubW96U2xpY2UpKSB7XG5cdFx0XHRcdHJldHVybiBibG9iU2xpY2UuY2FsbChibG9iLCBzdGFydCwgZW5kKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBudWxsOyAvLyBvciB0aHJvdyBzb21lIGV4Y2VwdGlvblxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuc2xpY2UgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBuZXcgQmxvYih0aGlzLmdldFJ1bnRpbWUoKS51aWQsIHczY0Jsb2JTbGljZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcblx0XHR9O1xuXG5cdFx0dGhpcy5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmdldFJ1bnRpbWUoKS5nZXRTaGltKCkucmVtb3ZlSW5zdGFuY2UodGhpcy51aWQpO1xuXHRcdH07XG5cdH1cblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuQmxvYiA9IEhUTUw1QmxvYik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvY29yZS91dGlscy9FdmVudHMuanNcblxuLyoqXG4gKiBFdmVudHMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvY29yZS91dGlscy9FdmVudHNcbkBwdWJsaWNcbkBzdGF0aWNcbiovXG5cbmRlZmluZSgnbW94aWUvY29yZS91dGlscy9FdmVudHMnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJ1xuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblx0dmFyIGV2ZW50aGFzaCA9IHt9LCB1aWQgPSAnbW94aWVfJyArIEJhc2ljLmd1aWQoKTtcblx0XG5cdC8vIElFIFczQyBsaWtlIGV2ZW50IGZ1bmNzXG5cdGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0KCkge1xuXHRcdHRoaXMucmV0dXJuVmFsdWUgPSBmYWxzZTtcblx0fVxuXG5cdGZ1bmN0aW9uIHN0b3BQcm9wYWdhdGlvbigpIHtcblx0XHR0aGlzLmNhbmNlbEJ1YmJsZSA9IHRydWU7XG5cdH1cblxuXHQvKipcblx0QWRkcyBhbiBldmVudCBoYW5kbGVyIHRvIHRoZSBzcGVjaWZpZWQgb2JqZWN0IGFuZCBzdG9yZSByZWZlcmVuY2UgdG8gdGhlIGhhbmRsZXJcblx0aW4gb2JqZWN0cyBpbnRlcm5hbCBQbHVwbG9hZCByZWdpc3RyeSAoQHNlZSByZW1vdmVFdmVudCkuXG5cdFxuXHRAbWV0aG9kIGFkZEV2ZW50XG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSB0byBhZGQgZXZlbnQgbGlzdGVuZXIgdG8uXG5cdEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBldmVudCBvY2N1cnMuXG5cdEBwYXJhbSB7U3RyaW5nfSBba2V5XSB0aGF0IG1pZ2h0IGJlIHVzZWQgdG8gYWRkIHNwZWNpZml0eSB0byB0aGUgZXZlbnQgcmVjb3JkLlxuXHQqL1xuXHR2YXIgYWRkRXZlbnQgPSBmdW5jdGlvbihvYmosIG5hbWUsIGNhbGxiYWNrLCBrZXkpIHtcblx0XHR2YXIgZnVuYywgZXZlbnRzO1xuXHRcdFx0XHRcdFxuXHRcdG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cblx0XHQvLyBBZGQgZXZlbnQgbGlzdGVuZXJcblx0XHRpZiAob2JqLmFkZEV2ZW50TGlzdGVuZXIpIHtcblx0XHRcdGZ1bmMgPSBjYWxsYmFjaztcblx0XHRcdFxuXHRcdFx0b2JqLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuYywgZmFsc2UpO1xuXHRcdH0gZWxzZSBpZiAob2JqLmF0dGFjaEV2ZW50KSB7XG5cdFx0XHRmdW5jID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBldnQgPSB3aW5kb3cuZXZlbnQ7XG5cblx0XHRcdFx0aWYgKCFldnQudGFyZ2V0KSB7XG5cdFx0XHRcdFx0ZXZ0LnRhcmdldCA9IGV2dC5zcmNFbGVtZW50O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZXZ0LnByZXZlbnREZWZhdWx0ID0gcHJldmVudERlZmF1bHQ7XG5cdFx0XHRcdGV2dC5zdG9wUHJvcGFnYXRpb24gPSBzdG9wUHJvcGFnYXRpb247XG5cblx0XHRcdFx0Y2FsbGJhY2soZXZ0KTtcblx0XHRcdH07XG5cblx0XHRcdG9iai5hdHRhY2hFdmVudCgnb24nICsgbmFtZSwgZnVuYyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIExvZyBldmVudCBoYW5kbGVyIHRvIG9iamVjdHMgaW50ZXJuYWwgbU94aWUgcmVnaXN0cnlcblx0XHRpZiAoIW9ialt1aWRdKSB7XG5cdFx0XHRvYmpbdWlkXSA9IEJhc2ljLmd1aWQoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKCFldmVudGhhc2guaGFzT3duUHJvcGVydHkob2JqW3VpZF0pKSB7XG5cdFx0XHRldmVudGhhc2hbb2JqW3VpZF1dID0ge307XG5cdFx0fVxuXHRcdFxuXHRcdGV2ZW50cyA9IGV2ZW50aGFzaFtvYmpbdWlkXV07XG5cdFx0XG5cdFx0aWYgKCFldmVudHMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcblx0XHRcdGV2ZW50c1tuYW1lXSA9IFtdO1xuXHRcdH1cblx0XHRcdFx0XG5cdFx0ZXZlbnRzW25hbWVdLnB1c2goe1xuXHRcdFx0ZnVuYzogZnVuYyxcblx0XHRcdG9yaWc6IGNhbGxiYWNrLCAvLyBzdG9yZSBvcmlnaW5hbCBjYWxsYmFjayBmb3IgSUVcblx0XHRcdGtleToga2V5XG5cdFx0fSk7XG5cdH07XG5cdFxuXHRcblx0LyoqXG5cdFJlbW92ZSBldmVudCBoYW5kbGVyIGZyb20gdGhlIHNwZWNpZmllZCBvYmplY3QuIElmIHRoaXJkIGFyZ3VtZW50IChjYWxsYmFjaylcblx0aXMgbm90IHNwZWNpZmllZCByZW1vdmUgYWxsIGV2ZW50cyB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZS5cblx0XG5cdEBtZXRob2QgcmVtb3ZlRXZlbnRcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IHRvIHJlbW92ZSBldmVudCBsaXN0ZW5lcihzKSBmcm9tLlxuXHRAcGFyYW0ge1N0cmluZ30gbmFtZSBOYW1lIG9mIGV2ZW50IGxpc3RlbmVyIHRvIHJlbW92ZS5cblx0QHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IFtjYWxsYmFja10gbWlnaHQgYmUgYSBjYWxsYmFjayBvciB1bmlxdWUga2V5IHRvIG1hdGNoLlxuXHQqL1xuXHR2YXIgcmVtb3ZlRXZlbnQgPSBmdW5jdGlvbihvYmosIG5hbWUsIGNhbGxiYWNrKSB7XG5cdFx0dmFyIHR5cGUsIHVuZGVmO1xuXHRcdFxuXHRcdG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0XG5cdFx0aWYgKG9ialt1aWRdICYmIGV2ZW50aGFzaFtvYmpbdWlkXV0gJiYgZXZlbnRoYXNoW29ialt1aWRdXVtuYW1lXSkge1xuXHRcdFx0dHlwZSA9IGV2ZW50aGFzaFtvYmpbdWlkXV1bbmFtZV07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XHRcblx0XHRmb3IgKHZhciBpID0gdHlwZS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0Ly8gdW5kZWZpbmVkIG9yIG5vdCwga2V5IHNob3VsZCBtYXRjaFxuXHRcdFx0aWYgKHR5cGVbaV0ub3JpZyA9PT0gY2FsbGJhY2sgfHwgdHlwZVtpXS5rZXkgPT09IGNhbGxiYWNrKSB7XG5cdFx0XHRcdGlmIChvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuXHRcdFx0XHRcdG9iai5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIHR5cGVbaV0uZnVuYywgZmFsc2UpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKG9iai5kZXRhY2hFdmVudCkge1xuXHRcdFx0XHRcdG9iai5kZXRhY2hFdmVudCgnb24nK25hbWUsIHR5cGVbaV0uZnVuYyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHR5cGVbaV0ub3JpZyA9IG51bGw7XG5cdFx0XHRcdHR5cGVbaV0uZnVuYyA9IG51bGw7XG5cdFx0XHRcdHR5cGUuc3BsaWNlKGksIDEpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gSWYgY2FsbGJhY2sgd2FzIHBhc3NlZCB3ZSBhcmUgZG9uZSBoZXJlLCBvdGhlcndpc2UgcHJvY2VlZFxuXHRcdFx0XHRpZiAoY2FsbGJhY2sgIT09IHVuZGVmKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgZXZlbnQgYXJyYXkgZ290IGVtcHR5LCByZW1vdmUgaXRcblx0XHRpZiAoIXR5cGUubGVuZ3RoKSB7XG5cdFx0XHRkZWxldGUgZXZlbnRoYXNoW29ialt1aWRdXVtuYW1lXTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbU94aWUgcmVnaXN0cnkgaGFzIGJlY29tZSBlbXB0eSwgcmVtb3ZlIGl0XG5cdFx0aWYgKEJhc2ljLmlzRW1wdHlPYmooZXZlbnRoYXNoW29ialt1aWRdXSkpIHtcblx0XHRcdGRlbGV0ZSBldmVudGhhc2hbb2JqW3VpZF1dO1xuXHRcdFx0XG5cdFx0XHQvLyBJRSBkb2Vzbid0IGxldCB5b3UgcmVtb3ZlIERPTSBvYmplY3QgcHJvcGVydHkgd2l0aCAtIGRlbGV0ZVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0ZGVsZXRlIG9ialt1aWRdO1xuXHRcdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRcdG9ialt1aWRdID0gdW5kZWY7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHRcblx0XG5cdC8qKlxuXHRSZW1vdmUgYWxsIGtpbmQgb2YgZXZlbnRzIGZyb20gdGhlIHNwZWNpZmllZCBvYmplY3Rcblx0XG5cdEBtZXRob2QgcmVtb3ZlQWxsRXZlbnRzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCB0byByZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZyb20uXG5cdEBwYXJhbSB7U3RyaW5nfSBba2V5XSB1bmlxdWUga2V5IHRvIG1hdGNoLCB3aGVuIHJlbW92aW5nIGV2ZW50cy5cblx0Ki9cblx0dmFyIHJlbW92ZUFsbEV2ZW50cyA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7XHRcdFxuXHRcdGlmICghb2JqIHx8ICFvYmpbdWlkXSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRCYXNpYy5lYWNoKGV2ZW50aGFzaFtvYmpbdWlkXV0sIGZ1bmN0aW9uKGV2ZW50cywgbmFtZSkge1xuXHRcdFx0cmVtb3ZlRXZlbnQob2JqLCBuYW1lLCBrZXkpO1xuXHRcdH0pO1xuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0YWRkRXZlbnQ6IGFkZEV2ZW50LFxuXHRcdHJlbW92ZUV2ZW50OiByZW1vdmVFdmVudCxcblx0XHRyZW1vdmVBbGxFdmVudHM6IHJlbW92ZUFsbEV2ZW50c1xuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlSW5wdXQuanNcblxuLyoqXG4gKiBGaWxlSW5wdXQuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS9maWxlL0ZpbGVJbnB1dFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZUlucHV0XCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0V2ZW50c1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEZpbGUsIEJhc2ljLCBEb20sIEV2ZW50cywgTWltZSwgRW52KSB7XG5cdFxuXHRmdW5jdGlvbiBGaWxlSW5wdXQoKSB7XG5cdFx0dmFyIF9vcHRpb25zLCBfYnJvd3NlQnRuWkluZGV4OyAvLyBzYXZlIG9yaWdpbmFsIHotaW5kZXhcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRpbml0OiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjb21wID0gdGhpcywgSSA9IGNvbXAuZ2V0UnVudGltZSgpLCBpbnB1dCwgc2hpbUNvbnRhaW5lciwgbWltZXMsIGJyb3dzZUJ1dHRvbiwgekluZGV4LCB0b3A7XG5cblx0XHRcdFx0X29wdGlvbnMgPSBvcHRpb25zO1xuXG5cdFx0XHRcdC8vIGZpZ3VyZSBvdXQgYWNjZXB0IHN0cmluZ1xuXHRcdFx0XHRtaW1lcyA9IE1pbWUuZXh0TGlzdDJtaW1lcyhfb3B0aW9ucy5hY2NlcHQsIEkuY2FuKCdmaWx0ZXJfYnlfZXh0ZW5zaW9uJykpO1xuXG5cdFx0XHRcdHNoaW1Db250YWluZXIgPSBJLmdldFNoaW1Db250YWluZXIoKTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyLmlubmVySFRNTCA9ICc8aW5wdXQgaWQ9XCInICsgSS51aWQgKydcIiB0eXBlPVwiZmlsZVwiIHN0eWxlPVwiZm9udC1zaXplOjk5OXB4O29wYWNpdHk6MDtcIicgK1xuXHRcdFx0XHRcdChfb3B0aW9ucy5tdWx0aXBsZSAmJiBJLmNhbignc2VsZWN0X211bHRpcGxlJykgPyAnbXVsdGlwbGUnIDogJycpICsgXG5cdFx0XHRcdFx0KF9vcHRpb25zLmRpcmVjdG9yeSAmJiBJLmNhbignc2VsZWN0X2ZvbGRlcicpID8gJ3dlYmtpdGRpcmVjdG9yeSBkaXJlY3RvcnknIDogJycpICsgLy8gQ2hyb21lIDExK1xuXHRcdFx0XHRcdChtaW1lcyA/ICcgYWNjZXB0PVwiJyArIG1pbWVzLmpvaW4oJywnKSArICdcIicgOiAnJykgKyAnIC8+JztcblxuXHRcdFx0XHRpbnB1dCA9IERvbS5nZXQoSS51aWQpO1xuXG5cdFx0XHRcdC8vIHByZXBhcmUgZmlsZSBpbnB1dCB0byBiZSBwbGFjZWQgdW5kZXJuZWF0aCB0aGUgYnJvd3NlX2J1dHRvbiBlbGVtZW50XG5cdFx0XHRcdEJhc2ljLmV4dGVuZChpbnB1dC5zdHlsZSwge1xuXHRcdFx0XHRcdHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuXHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHRcdHdpZHRoOiAnMTAwJScsXG5cdFx0XHRcdFx0aGVpZ2h0OiAnMTAwJSdcblx0XHRcdFx0fSk7XG5cblxuXHRcdFx0XHRicm93c2VCdXR0b24gPSBEb20uZ2V0KF9vcHRpb25zLmJyb3dzZV9idXR0b24pO1xuXHRcdFx0XHRfYnJvd3NlQnRuWkluZGV4ID0gRG9tLmdldFN0eWxlKGJyb3dzZUJ1dHRvbiwgJ3otaW5kZXgnKSB8fCAnYXV0byc7XG5cblx0XHRcdFx0Ly8gUm91dGUgY2xpY2sgZXZlbnQgdG8gdGhlIGlucHV0W3R5cGU9ZmlsZV0gZWxlbWVudCBmb3IgYnJvd3NlcnMgdGhhdCBzdXBwb3J0IHN1Y2ggYmVoYXZpb3Jcblx0XHRcdFx0aWYgKEkuY2FuKCdzdW1tb25fZmlsZV9kaWFsb2cnKSkge1xuXHRcdFx0XHRcdGlmIChEb20uZ2V0U3R5bGUoYnJvd3NlQnV0dG9uLCAncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHtcblx0XHRcdFx0XHRcdGJyb3dzZUJ1dHRvbi5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KGJyb3dzZUJ1dHRvbiwgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0dmFyIGlucHV0ID0gRG9tLmdldChJLnVpZCk7XG5cdFx0XHRcdFx0XHRpZiAoaW5wdXQgJiYgIWlucHV0LmRpc2FibGVkKSB7IC8vIGZvciBzb21lIHJlYXNvbiBGRiAodXAgdG8gOC4wLjEgc28gZmFyKSBsZXRzIHRvIGNsaWNrIGRpc2FibGVkIGlucHV0W3R5cGU9ZmlsZV1cblx0XHRcdFx0XHRcdFx0aW5wdXQuY2xpY2soKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0XHRjb21wLmJpbmQoJ1JlZnJlc2gnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHpJbmRleCA9IHBhcnNlSW50KF9icm93c2VCdG5aSW5kZXgsIDEwKSB8fCAxO1xuXG5cdFx0XHRcdFx0XHREb20uZ2V0KF9vcHRpb25zLmJyb3dzZV9idXR0b24pLnN0eWxlLnpJbmRleCA9IHpJbmRleDtcblx0XHRcdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW1Db250YWluZXIoKS5zdHlsZS56SW5kZXggPSB6SW5kZXggLSAxO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyogU2luY2Ugd2UgaGF2ZSB0byBwbGFjZSBpbnB1dFt0eXBlPWZpbGVdIG9uIHRvcCBvZiB0aGUgYnJvd3NlX2J1dHRvbiBmb3Igc29tZSBicm93c2Vycyxcblx0XHRcdFx0YnJvd3NlX2J1dHRvbiBsb3NlcyBpbnRlcmFjdGl2aXR5LCBzbyB3ZSByZXN0b3JlIGl0IGhlcmUgKi9cblx0XHRcdFx0dG9wID0gSS5jYW4oJ3N1bW1vbl9maWxlX2RpYWxvZycpID8gYnJvd3NlQnV0dG9uIDogc2hpbUNvbnRhaW5lcjtcblxuXHRcdFx0XHRFdmVudHMuYWRkRXZlbnQodG9wLCAnbW91c2VvdmVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XG5cdFx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0XHRFdmVudHMuYWRkRXZlbnQodG9wLCAnbW91c2VvdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlbGVhdmUnKTtcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdEV2ZW50cy5hZGRFdmVudCh0b3AsICdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlZG93bicpO1xuXHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KERvbS5nZXQoX29wdGlvbnMuY29udGFpbmVyKSwgJ21vdXNldXAnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNldXAnKTtcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdC8vIGl0IHNob3VsZG4ndCBiZSBwb3NzaWJsZSB0byB0YWIgaW50byB0aGUgaGlkZGVuIGVsZW1lbnRcblx0XHRcdFx0KEkuY2FuKCdzdW1tb25fZmlsZV9kaWFsb2cnKSA/IGlucHV0IDogYnJvd3NlQnV0dG9uKS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuXG5cdFx0XHRcdGlucHV0Lm9uY2hhbmdlID0gZnVuY3Rpb24gb25DaGFuZ2UoKSB7IC8vIHRoZXJlIHNob3VsZCBiZSBvbmx5IG9uZSBoYW5kbGVyIGZvciB0aGlzXG5cdFx0XHRcdFx0Y29tcC5maWxlcyA9IFtdO1xuXG5cdFx0XHRcdFx0QmFzaWMuZWFjaCh0aGlzLmZpbGVzLCBmdW5jdGlvbihmaWxlKSB7XG5cdFx0XHRcdFx0XHR2YXIgcmVsYXRpdmVQYXRoID0gJyc7XG5cblx0XHRcdFx0XHRcdGlmIChfb3B0aW9ucy5kaXJlY3RvcnkpIHtcblx0XHRcdFx0XHRcdFx0Ly8gZm9sZGVycyBhcmUgcmVwcmVzZW50ZWQgYnkgZG90cywgZmlsdGVyIHRoZW0gb3V0IChDaHJvbWUgMTErKVxuXHRcdFx0XHRcdFx0XHRpZiAoZmlsZS5uYW1lID09IFwiLlwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gaWYgaXQgbG9va3MgbGlrZSBhIGZvbGRlci4uLlxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmIChmaWxlLndlYmtpdFJlbGF0aXZlUGF0aCkge1xuXHRcdFx0XHRcdFx0XHRyZWxhdGl2ZVBhdGggPSAnLycgKyBmaWxlLndlYmtpdFJlbGF0aXZlUGF0aC5yZXBsYWNlKC9eXFwvLywgJycpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRmaWxlID0gbmV3IEZpbGUoSS51aWQsIGZpbGUpO1xuXHRcdFx0XHRcdFx0ZmlsZS5yZWxhdGl2ZVBhdGggPSByZWxhdGl2ZVBhdGg7XG5cblx0XHRcdFx0XHRcdGNvbXAuZmlsZXMucHVzaChmaWxlKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdC8vIGNsZWFyaW5nIHRoZSB2YWx1ZSBlbmFibGVzIHRoZSB1c2VyIHRvIHNlbGVjdCB0aGUgc2FtZSBmaWxlIGFnYWluIGlmIHRoZXkgd2FudCB0b1xuXHRcdFx0XHRcdGlmIChFbnYuYnJvd3NlciAhPT0gJ0lFJyAmJiBFbnYuYnJvd3NlciAhPT0gJ0lFTW9iaWxlJykge1xuXHRcdFx0XHRcdFx0dGhpcy52YWx1ZSA9ICcnO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBpbiBJRSBpbnB1dFt0eXBlPVwiZmlsZVwiXSBpcyByZWFkLW9ubHkgc28gdGhlIG9ubHkgd2F5IHRvIHJlc2V0IGl0IGlzIHRvIHJlLWluc2VydCBpdFxuXHRcdFx0XHRcdFx0dmFyIGNsb25lID0gdGhpcy5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0XHRcdFx0XHR0aGlzLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGNsb25lLCB0aGlzKTtcblx0XHRcdFx0XHRcdGNsb25lLm9uY2hhbmdlID0gb25DaGFuZ2U7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGNvbXAuZmlsZXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ2NoYW5nZScpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvLyByZWFkeSBldmVudCBpcyBwZXJmZWN0bHkgYXN5bmNocm9ub3VzXG5cdFx0XHRcdGNvbXAudHJpZ2dlcih7XG5cdFx0XHRcdFx0dHlwZTogJ3JlYWR5Jyxcblx0XHRcdFx0XHRhc3luYzogdHJ1ZVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyID0gbnVsbDtcblx0XHRcdH0sXG5cblxuXHRcdFx0c2V0T3B0aW9uOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0XHR2YXIgaW5wdXQgPSBEb20uZ2V0KEkudWlkKTtcblxuXHRcdFx0XHRzd2l0Y2ggKG5hbWUpIHtcblx0XHRcdFx0XHRjYXNlICdhY2NlcHQnOlxuXHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBtaW1lcyA9IHZhbHVlLm1pbWVzIHx8IE1pbWUuZXh0TGlzdDJtaW1lcyh2YWx1ZSwgSS5jYW4oJ2ZpbHRlcl9ieV9leHRlbnNpb24nKSk7XG5cdFx0XHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnYWNjZXB0JywgbWltZXMuam9pbignLCcpKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0LnJlbW92ZUF0dHJpYnV0ZSgnYWNjZXB0Jyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgJ2RpcmVjdG9yeSc6XG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgJiYgSS5jYW4oJ3NlbGVjdF9mb2xkZXInKSkge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2RpcmVjdG9yeScsICcnKTtcblx0XHRcdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCd3ZWJraXRkaXJlY3RvcnknLCAnJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2RpcmVjdG9yeScpO1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ3dlYmtpdGRpcmVjdG9yeScpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRjYXNlICdtdWx0aXBsZSc6XG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgJiYgSS5jYW4oJ3NlbGVjdF9tdWx0aXBsZScpKSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnbXVsdGlwbGUnLCAnJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ211bHRpcGxlJyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXG5cdFx0XHRkaXNhYmxlOiBmdW5jdGlvbihzdGF0ZSkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpLCBpbnB1dDtcblxuXHRcdFx0XHRpZiAoKGlucHV0ID0gRG9tLmdldChJLnVpZCkpKSB7XG5cdFx0XHRcdFx0aW5wdXQuZGlzYWJsZWQgPSAhIXN0YXRlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0XHQsIHNoaW0gPSBJLmdldFNoaW0oKVxuXHRcdFx0XHQsIHNoaW1Db250YWluZXIgPSBJLmdldFNoaW1Db250YWluZXIoKVxuXHRcdFx0XHQsIGNvbnRhaW5lciA9IF9vcHRpb25zICYmIERvbS5nZXQoX29wdGlvbnMuY29udGFpbmVyKVxuXHRcdFx0XHQsIGJyb3dzZUJ1dHRvbiA9IF9vcHRpb25zICYmIERvbS5nZXQoX29wdGlvbnMuYnJvd3NlX2J1dHRvbilcblx0XHRcdFx0O1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGNvbnRhaW5lcikge1xuXHRcdFx0XHRcdEV2ZW50cy5yZW1vdmVBbGxFdmVudHMoY29udGFpbmVyLCB0aGlzLnVpZCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmIChicm93c2VCdXR0b24pIHtcblx0XHRcdFx0XHRFdmVudHMucmVtb3ZlQWxsRXZlbnRzKGJyb3dzZUJ1dHRvbiwgdGhpcy51aWQpO1xuXHRcdFx0XHRcdGJyb3dzZUJ1dHRvbi5zdHlsZS56SW5kZXggPSBfYnJvd3NlQnRuWkluZGV4OyAvLyByZXNldCB0byBvcmlnaW5hbCB2YWx1ZVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoc2hpbUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdEV2ZW50cy5yZW1vdmVBbGxFdmVudHMoc2hpbUNvbnRhaW5lciwgdGhpcy51aWQpO1xuXHRcdFx0XHRcdHNoaW1Db250YWluZXIuaW5uZXJIVE1MID0gJyc7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzaGltLnJlbW92ZUluc3RhbmNlKHRoaXMudWlkKTtcblxuXHRcdFx0XHRfb3B0aW9ucyA9IHNoaW1Db250YWluZXIgPSBjb250YWluZXIgPSBicm93c2VCdXR0b24gPSBzaGltID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlRHJvcC5qc1xuXG4vKipcbiAqIEZpbGVEcm9wLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlRHJvcFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZURyb3BcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVwiLFxuXHQnbW94aWUvZmlsZS9GaWxlJyxcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0V2ZW50c1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBGaWxlLCBCYXNpYywgRG9tLCBFdmVudHMsIE1pbWUpIHtcblx0XG5cdGZ1bmN0aW9uIEZpbGVEcm9wKCkge1xuXHRcdHZhciBfZmlsZXMgPSBbXSwgX2FsbG93ZWRFeHRzID0gW10sIF9vcHRpb25zLCBfcnVpZDtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRpbml0OiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjb21wID0gdGhpcywgZHJvcFpvbmU7XG5cblx0XHRcdFx0X29wdGlvbnMgPSBvcHRpb25zO1xuXHRcdFx0XHRfcnVpZCA9IGNvbXAucnVpZDsgLy8gZXZlcnkgZHJvcHBlZC1pbiBmaWxlIHNob3VsZCBoYXZlIGEgcmVmZXJlbmNlIHRvIHRoZSBydW50aW1lXG5cdFx0XHRcdF9hbGxvd2VkRXh0cyA9IF9leHRyYWN0RXh0cyhfb3B0aW9ucy5hY2NlcHQpO1xuXHRcdFx0XHRkcm9wWm9uZSA9IF9vcHRpb25zLmNvbnRhaW5lcjtcblxuXHRcdFx0XHRFdmVudHMuYWRkRXZlbnQoZHJvcFpvbmUsICdkcmFnb3ZlcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRpZiAoIV9oYXNGaWxlcyhlKSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0ZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5Jztcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdEV2ZW50cy5hZGRFdmVudChkcm9wWm9uZSwgJ2Ryb3AnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0aWYgKCFfaGFzRmlsZXMoZSkpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdFx0X2ZpbGVzID0gW107XG5cblx0XHRcdFx0XHQvLyBDaHJvbWUgMjErIGFjY2VwdHMgZm9sZGVycyB2aWEgRHJhZyduJ0Ryb3Bcblx0XHRcdFx0XHRpZiAoZS5kYXRhVHJhbnNmZXIuaXRlbXMgJiYgZS5kYXRhVHJhbnNmZXIuaXRlbXNbMF0ud2Via2l0R2V0QXNFbnRyeSkge1xuXHRcdFx0XHRcdFx0X3JlYWRJdGVtcyhlLmRhdGFUcmFuc2Zlci5pdGVtcywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdGNvbXAuZmlsZXMgPSBfZmlsZXM7XG5cdFx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcihcImRyb3BcIik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0QmFzaWMuZWFjaChlLmRhdGFUcmFuc2Zlci5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0XHRcdFx0XHRfYWRkRmlsZShmaWxlKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0Y29tcC5maWxlcyA9IF9maWxlcztcblx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcihcImRyb3BcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KGRyb3Bab25lLCAnZHJhZ2VudGVyJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGNvbXAudHJpZ2dlcihcImRyYWdlbnRlclwiKTtcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdEV2ZW50cy5hZGRFdmVudChkcm9wWm9uZSwgJ2RyYWdsZWF2ZScsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoXCJkcmFnbGVhdmVcIik7XG5cdFx0XHRcdH0sIGNvbXAudWlkKTtcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRFdmVudHMucmVtb3ZlQWxsRXZlbnRzKF9vcHRpb25zICYmIERvbS5nZXQoX29wdGlvbnMuY29udGFpbmVyKSwgdGhpcy51aWQpO1xuXHRcdFx0XHRfcnVpZCA9IF9maWxlcyA9IF9hbGxvd2VkRXh0cyA9IF9vcHRpb25zID0gbnVsbDtcblx0XHRcdFx0dGhpcy5nZXRSdW50aW1lKCkuZ2V0U2hpbSgpLnJlbW92ZUluc3RhbmNlKHRoaXMudWlkKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0ZnVuY3Rpb24gX2hhc0ZpbGVzKGUpIHtcblx0XHRcdGlmICghZS5kYXRhVHJhbnNmZXIgfHwgIWUuZGF0YVRyYW5zZmVyLnR5cGVzKSB7IC8vIGUuZGF0YVRyYW5zZmVyLmZpbGVzIGlzIG5vdCBhdmFpbGFibGUgaW4gR2Vja28gZHVyaW5nIGRyYWdvdmVyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIHR5cGVzID0gQmFzaWMudG9BcnJheShlLmRhdGFUcmFuc2Zlci50eXBlcyB8fCBbXSk7XG5cblx0XHRcdHJldHVybiBCYXNpYy5pbkFycmF5KFwiRmlsZXNcIiwgdHlwZXMpICE9PSAtMSB8fFxuXHRcdFx0XHRCYXNpYy5pbkFycmF5KFwicHVibGljLmZpbGUtdXJsXCIsIHR5cGVzKSAhPT0gLTEgfHwgLy8gU2FmYXJpIDwgNVxuXHRcdFx0XHRCYXNpYy5pbkFycmF5KFwiYXBwbGljYXRpb24veC1tb3otZmlsZVwiLCB0eXBlcykgIT09IC0xIC8vIEdlY2tvIDwgMS45LjIgKDwgRmlyZWZveCAzLjYpXG5cdFx0XHRcdDtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9hZGRGaWxlKGZpbGUsIHJlbGF0aXZlUGF0aCkge1xuXHRcdFx0aWYgKF9pc0FjY2VwdGFibGUoZmlsZSkpIHtcblx0XHRcdFx0dmFyIGZpbGVPYmogPSBuZXcgRmlsZShfcnVpZCwgZmlsZSk7XG5cdFx0XHRcdGZpbGVPYmoucmVsYXRpdmVQYXRoID0gcmVsYXRpdmVQYXRoIHx8ICcnO1xuXHRcdFx0XHRfZmlsZXMucHVzaChmaWxlT2JqKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRcblx0XHRmdW5jdGlvbiBfZXh0cmFjdEV4dHMoYWNjZXB0KSB7XG5cdFx0XHR2YXIgZXh0cyA9IFtdO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhY2NlcHQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0W10ucHVzaC5hcHBseShleHRzLCBhY2NlcHRbaV0uZXh0ZW5zaW9ucy5zcGxpdCgvXFxzKixcXHMqLykpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIEJhc2ljLmluQXJyYXkoJyonLCBleHRzKSA9PT0gLTEgPyBleHRzIDogW107XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfaXNBY2NlcHRhYmxlKGZpbGUpIHtcblx0XHRcdGlmICghX2FsbG93ZWRFeHRzLmxlbmd0aCkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdHZhciBleHQgPSBNaW1lLmdldEZpbGVFeHRlbnNpb24oZmlsZS5uYW1lKTtcblx0XHRcdHJldHVybiAhZXh0IHx8IEJhc2ljLmluQXJyYXkoZXh0LCBfYWxsb3dlZEV4dHMpICE9PSAtMTtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9yZWFkSXRlbXMoaXRlbXMsIGNiKSB7XG5cdFx0XHR2YXIgZW50cmllcyA9IFtdO1xuXHRcdFx0QmFzaWMuZWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0XHR2YXIgZW50cnkgPSBpdGVtLndlYmtpdEdldEFzRW50cnkoKTtcblx0XHRcdFx0Ly8gQWRkcmVzcyAjOTk4IChodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzMyNTc5KVxuXHRcdFx0XHRpZiAoZW50cnkpIHtcblx0XHRcdFx0XHQvLyBmaWxlKCkgZmFpbHMgb24gT1NYIHdoZW4gdGhlIGZpbGVuYW1lIGNvbnRhaW5zIGEgc3BlY2lhbCBjaGFyYWN0ZXIgKGUuZy4gdW1sYXV0KTogc2VlICM2MVxuXHRcdFx0XHRcdGlmIChlbnRyeS5pc0ZpbGUpIHtcblx0XHRcdFx0XHRcdF9hZGRGaWxlKGl0ZW0uZ2V0QXNGaWxlKCksIGVudHJ5LmZ1bGxQYXRoKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZW50cmllcy5wdXNoKGVudHJ5KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAoZW50cmllcy5sZW5ndGgpIHtcblx0XHRcdFx0X3JlYWRFbnRyaWVzKGVudHJpZXMsIGNiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNiKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfcmVhZEVudHJpZXMoZW50cmllcywgY2IpIHtcblx0XHRcdHZhciBxdWV1ZSA9IFtdO1xuXHRcdFx0QmFzaWMuZWFjaChlbnRyaWVzLCBmdW5jdGlvbihlbnRyeSkge1xuXHRcdFx0XHRxdWV1ZS5wdXNoKGZ1bmN0aW9uKGNiY2IpIHtcblx0XHRcdFx0XHRfcmVhZEVudHJ5KGVudHJ5LCBjYmNiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHRcdEJhc2ljLmluU2VyaWVzKHF1ZXVlLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0Y2IoKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3JlYWRFbnRyeShlbnRyeSwgY2IpIHtcblx0XHRcdGlmIChlbnRyeS5pc0ZpbGUpIHtcblx0XHRcdFx0ZW50cnkuZmlsZShmdW5jdGlvbihmaWxlKSB7XG5cdFx0XHRcdFx0X2FkZEZpbGUoZmlsZSwgZW50cnkuZnVsbFBhdGgpO1xuXHRcdFx0XHRcdGNiKCk7XG5cdFx0XHRcdH0sIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIGZpcmUgYW4gZXJyb3IgZXZlbnQgbWF5YmVcblx0XHRcdFx0XHRjYigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSBpZiAoZW50cnkuaXNEaXJlY3RvcnkpIHtcblx0XHRcdFx0X3JlYWREaXJFbnRyeShlbnRyeSwgY2IpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2IoKTsgLy8gbm90IGZpbGUsIG5vdCBkaXJlY3Rvcnk/IHdoYXQgdGhlbj8uLlxuXHRcdFx0fVxuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3JlYWREaXJFbnRyeShkaXJFbnRyeSwgY2IpIHtcblx0XHRcdHZhciBlbnRyaWVzID0gW10sIGRpclJlYWRlciA9IGRpckVudHJ5LmNyZWF0ZVJlYWRlcigpO1xuXG5cdFx0XHQvLyBrZWVwIHF1ZXJpbmcgcmVjdXJzaXZlbHkgdGlsbCBubyBtb3JlIGVudHJpZXNcblx0XHRcdGZ1bmN0aW9uIGdldEVudHJpZXMoY2JjYikge1xuXHRcdFx0XHRkaXJSZWFkZXIucmVhZEVudHJpZXMoZnVuY3Rpb24obW9yZUVudHJpZXMpIHtcblx0XHRcdFx0XHRpZiAobW9yZUVudHJpZXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRbXS5wdXNoLmFwcGx5KGVudHJpZXMsIG1vcmVFbnRyaWVzKTtcblx0XHRcdFx0XHRcdGdldEVudHJpZXMoY2JjYik7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNiY2IoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIGNiY2IpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyAuLi5hbmQgeW91IHRob3VnaHQgRmlsZVJlYWRlciB3YXMgY3JhenkuLi5cblx0XHRcdGdldEVudHJpZXMoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9yZWFkRW50cmllcyhlbnRyaWVzLCBjYik7XG5cdFx0XHR9KTsgXG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVEcm9wID0gRmlsZURyb3ApO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEVuY29kZSwgQmFzaWMpIHtcblx0XG5cdGZ1bmN0aW9uIEZpbGVSZWFkZXIoKSB7XG5cdFx0dmFyIF9mciwgX2NvbnZlcnRUb0JpbmFyeSA9IGZhbHNlO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblxuXHRcdFx0cmVhZDogZnVuY3Rpb24ob3AsIGJsb2IpIHtcblx0XHRcdFx0dmFyIGNvbXAgPSB0aGlzO1xuXG5cdFx0XHRcdGNvbXAucmVzdWx0ID0gJyc7XG5cblx0XHRcdFx0X2ZyID0gbmV3IHdpbmRvdy5GaWxlUmVhZGVyKCk7XG5cblx0XHRcdFx0X2ZyLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGNvbXAudHJpZ2dlcihlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X2ZyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0Y29tcC5yZXN1bHQgPSBfY29udmVydFRvQmluYXJ5ID8gX3RvQmluYXJ5KF9mci5yZXN1bHQpIDogX2ZyLnJlc3VsdDtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF9mci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoZSwgX2ZyLmVycm9yKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X2ZyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlbmQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0X2ZyID0gbnVsbDtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoX2ZyW29wXSkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRfY29udmVydFRvQmluYXJ5ID0gZmFsc2U7XG5cdFx0XHRcdFx0X2ZyW29wXShibG9iLmdldFNvdXJjZSgpKTtcblx0XHRcdFx0fSBlbHNlIGlmIChvcCA9PT0gJ3JlYWRBc0JpbmFyeVN0cmluZycpIHsgLy8gcmVhZEFzQmluYXJ5U3RyaW5nIGlzIGRlcHJpY2F0ZWQgaW4gZ2VuZXJhbCBhbmQgbmV2ZXIgZXhpc3RlZCBpbiBJRTEwK1xuXHRcdFx0XHRcdF9jb252ZXJ0VG9CaW5hcnkgPSB0cnVlO1xuXHRcdFx0XHRcdF9mci5yZWFkQXNEYXRhVVJMKGJsb2IuZ2V0U291cmNlKCkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChfZnIpIHtcblx0XHRcdFx0XHRfZnIuYWJvcnQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9mciA9IG51bGw7XG5cdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBfdG9CaW5hcnkoc3RyKSB7XG5cdFx0XHRyZXR1cm4gRW5jb2RlLmF0b2Ioc3RyLnN1YnN0cmluZyhzdHIuaW5kZXhPZignYmFzZTY0LCcpICsgNykpO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlUmVhZGVyID0gRmlsZVJlYWRlcik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNS94aHIvWE1MSHR0cFJlcXVlc3QuanNcblxuLyoqXG4gKiBYTUxIdHRwUmVxdWVzdC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKmdsb2JhbCBBY3RpdmVYT2JqZWN0OnRydWUgKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS94aHIvWE1MSHR0cFJlcXVlc3RcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNS94aHIvWE1MSHR0cFJlcXVlc3RcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL1VybFwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVwiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL3hoci9Gb3JtRGF0YVwiLFxuXHRcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCBNaW1lLCBVcmwsIEZpbGUsIEJsb2IsIEZvcm1EYXRhLCB4LCBFbnYpIHtcblx0XG5cdGZ1bmN0aW9uIFhNTEh0dHBSZXF1ZXN0KCkge1xuXHRcdHZhciBzZWxmID0gdGhpc1xuXHRcdCwgX3hoclxuXHRcdCwgX2ZpbGVuYW1lXG5cdFx0O1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdHNlbmQ6IGZ1bmN0aW9uKG1ldGEsIGRhdGEpIHtcblx0XHRcdFx0dmFyIHRhcmdldCA9IHRoaXNcblx0XHRcdFx0LCBpc0dlY2tvMl81XzYgPSAoRW52LmJyb3dzZXIgPT09ICdNb3ppbGxhJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgNCwgJz49JykgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDcsICc8JykpXG5cdFx0XHRcdCwgaXNBbmRyb2lkQnJvd3NlciA9IEVudi5icm93c2VyID09PSAnQW5kcm9pZCBCcm93c2VyJ1xuXHRcdFx0XHQsIG11c3RTZW5kQXNCaW5hcnkgPSBmYWxzZVxuXHRcdFx0XHQ7XG5cblx0XHRcdFx0Ly8gZXh0cmFjdCBmaWxlIG5hbWVcblx0XHRcdFx0X2ZpbGVuYW1lID0gbWV0YS51cmwucmVwbGFjZSgvXi4rP1xcLyhbXFx3XFwtXFwuXSspJC8sICckMScpLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdFx0X3hociA9IF9nZXROYXRpdmVYSFIoKTtcblx0XHRcdFx0X3hoci5vcGVuKG1ldGEubWV0aG9kLCBtZXRhLnVybCwgbWV0YS5hc3luYywgbWV0YS51c2VyLCBtZXRhLnBhc3N3b3JkKTtcblxuXG5cdFx0XHRcdC8vIHByZXBhcmUgZGF0YSB0byBiZSBzZW50XG5cdFx0XHRcdGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikge1xuXHRcdFx0XHRcdGlmIChkYXRhLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdFx0bXVzdFNlbmRBc0JpbmFyeSA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGRhdGEgPSBkYXRhLmdldFNvdXJjZSgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXG5cdFx0XHRcdFx0aWYgKGRhdGEuaGFzQmxvYigpKSB7XG5cdFx0XHRcdFx0XHRpZiAoZGF0YS5nZXRCbG9iKCkuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdFx0XHRcdGRhdGEgPSBfcHJlcGFyZU11bHRpcGFydC5jYWxsKHRhcmdldCwgZGF0YSk7IC8vIF94aHIgbXVzdCBiZSBpbnN0YW50aWF0ZWQgYW5kIGJlIGluIE9QRU5FRCBzdGF0ZVxuXHRcdFx0XHRcdFx0XHRtdXN0U2VuZEFzQmluYXJ5ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoKGlzR2Vja28yXzVfNiB8fCBpc0FuZHJvaWRCcm93c2VyKSAmJiBCYXNpYy50eXBlT2YoZGF0YS5nZXRCbG9iKCkuZ2V0U291cmNlKCkpID09PSAnYmxvYicgJiYgd2luZG93LkZpbGVSZWFkZXIpIHtcblx0XHRcdFx0XHRcdFx0Ly8gR2Vja28gMi81LzYgY2FuJ3Qgc2VuZCBibG9iIGluIEZvcm1EYXRhOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02NDkxNTBcblx0XHRcdFx0XHRcdFx0Ly8gQW5kcm9pZCBicm93c2VycyAoZGVmYXVsdCBvbmUgYW5kIERvbHBoaW4pIHNlZW0gdG8gaGF2ZSB0aGUgc2FtZSBpc3N1ZSwgc2VlOiAjNjEzXG5cdFx0XHRcdFx0XHRcdF9wcmVsb2FkQW5kU2VuZC5jYWxsKHRhcmdldCwgbWV0YSwgZGF0YSk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjsgLy8gX3ByZWxvYWRBbmRTZW5kIHdpbGwgcmVpbnZva2Ugc2VuZCgpIHdpdGggdHJhbnNtdXRhdGVkIEZvcm1EYXRhID0lRFxuXHRcdFx0XHRcdFx0fVx0XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gdHJhbnNmZXIgZmllbGRzIHRvIHJlYWwgRm9ybURhdGFcblx0XHRcdFx0XHRpZiAoZGF0YSBpbnN0YW5jZW9mIEZvcm1EYXRhKSB7IC8vIGlmIHN0aWxsIGEgRm9ybURhdGEsIGUuZy4gbm90IG1hbmdsZWQgYnkgX3ByZXBhcmVNdWx0aXBhcnQoKVxuXHRcdFx0XHRcdFx0dmFyIGZkID0gbmV3IHdpbmRvdy5Gb3JtRGF0YSgpO1xuXHRcdFx0XHRcdFx0ZGF0YS5lYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG5cdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRcdFx0XHRmZC5hcHBlbmQobmFtZSwgdmFsdWUuZ2V0U291cmNlKCkpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGZkLmFwcGVuZChuYW1lLCB2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0ZGF0YSA9IGZkO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0Ly8gaWYgWEhSIEwyXG5cdFx0XHRcdGlmIChfeGhyLnVwbG9hZCkge1xuXHRcdFx0XHRcdGlmIChtZXRhLndpdGhDcmVkZW50aWFscykge1xuXHRcdFx0XHRcdFx0X3hoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdF94aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKGUpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0X3hoci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKGUpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0Ly8gYWRkaXRpb25hbGx5IGxpc3RlbiB0byBwcm9ncmVzcyBldmVudHNcblx0XHRcdFx0XHRfeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0dGFyZ2V0LnRyaWdnZXIoZSk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRfeGhyLnVwbG9hZC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKHtcblx0XHRcdFx0XHRcdFx0dHlwZTogJ1VwbG9hZFByb2dyZXNzJyxcblx0XHRcdFx0XHRcdFx0bG9hZGVkOiBlLmxvYWRlZCxcblx0XHRcdFx0XHRcdFx0dG90YWw6IGUudG90YWxcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHQvLyAuLi4gb3RoZXJ3aXNlIHNpbXVsYXRlIFhIUiBMMlxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF94aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gb25SZWFkeVN0YXRlQ2hhbmdlKCkge1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBmYWtlIExldmVsIDIgZXZlbnRzXG5cdFx0XHRcdFx0XHRzd2l0Y2ggKF94aHIucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Y2FzZSAxOiAvLyBYTUxIdHRwUmVxdWVzdC5PUEVORURcblx0XHRcdFx0XHRcdFx0XHQvLyByZWFkeXN0YXRlY2hhbmdlZCBpcyBmaXJlZCB0d2ljZSBmb3IgT1BFTkVEIHN0YXRlIChpbiBJRSBhbmQgTW96aWxsYSkgLSBuZXVcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIGxvb2tzIGxpa2UgSEVBREVSU19SRUNFSVZFRCAoc3RhdGUgMikgaXMgbm90IHJlcG9ydGVkIGluIE9wZXJhIChvciBpdCdzIG9sZCB2ZXJzaW9ucykgLSBuZXVcblx0XHRcdFx0XHRcdFx0Y2FzZSAyOiAvLyBYTUxIdHRwUmVxdWVzdC5IRUFERVJTX1JFQ0VJVkVEXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdGNhc2UgMzogLy8gWE1MSHR0cFJlcXVlc3QuTE9BRElORyBcblx0XHRcdFx0XHRcdFx0XHQvLyB0cnkgdG8gZmlyZSBwcm9ncmVzcyBldmVudCBmb3Igbm90IFhIUiBMMlxuXHRcdFx0XHRcdFx0XHRcdHZhciB0b3RhbCwgbG9hZGVkO1xuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoVXJsLmhhc1NhbWVPcmlnaW4obWV0YS51cmwpKSB7IC8vIENvbnRlbnQtTGVuZ3RoIG5vdCBhY2Nlc3NpYmxlIGZvciBjcm9zcy1kb21haW4gb24gc29tZSBicm93c2Vyc1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0b3RhbCA9IF94aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtTGVuZ3RoJykgfHwgMDsgLy8gb2xkIFNhZmFyaSB0aHJvd3MgYW4gZXhjZXB0aW9uIGhlcmVcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKF94aHIucmVzcG9uc2VUZXh0KSB7IC8vIHJlc3BvbnNlVGV4dCB3YXMgaW50cm9kdWNlZCBpbiBJRTdcblx0XHRcdFx0XHRcdFx0XHRcdFx0bG9hZGVkID0gX3hoci5yZXNwb25zZVRleHQubGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRvdGFsID0gbG9hZGVkID0gMDtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHR0YXJnZXQudHJpZ2dlcih7XG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncHJvZ3Jlc3MnLFxuXHRcdFx0XHRcdFx0XHRcdFx0bGVuZ3RoQ29tcHV0YWJsZTogISF0b3RhbCxcblx0XHRcdFx0XHRcdFx0XHRcdHRvdGFsOiBwYXJzZUludCh0b3RhbCwgMTApLFxuXHRcdFx0XHRcdFx0XHRcdFx0bG9hZGVkOiBsb2FkZWRcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Y2FzZSA0OiAvLyBYTUxIdHRwUmVxdWVzdC5ET05FXG5cdFx0XHRcdFx0XHRcdFx0Ly8gcmVsZWFzZSByZWFkeXN0YXRlY2hhbmdlIGhhbmRsZXIgKG1vc3RseSBmb3IgSUUpXG5cdFx0XHRcdFx0XHRcdFx0X3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHt9O1xuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gdXN1YWxseSBzdGF0dXMgMCBpcyByZXR1cm5lZCB3aGVuIHNlcnZlciBpcyB1bnJlYWNoYWJsZSwgYnV0IEZGIGFsc28gZmFpbHMgdG8gc3RhdHVzIDAgZm9yIDQwOCB0aW1lb3V0XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChfeGhyLnN0YXR1cyA+PSAyMDAgJiYgX3hoci5zdGF0dXMgPCA0MDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGFyZ2V0LnRyaWdnZXIoJ2xvYWQnKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaChleCkge31cblxuXHRcdFx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKCdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cblx0XHRcdFx0Ly8gc2V0IHJlcXVlc3QgaGVhZGVyc1xuXHRcdFx0XHRpZiAoIUJhc2ljLmlzRW1wdHlPYmoobWV0YS5oZWFkZXJzKSkge1xuXHRcdFx0XHRcdEJhc2ljLmVhY2gobWV0YS5oZWFkZXJzLCBmdW5jdGlvbih2YWx1ZSwgaGVhZGVyKSB7XG5cdFx0XHRcdFx0XHRfeGhyLnNldFJlcXVlc3RIZWFkZXIoaGVhZGVyLCB2YWx1ZSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyByZXF1ZXN0IHJlc3BvbnNlIHR5cGVcblx0XHRcdFx0aWYgKFwiXCIgIT09IG1ldGEucmVzcG9uc2VUeXBlICYmICdyZXNwb25zZVR5cGUnIGluIF94aHIpIHtcblx0XHRcdFx0XHRpZiAoJ2pzb24nID09PSBtZXRhLnJlc3BvbnNlVHlwZSAmJiAhRW52LmNhbigncmV0dXJuX3Jlc3BvbnNlX3R5cGUnLCAnanNvbicpKSB7IC8vIHdlIGNhbiBmYWtlIHRoaXMgb25lXG5cdFx0XHRcdFx0XHRfeGhyLnJlc3BvbnNlVHlwZSA9ICd0ZXh0Jztcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X3hoci5yZXNwb25zZVR5cGUgPSBtZXRhLnJlc3BvbnNlVHlwZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBzZW5kIC4uLlxuXHRcdFx0XHRpZiAoIW11c3RTZW5kQXNCaW5hcnkpIHtcblx0XHRcdFx0XHRfeGhyLnNlbmQoZGF0YSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKF94aHIuc2VuZEFzQmluYXJ5KSB7IC8vIEdlY2tvXG5cdFx0XHRcdFx0XHRfeGhyLnNlbmRBc0JpbmFyeShkYXRhKTtcblx0XHRcdFx0XHR9IGVsc2UgeyAvLyBvdGhlciBicm93c2VycyBoYXZpbmcgc3VwcG9ydCBmb3IgdHlwZWQgYXJyYXlzXG5cdFx0XHRcdFx0XHQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdC8vIG1pbWljIEdlY2tvJ3Mgc2VuZEFzQmluYXJ5XG5cdFx0XHRcdFx0XHRcdHZhciB1aThhID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHR1aThhW2ldID0gKGRhdGEuY2hhckNvZGVBdChpKSAmIDB4ZmYpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdF94aHIuc2VuZCh1aThhLmJ1ZmZlcik7XG5cdFx0XHRcdFx0XHR9KCkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRhcmdldC50cmlnZ2VyKCdsb2Fkc3RhcnQnKTtcblx0XHRcdH0sXG5cblx0XHRcdGdldFN0YXR1czogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGFjY29yZGluZyB0byBXM0Mgc3BlYyBpdCBzaG91bGQgcmV0dXJuIDAgZm9yIHJlYWR5U3RhdGUgPCAzLCBidXQgaW5zdGVhZCBpdCB0aHJvd3MgYW4gZXhjZXB0aW9uXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0aWYgKF94aHIpIHtcblx0XHRcdFx0XHRcdHJldHVybiBfeGhyLnN0YXR1cztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2goZXgpIHt9XG5cdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0fSxcblxuXHRcdFx0Z2V0UmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0c3dpdGNoIChyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0XHRcdGNhc2UgJ2Jsb2InOlxuXHRcdFx0XHRcdFx0XHR2YXIgZmlsZSA9IG5ldyBGaWxlKEkudWlkLCBfeGhyLnJlc3BvbnNlKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIHRyeSB0byBleHRyYWN0IGZpbGUgbmFtZSBmcm9tIGNvbnRlbnQtZGlzcG9zaXRpb24gaWYgcG9zc2libGUgKG1pZ2h0IGJlIC0gbm90LCBpZiBDT1JTIGZvciBleGFtcGxlKVx0XG5cdFx0XHRcdFx0XHRcdHZhciBkaXNwb3NpdGlvbiA9IF94aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtRGlzcG9zaXRpb24nKTtcblx0XHRcdFx0XHRcdFx0aWYgKGRpc3Bvc2l0aW9uKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gZXh0cmFjdCBmaWxlbmFtZSBmcm9tIHJlc3BvbnNlIGhlYWRlciBpZiBhdmFpbGFibGVcblx0XHRcdFx0XHRcdFx0XHR2YXIgbWF0Y2ggPSBkaXNwb3NpdGlvbi5tYXRjaCgvZmlsZW5hbWU9KFtcXCdcXFwiJ10pKFteXFwxXSspXFwxLyk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRfZmlsZW5hbWUgPSBtYXRjaFsyXTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0ZmlsZS5uYW1lID0gX2ZpbGVuYW1lO1xuXG5cdFx0XHRcdFx0XHRcdC8vIHByZS13ZWJraXQgT3BlcmEgZG9lc24ndCBzZXQgdHlwZSBwcm9wZXJ0eSBvbiB0aGUgYmxvYiByZXNwb25zZVxuXHRcdFx0XHRcdFx0XHRpZiAoIWZpbGUudHlwZSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGUudHlwZSA9IE1pbWUuZ2V0RmlsZU1pbWUoX2ZpbGVuYW1lKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmlsZTtcblxuXHRcdFx0XHRcdFx0Y2FzZSAnanNvbic6XG5cdFx0XHRcdFx0XHRcdGlmICghRW52LmNhbigncmV0dXJuX3Jlc3BvbnNlX3R5cGUnLCAnanNvbicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIF94aHIuc3RhdHVzID09PSAyMDAgJiYgISF3aW5kb3cuSlNPTiA/IEpTT04ucGFyc2UoX3hoci5yZXNwb25zZVRleHQpIDogbnVsbDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gX3hoci5yZXNwb25zZTtcblxuXHRcdFx0XHRcdFx0Y2FzZSAnZG9jdW1lbnQnOlxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gX2dldERvY3VtZW50KF94aHIpO1xuXG5cdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gX3hoci5yZXNwb25zZVRleHQgIT09ICcnID8gX3hoci5yZXNwb25zZVRleHQgOiBudWxsOyAvLyBhZ2FpbnN0IHRoZSBzcGVjcywgYnV0IGZvciBjb25zaXN0ZW5jeSBhY3Jvc3MgdGhlIHJ1bnRpbWVzXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGNhdGNoKGV4KSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cdFx0XHRcdFxuXHRcdFx0fSxcblxuXHRcdFx0Z2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gX3hoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKTtcblx0XHRcdFx0fSBjYXRjaChleCkge31cblx0XHRcdFx0cmV0dXJuICcnO1xuXHRcdFx0fSxcblxuXHRcdFx0YWJvcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoX3hocikge1xuXHRcdFx0XHRcdF94aHIuYWJvcnQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHNlbGYgPSBfZmlsZW5hbWUgPSBudWxsO1xuXHRcdFx0XHR0aGlzLmdldFJ1bnRpbWUoKS5nZXRTaGltKCkucmVtb3ZlSW5zdGFuY2UodGhpcy51aWQpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cblx0XHQvLyBoZXJlIHdlIGdvLi4uIHVnbHkgZml4IGZvciB1Z2x5IGJ1Z1xuXHRcdGZ1bmN0aW9uIF9wcmVsb2FkQW5kU2VuZChtZXRhLCBkYXRhKSB7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcywgYmxvYiwgZnI7XG5cdFx0XHRcdFxuXHRcdFx0Ly8gZ2V0IG9yaWdpbmFsIGJsb2Jcblx0XHRcdGJsb2IgPSBkYXRhLmdldEJsb2IoKS5nZXRTb3VyY2UoKTtcblx0XHRcdFxuXHRcdFx0Ly8gcHJlbG9hZCBibG9iIGluIG1lbW9yeSB0byBiZSBzZW50IGFzIGJpbmFyeSBzdHJpbmdcblx0XHRcdGZyID0gbmV3IHdpbmRvdy5GaWxlUmVhZGVyKCk7XG5cdFx0XHRmci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gb3ZlcndyaXRlIG9yaWdpbmFsIGJsb2Jcblx0XHRcdFx0ZGF0YS5hcHBlbmQoZGF0YS5nZXRCbG9iTmFtZSgpLCBuZXcgQmxvYihudWxsLCB7XG5cdFx0XHRcdFx0dHlwZTogYmxvYi50eXBlLFxuXHRcdFx0XHRcdGRhdGE6IGZyLnJlc3VsdFxuXHRcdFx0XHR9KSk7XG5cdFx0XHRcdC8vIGludm9rZSBzZW5kIG9wZXJhdGlvbiBhZ2FpblxuXHRcdFx0XHRzZWxmLnNlbmQuY2FsbCh0YXJnZXQsIG1ldGEsIGRhdGEpO1xuXHRcdFx0fTtcblx0XHRcdGZyLnJlYWRBc0JpbmFyeVN0cmluZyhibG9iKTtcblx0XHR9XG5cblx0XHRcblx0XHRmdW5jdGlvbiBfZ2V0TmF0aXZlWEhSKCkge1xuXHRcdFx0aWYgKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCAmJiAhKEVudi5icm93c2VyID09PSAnSUUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA4LCAnPCcpKSkgeyAvLyBJRTcgaGFzIG5hdGl2ZSBYSFIgYnV0IGl0J3MgYnVnZ3lcblx0XHRcdFx0cmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiAoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIHByb2dJRHMgPSBbJ01zeG1sMi5YTUxIVFRQLjYuMCcsICdNaWNyb3NvZnQuWE1MSFRUUCddOyAvLyBpZiA2LjAgYXZhaWxhYmxlLCB1c2UgaXQsIG90aGVyd2lzZSBmYWlsYmFjayB0byBkZWZhdWx0IDMuMFxuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcHJvZ0lEcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KHByb2dJRHNbaV0pO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXgpIHt9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBAY3JlZGl0cyBTZXJnZXkgSWxpbnNreVx0KGh0dHA6Ly93d3cuaWxpbnNreS5jb20vKVxuXHRcdGZ1bmN0aW9uIF9nZXREb2N1bWVudCh4aHIpIHtcblx0XHRcdHZhciByWE1MID0geGhyLnJlc3BvbnNlWE1MO1xuXHRcdFx0dmFyIHJUZXh0ID0geGhyLnJlc3BvbnNlVGV4dDtcblx0XHRcdFxuXHRcdFx0Ly8gVHJ5IHBhcnNpbmcgcmVzcG9uc2VUZXh0IChAc2VlOiBodHRwOi8vd3d3LmlsaW5za3kuY29tL2FydGljbGVzL1hNTEh0dHBSZXF1ZXN0LyNidWdzLWllLXJlc3BvbnNlWE1MLWNvbnRlbnQtdHlwZSlcblx0XHRcdGlmIChFbnYuYnJvd3NlciA9PT0gJ0lFJyAmJiByVGV4dCAmJiByWE1MICYmICFyWE1MLmRvY3VtZW50RWxlbWVudCAmJiAvW15cXC9dK1xcL1teXFwrXStcXCt4bWwvLnRlc3QoeGhyLmdldFJlc3BvbnNlSGVhZGVyKFwiQ29udGVudC1UeXBlXCIpKSkge1xuXHRcdFx0XHRyWE1MID0gbmV3IHdpbmRvdy5BY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTERPTVwiKTtcblx0XHRcdFx0clhNTC5hc3luYyA9IGZhbHNlO1xuXHRcdFx0XHRyWE1MLnZhbGlkYXRlT25QYXJzZSA9IGZhbHNlO1xuXHRcdFx0XHRyWE1MLmxvYWRYTUwoclRleHQpO1xuXHRcdFx0fVxuXHRcblx0XHRcdC8vIENoZWNrIGlmIHRoZXJlIGlzIG5vIGVycm9yIGluIGRvY3VtZW50XG5cdFx0XHRpZiAoclhNTCkge1xuXHRcdFx0XHRpZiAoKEVudi5icm93c2VyID09PSAnSUUnICYmIHJYTUwucGFyc2VFcnJvciAhPT0gMCkgfHwgIXJYTUwuZG9jdW1lbnRFbGVtZW50IHx8IHJYTUwuZG9jdW1lbnRFbGVtZW50LnRhZ05hbWUgPT09IFwicGFyc2VyZXJyb3JcIikge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gclhNTDtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9wcmVwYXJlTXVsdGlwYXJ0KGZkKSB7XG5cdFx0XHR2YXIgYm91bmRhcnkgPSAnLS0tLW1veGllYm91bmRhcnknICsgbmV3IERhdGUoKS5nZXRUaW1lKClcblx0XHRcdCwgZGFzaGRhc2ggPSAnLS0nXG5cdFx0XHQsIGNybGYgPSAnXFxyXFxuJ1xuXHRcdFx0LCBtdWx0aXBhcnQgPSAnJ1xuXHRcdFx0LCBJID0gdGhpcy5nZXRSdW50aW1lKClcblx0XHRcdDtcblxuXHRcdFx0aWYgKCFJLmNhbignc2VuZF9iaW5hcnlfc3RyaW5nJykpIHtcblx0XHRcdFx0dGhyb3cgbmV3IHguUnVudGltZUVycm9yKHguUnVudGltZUVycm9yLk5PVF9TVVBQT1JURURfRVJSKTtcblx0XHRcdH1cblxuXHRcdFx0X3hoci5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnbXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9JyArIGJvdW5kYXJ5KTtcblxuXHRcdFx0Ly8gYXBwZW5kIG11bHRpcGFydCBwYXJhbWV0ZXJzXG5cdFx0XHRmZC5lYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG5cdFx0XHRcdC8vIEZpcmVmb3ggMy42IGZhaWxlZCB0byBjb252ZXJ0IG11bHRpYnl0ZSBjaGFyYWN0ZXJzIHRvIFVURi04IGluIHNlbmRBc0JpbmFyeSgpLCBcblx0XHRcdFx0Ly8gc28gd2UgdHJ5IGl0IGhlcmUgb3Vyc2VsdmVzIHdpdGg6IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpXG5cdFx0XHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHQvLyBCdWlsZCBSRkMyMzg4IGJsb2Jcblx0XHRcdFx0XHRtdWx0aXBhcnQgKz0gZGFzaGRhc2ggKyBib3VuZGFyeSArIGNybGYgK1xuXHRcdFx0XHRcdFx0J0NvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cIicgKyBuYW1lICsgJ1wiOyBmaWxlbmFtZT1cIicgKyB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodmFsdWUubmFtZSB8fCAnYmxvYicpKSArICdcIicgKyBjcmxmICtcblx0XHRcdFx0XHRcdCdDb250ZW50LVR5cGU6ICcgKyAodmFsdWUudHlwZSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJykgKyBjcmxmICsgY3JsZiArXG5cdFx0XHRcdFx0XHR2YWx1ZS5nZXRTb3VyY2UoKSArIGNybGY7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bXVsdGlwYXJ0ICs9IGRhc2hkYXNoICsgYm91bmRhcnkgKyBjcmxmICtcblx0XHRcdFx0XHRcdCdDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCInICsgbmFtZSArICdcIicgKyBjcmxmICsgY3JsZiArXG5cdFx0XHRcdFx0XHR1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKSArIGNybGY7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRtdWx0aXBhcnQgKz0gZGFzaGRhc2ggKyBib3VuZGFyeSArIGRhc2hkYXNoICsgY3JsZjtcblxuXHRcdFx0cmV0dXJuIG11bHRpcGFydDtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuWE1MSHR0cFJlcXVlc3QgPSBYTUxIdHRwUmVxdWVzdCk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXIuanNcblxuLyoqXG4gKiBCaW5hcnlSZWFkZXIuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXJcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXJcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIlxuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblxuXHRcblx0ZnVuY3Rpb24gQmluYXJ5UmVhZGVyKGRhdGEpIHtcblx0XHRpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG5cdFx0XHRBcnJheUJ1ZmZlclJlYWRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRVVEYxNlN0cmluZ1JlYWRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH1cblx0fVxuXG5cdEJhc2ljLmV4dGVuZChCaW5hcnlSZWFkZXIucHJvdG90eXBlLCB7XG5cdFx0XG5cdFx0bGl0dGxlRW5kaWFuOiBmYWxzZSxcblxuXG5cdFx0cmVhZDogZnVuY3Rpb24oaWR4LCBzaXplKSB7XG5cdFx0XHR2YXIgc3VtLCBtdiwgaTtcblxuXHRcdFx0aWYgKGlkeCArIHNpemUgPiB0aGlzLmxlbmd0aCgpKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihcIllvdSBhcmUgdHJ5aW5nIHRvIHJlYWQgb3V0c2lkZSB0aGUgc291cmNlIGJvdW5kYXJpZXMuXCIpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRtdiA9IHRoaXMubGl0dGxlRW5kaWFuIFxuXHRcdFx0XHQ/IDAgXG5cdFx0XHRcdDogLTggKiAoc2l6ZSAtIDEpXG5cdFx0XHQ7XG5cblx0XHRcdGZvciAoaSA9IDAsIHN1bSA9IDA7IGkgPCBzaXplOyBpKyspIHtcblx0XHRcdFx0c3VtIHw9ICh0aGlzLnJlYWRCeXRlQXQoaWR4ICsgaSkgPDwgTWF0aC5hYnMobXYgKyBpKjgpKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBzdW07XG5cdFx0fSxcblxuXG5cdFx0d3JpdGU6IGZ1bmN0aW9uKGlkeCwgbnVtLCBzaXplKSB7XG5cdFx0XHR2YXIgbXYsIGksIHN0ciA9ICcnO1xuXG5cdFx0XHRpZiAoaWR4ID4gdGhpcy5sZW5ndGgoKSkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXJlIHRyeWluZyB0byB3cml0ZSBvdXRzaWRlIHRoZSBzb3VyY2UgYm91bmRhcmllcy5cIik7XG5cdFx0XHR9XG5cblx0XHRcdG12ID0gdGhpcy5saXR0bGVFbmRpYW4gXG5cdFx0XHRcdD8gMCBcblx0XHRcdFx0OiAtOCAqIChzaXplIC0gMSlcblx0XHRcdDtcblxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykge1xuXHRcdFx0XHR0aGlzLndyaXRlQnl0ZUF0KGlkeCArIGksIChudW0gPj4gTWF0aC5hYnMobXYgKyBpKjgpKSAmIDI1NSk7XG5cdFx0XHR9XG5cdFx0fSxcblxuXG5cdFx0QllURTogZnVuY3Rpb24oaWR4KSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yZWFkKGlkeCwgMSk7XG5cdFx0fSxcblxuXG5cdFx0U0hPUlQ6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVhZChpZHgsIDIpO1xuXHRcdH0sXG5cblxuXHRcdExPTkc6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVhZChpZHgsIDQpO1xuXHRcdH0sXG5cblxuXHRcdFNMT05HOiBmdW5jdGlvbihpZHgpIHsgLy8gMidzIGNvbXBsZW1lbnQgbm90YXRpb25cblx0XHRcdHZhciBudW0gPSB0aGlzLnJlYWQoaWR4LCA0KTtcblx0XHRcdHJldHVybiAobnVtID4gMjE0NzQ4MzY0NyA/IG51bSAtIDQyOTQ5NjcyOTYgOiBudW0pO1xuXHRcdH0sXG5cblxuXHRcdENIQVI6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0cmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5yZWFkKGlkeCwgMSkpO1xuXHRcdH0sXG5cblxuXHRcdFNUUklORzogZnVuY3Rpb24oaWR4LCBjb3VudCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuYXNBcnJheSgnQ0hBUicsIGlkeCwgY291bnQpLmpvaW4oJycpO1xuXHRcdH0sXG5cblxuXHRcdGFzQXJyYXk6IGZ1bmN0aW9uKHR5cGUsIGlkeCwgY291bnQpIHtcblx0XHRcdHZhciB2YWx1ZXMgPSBbXTtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG5cdFx0XHRcdHZhbHVlc1tpXSA9IHRoaXNbdHlwZV0oaWR4ICsgaSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdH1cblx0fSk7XG5cblxuXHRmdW5jdGlvbiBBcnJheUJ1ZmZlclJlYWRlcihkYXRhKSB7XG5cdFx0dmFyIF9kdiA9IG5ldyBEYXRhVmlldyhkYXRhKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRcblx0XHRcdHJlYWRCeXRlQXQ6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0XHRyZXR1cm4gX2R2LmdldFVpbnQ4KGlkeCk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdHdyaXRlQnl0ZUF0OiBmdW5jdGlvbihpZHgsIHZhbHVlKSB7XG5cdFx0XHRcdF9kdi5zZXRVaW50OChpZHgsIHZhbHVlKTtcblx0XHRcdH0sXG5cdFx0XHRcblxuXHRcdFx0U0VHTUVOVDogZnVuY3Rpb24oaWR4LCBzaXplLCB2YWx1ZSkge1xuXHRcdFx0XHRzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0XHRjYXNlIDI6XG5cdFx0XHRcdFx0XHRyZXR1cm4gZGF0YS5zbGljZShpZHgsIGlkeCArIHNpemUpO1xuXG5cdFx0XHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGRhdGEuc2xpY2UoaWR4KTtcblxuXHRcdFx0XHRcdGNhc2UgMzpcblx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IG5ldyBBcnJheUJ1ZmZlcigpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1x0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0dmFyIGFyciA9IG5ldyBVaW50OEFycmF5KHRoaXMubGVuZ3RoKCkgLSBzaXplICsgdmFsdWUuYnl0ZUxlbmd0aCk7XG5cdFx0XHRcdFx0XHRcdGlmIChpZHggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0YXJyLnNldChuZXcgVWludDhBcnJheShkYXRhLnNsaWNlKDAsIGlkeCkpLCAwKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRhcnIuc2V0KG5ldyBVaW50OEFycmF5KHZhbHVlKSwgaWR4KTtcblx0XHRcdFx0XHRcdFx0YXJyLnNldChuZXcgVWludDhBcnJheShkYXRhLnNsaWNlKGlkeCArIHNpemUpKSwgaWR4ICsgdmFsdWUuYnl0ZUxlbmd0aCk7XG5cblx0XHRcdFx0XHRcdFx0dGhpcy5jbGVhcigpO1xuXHRcdFx0XHRcdFx0XHRkYXRhID0gYXJyLmJ1ZmZlcjtcblx0XHRcdFx0XHRcdFx0X2R2ID0gbmV3IERhdGFWaWV3KGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRlZmF1bHQ6IHJldHVybiBkYXRhO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdGxlbmd0aDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBkYXRhID8gZGF0YS5ieXRlTGVuZ3RoIDogMDtcblx0XHRcdH0sXG5cblxuXHRcdFx0Y2xlYXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfZHYgPSBkYXRhID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cblx0ZnVuY3Rpb24gVVRGMTZTdHJpbmdSZWFkZXIoZGF0YSkge1xuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRcblx0XHRcdHJlYWRCeXRlQXQ6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0XHRyZXR1cm4gZGF0YS5jaGFyQ29kZUF0KGlkeCk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdHdyaXRlQnl0ZUF0OiBmdW5jdGlvbihpZHgsIHZhbHVlKSB7XG5cdFx0XHRcdHB1dHN0cihTdHJpbmcuZnJvbUNoYXJDb2RlKHZhbHVlKSwgaWR4LCAxKTtcblx0XHRcdH0sXG5cblxuXHRcdFx0U0VHTUVOVDogZnVuY3Rpb24oaWR4LCBsZW5ndGgsIHNlZ21lbnQpIHtcblx0XHRcdFx0c3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGRhdGEuc3Vic3RyKGlkeCk7XG5cdFx0XHRcdFx0Y2FzZSAyOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGRhdGEuc3Vic3RyKGlkeCwgbGVuZ3RoKTtcblx0XHRcdFx0XHRjYXNlIDM6XG5cdFx0XHRcdFx0XHRwdXRzdHIoc2VnbWVudCAhPT0gbnVsbCA/IHNlZ21lbnQgOiAnJywgaWR4LCBsZW5ndGgpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDogcmV0dXJuIGRhdGE7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblxuXHRcdFx0bGVuZ3RoOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIGRhdGEgPyBkYXRhLmxlbmd0aCA6IDA7XG5cdFx0XHR9LCBcblxuXHRcdFx0Y2xlYXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkYXRhID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0ZnVuY3Rpb24gcHV0c3RyKHNlZ21lbnQsIGlkeCwgbGVuZ3RoKSB7XG5cdFx0XHRsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoID09PSAzID8gbGVuZ3RoIDogZGF0YS5sZW5ndGggLSBpZHggLSAxO1xuXHRcdFx0ZGF0YSA9IGRhdGEuc3Vic3RyKDAsIGlkeCkgKyBzZWdtZW50ICsgZGF0YS5zdWJzdHIobGVuZ3RoICsgaWR4KTtcblx0XHR9XG5cdH1cblxuXG5cdHJldHVybiBCaW5hcnlSZWFkZXI7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNS9pbWFnZS9KUEVHSGVhZGVycy5qc1xuXG4vKipcbiAqIEpQRUdIZWFkZXJzLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG4gXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUdIZWFkZXJzXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR0hlYWRlcnNcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvdXRpbHMvQmluYXJ5UmVhZGVyXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCJcbl0sIGZ1bmN0aW9uKEJpbmFyeVJlYWRlciwgeCkge1xuXHRcblx0cmV0dXJuIGZ1bmN0aW9uIEpQRUdIZWFkZXJzKGRhdGEpIHtcblx0XHR2YXIgaGVhZGVycyA9IFtdLCBfYnIsIGlkeCwgbWFya2VyLCBsZW5ndGggPSAwO1xuXG5cdFx0X2JyID0gbmV3IEJpbmFyeVJlYWRlcihkYXRhKTtcblxuXHRcdC8vIENoZWNrIGlmIGRhdGEgaXMganBlZ1xuXHRcdGlmIChfYnIuU0hPUlQoMCkgIT09IDB4RkZEOCkge1xuXHRcdFx0X2JyLmNsZWFyKCk7XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdH1cblxuXHRcdGlkeCA9IDI7XG5cblx0XHR3aGlsZSAoaWR4IDw9IF9ici5sZW5ndGgoKSkge1xuXHRcdFx0bWFya2VyID0gX2JyLlNIT1JUKGlkeCk7XG5cblx0XHRcdC8vIG9taXQgUlNUIChyZXN0YXJ0KSBtYXJrZXJzXG5cdFx0XHRpZiAobWFya2VyID49IDB4RkZEMCAmJiBtYXJrZXIgPD0gMHhGRkQ3KSB7XG5cdFx0XHRcdGlkeCArPSAyO1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gbm8gaGVhZGVycyBhbGxvd2VkIGFmdGVyIFNPUyBtYXJrZXJcblx0XHRcdGlmIChtYXJrZXIgPT09IDB4RkZEQSB8fCBtYXJrZXIgPT09IDB4RkZEOSkge1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblxuXHRcdFx0bGVuZ3RoID0gX2JyLlNIT1JUKGlkeCArIDIpICsgMjtcblxuXHRcdFx0Ly8gQVBQbiBtYXJrZXIgZGV0ZWN0ZWRcblx0XHRcdGlmIChtYXJrZXIgPj0gMHhGRkUxICYmIG1hcmtlciA8PSAweEZGRUYpIHtcblx0XHRcdFx0aGVhZGVycy5wdXNoKHtcblx0XHRcdFx0XHRoZXg6IG1hcmtlcixcblx0XHRcdFx0XHRuYW1lOiAnQVBQJyArIChtYXJrZXIgJiAweDAwMEYpLFxuXHRcdFx0XHRcdHN0YXJ0OiBpZHgsXG5cdFx0XHRcdFx0bGVuZ3RoOiBsZW5ndGgsXG5cdFx0XHRcdFx0c2VnbWVudDogX2JyLlNFR01FTlQoaWR4LCBsZW5ndGgpXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHRpZHggKz0gbGVuZ3RoO1xuXHRcdH1cblxuXHRcdF9ici5jbGVhcigpO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGhlYWRlcnM6IGhlYWRlcnMsXG5cblx0XHRcdHJlc3RvcmU6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0dmFyIG1heCwgaSwgYnI7XG5cblx0XHRcdFx0YnIgPSBuZXcgQmluYXJ5UmVhZGVyKGRhdGEpO1xuXG5cdFx0XHRcdGlkeCA9IGJyLlNIT1JUKDIpID09IDB4RkZFMCA/IDQgKyBici5TSE9SVCg0KSA6IDI7XG5cblx0XHRcdFx0Zm9yIChpID0gMCwgbWF4ID0gaGVhZGVycy5sZW5ndGg7IGkgPCBtYXg7IGkrKykge1xuXHRcdFx0XHRcdGJyLlNFR01FTlQoaWR4LCAwLCBoZWFkZXJzW2ldLnNlZ21lbnQpO1xuXHRcdFx0XHRcdGlkeCArPSBoZWFkZXJzW2ldLmxlbmd0aDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRhdGEgPSBici5TRUdNRU5UKCk7XG5cdFx0XHRcdGJyLmNsZWFyKCk7XG5cdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0fSxcblxuXHRcdFx0c3RyaXA6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0dmFyIGJyLCBoZWFkZXJzLCBqcGVnSGVhZGVycywgaTtcblxuXHRcdFx0XHRqcGVnSGVhZGVycyA9IG5ldyBKUEVHSGVhZGVycyhkYXRhKTtcblx0XHRcdFx0aGVhZGVycyA9IGpwZWdIZWFkZXJzLmhlYWRlcnM7XG5cdFx0XHRcdGpwZWdIZWFkZXJzLnB1cmdlKCk7XG5cblx0XHRcdFx0YnIgPSBuZXcgQmluYXJ5UmVhZGVyKGRhdGEpO1xuXG5cdFx0XHRcdGkgPSBoZWFkZXJzLmxlbmd0aDtcblx0XHRcdFx0d2hpbGUgKGktLSkge1xuXHRcdFx0XHRcdGJyLlNFR01FTlQoaGVhZGVyc1tpXS5zdGFydCwgaGVhZGVyc1tpXS5sZW5ndGgsICcnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0ZGF0YSA9IGJyLlNFR01FTlQoKTtcblx0XHRcdFx0YnIuY2xlYXIoKTtcblx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKG5hbWUpIHtcblx0XHRcdFx0dmFyIGFycmF5ID0gW107XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIG1heCA9IGhlYWRlcnMubGVuZ3RoOyBpIDwgbWF4OyBpKyspIHtcblx0XHRcdFx0XHRpZiAoaGVhZGVyc1tpXS5uYW1lID09PSBuYW1lLnRvVXBwZXJDYXNlKCkpIHtcblx0XHRcdFx0XHRcdGFycmF5LnB1c2goaGVhZGVyc1tpXS5zZWdtZW50KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGFycmF5O1xuXHRcdFx0fSxcblxuXHRcdFx0c2V0OiBmdW5jdGlvbihuYW1lLCBzZWdtZW50KSB7XG5cdFx0XHRcdHZhciBhcnJheSA9IFtdLCBpLCBpaSwgbWF4O1xuXG5cdFx0XHRcdGlmICh0eXBlb2Yoc2VnbWVudCkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0YXJyYXkucHVzaChzZWdtZW50KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRhcnJheSA9IHNlZ21lbnQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRmb3IgKGkgPSBpaSA9IDAsIG1heCA9IGhlYWRlcnMubGVuZ3RoOyBpIDwgbWF4OyBpKyspIHtcblx0XHRcdFx0XHRpZiAoaGVhZGVyc1tpXS5uYW1lID09PSBuYW1lLnRvVXBwZXJDYXNlKCkpIHtcblx0XHRcdFx0XHRcdGhlYWRlcnNbaV0uc2VnbWVudCA9IGFycmF5W2lpXTtcblx0XHRcdFx0XHRcdGhlYWRlcnNbaV0ubGVuZ3RoID0gYXJyYXlbaWldLmxlbmd0aDtcblx0XHRcdFx0XHRcdGlpKys7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChpaSA+PSBhcnJheS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0cHVyZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmhlYWRlcnMgPSBoZWFkZXJzID0gW107XG5cdFx0XHR9XG5cdFx0fTtcblx0fTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL0V4aWZQYXJzZXIuanNcblxuLyoqXG4gKiBFeGlmUGFyc2VyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvRXhpZlBhcnNlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0V4aWZQYXJzZXJcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L3V0aWxzL0JpbmFyeVJlYWRlclwiLFxuXHRcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiXG5dLCBmdW5jdGlvbihCYXNpYywgQmluYXJ5UmVhZGVyLCB4KSB7XG5cdFxuXHRmdW5jdGlvbiBFeGlmUGFyc2VyKGRhdGEpIHtcblx0XHR2YXIgX19zdXBlcl9fLCB0YWdzLCB0YWdEZXNjcywgb2Zmc2V0cywgaWR4LCBUaWZmO1xuXHRcdFxuXHRcdEJpbmFyeVJlYWRlci5jYWxsKHRoaXMsIGRhdGEpO1xuXG5cdFx0dGFncyA9IHtcblx0XHRcdHRpZmY6IHtcblx0XHRcdFx0Lypcblx0XHRcdFx0VGhlIGltYWdlIG9yaWVudGF0aW9uIHZpZXdlZCBpbiB0ZXJtcyBvZiByb3dzIGFuZCBjb2x1bW5zLlxuXG5cdFx0XHRcdDEgPSBUaGUgMHRoIHJvdyBpcyBhdCB0aGUgdmlzdWFsIHRvcCBvZiB0aGUgaW1hZ2UsIGFuZCB0aGUgMHRoIGNvbHVtbiBpcyB0aGUgdmlzdWFsIGxlZnQtaGFuZCBzaWRlLlxuXHRcdFx0XHQyID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCB0b3Agb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUuXG5cdFx0XHRcdDMgPSBUaGUgMHRoIHJvdyBpcyBhdCB0aGUgdmlzdWFsIGJvdHRvbSBvZiB0aGUgaW1hZ2UsIGFuZCB0aGUgMHRoIGNvbHVtbiBpcyB0aGUgdmlzdWFsIHJpZ2h0LWhhbmQgc2lkZS5cblx0XHRcdFx0NCA9IFRoZSAwdGggcm93IGlzIGF0IHRoZSB2aXN1YWwgYm90dG9tIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUuXG5cdFx0XHRcdDUgPSBUaGUgMHRoIHJvdyBpcyB0aGUgdmlzdWFsIGxlZnQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgdG9wLlxuXHRcdFx0XHQ2ID0gVGhlIDB0aCByb3cgaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUgb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCB0b3AuXG5cdFx0XHRcdDcgPSBUaGUgMHRoIHJvdyBpcyB0aGUgdmlzdWFsIHJpZ2h0LWhhbmQgc2lkZSBvZiB0aGUgaW1hZ2UsIGFuZCB0aGUgMHRoIGNvbHVtbiBpcyB0aGUgdmlzdWFsIGJvdHRvbS5cblx0XHRcdFx0OCA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUgb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCBib3R0b20uXG5cdFx0XHRcdCovXG5cdFx0XHRcdDB4MDExMjogJ09yaWVudGF0aW9uJyxcblx0XHRcdFx0MHgwMTBFOiAnSW1hZ2VEZXNjcmlwdGlvbicsXG5cdFx0XHRcdDB4MDEwRjogJ01ha2UnLFxuXHRcdFx0XHQweDAxMTA6ICdNb2RlbCcsXG5cdFx0XHRcdDB4MDEzMTogJ1NvZnR3YXJlJyxcblx0XHRcdFx0MHg4NzY5OiAnRXhpZklGRFBvaW50ZXInLFxuXHRcdFx0XHQweDg4MjU6XHQnR1BTSW5mb0lGRFBvaW50ZXInXG5cdFx0XHR9LFxuXHRcdFx0ZXhpZjoge1xuXHRcdFx0XHQweDkwMDA6ICdFeGlmVmVyc2lvbicsXG5cdFx0XHRcdDB4QTAwMTogJ0NvbG9yU3BhY2UnLFxuXHRcdFx0XHQweEEwMDI6ICdQaXhlbFhEaW1lbnNpb24nLFxuXHRcdFx0XHQweEEwMDM6ICdQaXhlbFlEaW1lbnNpb24nLFxuXHRcdFx0XHQweDkwMDM6ICdEYXRlVGltZU9yaWdpbmFsJyxcblx0XHRcdFx0MHg4MjlBOiAnRXhwb3N1cmVUaW1lJyxcblx0XHRcdFx0MHg4MjlEOiAnRk51bWJlcicsXG5cdFx0XHRcdDB4ODgyNzogJ0lTT1NwZWVkUmF0aW5ncycsXG5cdFx0XHRcdDB4OTIwMTogJ1NodXR0ZXJTcGVlZFZhbHVlJyxcblx0XHRcdFx0MHg5MjAyOiAnQXBlcnR1cmVWYWx1ZSdcdCxcblx0XHRcdFx0MHg5MjA3OiAnTWV0ZXJpbmdNb2RlJyxcblx0XHRcdFx0MHg5MjA4OiAnTGlnaHRTb3VyY2UnLFxuXHRcdFx0XHQweDkyMDk6ICdGbGFzaCcsXG5cdFx0XHRcdDB4OTIwQTogJ0ZvY2FsTGVuZ3RoJyxcblx0XHRcdFx0MHhBNDAyOiAnRXhwb3N1cmVNb2RlJyxcblx0XHRcdFx0MHhBNDAzOiAnV2hpdGVCYWxhbmNlJyxcblx0XHRcdFx0MHhBNDA2OiAnU2NlbmVDYXB0dXJlVHlwZScsXG5cdFx0XHRcdDB4QTQwNDogJ0RpZ2l0YWxab29tUmF0aW8nLFxuXHRcdFx0XHQweEE0MDg6ICdDb250cmFzdCcsXG5cdFx0XHRcdDB4QTQwOTogJ1NhdHVyYXRpb24nLFxuXHRcdFx0XHQweEE0MEE6ICdTaGFycG5lc3MnXG5cdFx0XHR9LFxuXHRcdFx0Z3BzOiB7XG5cdFx0XHRcdDB4MDAwMDogJ0dQU1ZlcnNpb25JRCcsXG5cdFx0XHRcdDB4MDAwMTogJ0dQU0xhdGl0dWRlUmVmJyxcblx0XHRcdFx0MHgwMDAyOiAnR1BTTGF0aXR1ZGUnLFxuXHRcdFx0XHQweDAwMDM6ICdHUFNMb25naXR1ZGVSZWYnLFxuXHRcdFx0XHQweDAwMDQ6ICdHUFNMb25naXR1ZGUnXG5cdFx0XHR9LFxuXG5cdFx0XHR0aHVtYjoge1xuXHRcdFx0XHQweDAyMDE6ICdKUEVHSW50ZXJjaGFuZ2VGb3JtYXQnLFxuXHRcdFx0XHQweDAyMDI6ICdKUEVHSW50ZXJjaGFuZ2VGb3JtYXRMZW5ndGgnXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHRhZ0Rlc2NzID0ge1xuXHRcdFx0J0NvbG9yU3BhY2UnOiB7XG5cdFx0XHRcdDE6ICdzUkdCJyxcblx0XHRcdFx0MDogJ1VuY2FsaWJyYXRlZCdcblx0XHRcdH0sXG5cblx0XHRcdCdNZXRlcmluZ01vZGUnOiB7XG5cdFx0XHRcdDA6ICdVbmtub3duJyxcblx0XHRcdFx0MTogJ0F2ZXJhZ2UnLFxuXHRcdFx0XHQyOiAnQ2VudGVyV2VpZ2h0ZWRBdmVyYWdlJyxcblx0XHRcdFx0MzogJ1Nwb3QnLFxuXHRcdFx0XHQ0OiAnTXVsdGlTcG90Jyxcblx0XHRcdFx0NTogJ1BhdHRlcm4nLFxuXHRcdFx0XHQ2OiAnUGFydGlhbCcsXG5cdFx0XHRcdDI1NTogJ090aGVyJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0xpZ2h0U291cmNlJzoge1xuXHRcdFx0XHQxOiAnRGF5bGlnaHQnLFxuXHRcdFx0XHQyOiAnRmxpb3Jlc2NlbnQnLFxuXHRcdFx0XHQzOiAnVHVuZ3N0ZW4nLFxuXHRcdFx0XHQ0OiAnRmxhc2gnLFxuXHRcdFx0XHQ5OiAnRmluZSB3ZWF0aGVyJyxcblx0XHRcdFx0MTA6ICdDbG91ZHkgd2VhdGhlcicsXG5cdFx0XHRcdDExOiAnU2hhZGUnLFxuXHRcdFx0XHQxMjogJ0RheWxpZ2h0IGZsdW9yZXNjZW50IChEIDU3MDAgLSA3MTAwSyknLFxuXHRcdFx0XHQxMzogJ0RheSB3aGl0ZSBmbHVvcmVzY2VudCAoTiA0NjAwIC01NDAwSyknLFxuXHRcdFx0XHQxNDogJ0Nvb2wgd2hpdGUgZmx1b3Jlc2NlbnQgKFcgMzkwMCAtIDQ1MDBLKScsXG5cdFx0XHRcdDE1OiAnV2hpdGUgZmx1b3Jlc2NlbnQgKFdXIDMyMDAgLSAzNzAwSyknLFxuXHRcdFx0XHQxNzogJ1N0YW5kYXJkIGxpZ2h0IEEnLFxuXHRcdFx0XHQxODogJ1N0YW5kYXJkIGxpZ2h0IEInLFxuXHRcdFx0XHQxOTogJ1N0YW5kYXJkIGxpZ2h0IEMnLFxuXHRcdFx0XHQyMDogJ0Q1NScsXG5cdFx0XHRcdDIxOiAnRDY1Jyxcblx0XHRcdFx0MjI6ICdENzUnLFxuXHRcdFx0XHQyMzogJ0Q1MCcsXG5cdFx0XHRcdDI0OiAnSVNPIHN0dWRpbyB0dW5nc3RlbicsXG5cdFx0XHRcdDI1NTogJ090aGVyJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0ZsYXNoJzoge1xuXHRcdFx0XHQweDAwMDA6ICdGbGFzaCBkaWQgbm90IGZpcmUnLFxuXHRcdFx0XHQweDAwMDE6ICdGbGFzaCBmaXJlZCcsXG5cdFx0XHRcdDB4MDAwNTogJ1N0cm9iZSByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDA3OiAnU3Ryb2JlIHJldHVybiBsaWdodCBkZXRlY3RlZCcsXG5cdFx0XHRcdDB4MDAwOTogJ0ZsYXNoIGZpcmVkLCBjb21wdWxzb3J5IGZsYXNoIG1vZGUnLFxuXHRcdFx0XHQweDAwMEQ6ICdGbGFzaCBmaXJlZCwgY29tcHVsc29yeSBmbGFzaCBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDBGOiAnRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDEwOiAnRmxhc2ggZGlkIG5vdCBmaXJlLCBjb21wdWxzb3J5IGZsYXNoIG1vZGUnLFxuXHRcdFx0XHQweDAwMTg6ICdGbGFzaCBkaWQgbm90IGZpcmUsIGF1dG8gbW9kZScsXG5cdFx0XHRcdDB4MDAxOTogJ0ZsYXNoIGZpcmVkLCBhdXRvIG1vZGUnLFxuXHRcdFx0XHQweDAwMUQ6ICdGbGFzaCBmaXJlZCwgYXV0byBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDFGOiAnRmxhc2ggZmlyZWQsIGF1dG8gbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDIwOiAnTm8gZmxhc2ggZnVuY3Rpb24nLFxuXHRcdFx0XHQweDAwNDE6ICdGbGFzaCBmaXJlZCwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZScsXG5cdFx0XHRcdDB4MDA0NTogJ0ZsYXNoIGZpcmVkLCByZWQtZXllIHJlZHVjdGlvbiBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDQ3OiAnRmxhc2ggZmlyZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUsIHJldHVybiBsaWdodCBkZXRlY3RlZCcsXG5cdFx0XHRcdDB4MDA0OTogJ0ZsYXNoIGZpcmVkLCBjb21wdWxzb3J5IGZsYXNoIG1vZGUsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUnLFxuXHRcdFx0XHQweDAwNEQ6ICdGbGFzaCBmaXJlZCwgY29tcHVsc29yeSBmbGFzaCBtb2RlLCByZWQtZXllIHJlZHVjdGlvbiBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDRGOiAnRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDU5OiAnRmxhc2ggZmlyZWQsIGF1dG8gbW9kZSwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZScsXG5cdFx0XHRcdDB4MDA1RDogJ0ZsYXNoIGZpcmVkLCBhdXRvIG1vZGUsIHJldHVybiBsaWdodCBub3QgZGV0ZWN0ZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUnLFxuXHRcdFx0XHQweDAwNUY6ICdGbGFzaCBmaXJlZCwgYXV0byBtb2RlLCByZXR1cm4gbGlnaHQgZGV0ZWN0ZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUnXG5cdFx0XHR9LFxuXG5cdFx0XHQnRXhwb3N1cmVNb2RlJzoge1xuXHRcdFx0XHQwOiAnQXV0byBleHBvc3VyZScsXG5cdFx0XHRcdDE6ICdNYW51YWwgZXhwb3N1cmUnLFxuXHRcdFx0XHQyOiAnQXV0byBicmFja2V0J1xuXHRcdFx0fSxcblxuXHRcdFx0J1doaXRlQmFsYW5jZSc6IHtcblx0XHRcdFx0MDogJ0F1dG8gd2hpdGUgYmFsYW5jZScsXG5cdFx0XHRcdDE6ICdNYW51YWwgd2hpdGUgYmFsYW5jZSdcblx0XHRcdH0sXG5cblx0XHRcdCdTY2VuZUNhcHR1cmVUeXBlJzoge1xuXHRcdFx0XHQwOiAnU3RhbmRhcmQnLFxuXHRcdFx0XHQxOiAnTGFuZHNjYXBlJyxcblx0XHRcdFx0MjogJ1BvcnRyYWl0Jyxcblx0XHRcdFx0MzogJ05pZ2h0IHNjZW5lJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0NvbnRyYXN0Jzoge1xuXHRcdFx0XHQwOiAnTm9ybWFsJyxcblx0XHRcdFx0MTogJ1NvZnQnLFxuXHRcdFx0XHQyOiAnSGFyZCdcblx0XHRcdH0sXG5cblx0XHRcdCdTYXR1cmF0aW9uJzoge1xuXHRcdFx0XHQwOiAnTm9ybWFsJyxcblx0XHRcdFx0MTogJ0xvdyBzYXR1cmF0aW9uJyxcblx0XHRcdFx0MjogJ0hpZ2ggc2F0dXJhdGlvbidcblx0XHRcdH0sXG5cblx0XHRcdCdTaGFycG5lc3MnOiB7XG5cdFx0XHRcdDA6ICdOb3JtYWwnLFxuXHRcdFx0XHQxOiAnU29mdCcsXG5cdFx0XHRcdDI6ICdIYXJkJ1xuXHRcdFx0fSxcblxuXHRcdFx0Ly8gR1BTIHJlbGF0ZWRcblx0XHRcdCdHUFNMYXRpdHVkZVJlZic6IHtcblx0XHRcdFx0TjogJ05vcnRoIGxhdGl0dWRlJyxcblx0XHRcdFx0UzogJ1NvdXRoIGxhdGl0dWRlJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0dQU0xvbmdpdHVkZVJlZic6IHtcblx0XHRcdFx0RTogJ0Vhc3QgbG9uZ2l0dWRlJyxcblx0XHRcdFx0VzogJ1dlc3QgbG9uZ2l0dWRlJ1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRvZmZzZXRzID0ge1xuXHRcdFx0dGlmZkhlYWRlcjogMTBcblx0XHR9O1xuXHRcdFxuXHRcdGlkeCA9IG9mZnNldHMudGlmZkhlYWRlcjtcblxuXHRcdF9fc3VwZXJfXyA9IHtcblx0XHRcdGNsZWFyOiB0aGlzLmNsZWFyXG5cdFx0fTtcblxuXHRcdC8vIFB1YmxpYyBmdW5jdGlvbnNcblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0XG5cdFx0XHRyZWFkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gRXhpZlBhcnNlci5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdHdyaXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gRXhpZlBhcnNlci5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0fSBjYXRjaCAoZXgpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5JTlZBTElEX01FVEFfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXG5cdFx0XHRVTkRFRklORUQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5CWVRFLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdFJBVElPTkFMOiBmdW5jdGlvbihpZHgpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuTE9ORyhpZHgpIC8gdGhpcy5MT05HKGlkeCArIDQpXG5cdFx0XHR9LFxuXG5cblx0XHRcdFNSQVRJT05BTDogZnVuY3Rpb24oaWR4KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLlNMT05HKGlkeCkgLyB0aGlzLlNMT05HKGlkeCArIDQpXG5cdFx0XHR9LFxuXG5cdFx0XHRBU0NJSTogZnVuY3Rpb24oaWR4KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLkNIQVIoaWR4KTtcblx0XHRcdH0sXG5cblx0XHRcdFRJRkY6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gVGlmZiB8fCBudWxsO1xuXHRcdFx0fSxcblxuXG5cdFx0XHRFWElGOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIEV4aWYgPSBudWxsO1xuXG5cdFx0XHRcdGlmIChvZmZzZXRzLmV4aWZJRkQpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0RXhpZiA9IGV4dHJhY3RUYWdzLmNhbGwodGhpcywgb2Zmc2V0cy5leGlmSUZELCB0YWdzLmV4aWYpO1xuXHRcdFx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIEZpeCBmb3JtYXR0aW5nIG9mIHNvbWUgdGFnc1xuXHRcdFx0XHRcdGlmIChFeGlmLkV4aWZWZXJzaW9uICYmIEJhc2ljLnR5cGVPZihFeGlmLkV4aWZWZXJzaW9uKSA9PT0gJ2FycmF5Jykge1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGV4aWZWZXJzaW9uID0gJyc7IGkgPCBFeGlmLkV4aWZWZXJzaW9uLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGV4aWZWZXJzaW9uICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoRXhpZi5FeGlmVmVyc2lvbltpXSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRFeGlmLkV4aWZWZXJzaW9uID0gZXhpZlZlcnNpb247XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIEV4aWY7XG5cdFx0XHR9LFxuXG5cblx0XHRcdEdQUzogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBHUFMgPSBudWxsO1xuXG5cdFx0XHRcdGlmIChvZmZzZXRzLmdwc0lGRCkge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRHUFMgPSBleHRyYWN0VGFncy5jYWxsKHRoaXMsIG9mZnNldHMuZ3BzSUZELCB0YWdzLmdwcyk7XG5cdFx0XHRcdFx0fSBjYXRjaCAoZXgpIHtcblx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGlPUyBkZXZpY2VzIChhbmQgcHJvYmFibHkgc29tZSBvdGhlcnMpIGRvIG5vdCBwdXQgaW4gR1BTVmVyc2lvbklEIHRhZyAod2h5Py4uKVxuXHRcdFx0XHRcdGlmIChHUFMuR1BTVmVyc2lvbklEICYmIEJhc2ljLnR5cGVPZihHUFMuR1BTVmVyc2lvbklEKSA9PT0gJ2FycmF5Jykge1xuXHRcdFx0XHRcdFx0R1BTLkdQU1ZlcnNpb25JRCA9IEdQUy5HUFNWZXJzaW9uSUQuam9pbignLicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBHUFM7XG5cdFx0XHR9LFxuXG5cblx0XHRcdHRodW1iOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKG9mZnNldHMuSUZEMSkge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHR2YXIgSUZEMVRhZ3MgPSBleHRyYWN0VGFncy5jYWxsKHRoaXMsIG9mZnNldHMuSUZEMSwgdGFncy50aHVtYik7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICgnSlBFR0ludGVyY2hhbmdlRm9ybWF0JyBpbiBJRkQxVGFncykge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdGhpcy5TRUdNRU5UKG9mZnNldHMudGlmZkhlYWRlciArIElGRDFUYWdzLkpQRUdJbnRlcmNoYW5nZUZvcm1hdCwgSUZEMVRhZ3MuSlBFR0ludGVyY2hhbmdlRm9ybWF0TGVuZ3RoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGNhdGNoIChleCkge31cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH0sXG5cblxuXHRcdFx0c2V0RXhpZjogZnVuY3Rpb24odGFnLCB2YWx1ZSkge1xuXHRcdFx0XHQvLyBSaWdodCBub3cgb25seSBzZXR0aW5nIG9mIHdpZHRoL2hlaWdodCBpcyBwb3NzaWJsZVxuXHRcdFx0XHRpZiAodGFnICE9PSAnUGl4ZWxYRGltZW5zaW9uJyAmJiB0YWcgIT09ICdQaXhlbFlEaW1lbnNpb24nKSB7IHJldHVybiBmYWxzZTsgfVxuXG5cdFx0XHRcdHJldHVybiBzZXRUYWcuY2FsbCh0aGlzLCAnZXhpZicsIHRhZywgdmFsdWUpO1xuXHRcdFx0fSxcblxuXG5cdFx0XHRjbGVhcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9fc3VwZXJfXy5jbGVhcigpO1xuXHRcdFx0XHRkYXRhID0gdGFncyA9IHRhZ0Rlc2NzID0gVGlmZiA9IG9mZnNldHMgPSBfX3N1cGVyX18gPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cblx0XHQvLyBDaGVjayBpZiB0aGF0J3MgQVBQMSBhbmQgdGhhdCBpdCBoYXMgRVhJRlxuXHRcdGlmICh0aGlzLlNIT1JUKDApICE9PSAweEZGRTEgfHwgdGhpcy5TVFJJTkcoNCwgNSkudG9VcHBlckNhc2UoKSAhPT0gXCJFWElGXFwwXCIpIHtcblx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdH1cblxuXHRcdC8vIFNldCByZWFkIG9yZGVyIG9mIG11bHRpLWJ5dGUgZGF0YVxuXHRcdHRoaXMubGl0dGxlRW5kaWFuID0gKHRoaXMuU0hPUlQoaWR4KSA9PSAweDQ5NDkpO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgYWx3YXlzIHByZXNlbnQgYnl0ZXMgYXJlIGluZGVlZCBwcmVzZW50XG5cdFx0aWYgKHRoaXMuU0hPUlQoaWR4Kz0yKSAhPT0gMHgwMDJBKSB7XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5JTlZBTElEX01FVEFfRVJSKTtcblx0XHR9XG5cblx0XHRvZmZzZXRzLklGRDAgPSBvZmZzZXRzLnRpZmZIZWFkZXIgKyB0aGlzLkxPTkcoaWR4ICs9IDIpO1xuXHRcdFRpZmYgPSBleHRyYWN0VGFncy5jYWxsKHRoaXMsIG9mZnNldHMuSUZEMCwgdGFncy50aWZmKTtcblxuXHRcdGlmICgnRXhpZklGRFBvaW50ZXInIGluIFRpZmYpIHtcblx0XHRcdG9mZnNldHMuZXhpZklGRCA9IG9mZnNldHMudGlmZkhlYWRlciArIFRpZmYuRXhpZklGRFBvaW50ZXI7XG5cdFx0XHRkZWxldGUgVGlmZi5FeGlmSUZEUG9pbnRlcjtcblx0XHR9XG5cblx0XHRpZiAoJ0dQU0luZm9JRkRQb2ludGVyJyBpbiBUaWZmKSB7XG5cdFx0XHRvZmZzZXRzLmdwc0lGRCA9IG9mZnNldHMudGlmZkhlYWRlciArIFRpZmYuR1BTSW5mb0lGRFBvaW50ZXI7XG5cdFx0XHRkZWxldGUgVGlmZi5HUFNJbmZvSUZEUG9pbnRlcjtcblx0XHR9XG5cblx0XHRpZiAoQmFzaWMuaXNFbXB0eU9iaihUaWZmKSkge1xuXHRcdFx0VGlmZiA9IG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gY2hlY2sgaWYgd2UgaGF2ZSBhIHRodW1iIGFzIHdlbGxcblx0XHR2YXIgSUZEMU9mZnNldCA9IHRoaXMuTE9ORyhvZmZzZXRzLklGRDAgKyB0aGlzLlNIT1JUKG9mZnNldHMuSUZEMCkgKiAxMiArIDIpO1xuXHRcdGlmIChJRkQxT2Zmc2V0KSB7XG5cdFx0XHRvZmZzZXRzLklGRDEgPSBvZmZzZXRzLnRpZmZIZWFkZXIgKyBJRkQxT2Zmc2V0O1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gZXh0cmFjdFRhZ3MoSUZEX29mZnNldCwgdGFnczJleHRyYWN0KSB7XG5cdFx0XHR2YXIgZGF0YSA9IHRoaXM7XG5cdFx0XHR2YXIgbGVuZ3RoLCBpLCB0YWcsIHR5cGUsIGNvdW50LCBzaXplLCBvZmZzZXQsIHZhbHVlLCB2YWx1ZXMgPSBbXSwgaGFzaCA9IHt9O1xuXHRcdFx0XG5cdFx0XHR2YXIgdHlwZXMgPSB7XG5cdFx0XHRcdDEgOiAnQllURScsXG5cdFx0XHRcdDcgOiAnVU5ERUZJTkVEJyxcblx0XHRcdFx0MiA6ICdBU0NJSScsXG5cdFx0XHRcdDMgOiAnU0hPUlQnLFxuXHRcdFx0XHQ0IDogJ0xPTkcnLFxuXHRcdFx0XHQ1IDogJ1JBVElPTkFMJyxcblx0XHRcdFx0OSA6ICdTTE9ORycsXG5cdFx0XHRcdDEwOiAnU1JBVElPTkFMJ1xuXHRcdFx0fTtcblxuXHRcdFx0dmFyIHNpemVzID0ge1xuXHRcdFx0XHQnQllURScgXHRcdDogMSxcblx0XHRcdFx0J1VOREVGSU5FRCdcdDogMSxcblx0XHRcdFx0J0FTQ0lJJ1x0XHQ6IDEsXG5cdFx0XHRcdCdTSE9SVCdcdFx0OiAyLFxuXHRcdFx0XHQnTE9ORycgXHRcdDogNCxcblx0XHRcdFx0J1JBVElPTkFMJyBcdDogOCxcblx0XHRcdFx0J1NMT05HJ1x0XHQ6IDQsXG5cdFx0XHRcdCdTUkFUSU9OQUwnXHQ6IDhcblx0XHRcdH07XG5cblx0XHRcdGxlbmd0aCA9IGRhdGEuU0hPUlQoSUZEX29mZnNldCk7XG5cblx0XHRcdC8vIFRoZSBzaXplIG9mIEFQUDEgaW5jbHVkaW5nIGFsbCB0aGVzZSBlbGVtZW50cyBzaGFsbCBub3QgZXhjZWVkIHRoZSA2NCBLYnl0ZXMgc3BlY2lmaWVkIGluIHRoZSBKUEVHIHN0YW5kYXJkLlxuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFsdWVzID0gW107XG5cblx0XHRcdFx0Ly8gU2V0IGJpbmFyeSByZWFkZXIgcG9pbnRlciB0byBiZWdpbm5pbmcgb2YgdGhlIG5leHQgdGFnXG5cdFx0XHRcdG9mZnNldCA9IElGRF9vZmZzZXQgKyAyICsgaSoxMjtcblxuXHRcdFx0XHR0YWcgPSB0YWdzMmV4dHJhY3RbZGF0YS5TSE9SVChvZmZzZXQpXTtcblxuXHRcdFx0XHRpZiAodGFnID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gTm90IHRoZSB0YWcgd2UgcmVxdWVzdGVkXG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0eXBlID0gdHlwZXNbZGF0YS5TSE9SVChvZmZzZXQrPTIpXTtcblx0XHRcdFx0Y291bnQgPSBkYXRhLkxPTkcob2Zmc2V0Kz0yKTtcblx0XHRcdFx0c2l6ZSA9IHNpemVzW3R5cGVdO1xuXG5cdFx0XHRcdGlmICghc2l6ZSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0b2Zmc2V0ICs9IDQ7XG5cblx0XHRcdFx0Ly8gdGFnIGNhbiBvbmx5IGZpdCA0IGJ5dGVzIG9mIGRhdGEsIGlmIGRhdGEgaXMgbGFyZ2VyIHdlIHNob3VsZCBsb29rIG91dHNpZGVcblx0XHRcdFx0aWYgKHNpemUgKiBjb3VudCA+IDQpIHtcblx0XHRcdFx0XHQvLyBpbnN0ZWFkIG9mIGRhdGEgdGFnIGNvbnRhaW5zIGFuIG9mZnNldCBvZiB0aGUgZGF0YVxuXHRcdFx0XHRcdG9mZnNldCA9IGRhdGEuTE9ORyhvZmZzZXQpICsgb2Zmc2V0cy50aWZmSGVhZGVyO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gaW4gY2FzZSB3ZSBsZWZ0IHRoZSBib3VuZGFyaWVzIG9mIGRhdGEgdGhyb3cgYW4gZWFybHkgZXhjZXB0aW9uXG5cdFx0XHRcdGlmIChvZmZzZXQgKyBzaXplICogY291bnQgPj0gdGhpcy5sZW5ndGgoKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdFx0XHR9IFxuXG5cdFx0XHRcdC8vIHNwZWNpYWwgY2FyZSBmb3IgdGhlIHN0cmluZ1xuXHRcdFx0XHRpZiAodHlwZSA9PT0gJ0FTQ0lJJykge1xuXHRcdFx0XHRcdGhhc2hbdGFnXSA9IEJhc2ljLnRyaW0oZGF0YS5TVFJJTkcob2Zmc2V0LCBjb3VudCkucmVwbGFjZSgvXFwwJC8sICcnKSk7IC8vIHN0cmlwIHRyYWlsaW5nIE5VTExcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YWx1ZXMgPSBkYXRhLmFzQXJyYXkodHlwZSwgb2Zmc2V0LCBjb3VudCk7XG5cdFx0XHRcdFx0dmFsdWUgPSAoY291bnQgPT0gMSA/IHZhbHVlc1swXSA6IHZhbHVlcyk7XG5cblx0XHRcdFx0XHRpZiAodGFnRGVzY3MuaGFzT3duUHJvcGVydHkodGFnKSAmJiB0eXBlb2YgdmFsdWUgIT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRcdGhhc2hbdGFnXSA9IHRhZ0Rlc2NzW3RhZ11bdmFsdWVdO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRoYXNoW3RhZ10gPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGhhc2g7XG5cdFx0fVxuXG5cdFx0Ly8gQXQgdGhlIG1vbWVudCBvbmx5IHNldHRpbmcgb2Ygc2ltcGxlIChMT05HKSB2YWx1ZXMsIHRoYXQgZG8gbm90IHJlcXVpcmUgb2Zmc2V0IHJlY2FsY3VsYXRpb24sIGlzIHN1cHBvcnRlZFxuXHRcdGZ1bmN0aW9uIHNldFRhZyhpZmQsIHRhZywgdmFsdWUpIHtcblx0XHRcdHZhciBvZmZzZXQsIGxlbmd0aCwgdGFnT2Zmc2V0LCB2YWx1ZU9mZnNldCA9IDA7XG5cblx0XHRcdC8vIElmIHRhZyBuYW1lIHBhc3NlZCB0cmFuc2xhdGUgaW50byBoZXgga2V5XG5cdFx0XHRpZiAodHlwZW9mKHRhZykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdHZhciB0bXBUYWdzID0gdGFnc1tpZmQudG9Mb3dlckNhc2UoKV07XG5cdFx0XHRcdGZvciAodmFyIGhleCBpbiB0bXBUYWdzKSB7XG5cdFx0XHRcdFx0aWYgKHRtcFRhZ3NbaGV4XSA9PT0gdGFnKSB7XG5cdFx0XHRcdFx0XHR0YWcgPSBoZXg7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdG9mZnNldCA9IG9mZnNldHNbaWZkLnRvTG93ZXJDYXNlKCkgKyAnSUZEJ107XG5cdFx0XHRsZW5ndGggPSB0aGlzLlNIT1JUKG9mZnNldCk7XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFnT2Zmc2V0ID0gb2Zmc2V0ICsgMTIgKiBpICsgMjtcblxuXHRcdFx0XHRpZiAodGhpcy5TSE9SVCh0YWdPZmZzZXQpID09IHRhZykge1xuXHRcdFx0XHRcdHZhbHVlT2Zmc2V0ID0gdGFnT2Zmc2V0ICsgODtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIXZhbHVlT2Zmc2V0KSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dGhpcy53cml0ZSh2YWx1ZU9mZnNldCwgdmFsdWUsIDQpO1xuXHRcdFx0fSBjYXRjaChleCkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdEV4aWZQYXJzZXIucHJvdG90eXBlID0gQmluYXJ5UmVhZGVyLnByb3RvdHlwZTtcblxuXHRyZXR1cm4gRXhpZlBhcnNlcjtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUcuanNcblxuLyoqXG4gKiBKUEVHLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR1xuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUdcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUdIZWFkZXJzXCIsXG5cdFwibW94aWUvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXJcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0V4aWZQYXJzZXJcIlxuXSwgZnVuY3Rpb24oQmFzaWMsIHgsIEpQRUdIZWFkZXJzLCBCaW5hcnlSZWFkZXIsIEV4aWZQYXJzZXIpIHtcblx0XG5cdGZ1bmN0aW9uIEpQRUcoZGF0YSkge1xuXHRcdHZhciBfYnIsIF9obSwgX2VwLCBfaW5mbztcblxuXHRcdF9iciA9IG5ldyBCaW5hcnlSZWFkZXIoZGF0YSk7XG5cblx0XHQvLyBjaGVjayBpZiBpdCBpcyBqcGVnXG5cdFx0aWYgKF9ici5TSE9SVCgwKSAhPT0gMHhGRkQ4KSB7XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdH1cblxuXHRcdC8vIGJhY2t1cCBoZWFkZXJzXG5cdFx0X2htID0gbmV3IEpQRUdIZWFkZXJzKGRhdGEpO1xuXG5cdFx0Ly8gZXh0cmFjdCBleGlmIGluZm9cblx0XHR0cnkge1xuXHRcdFx0X2VwID0gbmV3IEV4aWZQYXJzZXIoX2htLmdldCgnYXBwMScpWzBdKTtcblx0XHR9IGNhdGNoKGV4KSB7fVxuXG5cdFx0Ly8gZ2V0IGRpbWVuc2lvbnNcblx0XHRfaW5mbyA9IF9nZXREaW1lbnNpb25zLmNhbGwodGhpcyk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0dHlwZTogJ2ltYWdlL2pwZWcnLFxuXG5cdFx0XHRzaXplOiBfYnIubGVuZ3RoKCksXG5cblx0XHRcdHdpZHRoOiBfaW5mbyAmJiBfaW5mby53aWR0aCB8fCAwLFxuXG5cdFx0XHRoZWlnaHQ6IF9pbmZvICYmIF9pbmZvLmhlaWdodCB8fCAwLFxuXG5cdFx0XHRzZXRFeGlmOiBmdW5jdGlvbih0YWcsIHZhbHVlKSB7XG5cdFx0XHRcdGlmICghX2VwKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlOyAvLyBvciB0aHJvdyBhbiBleGNlcHRpb25cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YodGFnKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRCYXNpYy5lYWNoKHRhZywgZnVuY3Rpb24odmFsdWUsIHRhZykge1xuXHRcdFx0XHRcdFx0X2VwLnNldEV4aWYodGFnLCB2YWx1ZSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0X2VwLnNldEV4aWYodGFnLCB2YWx1ZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyB1cGRhdGUgaW50ZXJuYWwgaGVhZGVyc1xuXHRcdFx0XHRfaG0uc2V0KCdhcHAxJywgX2VwLlNFR01FTlQoKSk7XG5cdFx0XHR9LFxuXG5cdFx0XHR3cml0ZUhlYWRlcnM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0XHQvLyBpZiBubyBhcmd1bWVudHMgcGFzc2VkLCB1cGRhdGUgaGVhZGVycyBpbnRlcm5hbGx5XG5cdFx0XHRcdFx0cmV0dXJuIF9obS5yZXN0b3JlKGRhdGEpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBfaG0ucmVzdG9yZShhcmd1bWVudHNbMF0pO1xuXHRcdFx0fSxcblxuXHRcdFx0c3RyaXBIZWFkZXJzOiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdHJldHVybiBfaG0uc3RyaXAoZGF0YSk7XG5cdFx0XHR9LFxuXG5cdFx0XHRwdXJnZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9wdXJnZS5jYWxsKHRoaXMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKF9lcCkge1xuXHRcdFx0dGhpcy5tZXRhID0ge1xuXHRcdFx0XHR0aWZmOiBfZXAuVElGRigpLFxuXHRcdFx0XHRleGlmOiBfZXAuRVhJRigpLFxuXHRcdFx0XHRncHM6IF9lcC5HUFMoKSxcblx0XHRcdFx0dGh1bWI6IF9nZXRUaHVtYigpXG5cdFx0XHR9O1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX2dldERpbWVuc2lvbnMoYnIpIHtcblx0XHRcdHZhciBpZHggPSAwXG5cdFx0XHQsIG1hcmtlclxuXHRcdFx0LCBsZW5ndGhcblx0XHRcdDtcblxuXHRcdFx0aWYgKCFicikge1xuXHRcdFx0XHRiciA9IF9icjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gZXhhbWluZSBhbGwgdGhyb3VnaCB0aGUgZW5kLCBzaW5jZSBzb21lIGltYWdlcyBtaWdodCBoYXZlIHZlcnkgbGFyZ2UgQVBQIHNlZ21lbnRzXG5cdFx0XHR3aGlsZSAoaWR4IDw9IGJyLmxlbmd0aCgpKSB7XG5cdFx0XHRcdG1hcmtlciA9IGJyLlNIT1JUKGlkeCArPSAyKTtcblxuXHRcdFx0XHRpZiAobWFya2VyID49IDB4RkZDMCAmJiBtYXJrZXIgPD0gMHhGRkMzKSB7IC8vIFNPRm5cblx0XHRcdFx0XHRpZHggKz0gNTsgLy8gbWFya2VyICgyIGJ5dGVzKSArIGxlbmd0aCAoMiBieXRlcykgKyBTYW1wbGUgcHJlY2lzaW9uICgxIGJ5dGUpXG5cdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdGhlaWdodDogYnIuU0hPUlQoaWR4KSxcblx0XHRcdFx0XHRcdHdpZHRoOiBici5TSE9SVChpZHggKz0gMilcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxlbmd0aCA9IGJyLlNIT1JUKGlkeCArPSAyKTtcblx0XHRcdFx0aWR4ICs9IGxlbmd0aCAtIDI7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9nZXRUaHVtYigpIHtcblx0XHRcdHZhciBkYXRhID0gIF9lcC50aHVtYigpXG5cdFx0XHQsIGJyXG5cdFx0XHQsIGluZm9cblx0XHRcdDtcblxuXHRcdFx0aWYgKGRhdGEpIHtcblx0XHRcdFx0YnIgPSBuZXcgQmluYXJ5UmVhZGVyKGRhdGEpO1xuXHRcdFx0XHRpbmZvID0gX2dldERpbWVuc2lvbnMoYnIpO1xuXHRcdFx0XHRici5jbGVhcigpO1xuXG5cdFx0XHRcdGlmIChpbmZvKSB7XG5cdFx0XHRcdFx0aW5mby5kYXRhID0gZGF0YTtcblx0XHRcdFx0XHRyZXR1cm4gaW5mbztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfcHVyZ2UoKSB7XG5cdFx0XHRpZiAoIV9lcCB8fCAhX2htIHx8ICFfYnIpIHsgXG5cdFx0XHRcdHJldHVybjsgLy8gaWdub3JlIGFueSByZXBlYXRpbmcgcHVyZ2UgcmVxdWVzdHNcblx0XHRcdH1cblx0XHRcdF9lcC5jbGVhcigpO1xuXHRcdFx0X2htLnB1cmdlKCk7XG5cdFx0XHRfYnIuY2xlYXIoKTtcblx0XHRcdF9pbmZvID0gX2htID0gX2VwID0gX2JyID0gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gSlBFRztcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL1BORy5qc1xuXG4vKipcbiAqIFBORy5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1BOR1xuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1BOR1wiLCBbXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvdXRpbHMvQmluYXJ5UmVhZGVyXCJcbl0sIGZ1bmN0aW9uKHgsIEJhc2ljLCBCaW5hcnlSZWFkZXIpIHtcblx0XG5cdGZ1bmN0aW9uIFBORyhkYXRhKSB7XG5cdFx0dmFyIF9iciwgX2htLCBfZXAsIF9pbmZvO1xuXG5cdFx0X2JyID0gbmV3IEJpbmFyeVJlYWRlcihkYXRhKTtcblxuXHRcdC8vIGNoZWNrIGlmIGl0J3MgcG5nXG5cdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGlkeCA9IDAsIGkgPSAwXG5cdFx0XHQsIHNpZ25hdHVyZSA9IFsweDg5NTAsIDB4NEU0NywgMHgwRDBBLCAweDFBMEFdXG5cdFx0XHQ7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBzaWduYXR1cmUubGVuZ3RoOyBpKyssIGlkeCArPSAyKSB7XG5cdFx0XHRcdGlmIChzaWduYXR1cmVbaV0gIT0gX2JyLlNIT1JUKGlkeCkpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSgpKTtcblxuXHRcdGZ1bmN0aW9uIF9nZXREaW1lbnNpb25zKCkge1xuXHRcdFx0dmFyIGNodW5rLCBpZHg7XG5cblx0XHRcdGNodW5rID0gX2dldENodW5rQXQuY2FsbCh0aGlzLCA4KTtcblxuXHRcdFx0aWYgKGNodW5rLnR5cGUgPT0gJ0lIRFInKSB7XG5cdFx0XHRcdGlkeCA9IGNodW5rLnN0YXJ0O1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHdpZHRoOiBfYnIuTE9ORyhpZHgpLFxuXHRcdFx0XHRcdGhlaWdodDogX2JyLkxPTkcoaWR4ICs9IDQpXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBfcHVyZ2UoKSB7XG5cdFx0XHRpZiAoIV9icikge1xuXHRcdFx0XHRyZXR1cm47IC8vIGlnbm9yZSBhbnkgcmVwZWF0aW5nIHB1cmdlIHJlcXVlc3RzXG5cdFx0XHR9XG5cdFx0XHRfYnIuY2xlYXIoKTtcblx0XHRcdGRhdGEgPSBfaW5mbyA9IF9obSA9IF9lcCA9IF9iciA9IG51bGw7XG5cdFx0fVxuXG5cdFx0X2luZm8gPSBfZ2V0RGltZW5zaW9ucy5jYWxsKHRoaXMpO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdHR5cGU6ICdpbWFnZS9wbmcnLFxuXG5cdFx0XHRzaXplOiBfYnIubGVuZ3RoKCksXG5cblx0XHRcdHdpZHRoOiBfaW5mby53aWR0aCxcblxuXHRcdFx0aGVpZ2h0OiBfaW5mby5oZWlnaHQsXG5cblx0XHRcdHB1cmdlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0X3B1cmdlLmNhbGwodGhpcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBmb3IgUE5HIHdlIGNhbiBzYWZlbHkgdHJpZ2dlciBwdXJnZSBhdXRvbWF0aWNhbGx5LCBhcyB3ZSBkbyBub3Qga2VlcCBhbnkgZGF0YSBmb3IgbGF0ZXJcblx0XHRfcHVyZ2UuY2FsbCh0aGlzKTtcblxuXHRcdGZ1bmN0aW9uIF9nZXRDaHVua0F0KGlkeCkge1xuXHRcdFx0dmFyIGxlbmd0aCwgdHlwZSwgc3RhcnQsIENSQztcblxuXHRcdFx0bGVuZ3RoID0gX2JyLkxPTkcoaWR4KTtcblx0XHRcdHR5cGUgPSBfYnIuU1RSSU5HKGlkeCArPSA0LCA0KTtcblx0XHRcdHN0YXJ0ID0gaWR4ICs9IDQ7XG5cdFx0XHRDUkMgPSBfYnIuTE9ORyhpZHggKyBsZW5ndGgpO1xuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRsZW5ndGg6IGxlbmd0aCxcblx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0c3RhcnQ6IHN0YXJ0LFxuXHRcdFx0XHRDUkM6IENSQ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gUE5HO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvaW1hZ2UvSW1hZ2VJbmZvLmpzXG5cbi8qKlxuICogSW1hZ2VJbmZvLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuT3B0aW9uYWwgaW1hZ2UgaW52ZXN0aWdhdGlvbiB0b29sIGZvciBIVE1MNSBydW50aW1lLiBQcm92aWRlcyB0aGUgZm9sbG93aW5nIGZlYXR1cmVzOlxuLSBhYmlsaXR5IHRvIGRpc3Rpbmd1aXNoIGltYWdlIHR5cGUgKEpQRUcgb3IgUE5HKSBieSBzaWduYXR1cmVcbi0gYWJpbGl0eSB0byBleHRyYWN0IGltYWdlIHdpZHRoL2hlaWdodCBkaXJlY3RseSBmcm9tIGl0J3MgaW50ZXJuYWxzLCB3aXRob3V0IHByZWxvYWRpbmcgaW4gbWVtb3J5IChmYXN0KVxuLSBhYmlsaXR5IHRvIGV4dHJhY3QgQVBQIGhlYWRlcnMgZnJvbSBKUEVHcyAoRXhpZiwgR1BTLCBldGMpXG4tIGFiaWxpdHkgdG8gcmVwbGFjZSB3aWR0aC9oZWlnaHQgdGFncyBpbiBleHRyYWN0ZWQgSlBFRyBoZWFkZXJzXG4tIGFiaWxpdHkgdG8gcmVzdG9yZSBBUFAgaGVhZGVycywgdGhhdCB3ZXJlIGZvciBleGFtcGxlIHN0cmlwcGVkIGR1cmluZyBpbWFnZSBtYW5pcHVsYXRpb25cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSW1hZ2VJbmZvXG5AcHJpdmF0ZVxuQHBhcmFtIHtTdHJpbmd9IGRhdGEgSW1hZ2Ugc291cmNlIGFzIGJpbmFyeSBzdHJpbmdcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlSW5mb1wiLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvUE5HXCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCB4LCBKUEVHLCBQTkcpIHtcblxuXHRyZXR1cm4gZnVuY3Rpb24oZGF0YSkge1xuXHRcdHZhciBfY3MgPSBbSlBFRywgUE5HXSwgX2ltZztcblxuXHRcdC8vIGZpZ3VyZSBvdXQgdGhlIGZvcm1hdCwgdGhyb3c6IEltYWdlRXJyb3IuV1JPTkdfRk9STUFUIGlmIG5vdCBzdXBwb3J0ZWRcblx0XHRfaW1nID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfY3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gbmV3IF9jc1tpXShkYXRhKTtcblx0XHRcdFx0fSBjYXRjaCAoZXgpIHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmluZm8oZXgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdH0oKSk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0LyoqXG5cdFx0XHRJbWFnZSBNaW1lIFR5cGUgZXh0cmFjdGVkIGZyb20gaXQncyBkZXB0aHNcblxuXHRcdFx0QHByb3BlcnR5IHR5cGVcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHRAZGVmYXVsdCAnJ1xuXHRcdFx0Ki9cblx0XHRcdHR5cGU6ICcnLFxuXG5cdFx0XHQvKipcblx0XHRcdEltYWdlIHNpemUgaW4gYnl0ZXNcblxuXHRcdFx0QHByb3BlcnR5IHNpemVcblx0XHRcdEB0eXBlIHtOdW1iZXJ9XG5cdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHQqL1xuXHRcdFx0c2l6ZTogMCxcblxuXHRcdFx0LyoqXG5cdFx0XHRJbWFnZSB3aWR0aCBleHRyYWN0ZWQgZnJvbSBpbWFnZSBzb3VyY2VcblxuXHRcdFx0QHByb3BlcnR5IHdpZHRoXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgMFxuXHRcdFx0Ki9cblx0XHRcdHdpZHRoOiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdEltYWdlIGhlaWdodCBleHRyYWN0ZWQgZnJvbSBpbWFnZSBzb3VyY2VcblxuXHRcdFx0QHByb3BlcnR5IGhlaWdodFxuXHRcdFx0QHR5cGUge051bWJlcn1cblx0XHRcdEBkZWZhdWx0IDBcblx0XHRcdCovXG5cdFx0XHRoZWlnaHQ6IDAsXG5cblx0XHRcdC8qKlxuXHRcdFx0U2V0cyBFeGlmIHRhZy4gQ3VycmVudGx5IGFwcGxpY2FibGUgb25seSBmb3Igd2lkdGggYW5kIGhlaWdodCB0YWdzLiBPYnZpb3VzbHkgd29ya3Mgb25seSB3aXRoIEpQRUdzLlxuXG5cdFx0XHRAbWV0aG9kIHNldEV4aWZcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSB0YWcgVGFnIHRvIHNldFxuXHRcdFx0QHBhcmFtIHtNaXhlZH0gdmFsdWUgVmFsdWUgdG8gYXNzaWduIHRvIHRoZSB0YWdcblx0XHRcdCovXG5cdFx0XHRzZXRFeGlmOiBmdW5jdGlvbigpIHt9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJlc3RvcmVzIGhlYWRlcnMgdG8gdGhlIHNvdXJjZS5cblxuXHRcdFx0QG1ldGhvZCB3cml0ZUhlYWRlcnNcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBkYXRhIEltYWdlIHNvdXJjZSBhcyBiaW5hcnkgc3RyaW5nXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IFVwZGF0ZWQgYmluYXJ5IHN0cmluZ1xuXHRcdFx0Ki9cblx0XHRcdHdyaXRlSGVhZGVyczogZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0U3RyaXAgYWxsIGhlYWRlcnMgZnJvbSB0aGUgc291cmNlLlxuXG5cdFx0XHRAbWV0aG9kIHN0cmlwSGVhZGVyc1xuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IGRhdGEgSW1hZ2Ugc291cmNlIGFzIGJpbmFyeSBzdHJpbmdcblx0XHRcdEByZXR1cm4ge1N0cmluZ30gVXBkYXRlZCBiaW5hcnkgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0c3RyaXBIZWFkZXJzOiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHREaXNwb3NlIHJlc291cmNlcy5cblxuXHRcdFx0QG1ldGhvZCBwdXJnZVxuXHRcdFx0Ki9cblx0XHRcdHB1cmdlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZGF0YSA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywgX2ltZyk7XG5cblx0XHR0aGlzLnB1cmdlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRfaW1nLnB1cmdlKCk7XG5cdFx0XHRfaW1nID0gbnVsbDtcblx0XHR9O1xuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvaW1hZ2UvUmVzaXplckNhbnZhcy5qc1xuXG4vKipcbiAqIFJlc2l6ZXJDYW52YXMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG4gKiBSZXNpemVzIGltYWdlL2NhbnZhcyB1c2luZyBjYW52YXNcbiAqL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9SZXNpemVyQ2FudmFzXCIsIFtdLCBmdW5jdGlvbigpIHtcblxuICAgIGZ1bmN0aW9uIHNjYWxlKGltYWdlLCByYXRpbywgcmVzYW1wbGUpIHtcbiAgICAgICAgdmFyIHNEID0gaW1hZ2Uud2lkdGggPiBpbWFnZS5oZWlnaHQgPyAnd2lkdGgnIDogJ2hlaWdodCc7IC8vIHRha2UgdGhlIGxhcmdlc3Qgc2lkZVxuICAgICAgICB2YXIgZEQgPSBNYXRoLnJvdW5kKGltYWdlW3NEXSAqIHJhdGlvKTtcbiAgICAgICAgdmFyIHNjYWxlQ2FwcGVkID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHJlc2FtcGxlICE9PSAnbmVhcmVzdCcgJiYgKHJhdGlvIDwgMC41IHx8IHJhdGlvID4gMikpIHtcbiAgICAgICAgICAgIHJhdGlvID0gcmF0aW8gPCAwLjUgPyAwLjUgOiAyO1xuICAgICAgICAgICAgc2NhbGVDYXBwZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHRDYW52YXMgPSBfc2NhbGUoaW1hZ2UsIHJhdGlvKTtcblxuICAgICAgICBpZiAoc2NhbGVDYXBwZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FsZSh0Q2FudmFzLCBkRCAvIHRDYW52YXNbc0RdLCByZXNhbXBsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdENhbnZhcztcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gX3NjYWxlKGltYWdlLCByYXRpbykge1xuICAgICAgICB2YXIgc1cgPSBpbWFnZS53aWR0aDtcbiAgICAgICAgdmFyIHNIID0gaW1hZ2UuaGVpZ2h0O1xuICAgICAgICB2YXIgZFcgPSBNYXRoLnJvdW5kKHNXICogcmF0aW8pO1xuICAgICAgICB2YXIgZEggPSBNYXRoLnJvdW5kKHNIICogcmF0aW8pO1xuXG4gICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgY2FudmFzLndpZHRoID0gZFc7XG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBkSDtcbiAgICAgICAgY2FudmFzLmdldENvbnRleHQoXCIyZFwiKS5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDAsIHNXLCBzSCwgMCwgMCwgZFcsIGRIKTtcblxuICAgICAgICBpbWFnZSA9IG51bGw7IC8vIGp1c3QgaW4gY2FzZVxuICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHNjYWxlOiBzY2FsZVxuICAgIH07XG5cbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlLmpzXG5cbi8qKlxuICogSW1hZ2UuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9JbWFnZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlSW5mb1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvUmVzaXplckNhbnZhc1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCB4LCBFbmNvZGUsIEJsb2IsIEZpbGUsIEltYWdlSW5mbywgUmVzaXplckNhbnZhcywgTWltZSwgRW52KSB7XG5cblx0ZnVuY3Rpb24gSFRNTDVJbWFnZSgpIHtcblx0XHR2YXIgbWUgPSB0aGlzXG5cdFx0LCBfaW1nLCBfaW1nSW5mbywgX2NhbnZhcywgX2JpblN0ciwgX2Jsb2Jcblx0XHQsIF9tb2RpZmllZCA9IGZhbHNlIC8vIGlzIHNldCB0cnVlIHdoZW5ldmVyIGltYWdlIGlzIG1vZGlmaWVkXG5cdFx0LCBfcHJlc2VydmVIZWFkZXJzID0gdHJ1ZVxuXHRcdDtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRsb2FkRnJvbUJsb2I6IGZ1bmN0aW9uKGJsb2IpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0XHQsIGFzQmluYXJ5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB0cnVlXG5cdFx0XHRcdDtcblxuXHRcdFx0XHRpZiAoIUkuY2FuKCdhY2Nlc3NfYmluYXJ5JykpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5SdW50aW1lRXJyb3IoeC5SdW50aW1lRXJyb3IuTk9UX1NVUFBPUlRFRF9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0X2Jsb2IgPSBibG9iO1xuXG5cdFx0XHRcdGlmIChibG9iLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdF9iaW5TdHIgPSBibG9iLmdldFNvdXJjZSgpO1xuXHRcdFx0XHRcdF9wcmVsb2FkLmNhbGwodGhpcywgX2JpblN0cik7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF9yZWFkQXNEYXRhVXJsLmNhbGwodGhpcywgYmxvYi5nZXRTb3VyY2UoKSwgZnVuY3Rpb24oZGF0YVVybCkge1xuXHRcdFx0XHRcdFx0aWYgKGFzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdF9iaW5TdHIgPSBfdG9CaW5hcnkoZGF0YVVybCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRfcHJlbG9hZC5jYWxsKHRoaXMsIGRhdGFVcmwpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRsb2FkRnJvbUltYWdlOiBmdW5jdGlvbihpbWcsIGV4YWN0KSB7XG5cdFx0XHRcdHRoaXMubWV0YSA9IGltZy5tZXRhO1xuXG5cdFx0XHRcdF9ibG9iID0gbmV3IEZpbGUobnVsbCwge1xuXHRcdFx0XHRcdG5hbWU6IGltZy5uYW1lLFxuXHRcdFx0XHRcdHNpemU6IGltZy5zaXplLFxuXHRcdFx0XHRcdHR5cGU6IGltZy50eXBlXG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF9wcmVsb2FkLmNhbGwodGhpcywgZXhhY3QgPyAoX2JpblN0ciA9IGltZy5nZXRBc0JpbmFyeVN0cmluZygpKSA6IGltZy5nZXRBc0RhdGFVUkwoKSk7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRJbmZvOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKSwgaW5mbztcblxuXHRcdFx0XHRpZiAoIV9pbWdJbmZvICYmIF9iaW5TdHIgJiYgSS5jYW4oJ2FjY2Vzc19pbWFnZV9iaW5hcnknKSkge1xuXHRcdFx0XHRcdF9pbWdJbmZvID0gbmV3IEltYWdlSW5mbyhfYmluU3RyKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIHRoaXMgc3R1ZmYgYmVsb3cgaXMgZGVmaW5pdGVseSBoYXZpbmcgZnVuIHdpdGggaXRzZWxmXG5cdFx0XHRcdGluZm8gPSB7XG5cdFx0XHRcdFx0d2lkdGg6IF9nZXRJbWcoKS53aWR0aCB8fCAwLFxuXHRcdFx0XHRcdGhlaWdodDogX2dldEltZygpLmhlaWdodCB8fCAwLFxuXHRcdFx0XHRcdHR5cGU6IF9ibG9iLnR5cGUgfHwgTWltZS5nZXRGaWxlTWltZShfYmxvYi5uYW1lKSxcblx0XHRcdFx0XHRzaXplOiBfYmluU3RyICYmIF9iaW5TdHIubGVuZ3RoIHx8IF9ibG9iLnNpemUgfHwgMCxcblx0XHRcdFx0XHRuYW1lOiBfYmxvYi5uYW1lIHx8ICcnLFxuXHRcdFx0XHRcdG1ldGE6IG51bGxcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRpZiAoX3ByZXNlcnZlSGVhZGVycykge1xuXHRcdFx0XHRcdGluZm8ubWV0YSA9IF9pbWdJbmZvICYmIF9pbWdJbmZvLm1ldGEgfHwgdGhpcy5tZXRhIHx8IHt9O1xuXG5cdFx0XHRcdFx0Ly8gaWYgZGF0YSB3YXMgdGFrZW4gZnJvbSBJbWFnZUluZm8gaXQgd2lsbCBiZSBhIGJpbmFyeSBzdHJpbmcsIHNvIHdlIGNvbnZlcnQgaXQgdG8gYmxvYlxuXHRcdFx0XHRcdGlmIChpbmZvLm1ldGEgJiYgaW5mby5tZXRhLnRodW1iICYmICEoaW5mby5tZXRhLnRodW1iLmRhdGEgaW5zdGFuY2VvZiBCbG9iKSkge1xuXHRcdFx0XHRcdFx0aW5mby5tZXRhLnRodW1iLmRhdGEgPSBuZXcgQmxvYihudWxsLCB7XG5cdFx0XHRcdFx0XHRcdHR5cGU6ICdpbWFnZS9qcGVnJyxcblx0XHRcdFx0XHRcdFx0ZGF0YTogaW5mby5tZXRhLnRodW1iLmRhdGFcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBpbmZvO1xuXHRcdFx0fSxcblxuXG5cdFx0XHRyZXNpemU6IGZ1bmN0aW9uKHJlY3QsIHJhdGlvLCBvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdFx0Y2FudmFzLndpZHRoID0gcmVjdC53aWR0aDtcblx0XHRcdFx0Y2FudmFzLmhlaWdodCA9IHJlY3QuaGVpZ2h0O1xuXG5cdFx0XHRcdGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKF9nZXRJbWcoKSwgcmVjdC54LCByZWN0LnksIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0LCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXG5cdFx0XHRcdF9jYW52YXMgPSBSZXNpemVyQ2FudmFzLnNjYWxlKGNhbnZhcywgcmF0aW8pO1xuXG5cdFx0XHRcdF9wcmVzZXJ2ZUhlYWRlcnMgPSBvcHRpb25zLnByZXNlcnZlSGVhZGVycztcblxuXHRcdFx0XHQvLyByb3RhdGUgaWYgcmVxdWlyZWQsIGFjY29yZGluZyB0byBvcmllbnRhdGlvbiB0YWdcblx0XHRcdFx0aWYgKCFfcHJlc2VydmVIZWFkZXJzKSB7XG5cdFx0XHRcdFx0dmFyIG9yaWVudGF0aW9uID0gKHRoaXMubWV0YSAmJiB0aGlzLm1ldGEudGlmZiAmJiB0aGlzLm1ldGEudGlmZi5PcmllbnRhdGlvbikgfHwgMTtcblx0XHRcdFx0XHRfY2FudmFzID0gX3JvdGF0ZVRvT3JpZW50YWlvbihfY2FudmFzLCBvcmllbnRhdGlvbik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLndpZHRoID0gX2NhbnZhcy53aWR0aDtcblx0XHRcdFx0dGhpcy5oZWlnaHQgPSBfY2FudmFzLmhlaWdodDtcblxuXHRcdFx0XHRfbW9kaWZpZWQgPSB0cnVlO1xuXG5cdFx0XHRcdHRoaXMudHJpZ2dlcignUmVzaXplJyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRBc0NhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghX2NhbnZhcykge1xuXHRcdFx0XHRcdF9jYW52YXMgPSBfZ2V0Q2FudmFzKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0X2NhbnZhcy5pZCA9IHRoaXMudWlkICsgJ19jYW52YXMnO1xuXHRcdFx0XHRyZXR1cm4gX2NhbnZhcztcblx0XHRcdH0sXG5cblx0XHRcdGdldEFzQmxvYjogZnVuY3Rpb24odHlwZSwgcXVhbGl0eSkge1xuXHRcdFx0XHRpZiAodHlwZSAhPT0gdGhpcy50eXBlKSB7XG5cdFx0XHRcdFx0X21vZGlmaWVkID0gdHJ1ZTsgLy8gcmVjb25zaWRlciB0aGUgc3RhdGVcblx0XHRcdFx0XHRyZXR1cm4gbmV3IEZpbGUobnVsbCwge1xuXHRcdFx0XHRcdFx0bmFtZTogX2Jsb2IubmFtZSB8fCAnJyxcblx0XHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0XHRkYXRhOiBtZS5nZXRBc0RhdGFVUkwodHlwZSwgcXVhbGl0eSlcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbmV3IEZpbGUobnVsbCwge1xuXHRcdFx0XHRcdG5hbWU6IF9ibG9iLm5hbWUgfHwgJycsXG5cdFx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0XHRkYXRhOiBtZS5nZXRBc0JpbmFyeVN0cmluZyh0eXBlLCBxdWFsaXR5KVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cblx0XHRcdGdldEFzRGF0YVVSTDogZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0XHR2YXIgcXVhbGl0eSA9IGFyZ3VtZW50c1sxXSB8fCA5MDtcblxuXHRcdFx0XHQvLyBpZiBpbWFnZSBoYXMgbm90IGJlZW4gbW9kaWZpZWQsIHJldHVybiB0aGUgc291cmNlIHJpZ2h0IGF3YXlcblx0XHRcdFx0aWYgKCFfbW9kaWZpZWQpIHtcblx0XHRcdFx0XHRyZXR1cm4gX2ltZy5zcmM7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBtYWtlIHN1cmUgd2UgaGF2ZSBhIGNhbnZhcyB0byB3b3JrIHdpdGhcblx0XHRcdFx0X2dldENhbnZhcygpO1xuXG5cdFx0XHRcdGlmICgnaW1hZ2UvanBlZycgIT09IHR5cGUpIHtcblx0XHRcdFx0XHRyZXR1cm4gX2NhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3BuZycpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHQvLyBvbGRlciBHZWNrb3MgdXNlZCB0byByZXN1bHQgaW4gYW4gZXhjZXB0aW9uIG9uIHF1YWxpdHkgYXJndW1lbnRcblx0XHRcdFx0XHRcdHJldHVybiBfY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvanBlZycsIHF1YWxpdHkvMTAwKTtcblx0XHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIF9jYW52YXMudG9EYXRhVVJMKCdpbWFnZS9qcGVnJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRBc0JpbmFyeVN0cmluZzogZnVuY3Rpb24odHlwZSwgcXVhbGl0eSkge1xuXHRcdFx0XHQvLyBpZiBpbWFnZSBoYXMgbm90IGJlZW4gbW9kaWZpZWQsIHJldHVybiB0aGUgc291cmNlIHJpZ2h0IGF3YXlcblx0XHRcdFx0aWYgKCFfbW9kaWZpZWQpIHtcblx0XHRcdFx0XHQvLyBpZiBpbWFnZSB3YXMgbm90IGxvYWRlZCBmcm9tIGJpbmFyeSBzdHJpbmdcblx0XHRcdFx0XHRpZiAoIV9iaW5TdHIpIHtcblx0XHRcdFx0XHRcdF9iaW5TdHIgPSBfdG9CaW5hcnkobWUuZ2V0QXNEYXRhVVJMKHR5cGUsIHF1YWxpdHkpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIF9iaW5TdHI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoJ2ltYWdlL2pwZWcnICE9PSB0eXBlKSB7XG5cdFx0XHRcdFx0X2JpblN0ciA9IF90b0JpbmFyeShtZS5nZXRBc0RhdGFVUkwodHlwZSwgcXVhbGl0eSkpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBkYXRhVXJsO1xuXG5cdFx0XHRcdFx0Ly8gaWYganBlZ1xuXHRcdFx0XHRcdGlmICghcXVhbGl0eSkge1xuXHRcdFx0XHRcdFx0cXVhbGl0eSA9IDkwO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB3ZSBoYXZlIGEgY2FudmFzIHRvIHdvcmsgd2l0aFxuXHRcdFx0XHRcdF9nZXRDYW52YXMoKTtcblxuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHQvLyBvbGRlciBHZWNrb3MgdXNlZCB0byByZXN1bHQgaW4gYW4gZXhjZXB0aW9uIG9uIHF1YWxpdHkgYXJndW1lbnRcblx0XHRcdFx0XHRcdGRhdGFVcmwgPSBfY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvanBlZycsIHF1YWxpdHkvMTAwKTtcblx0XHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdFx0ZGF0YVVybCA9IF9jYW52YXMudG9EYXRhVVJMKCdpbWFnZS9qcGVnJyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0X2JpblN0ciA9IF90b0JpbmFyeShkYXRhVXJsKTtcblxuXHRcdFx0XHRcdGlmIChfaW1nSW5mbykge1xuXHRcdFx0XHRcdFx0X2JpblN0ciA9IF9pbWdJbmZvLnN0cmlwSGVhZGVycyhfYmluU3RyKTtcblxuXHRcdFx0XHRcdFx0aWYgKF9wcmVzZXJ2ZUhlYWRlcnMpIHtcblx0XHRcdFx0XHRcdFx0Ly8gdXBkYXRlIGRpbWVuc2lvbnMgaW5mbyBpbiBleGlmXG5cdFx0XHRcdFx0XHRcdGlmIChfaW1nSW5mby5tZXRhICYmIF9pbWdJbmZvLm1ldGEuZXhpZikge1xuXHRcdFx0XHRcdFx0XHRcdF9pbWdJbmZvLnNldEV4aWYoe1xuXHRcdFx0XHRcdFx0XHRcdFx0UGl4ZWxYRGltZW5zaW9uOiB0aGlzLndpZHRoLFxuXHRcdFx0XHRcdFx0XHRcdFx0UGl4ZWxZRGltZW5zaW9uOiB0aGlzLmhlaWdodFxuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0Ly8gcmUtaW5qZWN0IHRoZSBoZWFkZXJzXG5cdFx0XHRcdFx0XHRcdF9iaW5TdHIgPSBfaW1nSW5mby53cml0ZUhlYWRlcnMoX2JpblN0cik7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIHdpbGwgYmUgcmUtY3JlYXRlZCBmcm9tIGZyZXNoIG9uIG5leHQgZ2V0SW5mbyBjYWxsXG5cdFx0XHRcdFx0XHRfaW1nSW5mby5wdXJnZSgpO1xuXHRcdFx0XHRcdFx0X2ltZ0luZm8gPSBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdF9tb2RpZmllZCA9IGZhbHNlO1xuXG5cdFx0XHRcdHJldHVybiBfYmluU3RyO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdG1lID0gbnVsbDtcblx0XHRcdFx0X3B1cmdlLmNhbGwodGhpcyk7XG5cdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblxuXHRcdGZ1bmN0aW9uIF9nZXRJbWcoKSB7XG5cdFx0XHRpZiAoIV9jYW52YXMgJiYgIV9pbWcpIHtcblx0XHRcdFx0dGhyb3cgbmV3IHguSW1hZ2VFcnJvcih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gX2NhbnZhcyB8fCBfaW1nO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX2dldENhbnZhcygpIHtcblx0XHRcdHZhciBjYW52YXMgPSBfZ2V0SW1nKCk7XG5cdFx0XHRpZiAoY2FudmFzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2NhbnZhcycpIHtcblx0XHRcdFx0cmV0dXJuIGNhbnZhcztcblx0XHRcdH1cblx0XHRcdF9jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdF9jYW52YXMud2lkdGggPSBjYW52YXMud2lkdGg7XG5cdFx0XHRfY2FudmFzLmhlaWdodCA9IGNhbnZhcy5oZWlnaHQ7XG5cdFx0XHRfY2FudmFzLmdldENvbnRleHQoXCIyZFwiKS5kcmF3SW1hZ2UoY2FudmFzLCAwLCAwKTtcblx0XHRcdHJldHVybiBfY2FudmFzO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3RvQmluYXJ5KHN0cikge1xuXHRcdFx0cmV0dXJuIEVuY29kZS5hdG9iKHN0ci5zdWJzdHJpbmcoc3RyLmluZGV4T2YoJ2Jhc2U2NCwnKSArIDcpKTtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF90b0RhdGFVcmwoc3RyLCB0eXBlKSB7XG5cdFx0XHRyZXR1cm4gJ2RhdGE6JyArICh0eXBlIHx8ICcnKSArICc7YmFzZTY0LCcgKyBFbmNvZGUuYnRvYShzdHIpO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3ByZWxvYWQoc3RyKSB7XG5cdFx0XHR2YXIgY29tcCA9IHRoaXM7XG5cblx0XHRcdF9pbWcgPSBuZXcgSW1hZ2UoKTtcblx0XHRcdF9pbWcub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfcHVyZ2UuY2FsbCh0aGlzKTtcblx0XHRcdFx0Y29tcC50cmlnZ2VyKCdlcnJvcicsIHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0fTtcblx0XHRcdF9pbWcub25sb2FkID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNvbXAudHJpZ2dlcignbG9hZCcpO1xuXHRcdFx0fTtcblxuXHRcdFx0X2ltZy5zcmMgPSBzdHIuc3Vic3RyKDAsIDUpID09ICdkYXRhOicgPyBzdHIgOiBfdG9EYXRhVXJsKHN0ciwgX2Jsb2IudHlwZSk7XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfcmVhZEFzRGF0YVVybChmaWxlLCBjYWxsYmFjaykge1xuXHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBmcjtcblxuXHRcdFx0Ly8gdXNlIEZpbGVSZWFkZXIgaWYgaXQncyBhdmFpbGFibGVcblx0XHRcdGlmICh3aW5kb3cuRmlsZVJlYWRlcikge1xuXHRcdFx0XHRmciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0XHRcdGZyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNhbGxiYWNrLmNhbGwoY29tcCwgdGhpcy5yZXN1bHQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRmci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdlcnJvcicsIHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRmci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrLmNhbGwodGhpcywgZmlsZS5nZXRBc0RhdGFVUkwoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG5cdFx0KiBUcmFuc2Zvcm0gY2FudmFzIGNvb3JkaW5hdGlvbiBhY2NvcmRpbmcgdG8gc3BlY2lmaWVkIGZyYW1lIHNpemUgYW5kIG9yaWVudGF0aW9uXG5cdFx0KiBPcmllbnRhdGlvbiB2YWx1ZSBpcyBmcm9tIEVYSUYgdGFnXG5cdFx0KiBAYXV0aG9yIFNoaW5pY2hpIFRvbWl0YSA8c2hpbmljaGkudG9taXRhQGdtYWlsLmNvbT5cblx0XHQqL1xuXHRcdGZ1bmN0aW9uIF9yb3RhdGVUb09yaWVudGFpb24oaW1nLCBvcmllbnRhdGlvbikge1xuXHRcdFx0dmFyIFJBRElBTlMgPSBNYXRoLlBJLzE4MDtcblx0XHRcdHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblx0XHRcdHZhciB3aWR0aCA9IGltZy53aWR0aDtcblx0XHRcdHZhciBoZWlnaHQgPSBpbWcuaGVpZ2h0O1xuXG5cdFx0XHRpZiAoQmFzaWMuaW5BcnJheShvcmllbnRhdGlvbiwgWzUsNiw3LDhdKSA+IC0xKSB7XG5cdFx0XHRcdGNhbnZhcy53aWR0aCA9IGhlaWdodDtcblx0XHRcdFx0Y2FudmFzLmhlaWdodCA9IHdpZHRoO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FudmFzLndpZHRoID0gd2lkdGg7XG5cdFx0XHRcdGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0MSA9IFRoZSAwdGggcm93IGlzIGF0IHRoZSB2aXN1YWwgdG9wIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUuXG5cdFx0XHQyID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCB0b3Agb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUuXG5cdFx0XHQzID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCBib3R0b20gb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUuXG5cdFx0XHQ0ID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCBib3R0b20gb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCBsZWZ0LWhhbmQgc2lkZS5cblx0XHRcdDUgPSBUaGUgMHRoIHJvdyBpcyB0aGUgdmlzdWFsIGxlZnQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgdG9wLlxuXHRcdFx0NiA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgcmlnaHQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgdG9wLlxuXHRcdFx0NyA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgcmlnaHQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgYm90dG9tLlxuXHRcdFx0OCA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUgb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCBib3R0b20uXG5cdFx0XHQqL1xuXHRcdFx0c3dpdGNoIChvcmllbnRhdGlvbikge1xuXHRcdFx0XHRjYXNlIDI6XG5cdFx0XHRcdFx0Ly8gaG9yaXpvbnRhbCBmbGlwXG5cdFx0XHRcdFx0Y3R4LnRyYW5zbGF0ZSh3aWR0aCwgMCk7XG5cdFx0XHRcdFx0Y3R4LnNjYWxlKC0xLCAxKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAzOlxuXHRcdFx0XHRcdC8vIDE4MCByb3RhdGUgbGVmdFxuXHRcdFx0XHRcdGN0eC50cmFuc2xhdGUod2lkdGgsIGhlaWdodCk7XG5cdFx0XHRcdFx0Y3R4LnJvdGF0ZSgxODAgKiBSQURJQU5TKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSA0OlxuXHRcdFx0XHRcdC8vIHZlcnRpY2FsIGZsaXBcblx0XHRcdFx0XHRjdHgudHJhbnNsYXRlKDAsIGhlaWdodCk7XG5cdFx0XHRcdFx0Y3R4LnNjYWxlKDEsIC0xKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSA1OlxuXHRcdFx0XHRcdC8vIHZlcnRpY2FsIGZsaXAgKyA5MCByb3RhdGUgcmlnaHRcblx0XHRcdFx0XHRjdHgucm90YXRlKDkwICogUkFESUFOUyk7XG5cdFx0XHRcdFx0Y3R4LnNjYWxlKDEsIC0xKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSA2OlxuXHRcdFx0XHRcdC8vIDkwIHJvdGF0ZSByaWdodFxuXHRcdFx0XHRcdGN0eC5yb3RhdGUoOTAgKiBSQURJQU5TKTtcblx0XHRcdFx0XHRjdHgudHJhbnNsYXRlKDAsIC1oZWlnaHQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIDc6XG5cdFx0XHRcdFx0Ly8gaG9yaXpvbnRhbCBmbGlwICsgOTAgcm90YXRlIHJpZ2h0XG5cdFx0XHRcdFx0Y3R4LnJvdGF0ZSg5MCAqIFJBRElBTlMpO1xuXHRcdFx0XHRcdGN0eC50cmFuc2xhdGUod2lkdGgsIC1oZWlnaHQpO1xuXHRcdFx0XHRcdGN0eC5zY2FsZSgtMSwgMSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgODpcblx0XHRcdFx0XHQvLyA5MCByb3RhdGUgbGVmdFxuXHRcdFx0XHRcdGN0eC5yb3RhdGUoLTkwICogUkFESUFOUyk7XG5cdFx0XHRcdFx0Y3R4LnRyYW5zbGF0ZSgtd2lkdGgsIDApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHRjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cdFx0XHRyZXR1cm4gY2FudmFzO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3B1cmdlKCkge1xuXHRcdFx0aWYgKF9pbWdJbmZvKSB7XG5cdFx0XHRcdF9pbWdJbmZvLnB1cmdlKCk7XG5cdFx0XHRcdF9pbWdJbmZvID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0X2JpblN0ciA9IF9pbWcgPSBfY2FudmFzID0gX2Jsb2IgPSBudWxsO1xuXHRcdFx0X21vZGlmaWVkID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkltYWdlID0gSFRNTDVJbWFnZSk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC9SdW50aW1lLmpzXG5cbi8qKlxuICogUnVudGltZS5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKmdsb2JhbCBBY3RpdmVYT2JqZWN0OnRydWUgKi9cblxuLyoqXG5EZWZpbmVzIGNvbnN0cnVjdG9yIGZvciBGbGFzaCBydW50aW1lLlxuXG5AY2xhc3MgbW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIlxuXSwgZnVuY3Rpb24oQmFzaWMsIEVudiwgRG9tLCB4LCBSdW50aW1lKSB7XG5cdFxuXHR2YXIgdHlwZSA9ICdmbGFzaCcsIGV4dGVuc2lvbnMgPSB7fTtcblxuXHQvKipcblx0R2V0IHRoZSB2ZXJzaW9uIG9mIHRoZSBGbGFzaCBQbGF5ZXJcblxuXHRAbWV0aG9kIGdldFNoaW1WZXJzaW9uXG5cdEBwcml2YXRlXG5cdEByZXR1cm4ge051bWJlcn0gRmxhc2ggUGxheWVyIHZlcnNpb25cblx0Ki9cblx0ZnVuY3Rpb24gZ2V0U2hpbVZlcnNpb24oKSB7XG5cdFx0dmFyIHZlcnNpb247XG5cblx0XHR0cnkge1xuXHRcdFx0dmVyc2lvbiA9IG5hdmlnYXRvci5wbHVnaW5zWydTaG9ja3dhdmUgRmxhc2gnXTtcblx0XHRcdHZlcnNpb24gPSB2ZXJzaW9uLmRlc2NyaXB0aW9uO1xuXHRcdH0gY2F0Y2ggKGUxKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR2ZXJzaW9uID0gbmV3IEFjdGl2ZVhPYmplY3QoJ1Nob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoJykuR2V0VmFyaWFibGUoJyR2ZXJzaW9uJyk7XG5cdFx0XHR9IGNhdGNoIChlMikge1xuXHRcdFx0XHR2ZXJzaW9uID0gJzAuMCc7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHZlcnNpb24gPSB2ZXJzaW9uLm1hdGNoKC9cXGQrL2cpO1xuXHRcdHJldHVybiBwYXJzZUZsb2F0KHZlcnNpb25bMF0gKyAnLicgKyB2ZXJzaW9uWzFdKTtcblx0fVxuXG5cblx0LyoqXG5cdENyb3NzLWJyb3dzZXIgU1dGIHJlbW92YWxcbiAgICBcdC0gRXNwZWNpYWxseSBuZWVkZWQgdG8gc2FmZWx5IGFuZCBjb21wbGV0ZWx5IHJlbW92ZSBhIFNXRiBpbiBJbnRlcm5ldCBFeHBsb3JlclxuXG4gICBcdE9yaWdpbmF0ZWQgZnJvbSBTV0ZPYmplY3QgdjIuMiA8aHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3N3Zm9iamVjdC8+IFxuXHQqL1xuXHRmdW5jdGlvbiByZW1vdmVTV0YoaWQpIHtcbiAgICAgICAgdmFyIG9iaiA9IERvbS5nZXQoaWQpO1xuICAgICAgICBpZiAob2JqICYmIG9iai5ub2RlTmFtZSA9PSBcIk9CSkVDVFwiKSB7XG4gICAgICAgICAgICBpZiAoRW52LmJyb3dzZXIgPT09ICdJRScpIHtcbiAgICAgICAgICAgICAgICBvYmouc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgICAgIChmdW5jdGlvbiBvbkluaXQoKXtcbiAgICAgICAgICAgICAgICBcdC8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9tczUzNDM2MCh2PXZzLjg1KS5hc3B4XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmoucmVhZHlTdGF0ZSA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVPYmplY3RJbklFKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQob25Jbml0LCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuXG5cdGZ1bmN0aW9uIHJlbW92ZU9iamVjdEluSUUoaWQpIHtcbiAgICAgICAgdmFyIG9iaiA9IERvbS5nZXQoaWQpO1xuICAgICAgICBpZiAob2JqKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIG9iaikge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb2JqW2ldID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBvYmpbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9iai5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG9iaik7XG4gICAgICAgIH1cbiAgICB9XG5cblx0LyoqXG5cdENvbnN0cnVjdG9yIGZvciB0aGUgRmxhc2ggUnVudGltZVxuXHQqL1xuXHRmdW5jdGlvbiBGbGFzaFJ1bnRpbWUob3B0aW9ucykge1xuXHRcdHZhciBJID0gdGhpcywgaW5pdFRpbWVyO1xuXG5cdFx0b3B0aW9ucyA9IEJhc2ljLmV4dGVuZCh7IHN3Zl91cmw6IEVudi5zd2ZfdXJsIH0sIG9wdGlvbnMpO1xuXG5cdFx0UnVudGltZS5jYWxsKHRoaXMsIG9wdGlvbnMsIHR5cGUsIHtcblx0XHRcdGFjY2Vzc19iaW5hcnk6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0ZGlzcGxheV9tZWRpYTogUnVudGltZS5jYXBUZXN0KGRlZmluZWQoJ21veGllL2ltYWdlL0ltYWdlJykpLFxuXHRcdFx0ZG9fY29yczogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0ZHJhZ19hbmRfZHJvcDogZmFsc2UsXG5cdFx0XHRyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0cmVzaXplX2ltYWdlOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRyZXR1cm5fcmVzcG9uc2VfaGVhZGVyczogZmFsc2UsXG5cdFx0XHRyZXR1cm5fcmVzcG9uc2VfdHlwZTogZnVuY3Rpb24ocmVzcG9uc2VUeXBlKSB7XG5cdFx0XHRcdGlmIChyZXNwb25zZVR5cGUgPT09ICdqc29uJyAmJiAhIXdpbmRvdy5KU09OKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH0gXG5cdFx0XHRcdHJldHVybiAhQmFzaWMuYXJyYXlEaWZmKHJlc3BvbnNlVHlwZSwgWycnLCAndGV4dCcsICdkb2N1bWVudCddKSB8fCBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IGZ1bmN0aW9uKGNvZGUpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2Jyb3dzZXInIHx8ICFCYXNpYy5hcnJheURpZmYoY29kZSwgWzIwMCwgNDA0XSk7XG5cdFx0XHR9LFxuXHRcdFx0c2VsZWN0X2ZpbGU6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNlbGVjdF9tdWx0aXBsZTogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0c2VuZF9iaW5hcnlfc3RyaW5nOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9icm93c2VyX2Nvb2tpZXM6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9tdWx0aXBhcnQ6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNsaWNlX2Jsb2I6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRzdHJlYW1fdXBsb2FkOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c3VtbW9uX2ZpbGVfZGlhbG9nOiBmYWxzZSxcblx0XHRcdHVwbG9hZF9maWxlc2l6ZTogZnVuY3Rpb24oc2l6ZSkge1xuXHRcdFx0XHRyZXR1cm4gQmFzaWMucGFyc2VTaXplU3RyKHNpemUpIDw9IDIwOTcxNTIgfHwgSS5tb2RlID09PSAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuICFCYXNpYy5hcnJheURpZmYobWV0aG9kcywgWydHRVQnLCAnUE9TVCddKTtcblx0XHRcdH1cblx0XHR9LCB7IFxuXHRcdFx0Ly8gY2FwYWJpbGl0aWVzIHRoYXQgcmVxdWlyZSBzcGVjaWZpYyBtb2RlXG5cdFx0XHRhY2Nlc3NfYmluYXJ5OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fcmVzcG9uc2VfdHlwZTogZnVuY3Rpb24ocmVzcG9uc2VUeXBlKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5hcnJheURpZmYocmVzcG9uc2VUeXBlLCBbJycsICd0ZXh0JywgJ2pzb24nLCAnZG9jdW1lbnQnXSkgPyAnYnJvd3NlcicgOiBbJ2NsaWVudCcsICdicm93c2VyJ107XG5cdFx0XHR9LFxuXHRcdFx0cmV0dXJuX3N0YXR1c19jb2RlOiBmdW5jdGlvbihjb2RlKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5hcnJheURpZmYoY29kZSwgWzIwMCwgNDA0XSkgPyAnYnJvd3NlcicgOiBbJ2NsaWVudCcsICdicm93c2VyJ107XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9iaW5hcnlfc3RyaW5nOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRzZW5kX2Jyb3dzZXJfY29va2llczogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2Jyb3dzZXInIDogJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9jdXN0b21faGVhZGVyczogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2Jyb3dzZXInIDogJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c2xpY2VfYmxvYjogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2Jyb3dzZXInIDogJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c3RyZWFtX3VwbG9hZDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2NsaWVudCcgOiAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0dXBsb2FkX2ZpbGVzaXplOiBmdW5jdGlvbihzaXplKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5wYXJzZVNpemVTdHIoc2l6ZSkgPj0gMjA5NzE1MiA/ICdjbGllbnQnIDogJ2Jyb3dzZXInO1xuXHRcdFx0fVxuXHRcdH0sICdjbGllbnQnKTtcblxuXG5cdFx0Ly8gbWluaW1hbCByZXF1aXJlbWVudCBmb3IgRmxhc2ggUGxheWVyIHZlcnNpb25cblx0XHRpZiAoZ2V0U2hpbVZlcnNpb24oKSA8IDExLjMpIHtcblx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0RW52LmxvZyhcIlxcdEZsYXNoIGRpZG4ndCBtZWV0IG1pbmltYWwgdmVyc2lvbiByZXF1aXJlbWVudCAoMTEuMykuXCIpO1x0XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMubW9kZSA9IGZhbHNlOyAvLyB3aXRoIGZhbHN5IG1vZGUsIHJ1bnRpbWUgd29uJ3Qgb3BlcmFibGUsIG5vIG1hdHRlciB3aGF0IHRoZSBtb2RlIHdhcyBiZWZvcmVcblx0XHR9XG5cblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cblx0XHRcdGdldFNoaW06IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gRG9tLmdldCh0aGlzLnVpZCk7XG5cdFx0XHR9LFxuXG5cdFx0XHRzaGltRXhlYzogZnVuY3Rpb24oY29tcG9uZW50LCBhY3Rpb24pIHtcblx0XHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG5cdFx0XHRcdHJldHVybiBJLmdldFNoaW0oKS5leGVjKHRoaXMudWlkLCBjb21wb25lbnQsIGFjdGlvbiwgYXJncyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRpbml0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGh0bWwsIGVsLCBjb250YWluZXI7XG5cblx0XHRcdFx0Y29udGFpbmVyID0gdGhpcy5nZXRTaGltQ29udGFpbmVyKCk7XG5cblx0XHRcdFx0Ly8gaWYgbm90IHRoZSBtaW5pbWFsIGhlaWdodCwgc2hpbXMgYXJlIG5vdCBpbml0aWFsaXplZCBpbiBvbGRlciBicm93c2VycyAoZS5nIEZGMy42LCBJRTYsNyw4LCBTYWZhcmkgNC4wLDUuMCwgZXRjKVxuXHRcdFx0XHRCYXNpYy5leHRlbmQoY29udGFpbmVyLnN0eWxlLCB7XG5cdFx0XHRcdFx0cG9zaXRpb246ICdhYnNvbHV0ZScsXG5cdFx0XHRcdFx0dG9wOiAnLThweCcsXG5cdFx0XHRcdFx0bGVmdDogJy04cHgnLFxuXHRcdFx0XHRcdHdpZHRoOiAnOXB4Jyxcblx0XHRcdFx0XHRoZWlnaHQ6ICc5cHgnLFxuXHRcdFx0XHRcdG92ZXJmbG93OiAnaGlkZGVuJ1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBpbnNlcnQgZmxhc2ggb2JqZWN0XG5cdFx0XHRcdGh0bWwgPSAnPG9iamVjdCBpZD1cIicgKyB0aGlzLnVpZCArICdcIiB0eXBlPVwiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2hcIiBkYXRhPVwiJyArICBvcHRpb25zLnN3Zl91cmwgKyAnXCIgJztcblxuXHRcdFx0XHRpZiAoRW52LmJyb3dzZXIgPT09ICdJRScpIHtcblx0XHRcdFx0XHRodG1sICs9ICdjbGFzc2lkPVwiY2xzaWQ6ZDI3Y2RiNmUtYWU2ZC0xMWNmLTk2YjgtNDQ0NTUzNTQwMDAwXCIgJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGh0bWwgKz0gJ3dpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiBzdHlsZT1cIm91dGxpbmU6MFwiPicgICtcblx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJtb3ZpZVwiIHZhbHVlPVwiJyArIG9wdGlvbnMuc3dmX3VybCArICdcIiAvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cImZsYXNodmFyc1wiIHZhbHVlPVwidWlkPScgKyBlc2NhcGUodGhpcy51aWQpICsgJyZ0YXJnZXQ9JyArIFJ1bnRpbWUuZ2V0R2xvYmFsRXZlbnRUYXJnZXQoKSArICdcIiAvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cIndtb2RlXCIgdmFsdWU9XCJ0cmFuc3BhcmVudFwiIC8+JyArXG5cdFx0XHRcdFx0JzxwYXJhbSBuYW1lPVwiYWxsb3dzY3JpcHRhY2Nlc3NcIiB2YWx1ZT1cImFsd2F5c1wiIC8+JyArXG5cdFx0XHRcdCc8L29iamVjdD4nO1xuXG5cdFx0XHRcdGlmIChFbnYuYnJvd3NlciA9PT0gJ0lFJykge1xuXHRcdFx0XHRcdGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRcdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKGVsKTtcblx0XHRcdFx0XHRlbC5vdXRlckhUTUwgPSBodG1sO1xuXHRcdFx0XHRcdGVsID0gY29udGFpbmVyID0gbnVsbDsgLy8ganVzdCBpbiBjYXNlXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udGFpbmVyLmlubmVySFRNTCA9IGh0bWw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBJbml0IGlzIGRpc3BhdGNoZWQgYnkgdGhlIHNoaW1cblx0XHRcdFx0aW5pdFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoSSAmJiAhSS5pbml0aWFsaXplZCkgeyAvLyBydW50aW1lIG1pZ2h0IGJlIGFscmVhZHkgZGVzdHJveWVkIGJ5IHRoaXMgbW9tZW50XG5cdFx0XHRcdFx0XHRJLnRyaWdnZXIoXCJFcnJvclwiLCBuZXcgeC5SdW50aW1lRXJyb3IoeC5SdW50aW1lRXJyb3IuTk9UX0lOSVRfRVJSKSk7XG5cblx0XHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0RW52LmxvZyhcIlxcdEZsYXNoIGZhaWxlZCB0byBpbml0aWFsaXplIHdpdGhpbiBhIHNwZWNpZmllZCBwZXJpb2Qgb2YgdGltZSAodHlwaWNhbGx5IDVzKS5cIik7XHRcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIDUwMDApO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogKGZ1bmN0aW9uKGRlc3Ryb3kpIHsgLy8gZXh0ZW5kIGRlZmF1bHQgZGVzdHJveSBtZXRob2Rcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHJlbW92ZVNXRihJLnVpZCk7IC8vIFNXRiByZW1vdmFsIHJlcXVpcmVzIHNwZWNpYWwgY2FyZSBpbiBJRVxuXG5cdFx0XHRcdFx0ZGVzdHJveS5jYWxsKEkpO1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dChpbml0VGltZXIpOyAvLyBpbml0aWFsaXphdGlvbiBjaGVjayBtaWdodCBiZSBzdGlsbCBvbndhaXRcblx0XHRcdFx0XHRvcHRpb25zID0gaW5pdFRpbWVyID0gZGVzdHJveSA9IEkgPSBudWxsO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSh0aGlzLmRlc3Ryb3kpKVxuXG5cdFx0fSwgZXh0ZW5zaW9ucyk7XG5cdH1cblxuXHRSdW50aW1lLmFkZENvbnN0cnVjdG9yKHR5cGUsIEZsYXNoUnVudGltZSk7XG5cblx0cmV0dXJuIGV4dGVuc2lvbnM7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC9maWxlL0Jsb2IuanNcblxuLyoqXG4gKiBCbG9iLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9CbG9iXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9CbG9iXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL1J1bnRpbWVcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmxvYikge1xuXG5cdHZhciBGbGFzaEJsb2IgPSB7XG5cdFx0c2xpY2U6IGZ1bmN0aW9uKGJsb2IsIHN0YXJ0LCBlbmQsIHR5cGUpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKCk7XG5cblx0XHRcdGlmIChzdGFydCA8IDApIHtcblx0XHRcdFx0c3RhcnQgPSBNYXRoLm1heChibG9iLnNpemUgKyBzdGFydCwgMCk7XG5cdFx0XHR9IGVsc2UgaWYgKHN0YXJ0ID4gMCkge1xuXHRcdFx0XHRzdGFydCA9IE1hdGgubWluKHN0YXJ0LCBibG9iLnNpemUpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZW5kIDwgMCkge1xuXHRcdFx0XHRlbmQgPSBNYXRoLm1heChibG9iLnNpemUgKyBlbmQsIDApO1xuXHRcdFx0fSBlbHNlIGlmIChlbmQgPiAwKSB7XG5cdFx0XHRcdGVuZCA9IE1hdGgubWluKGVuZCwgYmxvYi5zaXplKTtcblx0XHRcdH1cblxuXHRcdFx0YmxvYiA9IHNlbGYuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnQmxvYicsICdzbGljZScsIHN0YXJ0LCBlbmQsIHR5cGUgfHwgJycpO1xuXG5cdFx0XHRpZiAoYmxvYikge1xuXHRcdFx0XHRibG9iID0gbmV3IEJsb2Ioc2VsZi51aWQsIGJsb2IpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGJsb2I7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5CbG9iID0gRmxhc2hCbG9iKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlSW5wdXRcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVJbnB1dFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEZpbGUsIERvbSwgQmFzaWMpIHtcblxuXHR2YXIgRmlsZUlucHV0ID0ge1xuXHRcdGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcywgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0dmFyIGJyb3dzZUJ1dHRvbiA9IERvbS5nZXQob3B0aW9ucy5icm93c2VfYnV0dG9uKTtcblxuXHRcdFx0aWYgKGJyb3dzZUJ1dHRvbikge1xuXHRcdFx0XHRicm93c2VCdXR0b24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcblx0XHRcdFx0YnJvd3NlQnV0dG9uID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5iaW5kKFwiQ2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZmlsZXMgPSBJLnNoaW1FeGVjLmNhbGwoY29tcCwgJ0ZpbGVJbnB1dCcsICdnZXRGaWxlcycpO1xuXHRcdFx0XHRjb21wLmZpbGVzID0gW107XG5cdFx0XHRcdEJhc2ljLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGZpbGUpIHtcblx0XHRcdFx0XHRjb21wLmZpbGVzLnB1c2gobmV3IEZpbGUoSS51aWQsIGZpbGUpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9LCA5OTkpO1xuXG5cdFx0XHR0aGlzLmdldFJ1bnRpbWUoKS5zaGltRXhlYy5jYWxsKHRoaXMsICdGaWxlSW5wdXQnLCAnaW5pdCcsIHtcblx0XHRcdFx0YWNjZXB0OiBvcHRpb25zLmFjY2VwdCxcblx0XHRcdFx0bXVsdGlwbGU6IG9wdGlvbnMubXVsdGlwbGVcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLnRyaWdnZXIoJ3JlYWR5Jyk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgRW5jb2RlKSB7XG5cblx0ZnVuY3Rpb24gX2Zvcm1hdERhdGEoZGF0YSwgb3ApIHtcblx0XHRzd2l0Y2ggKG9wKSB7XG5cdFx0XHRjYXNlICdyZWFkQXNUZXh0Jzpcblx0XHRcdFx0cmV0dXJuIEVuY29kZS5hdG9iKGRhdGEsICd1dGY4Jyk7XG5cdFx0XHRjYXNlICdyZWFkQXNCaW5hcnlTdHJpbmcnOlxuXHRcdFx0XHRyZXR1cm4gRW5jb2RlLmF0b2IoZGF0YSk7XG5cdFx0XHRjYXNlICdyZWFkQXNEYXRhVVJMJzpcblx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0dmFyIEZpbGVSZWFkZXIgPSB7XG5cdFx0cmVhZDogZnVuY3Rpb24ob3AsIGJsb2IpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcztcblxuXHRcdFx0Y29tcC5yZXN1bHQgPSAnJztcblxuXHRcdFx0Ly8gc3BlY2lhbCBwcmVmaXggZm9yIERhdGFVUkwgcmVhZCBtb2RlXG5cdFx0XHRpZiAob3AgPT09ICdyZWFkQXNEYXRhVVJMJykge1xuXHRcdFx0XHRjb21wLnJlc3VsdCA9ICdkYXRhOicgKyAoYmxvYi50eXBlIHx8ICcnKSArICc7YmFzZTY0LCc7XG5cdFx0XHR9XG5cblx0XHRcdGNvbXAuYmluZCgnUHJvZ3Jlc3MnLCBmdW5jdGlvbihlLCBkYXRhKSB7XG5cdFx0XHRcdGlmIChkYXRhKSB7XG5cdFx0XHRcdFx0Y29tcC5yZXN1bHQgKz0gX2Zvcm1hdERhdGEoZGF0YSwgb3ApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA5OTkpO1xuXG5cdFx0XHRyZXR1cm4gY29tcC5nZXRSdW50aW1lKCkuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnRmlsZVJlYWRlcicsICdyZWFkQXNCYXNlNjQnLCBibG9iLnVpZCk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlUmVhZGVyID0gRmlsZVJlYWRlcik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVSZWFkZXJTeW5jLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlclN5bmMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVSZWFkZXJTeW5jXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyU3luY1wiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgRW5jb2RlKSB7XG5cdFxuXHRmdW5jdGlvbiBfZm9ybWF0RGF0YShkYXRhLCBvcCkge1xuXHRcdHN3aXRjaCAob3ApIHtcblx0XHRcdGNhc2UgJ3JlYWRBc1RleHQnOlxuXHRcdFx0XHRyZXR1cm4gRW5jb2RlLmF0b2IoZGF0YSwgJ3V0ZjgnKTtcblx0XHRcdGNhc2UgJ3JlYWRBc0JpbmFyeVN0cmluZyc6XG5cdFx0XHRcdHJldHVybiBFbmNvZGUuYXRvYihkYXRhKTtcblx0XHRcdGNhc2UgJ3JlYWRBc0RhdGFVUkwnOlxuXHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHR2YXIgRmlsZVJlYWRlclN5bmMgPSB7XG5cdFx0cmVhZDogZnVuY3Rpb24ob3AsIGJsb2IpIHtcblx0XHRcdHZhciByZXN1bHQsIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblxuXHRcdFx0cmVzdWx0ID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdGaWxlUmVhZGVyU3luYycsICdyZWFkQXNCYXNlNjQnLCBibG9iLnVpZCk7XG5cdFx0XHRpZiAoIXJlc3VsdCkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gb3IgdGhyb3cgZXhcblx0XHRcdH1cblxuXHRcdFx0Ly8gc3BlY2lhbCBwcmVmaXggZm9yIERhdGFVUkwgcmVhZCBtb2RlXG5cdFx0XHRpZiAob3AgPT09ICdyZWFkQXNEYXRhVVJMJykge1xuXHRcdFx0XHRyZXN1bHQgPSAnZGF0YTonICsgKGJsb2IudHlwZSB8fCAnJykgKyAnO2Jhc2U2NCwnICsgcmVzdWx0O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gX2Zvcm1hdERhdGEocmVzdWx0LCBvcCwgYmxvYi50eXBlKTtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVSZWFkZXJTeW5jID0gRmlsZVJlYWRlclN5bmMpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvZmxhc2gvcnVudGltZS9UcmFuc3BvcnRlci5qc1xuXG4vKipcbiAqIFRyYW5zcG9ydGVyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvZmxhc2gvcnVudGltZS9UcmFuc3BvcnRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBCbG9iKSB7XG5cblx0dmFyIFRyYW5zcG9ydGVyID0ge1xuXHRcdGdldEFzQmxvYjogZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0LCBibG9iID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdUcmFuc3BvcnRlcicsICdnZXRBc0Jsb2InLCB0eXBlKVxuXHRcdFx0O1xuXHRcdFx0aWYgKGJsb2IpIHtcblx0XHRcdFx0cmV0dXJuIG5ldyBCbG9iKHNlbGYudWlkLCBibG9iKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fTtcblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuVHJhbnNwb3J0ZXIgPSBUcmFuc3BvcnRlcik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC94aHIvWE1MSHR0cFJlcXVlc3QuanNcblxuLyoqXG4gKiBYTUxIdHRwUmVxdWVzdC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2ZsYXNoL3hoci9YTUxIdHRwUmVxdWVzdFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL3hoci9YTUxIdHRwUmVxdWVzdFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcblx0XCJtb3hpZS94aHIvRm9ybURhdGFcIixcblx0XCJtb3hpZS9ydW50aW1lL1RyYW5zcG9ydGVyXCIsXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9ydW50aW1lL1RyYW5zcG9ydGVyXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCBCbG9iLCBGaWxlLCBGaWxlUmVhZGVyU3luYywgRmlsZVJlYWRlclN5bmNGbGFzaCwgRm9ybURhdGEsIFRyYW5zcG9ydGVyLCBUcmFuc3BvcnRlckZsYXNoKSB7XG5cdFxuXHR2YXIgWE1MSHR0cFJlcXVlc3QgPSB7XG5cblx0XHRzZW5kOiBmdW5jdGlvbihtZXRhLCBkYXRhKSB7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcywgc2VsZiA9IHRhcmdldC5nZXRSdW50aW1lKCk7XG5cblx0XHRcdGZ1bmN0aW9uIHNlbmQoKSB7XG5cdFx0XHRcdG1ldGEudHJhbnNwb3J0ID0gc2VsZi5tb2RlO1xuXHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnc2VuZCcsIG1ldGEsIGRhdGEpO1xuXHRcdFx0fVxuXG5cblx0XHRcdGZ1bmN0aW9uIGFwcGVuZEJsb2IobmFtZSwgYmxvYikge1xuXHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnYXBwZW5kQmxvYicsIG5hbWUsIGJsb2IudWlkKTtcblx0XHRcdFx0ZGF0YSA9IG51bGw7XG5cdFx0XHRcdHNlbmQoKTtcblx0XHRcdH1cblxuXG5cdFx0XHRmdW5jdGlvbiBhdHRhY2hCbG9iKGJsb2IsIGNiKSB7XG5cdFx0XHRcdHZhciB0ciA9IG5ldyBUcmFuc3BvcnRlcigpO1xuXG5cdFx0XHRcdHRyLmJpbmQoXCJUcmFuc3BvcnRpbmdDb21wbGV0ZVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjYih0aGlzLnJlc3VsdCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHRyLnRyYW5zcG9ydChibG9iLmdldFNvdXJjZSgpLCBibG9iLnR5cGUsIHtcblx0XHRcdFx0XHRydWlkOiBzZWxmLnVpZFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gY29weSBvdmVyIHRoZSBoZWFkZXJzIGlmIGFueVxuXHRcdFx0aWYgKCFCYXNpYy5pc0VtcHR5T2JqKG1ldGEuaGVhZGVycykpIHtcblx0XHRcdFx0QmFzaWMuZWFjaChtZXRhLmhlYWRlcnMsIGZ1bmN0aW9uKHZhbHVlLCBoZWFkZXIpIHtcblx0XHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnc2V0UmVxdWVzdEhlYWRlcicsIGhlYWRlciwgdmFsdWUudG9TdHJpbmcoKSk7IC8vIFNpbHZlcmxpZ2h0IGRvZXNuJ3QgYWNjZXB0IGludGVnZXJzIGludG8gdGhlIGFyZ3VtZW50cyBvZiB0eXBlIG9iamVjdFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gdHJhbnNmZXIgb3ZlciBtdWx0aXBhcnQgcGFyYW1zIGFuZCBibG9iIGl0c2VsZlxuXHRcdFx0aWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXHRcdFx0XHR2YXIgYmxvYkZpZWxkO1xuXHRcdFx0XHRkYXRhLmVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcblx0XHRcdFx0XHRpZiAodmFsdWUgaW5zdGFuY2VvZiBCbG9iKSB7XG5cdFx0XHRcdFx0XHRibG9iRmllbGQgPSBuYW1lO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnYXBwZW5kJywgbmFtZSwgdmFsdWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKCFkYXRhLmhhc0Jsb2IoKSkge1xuXHRcdFx0XHRcdGRhdGEgPSBudWxsO1xuXHRcdFx0XHRcdHNlbmQoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgYmxvYiA9IGRhdGEuZ2V0QmxvYigpO1xuXHRcdFx0XHRcdGlmIChibG9iLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdFx0YXR0YWNoQmxvYihibG9iLCBmdW5jdGlvbihhdHRhY2hlZEJsb2IpIHtcblx0XHRcdFx0XHRcdFx0YmxvYi5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdGFwcGVuZEJsb2IoYmxvYkZpZWxkLCBhdHRhY2hlZEJsb2IpO1x0XHRcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRhcHBlbmRCbG9iKGJsb2JGaWVsZCwgYmxvYik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSB7XG5cdFx0XHRcdGlmIChkYXRhLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdGF0dGFjaEJsb2IoZGF0YSwgZnVuY3Rpb24oYXR0YWNoZWRCbG9iKSB7XG5cdFx0XHRcdFx0XHRkYXRhLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdGRhdGEgPSBhdHRhY2hlZEJsb2IudWlkO1xuXHRcdFx0XHRcdFx0c2VuZCgpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGRhdGEgPSBkYXRhLnVpZDtcblx0XHRcdFx0XHRzZW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlbmQoKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0Z2V0UmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0dmFyIGZycywgYmxvYiwgc2VsZiA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXG5cdFx0XHRibG9iID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdYTUxIdHRwUmVxdWVzdCcsICdnZXRSZXNwb25zZUFzQmxvYicpO1xuXG5cdFx0XHRpZiAoYmxvYikge1xuXHRcdFx0XHRibG9iID0gbmV3IEZpbGUoc2VsZi51aWQsIGJsb2IpO1xuXG5cdFx0XHRcdGlmICgnYmxvYicgPT09IHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHRcdHJldHVybiBibG9iO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dHJ5IHsgXG5cdFx0XHRcdFx0ZnJzID0gbmV3IEZpbGVSZWFkZXJTeW5jKCk7XG5cblx0XHRcdFx0XHRpZiAoISF+QmFzaWMuaW5BcnJheShyZXNwb25zZVR5cGUsIFtcIlwiLCBcInRleHRcIl0pKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZnJzLnJlYWRBc1RleHQoYmxvYik7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICgnanNvbicgPT09IHJlc3BvbnNlVHlwZSAmJiAhIXdpbmRvdy5KU09OKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gSlNPTi5wYXJzZShmcnMucmVhZEFzVGV4dChibG9iKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGZpbmFsbHkge1xuXHRcdFx0XHRcdGJsb2IuZGVzdHJveSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9LFxuXG5cdFx0YWJvcnQ6IGZ1bmN0aW9uKHVwbG9hZF9jb21wbGV0ZV9mbGFnKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXG5cdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGhpcywgJ1hNTEh0dHBSZXF1ZXN0JywgJ2Fib3J0Jyk7XG5cblx0XHRcdHRoaXMuZGlzcGF0Y2hFdmVudCgncmVhZHlzdGF0ZWNoYW5nZScpO1xuXHRcdFx0Ly8gdGhpcy5kaXNwYXRjaEV2ZW50KCdwcm9ncmVzcycpO1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV2ZW50KCdhYm9ydCcpO1xuXG5cdFx0XHQvL2lmICghdXBsb2FkX2NvbXBsZXRlX2ZsYWcpIHtcblx0XHRcdFx0Ly8gdGhpcy5kaXNwYXRjaEV2ZW50KCd1cGxvYWRwcm9ncmVzcycpO1xuXHRcdFx0Ly99XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5YTUxIdHRwUmVxdWVzdCA9IFhNTEh0dHBSZXF1ZXN0KTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2ZsYXNoL2ltYWdlL0ltYWdlLmpzXG5cbi8qKlxuICogSW1hZ2UuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9mbGFzaC9pbWFnZS9JbWFnZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ltYWdlL0ltYWdlXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvcnVudGltZS9UcmFuc3BvcnRlclwiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIFRyYW5zcG9ydGVyLCBCbG9iLCBGaWxlUmVhZGVyU3luYykge1xuXHRcblx0dmFyIEltYWdlID0ge1xuXHRcdGxvYWRGcm9tQmxvYjogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBzZWxmID0gY29tcC5nZXRSdW50aW1lKCk7XG5cblx0XHRcdGZ1bmN0aW9uIGV4ZWMoc3JjQmxvYikge1xuXHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwoY29tcCwgJ0ltYWdlJywgJ2xvYWRGcm9tQmxvYicsIHNyY0Jsb2IudWlkKTtcblx0XHRcdFx0Y29tcCA9IHNlbGYgPSBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYmxvYi5pc0RldGFjaGVkKCkpIHsgLy8gYmluYXJ5IHN0cmluZ1xuXHRcdFx0XHR2YXIgdHIgPSBuZXcgVHJhbnNwb3J0ZXIoKTtcblx0XHRcdFx0dHIuYmluZChcIlRyYW5zcG9ydGluZ0NvbXBsZXRlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGV4ZWModHIucmVzdWx0LmdldFNvdXJjZSgpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHRyLnRyYW5zcG9ydChibG9iLmdldFNvdXJjZSgpLCBibG9iLnR5cGUsIHsgcnVpZDogc2VsZi51aWQgfSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRleGVjKGJsb2IuZ2V0U291cmNlKCkpO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRsb2FkRnJvbUltYWdlOiBmdW5jdGlvbihpbWcpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKCk7XG5cdFx0XHRyZXR1cm4gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdsb2FkRnJvbUltYWdlJywgaW1nLnVpZCk7XG5cdFx0fSxcblxuXHRcdGdldEluZm86IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0LCBpbmZvID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdnZXRJbmZvJylcblx0XHRcdDtcblxuXHRcdFx0aWYgKGluZm8ubWV0YSAmJiBpbmZvLm1ldGEudGh1bWIgJiYgaW5mby5tZXRhLnRodW1iLmRhdGEgJiYgIShzZWxmLm1ldGEudGh1bWIuZGF0YSBpbnN0YW5jZW9mIEJsb2IpKSB7XG5cdFx0XHRcdGluZm8ubWV0YS50aHVtYi5kYXRhID0gbmV3IEJsb2Ioc2VsZi51aWQsIGluZm8ubWV0YS50aHVtYi5kYXRhKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBpbmZvO1xuXHRcdH0sXG5cblx0XHRnZXRBc0Jsb2I6IGZ1bmN0aW9uKHR5cGUsIHF1YWxpdHkpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKClcblx0XHRcdCwgYmxvYiA9IHNlbGYuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnSW1hZ2UnLCAnZ2V0QXNCbG9iJywgdHlwZSwgcXVhbGl0eSlcblx0XHRcdDtcblx0XHRcdGlmIChibG9iKSB7XG5cdFx0XHRcdHJldHVybiBuZXcgQmxvYihzZWxmLnVpZCwgYmxvYik7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9LFxuXG5cdFx0Z2V0QXNEYXRhVVJMOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKClcblx0XHRcdCwgYmxvYiA9IHNlbGYuSW1hZ2UuZ2V0QXNCbG9iLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcblx0XHRcdCwgZnJzXG5cdFx0XHQ7XG5cdFx0XHRpZiAoIWJsb2IpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRmcnMgPSBuZXcgRmlsZVJlYWRlclN5bmMoKTtcblx0XHRcdHJldHVybiBmcnMucmVhZEFzRGF0YVVSTChibG9iKTtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkltYWdlID0gSW1hZ2UpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1blRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLypnbG9iYWwgQWN0aXZlWE9iamVjdDp0cnVlICovXG5cbi8qKlxuRGVmaW5lcyBjb25zdHJ1Y3RvciBmb3IgU2lsdmVybGlnaHQgcnVudGltZS5cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvcnVudGltZS9SdW50aW1lXCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCBFbnYsIERvbSwgeCwgUnVudGltZSkge1xuXHRcblx0dmFyIHR5cGUgPSBcInNpbHZlcmxpZ2h0XCIsIGV4dGVuc2lvbnMgPSB7fTtcblxuXHRmdW5jdGlvbiBpc0luc3RhbGxlZCh2ZXJzaW9uKSB7XG5cdFx0dmFyIGlzVmVyc2lvblN1cHBvcnRlZCA9IGZhbHNlLCBjb250cm9sID0gbnVsbCwgYWN0dWFsVmVyLFxuXHRcdFx0YWN0dWFsVmVyQXJyYXksIHJlcVZlckFycmF5LCByZXF1aXJlZFZlcnNpb25QYXJ0LCBhY3R1YWxWZXJzaW9uUGFydCwgaW5kZXggPSAwO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnRyb2wgPSBuZXcgQWN0aXZlWE9iamVjdCgnQWdDb250cm9sLkFnQ29udHJvbCcpO1xuXG5cdFx0XHRcdGlmIChjb250cm9sLklzVmVyc2lvblN1cHBvcnRlZCh2ZXJzaW9uKSkge1xuXHRcdFx0XHRcdGlzVmVyc2lvblN1cHBvcnRlZCA9IHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb250cm9sID0gbnVsbDtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0dmFyIHBsdWdpbiA9IG5hdmlnYXRvci5wbHVnaW5zW1wiU2lsdmVybGlnaHQgUGx1Zy1JblwiXTtcblxuXHRcdFx0XHRpZiAocGx1Z2luKSB7XG5cdFx0XHRcdFx0YWN0dWFsVmVyID0gcGx1Z2luLmRlc2NyaXB0aW9uO1xuXG5cdFx0XHRcdFx0aWYgKGFjdHVhbFZlciA9PT0gXCIxLjAuMzAyMjYuMlwiKSB7XG5cdFx0XHRcdFx0XHRhY3R1YWxWZXIgPSBcIjIuMC4zMDIyNi4yXCI7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0YWN0dWFsVmVyQXJyYXkgPSBhY3R1YWxWZXIuc3BsaXQoXCIuXCIpO1xuXG5cdFx0XHRcdFx0d2hpbGUgKGFjdHVhbFZlckFycmF5Lmxlbmd0aCA+IDMpIHtcblx0XHRcdFx0XHRcdGFjdHVhbFZlckFycmF5LnBvcCgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdoaWxlICggYWN0dWFsVmVyQXJyYXkubGVuZ3RoIDwgNCkge1xuXHRcdFx0XHRcdFx0YWN0dWFsVmVyQXJyYXkucHVzaCgwKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXFWZXJBcnJheSA9IHZlcnNpb24uc3BsaXQoXCIuXCIpO1xuXG5cdFx0XHRcdFx0d2hpbGUgKHJlcVZlckFycmF5Lmxlbmd0aCA+IDQpIHtcblx0XHRcdFx0XHRcdHJlcVZlckFycmF5LnBvcCgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRvIHtcblx0XHRcdFx0XHRcdHJlcXVpcmVkVmVyc2lvblBhcnQgPSBwYXJzZUludChyZXFWZXJBcnJheVtpbmRleF0sIDEwKTtcblx0XHRcdFx0XHRcdGFjdHVhbFZlcnNpb25QYXJ0ID0gcGFyc2VJbnQoYWN0dWFsVmVyQXJyYXlbaW5kZXhdLCAxMCk7XG5cdFx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdH0gd2hpbGUgKGluZGV4IDwgcmVxVmVyQXJyYXkubGVuZ3RoICYmIHJlcXVpcmVkVmVyc2lvblBhcnQgPT09IGFjdHVhbFZlcnNpb25QYXJ0KTtcblxuXHRcdFx0XHRcdGlmIChyZXF1aXJlZFZlcnNpb25QYXJ0IDw9IGFjdHVhbFZlcnNpb25QYXJ0ICYmICFpc05hTihyZXF1aXJlZFZlcnNpb25QYXJ0KSkge1xuXHRcdFx0XHRcdFx0aXNWZXJzaW9uU3VwcG9ydGVkID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlMikge1xuXHRcdFx0aXNWZXJzaW9uU3VwcG9ydGVkID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGlzVmVyc2lvblN1cHBvcnRlZDtcblx0fVxuXG5cdC8qKlxuXHRDb25zdHJ1Y3RvciBmb3IgdGhlIFNpbHZlcmxpZ2h0IFJ1bnRpbWVcblx0Ki9cblx0ZnVuY3Rpb24gU2lsdmVybGlnaHRSdW50aW1lKG9wdGlvbnMpIHtcblx0XHR2YXIgSSA9IHRoaXMsIGluaXRUaW1lcjtcblxuXHRcdG9wdGlvbnMgPSBCYXNpYy5leHRlbmQoeyB4YXBfdXJsOiBFbnYueGFwX3VybCB9LCBvcHRpb25zKTtcblxuXHRcdFJ1bnRpbWUuY2FsbCh0aGlzLCBvcHRpb25zLCB0eXBlLCB7XG5cdFx0XHRhY2Nlc3NfYmluYXJ5OiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRkaXNwbGF5X21lZGlhOiBSdW50aW1lLmNhcFRlc3QoZGVmaW5lZCgnbW94aWUvaW1hZ2UvSW1hZ2UnKSksXG5cdFx0XHRkb19jb3JzOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRkcmFnX2FuZF9kcm9wOiBmYWxzZSxcblx0XHRcdHJlcG9ydF91cGxvYWRfcHJvZ3Jlc3M6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHJlc2l6ZV9pbWFnZTogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0cmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdjbGllbnQnO1xuXHRcdFx0fSxcblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0aWYgKHJlc3BvbnNlVHlwZSAhPT0gJ2pzb24nKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhd2luZG93LkpTT047XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IGZ1bmN0aW9uKGNvZGUpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2NsaWVudCcgfHwgIUJhc2ljLmFycmF5RGlmZihjb2RlLCBbMjAwLCA0MDRdKTtcblx0XHRcdH0sXG5cdFx0XHRzZWxlY3RfZmlsZTogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0c2VsZWN0X211bHRpcGxlOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRzZW5kX2JpbmFyeV9zdHJpbmc6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNlbmRfYnJvd3Nlcl9jb29raWVzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9jdXN0b21faGVhZGVyczogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlICYmIEkubW9kZSA9PT0gJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9tdWx0aXBhcnQ6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNsaWNlX2Jsb2I6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHN0cmVhbV91cGxvYWQ6IHRydWUsXG5cdFx0XHRzdW1tb25fZmlsZV9kaWFsb2c6IGZhbHNlLFxuXHRcdFx0dXBsb2FkX2ZpbGVzaXplOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2NsaWVudCcgfHwgIUJhc2ljLmFycmF5RGlmZihtZXRob2RzLCBbJ0dFVCcsICdQT1NUJ10pO1xuXHRcdFx0fVxuXHRcdH0sIHsgXG5cdFx0XHQvLyBjYXBhYmlsaXRpZXMgdGhhdCByZXF1aXJlIHNwZWNpZmljIG1vZGVcblx0XHRcdHJldHVybl9yZXNwb25zZV9oZWFkZXJzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnY2xpZW50JyA6ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IGZ1bmN0aW9uKGNvZGUpIHtcblx0XHRcdFx0cmV0dXJuIEJhc2ljLmFycmF5RGlmZihjb2RlLCBbMjAwLCA0MDRdKSA/ICdjbGllbnQnIDogWydjbGllbnQnLCAnYnJvd3NlciddO1xuXHRcdFx0fSxcblx0XHRcdHNlbmRfYnJvd3Nlcl9jb29raWVzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnY2xpZW50JyA6ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuIEJhc2ljLmFycmF5RGlmZihtZXRob2RzLCBbJ0dFVCcsICdQT1NUJ10pID8gJ2NsaWVudCcgOiBbJ2NsaWVudCcsICdicm93c2VyJ107XG5cdFx0XHR9XG5cdFx0fSk7XG5cblxuXHRcdC8vIG1pbmltYWwgcmVxdWlyZW1lbnRcblx0XHRpZiAoIWlzSW5zdGFsbGVkKCcyLjAuMzEwMDUuMCcpIHx8IEVudi5icm93c2VyID09PSAnT3BlcmEnKSB7XG5cdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdEVudi5sb2coXCJcXHRTaWx2ZXJsaWdodCBpcyBub3QgaW5zdGFsbGVkIG9yIG1pbmltYWwgdmVyc2lvbiAoMi4wLjMxMDA1LjApIHJlcXVpcmVtZW50IG5vdCBtZXQgKG5vdCBsaWtlbHkpLlwiKTtcdFxuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLm1vZGUgPSBmYWxzZTtcblx0XHR9XG5cblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRnZXRTaGltOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIERvbS5nZXQodGhpcy51aWQpLmNvbnRlbnQuTW94aWU7XG5cdFx0XHR9LFxuXG5cdFx0XHRzaGltRXhlYzogZnVuY3Rpb24oY29tcG9uZW50LCBhY3Rpb24pIHtcblx0XHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG5cdFx0XHRcdHJldHVybiBJLmdldFNoaW0oKS5leGVjKHRoaXMudWlkLCBjb21wb25lbnQsIGFjdGlvbiwgYXJncyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRpbml0IDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBjb250YWluZXI7XG5cblx0XHRcdFx0Y29udGFpbmVyID0gdGhpcy5nZXRTaGltQ29udGFpbmVyKCk7XG5cblx0XHRcdFx0Y29udGFpbmVyLmlubmVySFRNTCA9ICc8b2JqZWN0IGlkPVwiJyArIHRoaXMudWlkICsgJ1wiIGRhdGE9XCJkYXRhOmFwcGxpY2F0aW9uL3gtc2lsdmVybGlnaHQsXCIgdHlwZT1cImFwcGxpY2F0aW9uL3gtc2lsdmVybGlnaHQtMlwiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiBzdHlsZT1cIm91dGxpbmU6bm9uZTtcIj4nICtcblx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJzb3VyY2VcIiB2YWx1ZT1cIicgKyBvcHRpb25zLnhhcF91cmwgKyAnXCIvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cImJhY2tncm91bmRcIiB2YWx1ZT1cIlRyYW5zcGFyZW50XCIvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cIndpbmRvd2xlc3NcIiB2YWx1ZT1cInRydWVcIi8+JyArXG5cdFx0XHRcdFx0JzxwYXJhbSBuYW1lPVwiZW5hYmxlaHRtbGFjY2Vzc1wiIHZhbHVlPVwidHJ1ZVwiLz4nICtcblx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJpbml0UGFyYW1zXCIgdmFsdWU9XCJ1aWQ9JyArIHRoaXMudWlkICsgJyx0YXJnZXQ9JyArIFJ1bnRpbWUuZ2V0R2xvYmFsRXZlbnRUYXJnZXQoKSArICdcIi8+JyArXG5cdFx0XHRcdCc8L29iamVjdD4nO1xuXG5cdFx0XHRcdC8vIEluaXQgaXMgZGlzcGF0Y2hlZCBieSB0aGUgc2hpbVxuXHRcdFx0XHRpbml0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmIChJICYmICFJLmluaXRpYWxpemVkKSB7IC8vIHJ1bnRpbWUgbWlnaHQgYmUgYWxyZWFkeSBkZXN0cm95ZWQgYnkgdGhpcyBtb21lbnRcblx0XHRcdFx0XHRcdEkudHJpZ2dlcihcIkVycm9yXCIsIG5ldyB4LlJ1bnRpbWVFcnJvcih4LlJ1bnRpbWVFcnJvci5OT1RfSU5JVF9FUlIpKTtcblxuXHRcdFx0XHRcdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0XHRcdFx0XHRFbnYubG9nKFwiXFxTaWx2ZXJsaWdodCBmYWlsZWQgdG8gaW5pdGlhbGl6ZSB3aXRoaW4gYSBzcGVjaWZpZWQgcGVyaW9kIG9mIHRpbWUgKDUtMTBzKS5cIik7XHRcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIEVudi5PUyAhPT0gJ1dpbmRvd3MnPyAxMDAwMCA6IDUwMDApOyAvLyBnaXZlIGl0IG1vcmUgdGltZSB0byBpbml0aWFsaXplIGluIG5vbiBXaW5kb3dzIE9TIChsaWtlIE1hYylcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IChmdW5jdGlvbihkZXN0cm95KSB7IC8vIGV4dGVuZCBkZWZhdWx0IGRlc3Ryb3kgbWV0aG9kXG5cdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkZXN0cm95LmNhbGwoSSk7XG5cdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KGluaXRUaW1lcik7IC8vIGluaXRpYWxpemF0aW9uIGNoZWNrIG1pZ2h0IGJlIHN0aWxsIG9ud2FpdFxuXHRcdFx0XHRcdG9wdGlvbnMgPSBpbml0VGltZXIgPSBkZXN0cm95ID0gSSA9IG51bGw7XG5cdFx0XHRcdH07XG5cdFx0XHR9KHRoaXMuZGVzdHJveSkpXG5cblx0XHR9LCBleHRlbnNpb25zKTtcblx0fVxuXG5cdFJ1bnRpbWUuYWRkQ29uc3RydWN0b3IodHlwZSwgU2lsdmVybGlnaHRSdW50aW1lKTsgXG5cblx0cmV0dXJuIGV4dGVuc2lvbnM7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0Jsb2IuanNcblxuLyoqXG4gKiBCbG9iLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9CbG9iXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9CbG9iXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0Jsb2JcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIEJsb2IpIHtcblx0cmV0dXJuIChleHRlbnNpb25zLkJsb2IgPSBCYXNpYy5leHRlbmQoe30sIEJsb2IpKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlSW5wdXRcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVJbnB1dFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEZpbGUsIERvbSwgQmFzaWMpIHtcblxuXHRmdW5jdGlvbiB0b0ZpbHRlcnMoYWNjZXB0KSB7XG5cdFx0dmFyIGZpbHRlciA9ICcnO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYWNjZXB0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRmaWx0ZXIgKz0gKGZpbHRlciAhPT0gJycgPyAnfCcgOiAnJykgKyBhY2NlcHRbaV0udGl0bGUgKyBcIiB8ICouXCIgKyBhY2NlcHRbaV0uZXh0ZW5zaW9ucy5yZXBsYWNlKC8sL2csICc7Ki4nKTtcblx0XHR9XG5cdFx0cmV0dXJuIGZpbHRlcjtcblx0fVxuXG5cdFxuXHR2YXIgRmlsZUlucHV0ID0ge1xuXHRcdGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcywgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0dmFyIGJyb3dzZUJ1dHRvbiA9IERvbS5nZXQob3B0aW9ucy5icm93c2VfYnV0dG9uKTtcblxuXHRcdFx0aWYgKGJyb3dzZUJ1dHRvbikge1xuXHRcdFx0XHRicm93c2VCdXR0b24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcblx0XHRcdFx0YnJvd3NlQnV0dG9uID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5iaW5kKFwiQ2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZmlsZXMgPSBJLnNoaW1FeGVjLmNhbGwoY29tcCwgJ0ZpbGVJbnB1dCcsICdnZXRGaWxlcycpO1xuXHRcdFx0XHRjb21wLmZpbGVzID0gW107XG5cdFx0XHRcdEJhc2ljLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGZpbGUpIHtcblx0XHRcdFx0XHRjb21wLmZpbGVzLnB1c2gobmV3IEZpbGUoSS51aWQsIGZpbGUpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9LCA5OTkpO1xuXHRcdFx0XG5cdFx0XHRJLnNoaW1FeGVjLmNhbGwodGhpcywgJ0ZpbGVJbnB1dCcsICdpbml0JywgdG9GaWx0ZXJzKG9wdGlvbnMuYWNjZXB0KSwgb3B0aW9ucy5tdWx0aXBsZSk7XG5cdFx0XHR0aGlzLnRyaWdnZXIoJ3JlYWR5Jyk7XG5cdFx0fSxcblxuXHRcdHNldE9wdGlvbjogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcblx0XHRcdGlmIChuYW1lID09ICdhY2NlcHQnKSB7XG5cdFx0XHRcdHZhbHVlID0gdG9GaWx0ZXJzKHZhbHVlKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLnNoaW1FeGVjLmNhbGwodGhpcywgJ0ZpbGVJbnB1dCcsICdzZXRPcHRpb24nLCBuYW1lLCB2YWx1ZSk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlRHJvcC5qc1xuXG4vKipcbiAqIEZpbGVEcm9wLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlRHJvcFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZURyb3BcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsIFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRXZlbnRzXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIERvbSwgRXZlbnRzKSB7XG5cblx0Ly8gbm90IGV4YWN0bHkgdXNlZnVsLCBzaW5jZSB3b3JrcyBvbmx5IGluIHNhZmFyaSAoLi4uY3JpY2tldHMuLi4pXG5cdHZhciBGaWxlRHJvcCA9IHtcblx0XHRpbml0OiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcywgc2VsZiA9IGNvbXAuZ2V0UnVudGltZSgpLCBkcm9wWm9uZTtcblxuXHRcdFx0ZHJvcFpvbmUgPSBzZWxmLmdldFNoaW1Db250YWluZXIoKTtcblxuXHRcdFx0RXZlbnRzLmFkZEV2ZW50KGRyb3Bab25lLCAnZHJhZ292ZXInLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5Jztcblx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0RXZlbnRzLmFkZEV2ZW50KGRyb3Bab25lLCAnZHJhZ2VudGVyJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHZhciBmbGFnID0gRG9tLmdldChzZWxmLnVpZCkuZHJhZ0VudGVyKGUpO1xuXHRcdFx0XHQvLyBJZiBoYW5kbGVkLCB0aGVuIHN0b3AgcHJvcGFnYXRpb24gb2YgZXZlbnQgaW4gRE9NXG5cdFx0XHRcdGlmIChmbGFnKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRFdmVudHMuYWRkRXZlbnQoZHJvcFpvbmUsICdkcm9wJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHZhciBmbGFnID0gRG9tLmdldChzZWxmLnVpZCkuZHJhZ0Ryb3AoZSk7XG5cdFx0XHRcdC8vIElmIGhhbmRsZWQsIHRoZW4gc3RvcCBwcm9wYWdhdGlvbiBvZiBldmVudCBpbiBET01cblx0XHRcdFx0aWYgKGZsYWcpIHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdHJldHVybiBzZWxmLnNoaW1FeGVjLmNhbGwodGhpcywgJ0ZpbGVEcm9wJywgJ2luaXQnKTtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVEcm9wID0gRmlsZURyb3ApO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCBGaWxlUmVhZGVyKSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlUmVhZGVyID0gQmFzaWMuZXh0ZW5kKHt9LCBGaWxlUmVhZGVyKSk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVSZWFkZXJTeW5jLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlclN5bmMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVSZWFkZXJTeW5jXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlUmVhZGVyU3luY1wiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyU3luY1wiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBCYXNpYywgRmlsZVJlYWRlclN5bmMpIHtcblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVSZWFkZXJTeW5jID0gQmFzaWMuZXh0ZW5kKHt9LCBGaWxlUmVhZGVyU3luYykpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvcnVudGltZS9UcmFuc3BvcnRlci5qc1xuXG4vKipcbiAqIFRyYW5zcG9ydGVyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvcnVudGltZS9UcmFuc3BvcnRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L3J1bnRpbWUvVHJhbnNwb3J0ZXJcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIFRyYW5zcG9ydGVyKSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5UcmFuc3BvcnRlciA9IEJhc2ljLmV4dGVuZCh7fSwgVHJhbnNwb3J0ZXIpKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL3NpbHZlcmxpZ2h0L3hoci9YTUxIdHRwUmVxdWVzdC5qc1xuXG4vKipcbiAqIFhNTEh0dHBSZXF1ZXN0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQveGhyL1hNTEh0dHBSZXF1ZXN0XG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQveGhyL1hNTEh0dHBSZXF1ZXN0XCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC94aHIvWE1MSHR0cFJlcXVlc3RcIixcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L3J1bnRpbWUvVHJhbnNwb3J0ZXJcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIFhNTEh0dHBSZXF1ZXN0LCBGaWxlUmVhZGVyU3luY1NpbHZlcmxpZ2h0LCBUcmFuc3BvcnRlclNpbHZlcmxpZ2h0KSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5YTUxIdHRwUmVxdWVzdCA9IEJhc2ljLmV4dGVuZCh7fSwgWE1MSHR0cFJlcXVlc3QpKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL3NpbHZlcmxpZ2h0L2ltYWdlL0ltYWdlLmpzXG5cbi8qKlxuICogSW1hZ2UuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cbiBcbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvaW1hZ2UvSW1hZ2VcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9pbWFnZS9JbWFnZVwiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvaW1hZ2UvSW1hZ2VcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIEJsb2IsIEltYWdlKSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5JbWFnZSA9IEJhc2ljLmV4dGVuZCh7fSwgSW1hZ2UsIHtcblxuXHRcdGdldEluZm86IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0LCBncnBzID0gWyd0aWZmJywgJ2V4aWYnLCAnZ3BzJywgJ3RodW1iJ11cblx0XHRcdCwgaW5mbyA9IHsgbWV0YToge30gfVxuXHRcdFx0LCByYXdJbmZvID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdnZXRJbmZvJylcblx0XHRcdDtcblxuXHRcdFx0aWYgKHJhd0luZm8ubWV0YSkge1xuXHRcdFx0XHRCYXNpYy5lYWNoKGdycHMsIGZ1bmN0aW9uKGdycCkge1xuXHRcdFx0XHRcdHZhciBtZXRhID0gcmF3SW5mby5tZXRhW2dycF1cblx0XHRcdFx0XHQsIHRhZ1xuXHRcdFx0XHRcdCwgaVxuXHRcdFx0XHRcdCwgbGVuZ3RoXG5cdFx0XHRcdFx0LCB2YWx1ZVxuXHRcdFx0XHRcdDtcblx0XHRcdFx0XHRpZiAobWV0YSAmJiBtZXRhLmtleXMpIHtcblx0XHRcdFx0XHRcdGluZm8ubWV0YVtncnBdID0ge307XG5cdFx0XHRcdFx0XHRmb3IgKGkgPSAwLCBsZW5ndGggPSBtZXRhLmtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0dGFnID0gbWV0YS5rZXlzW2ldO1xuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IG1ldGFbdGFnXTtcblx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gY29udmVydCBudW1iZXJzXG5cdFx0XHRcdFx0XHRcdFx0aWYgKC9eKFxcZHxbMS05XVxcZCspJC8udGVzdCh2YWx1ZSkpIHsgLy8gaW50ZWdlciAobWFrZSBzdXJlIGRvZXNuJ3Qgc3RhcnQgd2l0aCB6ZXJvKVxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoL15cXGQqXFwuXFxkKyQvLnRlc3QodmFsdWUpKSB7IC8vIGRvdWJsZVxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0aW5mby5tZXRhW2dycF1bdGFnXSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBzYXZlIHRodW1iIGRhdGEgYXMgYmxvYlxuXHRcdFx0XHRpZiAoaW5mby5tZXRhICYmIGluZm8ubWV0YS50aHVtYiAmJiBpbmZvLm1ldGEudGh1bWIuZGF0YSAmJiAhKHNlbGYubWV0YS50aHVtYi5kYXRhIGluc3RhbmNlb2YgQmxvYikpIHtcblx0XHRcdFx0XHRpbmZvLm1ldGEudGh1bWIuZGF0YSA9IG5ldyBCbG9iKHNlbGYudWlkLCBpbmZvLm1ldGEudGh1bWIuZGF0YSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aW5mby53aWR0aCA9IHBhcnNlSW50KHJhd0luZm8ud2lkdGgsIDEwKTtcblx0XHRcdGluZm8uaGVpZ2h0ID0gcGFyc2VJbnQocmF3SW5mby5oZWlnaHQsIDEwKTtcblx0XHRcdGluZm8uc2l6ZSA9IHBhcnNlSW50KHJhd0luZm8uc2l6ZSwgMTApO1xuXHRcdFx0aW5mby50eXBlID0gcmF3SW5mby50eXBlO1xuXHRcdFx0aW5mby5uYW1lID0gcmF3SW5mby5uYW1lO1xuXG5cdFx0XHRyZXR1cm4gaW5mbztcblx0XHR9LFxuXG5cdFx0cmVzaXplOiBmdW5jdGlvbihyZWN0LCByYXRpbywgb3B0cykge1xuXHRcdFx0dGhpcy5nZXRSdW50aW1lKCkuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnSW1hZ2UnLCAncmVzaXplJywgcmVjdC54LCByZWN0LnksIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0LCByYXRpbywgb3B0cy5wcmVzZXJ2ZUhlYWRlcnMsIG9wdHMucmVzYW1wbGUpO1xuXHRcdH1cblx0fSkpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDQvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1bnRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLypnbG9iYWwgRmlsZTp0cnVlICovXG5cbi8qKlxuRGVmaW5lcyBjb25zdHJ1Y3RvciBmb3IgSFRNTDQgcnVudGltZS5cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDQvUnVudGltZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw0L1J1bnRpbWVcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiXG5dLCBmdW5jdGlvbihCYXNpYywgeCwgUnVudGltZSwgRW52KSB7XG5cdFxuXHR2YXIgdHlwZSA9ICdodG1sNCcsIGV4dGVuc2lvbnMgPSB7fTtcblxuXHRmdW5jdGlvbiBIdG1sNFJ1bnRpbWUob3B0aW9ucykge1xuXHRcdHZhciBJID0gdGhpc1xuXHRcdCwgVGVzdCA9IFJ1bnRpbWUuY2FwVGVzdFxuXHRcdCwgVHJ1ZSA9IFJ1bnRpbWUuY2FwVHJ1ZVxuXHRcdDtcblxuXHRcdFJ1bnRpbWUuY2FsbCh0aGlzLCBvcHRpb25zLCB0eXBlLCB7XG5cdFx0XHRhY2Nlc3NfYmluYXJ5OiBUZXN0KHdpbmRvdy5GaWxlUmVhZGVyIHx8IHdpbmRvdy5GaWxlICYmIEZpbGUuZ2V0QXNEYXRhVVJMKSxcblx0XHRcdGFjY2Vzc19pbWFnZV9iaW5hcnk6IGZhbHNlLFxuXHRcdFx0ZGlzcGxheV9tZWRpYTogVGVzdChcblx0XHRcdFx0KEVudi5jYW4oJ2NyZWF0ZV9jYW52YXMnKSB8fCBFbnYuY2FuKCd1c2VfZGF0YV91cmlfb3ZlcjMya2InKSkgJiYgXG5cdFx0XHRcdGRlZmluZWQoJ21veGllL2ltYWdlL0ltYWdlJylcblx0XHRcdCksXG5cdFx0XHRkb19jb3JzOiBmYWxzZSxcblx0XHRcdGRyYWdfYW5kX2Ryb3A6IGZhbHNlLFxuXHRcdFx0ZmlsdGVyX2J5X2V4dGVuc2lvbjogVGVzdChmdW5jdGlvbigpIHsgLy8gaWYgeW91IGtub3cgaG93IHRvIGZlYXR1cmUtZGV0ZWN0IHRoaXMsIHBsZWFzZSBzdWdnZXN0XG5cdFx0XHRcdHJldHVybiAhKFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0Nocm9tZScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDI4LCAnPCcpKSB8fCBcblx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdJRScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDEwLCAnPCcpKSB8fCBcblx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdTYWZhcmknICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA3LCAnPCcpKSB8fFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAzNywgJzwnKSlcblx0XHRcdFx0KTtcblx0XHRcdH0oKSksXG5cdFx0XHRyZXNpemVfaW1hZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gZXh0ZW5zaW9ucy5JbWFnZSAmJiBJLmNhbignYWNjZXNzX2JpbmFyeScpICYmIEVudi5jYW4oJ2NyZWF0ZV9jYW52YXMnKTtcblx0XHRcdH0sXG5cdFx0XHRyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOiBmYWxzZSxcblx0XHRcdHJldHVybl9yZXNwb25zZV9oZWFkZXJzOiBmYWxzZSxcblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0aWYgKHJlc3BvbnNlVHlwZSA9PT0gJ2pzb24nICYmICEhd2luZG93LkpTT04pIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fSBcblx0XHRcdFx0cmV0dXJuICEhfkJhc2ljLmluQXJyYXkocmVzcG9uc2VUeXBlLCBbJ3RleHQnLCAnZG9jdW1lbnQnLCAnJ10pO1xuXHRcdFx0fSxcblx0XHRcdHJldHVybl9zdGF0dXNfY29kZTogZnVuY3Rpb24oY29kZSkge1xuXHRcdFx0XHRyZXR1cm4gIUJhc2ljLmFycmF5RGlmZihjb2RlLCBbMjAwLCA0MDRdKTtcblx0XHRcdH0sXG5cdFx0XHRzZWxlY3RfZmlsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBFbnYuY2FuKCd1c2VfZmlsZWlucHV0Jyk7XG5cdFx0XHR9LFxuXHRcdFx0c2VsZWN0X211bHRpcGxlOiBmYWxzZSxcblx0XHRcdHNlbmRfYmluYXJ5X3N0cmluZzogZmFsc2UsXG5cdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBmYWxzZSxcblx0XHRcdHNlbmRfbXVsdGlwYXJ0OiB0cnVlLFxuXHRcdFx0c2xpY2VfYmxvYjogZmFsc2UsXG5cdFx0XHRzdHJlYW1fdXBsb2FkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIEkuY2FuKCdzZWxlY3RfZmlsZScpO1xuXHRcdFx0fSxcblx0XHRcdHN1bW1vbl9maWxlX2RpYWxvZzogZnVuY3Rpb24oKSB7IC8vIHllYWguLi4gc29tZSBkaXJ0eSBzbmlmZmluZyBoZXJlLi4uXG5cdFx0XHRcdHJldHVybiBJLmNhbignc2VsZWN0X2ZpbGUnKSAmJiAhKFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA0LCAnPCcpKSB8fFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ09wZXJhJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMTIsICc8JykpIHx8XG5cdFx0XHRcdFx0KEVudi5icm93c2VyID09PSAnSUUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAxMCwgJzwnKSlcblx0XHRcdFx0KTtcblx0XHRcdH0sXG5cdFx0XHR1cGxvYWRfZmlsZXNpemU6IFRydWUsXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuICFCYXNpYy5hcnJheURpZmYobWV0aG9kcywgWydHRVQnLCAnUE9TVCddKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdGluaXQgOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKFwiSW5pdFwiKTtcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IChmdW5jdGlvbihkZXN0cm95KSB7IC8vIGV4dGVuZCBkZWZhdWx0IGRlc3Ryb3kgbWV0aG9kXG5cdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkZXN0cm95LmNhbGwoSSk7XG5cdFx0XHRcdFx0ZGVzdHJveSA9IEkgPSBudWxsO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSh0aGlzLmRlc3Ryb3kpKVxuXHRcdH0pO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMuZ2V0U2hpbSgpLCBleHRlbnNpb25zKTtcblx0fVxuXG5cdFJ1bnRpbWUuYWRkQ29uc3RydWN0b3IodHlwZSwgSHRtbDRSdW50aW1lKTtcblxuXHRyZXR1cm4gZXh0ZW5zaW9ucztcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw0L2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDQvZmlsZS9GaWxlSW5wdXRcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNC9maWxlL0ZpbGVJbnB1dFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FdmVudHNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBGaWxlLCBCYXNpYywgRG9tLCBFdmVudHMsIE1pbWUsIEVudikge1xuXHRcblx0ZnVuY3Rpb24gRmlsZUlucHV0KCkge1xuXHRcdHZhciBfdWlkLCBfbWltZXMgPSBbXSwgX29wdGlvbnMsIF9icm93c2VCdG5aSW5kZXg7IC8vIHNhdmUgb3JpZ2luYWwgei1pbmRleDtcblxuXHRcdGZ1bmN0aW9uIGFkZElucHV0KCkge1xuXHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBJID0gY29tcC5nZXRSdW50aW1lKCksIHNoaW1Db250YWluZXIsIGJyb3dzZUJ1dHRvbiwgY3VyckZvcm0sIGZvcm0sIGlucHV0LCB1aWQ7XG5cblx0XHRcdHVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblxuXHRcdFx0c2hpbUNvbnRhaW5lciA9IEkuZ2V0U2hpbUNvbnRhaW5lcigpOyAvLyB3ZSBnZXQgbmV3IHJlZiBldmVyeSB0aW1lIHRvIGF2b2lkIG1lbW9yeSBsZWFrcyBpbiBJRVxuXG5cdFx0XHRpZiAoX3VpZCkgeyAvLyBtb3ZlIHByZXZpb3VzIGZvcm0gb3V0IG9mIHRoZSB2aWV3XG5cdFx0XHRcdGN1cnJGb3JtID0gRG9tLmdldChfdWlkICsgJ19mb3JtJyk7XG5cdFx0XHRcdGlmIChjdXJyRm9ybSkge1xuXHRcdFx0XHRcdEJhc2ljLmV4dGVuZChjdXJyRm9ybS5zdHlsZSwgeyB0b3A6ICcxMDAlJyB9KTtcblx0XHRcdFx0XHQvLyBpdCBzaG91bGRuJ3QgYmUgcG9zc2libGUgdG8gdGFiIGludG8gdGhlIGhpZGRlbiBlbGVtZW50XG5cdFx0XHRcdFx0Y3VyckZvcm0uZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIGJ1aWxkIGZvcm0gaW4gRE9NLCBzaW5jZSBpbm5lckhUTUwgdmVyc2lvbiBub3QgYWJsZSB0byBzdWJtaXQgZmlsZSBmb3Igc29tZSByZWFzb25cblx0XHRcdGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XG5cdFx0XHRmb3JtLnNldEF0dHJpYnV0ZSgnaWQnLCB1aWQgKyAnX2Zvcm0nKTtcblx0XHRcdGZvcm0uc2V0QXR0cmlidXRlKCdtZXRob2QnLCAncG9zdCcpO1xuXHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2VuY3R5cGUnLCAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpO1xuXHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2VuY29kaW5nJywgJ211bHRpcGFydC9mb3JtLWRhdGEnKTtcblxuXHRcdFx0QmFzaWMuZXh0ZW5kKGZvcm0uc3R5bGUsIHtcblx0XHRcdFx0b3ZlcmZsb3c6ICdoaWRkZW4nLFxuXHRcdFx0XHRwb3NpdGlvbjogJ2Fic29sdXRlJyxcblx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHR3aWR0aDogJzEwMCUnLFxuXHRcdFx0XHRoZWlnaHQ6ICcxMDAlJ1xuXHRcdFx0fSk7XG5cblx0XHRcdGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCB1aWQpO1xuXHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2ZpbGUnKTtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnYWNjZXB0JywgX21pbWVzLmpvaW4oJywnKSk7XG5cblx0XHRcdGlmIChJLmNhbignc3VtbW9uX2ZpbGVfZGlhbG9nJykpIHtcblx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcblx0XHRcdH1cblxuXHRcdFx0QmFzaWMuZXh0ZW5kKGlucHV0LnN0eWxlLCB7XG5cdFx0XHRcdGZvbnRTaXplOiAnOTk5cHgnLFxuXHRcdFx0XHRvcGFjaXR5OiAwXG5cdFx0XHR9KTtcblxuXHRcdFx0Zm9ybS5hcHBlbmRDaGlsZChpbnB1dCk7XG5cdFx0XHRzaGltQ29udGFpbmVyLmFwcGVuZENoaWxkKGZvcm0pO1xuXG5cdFx0XHQvLyBwcmVwYXJlIGZpbGUgaW5wdXQgdG8gYmUgcGxhY2VkIHVuZGVybmVhdGggdGhlIGJyb3dzZV9idXR0b24gZWxlbWVudFxuXHRcdFx0QmFzaWMuZXh0ZW5kKGlucHV0LnN0eWxlLCB7XG5cdFx0XHRcdHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuXHRcdFx0XHR0b3A6IDAsXG5cdFx0XHRcdGxlZnQ6IDAsXG5cdFx0XHRcdHdpZHRoOiAnMTAwJScsXG5cdFx0XHRcdGhlaWdodDogJzEwMCUnXG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKEVudi5icm93c2VyID09PSAnSUUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAxMCwgJzwnKSkge1xuXHRcdFx0XHRCYXNpYy5leHRlbmQoaW5wdXQuc3R5bGUsIHtcblx0XHRcdFx0XHRmaWx0ZXIgOiBcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYShvcGFjaXR5PTApXCJcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGlucHV0Lm9uY2hhbmdlID0gZnVuY3Rpb24oKSB7IC8vIHRoZXJlIHNob3VsZCBiZSBvbmx5IG9uZSBoYW5kbGVyIGZvciB0aGlzXG5cdFx0XHRcdHZhciBmaWxlO1xuXG5cdFx0XHRcdGlmICghdGhpcy52YWx1ZSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh0aGlzLmZpbGVzKSB7IC8vIGNoZWNrIGlmIGJyb3dzZXIgaXMgZnJlc2ggZW5vdWdoXG5cdFx0XHRcdFx0ZmlsZSA9IHRoaXMuZmlsZXNbMF07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZmlsZSA9IHtcblx0XHRcdFx0XHRcdG5hbWU6IHRoaXMudmFsdWVcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZmlsZSA9IG5ldyBGaWxlKEkudWlkLCBmaWxlKTtcblxuXHRcdFx0XHQvLyBjbGVhciBldmVudCBoYW5kbGVyXG5cdFx0XHRcdHRoaXMub25jaGFuZ2UgPSBmdW5jdGlvbigpIHt9OyBcblx0XHRcdFx0YWRkSW5wdXQuY2FsbChjb21wKTsgXG5cblx0XHRcdFx0Y29tcC5maWxlcyA9IFtmaWxlXTtcblxuXHRcdFx0XHQvLyBzdWJzdGl0dXRlIGFsbCBpZHMgd2l0aCBmaWxlIHVpZHMgKGNvbnNpZGVyIGZpbGUudWlkIHJlYWQtb25seSAtIHdlIGNhbm5vdCBkbyBpdCB0aGUgb3RoZXIgd2F5IGFyb3VuZClcblx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsIGZpbGUudWlkKTtcblx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2lkJywgZmlsZS51aWQgKyAnX2Zvcm0nKTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbXAudHJpZ2dlcignY2hhbmdlJyk7XG5cblx0XHRcdFx0aW5wdXQgPSBmb3JtID0gbnVsbDtcblx0XHRcdH07XG5cblxuXHRcdFx0Ly8gcm91dGUgY2xpY2sgZXZlbnQgdG8gdGhlIGlucHV0XG5cdFx0XHRpZiAoSS5jYW4oJ3N1bW1vbl9maWxlX2RpYWxvZycpKSB7XG5cdFx0XHRcdGJyb3dzZUJ1dHRvbiA9IERvbS5nZXQoX29wdGlvbnMuYnJvd3NlX2J1dHRvbik7XG5cdFx0XHRcdEV2ZW50cy5yZW1vdmVFdmVudChicm93c2VCdXR0b24sICdjbGljaycsIGNvbXAudWlkKTtcblx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KGJyb3dzZUJ1dHRvbiwgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGlmIChpbnB1dCAmJiAhaW5wdXQuZGlzYWJsZWQpIHsgLy8gZm9yIHNvbWUgcmVhc29uIEZGICh1cCB0byA4LjAuMSBzbyBmYXIpIGxldHMgdG8gY2xpY2sgZGlzYWJsZWQgaW5wdXRbdHlwZT1maWxlXVxuXHRcdFx0XHRcdFx0aW5wdXQuY2xpY2soKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cdFx0XHR9XG5cblx0XHRcdF91aWQgPSB1aWQ7XG5cblx0XHRcdHNoaW1Db250YWluZXIgPSBjdXJyRm9ybSA9IGJyb3dzZUJ1dHRvbiA9IG51bGw7XG5cdFx0fVxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBJID0gY29tcC5nZXRSdW50aW1lKCksIHNoaW1Db250YWluZXI7XG5cblx0XHRcdFx0Ly8gZmlndXJlIG91dCBhY2NlcHQgc3RyaW5nXG5cdFx0XHRcdF9vcHRpb25zID0gb3B0aW9ucztcblx0XHRcdFx0X21pbWVzID0gTWltZS5leHRMaXN0Mm1pbWVzKG9wdGlvbnMuYWNjZXB0LCBJLmNhbignZmlsdGVyX2J5X2V4dGVuc2lvbicpKTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyID0gSS5nZXRTaGltQ29udGFpbmVyKCk7XG5cblx0XHRcdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBicm93c2VCdXR0b24sIHpJbmRleCwgdG9wO1xuXG5cdFx0XHRcdFx0YnJvd3NlQnV0dG9uID0gRG9tLmdldChvcHRpb25zLmJyb3dzZV9idXR0b24pO1xuXHRcdFx0XHRcdF9icm93c2VCdG5aSW5kZXggPSBEb20uZ2V0U3R5bGUoYnJvd3NlQnV0dG9uLCAnei1pbmRleCcpIHx8ICdhdXRvJztcblxuXHRcdFx0XHRcdC8vIFJvdXRlIGNsaWNrIGV2ZW50IHRvIHRoZSBpbnB1dFt0eXBlPWZpbGVdIGVsZW1lbnQgZm9yIGJyb3dzZXJzIHRoYXQgc3VwcG9ydCBzdWNoIGJlaGF2aW9yXG5cdFx0XHRcdFx0aWYgKEkuY2FuKCdzdW1tb25fZmlsZV9kaWFsb2cnKSkge1xuXHRcdFx0XHRcdFx0aWYgKERvbS5nZXRTdHlsZShicm93c2VCdXR0b24sICdwb3NpdGlvbicpID09PSAnc3RhdGljJykge1xuXHRcdFx0XHRcdFx0XHRicm93c2VCdXR0b24uc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuXHRcdFx0XHRcdFx0fVx0XHRcdFx0XHRcdFxuXG5cdFx0XHRcdFx0XHRjb21wLmJpbmQoJ1JlZnJlc2gnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0ekluZGV4ID0gcGFyc2VJbnQoX2Jyb3dzZUJ0blpJbmRleCwgMTApIHx8IDE7XG5cblx0XHRcdFx0XHRcdFx0RG9tLmdldChfb3B0aW9ucy5icm93c2VfYnV0dG9uKS5zdHlsZS56SW5kZXggPSB6SW5kZXg7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW1Db250YWluZXIoKS5zdHlsZS56SW5kZXggPSB6SW5kZXggLSAxO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIGl0IHNob3VsZG4ndCBiZSBwb3NzaWJsZSB0byB0YWIgaW50byB0aGUgaGlkZGVuIGVsZW1lbnRcblx0XHRcdFx0XHRcdGJyb3dzZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qIFNpbmNlIHdlIGhhdmUgdG8gcGxhY2UgaW5wdXRbdHlwZT1maWxlXSBvbiB0b3Agb2YgdGhlIGJyb3dzZV9idXR0b24gZm9yIHNvbWUgYnJvd3NlcnMsXG5cdFx0XHRcdFx0YnJvd3NlX2J1dHRvbiBsb3NlcyBpbnRlcmFjdGl2aXR5LCBzbyB3ZSByZXN0b3JlIGl0IGhlcmUgKi9cblx0XHRcdFx0XHR0b3AgPSBJLmNhbignc3VtbW9uX2ZpbGVfZGlhbG9nJykgPyBicm93c2VCdXR0b24gOiBzaGltQ29udGFpbmVyO1xuXG5cdFx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KHRvcCwgJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XG5cdFx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KHRvcCwgJ21vdXNlb3V0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlbGVhdmUnKTtcblx0XHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0XHRFdmVudHMuYWRkRXZlbnQodG9wLCAnbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlZG93bicpO1xuXHRcdFx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0XHRcdEV2ZW50cy5hZGRFdmVudChEb20uZ2V0KG9wdGlvbnMuY29udGFpbmVyKSwgJ21vdXNldXAnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcignbW91c2V1cCcpO1xuXHRcdFx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0XHRcdGJyb3dzZUJ1dHRvbiA9IG51bGw7XG5cdFx0XHRcdH0oKSk7XG5cblx0XHRcdFx0YWRkSW5wdXQuY2FsbCh0aGlzKTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyID0gbnVsbDtcblxuXHRcdFx0XHQvLyB0cmlnZ2VyIHJlYWR5IGV2ZW50IGFzeW5jaHJvbm91c2x5XG5cdFx0XHRcdGNvbXAudHJpZ2dlcih7XG5cdFx0XHRcdFx0dHlwZTogJ3JlYWR5Jyxcblx0XHRcdFx0XHRhc3luYzogdHJ1ZVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cblx0XHRcdHNldE9wdGlvbjogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblx0XHRcdFx0dmFyIGlucHV0O1xuXG5cdFx0XHRcdGlmIChuYW1lID09ICdhY2NlcHQnKSB7XG5cdFx0XHRcdFx0X21pbWVzID0gdmFsdWUubWltZXMgfHwgTWltZS5leHRMaXN0Mm1pbWVzKHZhbHVlLCBJLmNhbignZmlsdGVyX2J5X2V4dGVuc2lvbicpKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIHVwZGF0ZSBjdXJyZW50IGlucHV0XG5cdFx0XHRcdGlucHV0ID0gRG9tLmdldChfdWlkKVxuXHRcdFx0XHRpZiAoaW5wdXQpIHtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FjY2VwdCcsIF9taW1lcy5qb2luKCcsJykpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdGRpc2FibGU6IGZ1bmN0aW9uKHN0YXRlKSB7XG5cdFx0XHRcdHZhciBpbnB1dDtcblxuXHRcdFx0XHRpZiAoKGlucHV0ID0gRG9tLmdldChfdWlkKSkpIHtcblx0XHRcdFx0XHRpbnB1dC5kaXNhYmxlZCA9ICEhc3RhdGU7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpXG5cdFx0XHRcdCwgc2hpbSA9IEkuZ2V0U2hpbSgpXG5cdFx0XHRcdCwgc2hpbUNvbnRhaW5lciA9IEkuZ2V0U2hpbUNvbnRhaW5lcigpXG5cdFx0XHRcdCwgY29udGFpbmVyID0gX29wdGlvbnMgJiYgRG9tLmdldChfb3B0aW9ucy5jb250YWluZXIpXG5cdFx0XHRcdCwgYnJvd3NlQnV0dG9uID0gX29wdGlvbnMgJiYgRG9tLmdldChfb3B0aW9ucy5icm93c2VfYnV0dG9uKVxuXHRcdFx0XHQ7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoY29udGFpbmVyKSB7XG5cdFx0XHRcdFx0RXZlbnRzLnJlbW92ZUFsbEV2ZW50cyhjb250YWluZXIsIHRoaXMudWlkKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGJyb3dzZUJ1dHRvbikge1xuXHRcdFx0XHRcdEV2ZW50cy5yZW1vdmVBbGxFdmVudHMoYnJvd3NlQnV0dG9uLCB0aGlzLnVpZCk7XG5cdFx0XHRcdFx0YnJvd3NlQnV0dG9uLnN0eWxlLnpJbmRleCA9IF9icm93c2VCdG5aSW5kZXg7IC8vIHJlc2V0IHRvIG9yaWdpbmFsIHZhbHVlXG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmIChzaGltQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0RXZlbnRzLnJlbW92ZUFsbEV2ZW50cyhzaGltQ29udGFpbmVyLCB0aGlzLnVpZCk7XG5cdFx0XHRcdFx0c2hpbUNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHNoaW0ucmVtb3ZlSW5zdGFuY2UodGhpcy51aWQpO1xuXG5cdFx0XHRcdF91aWQgPSBfbWltZXMgPSBfb3B0aW9ucyA9IHNoaW1Db250YWluZXIgPSBjb250YWluZXIgPSBicm93c2VCdXR0b24gPSBzaGltID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDQvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw0L2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw0L2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9maWxlL0ZpbGVSZWFkZXJcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgRmlsZVJlYWRlcikge1xuXHRyZXR1cm4gKGV4dGVuc2lvbnMuRmlsZVJlYWRlciA9IEZpbGVSZWFkZXIpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDQveGhyL1hNTEh0dHBSZXF1ZXN0LmpzXG5cbi8qKlxuICogWE1MSHR0cFJlcXVlc3QuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNC94aHIvWE1MSHR0cFJlcXVlc3RcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNC94aHIvWE1MSHR0cFJlcXVlc3RcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDQvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvVXJsXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FdmVudHNcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS94aHIvRm9ybURhdGFcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIERvbSwgVXJsLCB4LCBFdmVudHMsIEJsb2IsIEZvcm1EYXRhKSB7XG5cdFxuXHRmdW5jdGlvbiBYTUxIdHRwUmVxdWVzdCgpIHtcblx0XHR2YXIgX3N0YXR1cywgX3Jlc3BvbnNlLCBfaWZyYW1lO1xuXG5cdFx0ZnVuY3Rpb24gY2xlYW51cChjYikge1xuXHRcdFx0dmFyIHRhcmdldCA9IHRoaXMsIHVpZCwgZm9ybSwgaW5wdXRzLCBpLCBoYXNGaWxlID0gZmFsc2U7XG5cblx0XHRcdGlmICghX2lmcmFtZSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHVpZCA9IF9pZnJhbWUuaWQucmVwbGFjZSgvX2lmcmFtZSQvLCAnJyk7XG5cblx0XHRcdGZvcm0gPSBEb20uZ2V0KHVpZCArICdfZm9ybScpO1xuXHRcdFx0aWYgKGZvcm0pIHtcblx0XHRcdFx0aW5wdXRzID0gZm9ybS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKTtcblx0XHRcdFx0aSA9IGlucHV0cy5sZW5ndGg7XG5cblx0XHRcdFx0d2hpbGUgKGktLSkge1xuXHRcdFx0XHRcdHN3aXRjaCAoaW5wdXRzW2ldLmdldEF0dHJpYnV0ZSgndHlwZScpKSB7XG5cdFx0XHRcdFx0XHRjYXNlICdoaWRkZW4nOlxuXHRcdFx0XHRcdFx0XHRpbnB1dHNbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpbnB1dHNbaV0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2ZpbGUnOlxuXHRcdFx0XHRcdFx0XHRoYXNGaWxlID0gdHJ1ZTsgLy8gZmxhZyB0aGUgY2FzZSBmb3IgbGF0ZXJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlucHV0cyA9IFtdO1xuXG5cdFx0XHRcdGlmICghaGFzRmlsZSkgeyAvLyB3ZSBuZWVkIHRvIGtlZXAgdGhlIGZvcm0gZm9yIHNha2Ugb2YgcG9zc2libGUgcmV0cmllc1xuXHRcdFx0XHRcdGZvcm0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmb3JtKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRmb3JtID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gd2l0aG91dCB0aW1lb3V0LCByZXF1ZXN0IGlzIG1hcmtlZCBhcyBjYW5jZWxlZCAoaW4gY29uc29sZSlcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdEV2ZW50cy5yZW1vdmVFdmVudChfaWZyYW1lLCAnbG9hZCcsIHRhcmdldC51aWQpO1xuXHRcdFx0XHRpZiAoX2lmcmFtZS5wYXJlbnROb2RlKSB7IC8vICMzODJcblx0XHRcdFx0XHRfaWZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoX2lmcmFtZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjaGVjayBpZiBzaGltIGNvbnRhaW5lciBoYXMgYW55IG90aGVyIGNoaWxkcmVuLCBpZiAtIG5vdCwgcmVtb3ZlIGl0IGFzIHdlbGxcblx0XHRcdFx0dmFyIHNoaW1Db250YWluZXIgPSB0YXJnZXQuZ2V0UnVudGltZSgpLmdldFNoaW1Db250YWluZXIoKTtcblx0XHRcdFx0aWYgKCFzaGltQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCkge1xuXHRcdFx0XHRcdHNoaW1Db250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzaGltQ29udGFpbmVyKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHNoaW1Db250YWluZXIgPSBfaWZyYW1lID0gbnVsbDtcblx0XHRcdFx0Y2IoKTtcblx0XHRcdH0sIDEpO1xuXHRcdH1cblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRzZW5kOiBmdW5jdGlvbihtZXRhLCBkYXRhKSB7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSB0aGlzLCBJID0gdGFyZ2V0LmdldFJ1bnRpbWUoKSwgdWlkLCBmb3JtLCBpbnB1dCwgYmxvYjtcblxuXHRcdFx0XHRfc3RhdHVzID0gX3Jlc3BvbnNlID0gbnVsbDtcblxuXHRcdFx0XHRmdW5jdGlvbiBjcmVhdGVJZnJhbWUoKSB7XG5cdFx0XHRcdFx0dmFyIGNvbnRhaW5lciA9IEkuZ2V0U2hpbUNvbnRhaW5lcigpIHx8IGRvY3VtZW50LmJvZHlcblx0XHRcdFx0XHQsIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXHRcdFx0XHRcdDtcblxuXHRcdFx0XHRcdC8vIElFIDYgd29uJ3QgYmUgYWJsZSB0byBzZXQgdGhlIG5hbWUgdXNpbmcgc2V0QXR0cmlidXRlIG9yIGlmcmFtZS5uYW1lXG5cdFx0XHRcdFx0dGVtcC5pbm5lckhUTUwgPSAnPGlmcmFtZSBpZD1cIicgKyB1aWQgKyAnX2lmcmFtZVwiIG5hbWU9XCInICsgdWlkICsgJ19pZnJhbWVcIiBzcmM9XCJqYXZhc2NyaXB0OiZxdW90OyZxdW90O1wiIHN0eWxlPVwiZGlzcGxheTpub25lXCI+PC9pZnJhbWU+Jztcblx0XHRcdFx0XHRfaWZyYW1lID0gdGVtcC5maXJzdENoaWxkO1xuXHRcdFx0XHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZChfaWZyYW1lKTtcblxuXHRcdFx0XHRcdC8qIF9pZnJhbWUub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmluZm8oX2lmcmFtZS5yZWFkeVN0YXRlKTtcblx0XHRcdFx0XHR9OyovXG5cblx0XHRcdFx0XHRFdmVudHMuYWRkRXZlbnQoX2lmcmFtZSwgJ2xvYWQnLCBmdW5jdGlvbigpIHsgLy8gX2lmcmFtZS5vbmxvYWQgZG9lc24ndCB3b3JrIGluIElFIGx0ZSA4XG5cdFx0XHRcdFx0XHR2YXIgZWw7XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGVsID0gX2lmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50IHx8IF9pZnJhbWUuY29udGVudERvY3VtZW50IHx8IHdpbmRvdy5mcmFtZXNbX2lmcmFtZS5pZF0uZG9jdW1lbnQ7XG5cblx0XHRcdFx0XHRcdFx0Ly8gdHJ5IHRvIGRldGVjdCBzb21lIHN0YW5kYXJkIGVycm9yIHBhZ2VzXG5cdFx0XHRcdFx0XHRcdGlmICgvXjQoMFswLTldfDFbMC03XXwyWzIzNDZdKVxccy8udGVzdChlbC50aXRsZSkpIHsgLy8gdGVzdCBpZiB0aXRsZSBzdGFydHMgd2l0aCA0eHggSFRUUCBlcnJvclxuXHRcdFx0XHRcdFx0XHRcdF9zdGF0dXMgPSBlbC50aXRsZS5yZXBsYWNlKC9eKFxcZCspLiokLywgJyQxJyk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0X3N0YXR1cyA9IDIwMDtcblx0XHRcdFx0XHRcdFx0XHQvLyBnZXQgcmVzdWx0XG5cdFx0XHRcdFx0XHRcdFx0X3Jlc3BvbnNlID0gQmFzaWMudHJpbShlbC5ib2R5LmlubmVySFRNTCk7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyB3ZSBuZWVkIHRvIGZpcmUgdGhlc2UgYXQgbGVhc3Qgb25jZVxuXHRcdFx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKHtcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICdwcm9ncmVzcycsXG5cdFx0XHRcdFx0XHRcdFx0XHRsb2FkZWQ6IF9yZXNwb25zZS5sZW5ndGgsXG5cdFx0XHRcdFx0XHRcdFx0XHR0b3RhbDogX3Jlc3BvbnNlLmxlbmd0aFxuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGJsb2IpIHsgLy8gaWYgd2Ugd2VyZSB1cGxvYWRpbmcgYSBmaWxlXG5cdFx0XHRcdFx0XHRcdFx0XHR0YXJnZXQudHJpZ2dlcih7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICd1cGxvYWRwcm9ncmVzcycsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxvYWRlZDogYmxvYi5zaXplIHx8IDEwMjUsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRvdGFsOiBibG9iLnNpemUgfHwgMTAyNVxuXHRcdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoVXJsLmhhc1NhbWVPcmlnaW4obWV0YS51cmwpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gaWYgcmVzcG9uc2UgaXMgc2VudCB3aXRoIGVycm9yIGNvZGUsIGlmcmFtZSBpbiBJRSBnZXRzIHJlZGlyZWN0ZWQgdG8gcmVzOi8vaWVmcmFtZS5kbGwvaHR0cF94Lmh0bVxuXHRcdFx0XHRcdFx0XHRcdC8vIHdoaWNoIG9idmlvdXNseSByZXN1bHRzIHRvIGNyb3NzIGRvbWFpbiBlcnJvciAod3RmPylcblx0XHRcdFx0XHRcdFx0XHRfc3RhdHVzID0gNDA0O1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGNsZWFudXAuY2FsbCh0YXJnZXQsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGFyZ2V0LnRyaWdnZXIoJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XHRcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGNsZWFudXAuY2FsbCh0YXJnZXQsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHR0YXJnZXQudHJpZ2dlcignbG9hZCcpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSwgdGFyZ2V0LnVpZCk7XG5cdFx0XHRcdH0gLy8gZW5kIGNyZWF0ZUlmcmFtZVxuXG5cdFx0XHRcdC8vIHByZXBhcmUgZGF0YSB0byBiZSBzZW50IGFuZCBjb252ZXJ0IGlmIHJlcXVpcmVkXG5cdFx0XHRcdGlmIChkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEgJiYgZGF0YS5oYXNCbG9iKCkpIHtcblx0XHRcdFx0XHRibG9iID0gZGF0YS5nZXRCbG9iKCk7XG5cdFx0XHRcdFx0dWlkID0gYmxvYi51aWQ7XG5cdFx0XHRcdFx0aW5wdXQgPSBEb20uZ2V0KHVpZCk7XG5cdFx0XHRcdFx0Zm9ybSA9IERvbS5nZXQodWlkICsgJ19mb3JtJyk7XG5cdFx0XHRcdFx0aWYgKCFmb3JtKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uTk9UX0ZPVU5EX0VSUik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblxuXHRcdFx0XHRcdGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XG5cdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2lkJywgdWlkICsgJ19mb3JtJyk7XG5cdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsIG1ldGEubWV0aG9kKTtcblx0XHRcdFx0XHRmb3JtLnNldEF0dHJpYnV0ZSgnZW5jdHlwZScsICdtdWx0aXBhcnQvZm9ybS1kYXRhJyk7XG5cdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2VuY29kaW5nJywgJ211bHRpcGFydC9mb3JtLWRhdGEnKTtcblxuXHRcdFx0XHRcdEkuZ2V0U2hpbUNvbnRhaW5lcigpLmFwcGVuZENoaWxkKGZvcm0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gc2V0IHVwbG9hZCB0YXJnZXRcblx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ3RhcmdldCcsIHVpZCArICdfaWZyYW1lJyk7XG5cblx0XHRcdFx0aWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXHRcdFx0XHRcdGRhdGEuZWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuXHRcdFx0XHRcdFx0aWYgKHZhbHVlIGluc3RhbmNlb2YgQmxvYikge1xuXHRcdFx0XHRcdFx0XHRpZiAoaW5wdXQpIHtcblx0XHRcdFx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCBuYW1lKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIGhpZGRlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG5cblx0XHRcdFx0XHRcdFx0QmFzaWMuZXh0ZW5kKGhpZGRlbiwge1xuXHRcdFx0XHRcdFx0XHRcdHR5cGUgOiAnaGlkZGVuJyxcblx0XHRcdFx0XHRcdFx0XHRuYW1lIDogbmFtZSxcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA6IHZhbHVlXG5cdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB0aGF0IGlucHV0W3R5cGU9XCJmaWxlXCJdLCBpZiBpdCdzIHRoZXJlLCBjb21lcyBsYXN0XG5cdFx0XHRcdFx0XHRcdGlmIChpbnB1dCkge1xuXHRcdFx0XHRcdFx0XHRcdGZvcm0uaW5zZXJ0QmVmb3JlKGhpZGRlbiwgaW5wdXQpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGZvcm0uYXBwZW5kQ2hpbGQoaGlkZGVuKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gc2V0IGRlc3RpbmF0aW9uIHVybFxuXHRcdFx0XHRmb3JtLnNldEF0dHJpYnV0ZShcImFjdGlvblwiLCBtZXRhLnVybCk7XG5cblx0XHRcdFx0Y3JlYXRlSWZyYW1lKCk7XG5cdFx0XHRcdGZvcm0uc3VibWl0KCk7XG5cdFx0XHRcdHRhcmdldC50cmlnZ2VyKCdsb2Fkc3RhcnQnKTtcblx0XHRcdH0sXG5cblx0XHRcdGdldFN0YXR1czogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBfc3RhdHVzO1xuXHRcdFx0fSxcblxuXHRcdFx0Z2V0UmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHRpZiAoJ2pzb24nID09PSByZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0XHQvLyBzdHJpcCBvZmYgPHByZT4uLjwvcHJlPiB0YWdzIHRoYXQgbWlnaHQgYmUgZW5jbG9zaW5nIHRoZSByZXNwb25zZVxuXHRcdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoX3Jlc3BvbnNlKSA9PT0gJ3N0cmluZycgJiYgISF3aW5kb3cuSlNPTikge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIEpTT04ucGFyc2UoX3Jlc3BvbnNlLnJlcGxhY2UoL15cXHMqPHByZVtePl0qPi8sICcnKS5yZXBsYWNlKC88XFwvcHJlPlxccyokLywgJycpKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4KSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gXG5cdFx0XHRcdH0gZWxzZSBpZiAoJ2RvY3VtZW50JyA9PT0gcmVzcG9uc2VUeXBlKSB7XG5cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gX3Jlc3BvbnNlO1xuXHRcdFx0fSxcblxuXHRcdFx0YWJvcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcztcblxuXHRcdFx0XHRpZiAoX2lmcmFtZSAmJiBfaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcblx0XHRcdFx0XHRpZiAoX2lmcmFtZS5jb250ZW50V2luZG93LnN0b3ApIHsgLy8gRmlyZUZveC9TYWZhcmkvQ2hyb21lXG5cdFx0XHRcdFx0XHRfaWZyYW1lLmNvbnRlbnRXaW5kb3cuc3RvcCgpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoX2lmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LmV4ZWNDb21tYW5kKSB7IC8vIElFXG5cdFx0XHRcdFx0XHRfaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ1N0b3AnKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X2lmcmFtZS5zcmMgPSBcImFib3V0OmJsYW5rXCI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y2xlYW51cC5jYWxsKHRoaXMsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIHRhcmdldC5kaXNwYXRjaEV2ZW50KCdyZWFkeXN0YXRlY2hhbmdlJyk7XG5cdFx0XHRcdFx0dGFyZ2V0LmRpc3BhdGNoRXZlbnQoJ2Fib3J0Jyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuWE1MSHR0cFJlcXVlc3QgPSBYTUxIdHRwUmVxdWVzdCk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNC9pbWFnZS9JbWFnZS5qc1xuXG4vKipcbiAqIEltYWdlLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDQvaW1hZ2UvSW1hZ2VcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNC9pbWFnZS9JbWFnZVwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9JbWFnZVwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBJbWFnZSkge1xuXHRyZXR1cm4gKGV4dGVuc2lvbnMuSW1hZ2UgPSBJbWFnZSk7XG59KTtcblxuZXhwb3NlKFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvdXRpbHMvRW5jb2RlXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFwibW94aWUvY29yZS9FdmVudFRhcmdldFwiLFwibW94aWUvcnVudGltZS9SdW50aW1lXCIsXCJtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnRcIixcIm1veGllL2ZpbGUvQmxvYlwiLFwibW94aWUvY29yZS9JMThuXCIsXCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcIm1veGllL2ZpbGUvRmlsZUlucHV0XCIsXCJtb3hpZS9maWxlL0ZpbGVcIixcIm1veGllL2ZpbGUvRmlsZURyb3BcIixcIm1veGllL2ZpbGUvRmlsZVJlYWRlclwiLFwibW94aWUvY29yZS91dGlscy9VcmxcIixcIm1veGllL3J1bnRpbWUvUnVudGltZVRhcmdldFwiLFwibW94aWUveGhyL0Zvcm1EYXRhXCIsXCJtb3hpZS94aHIvWE1MSHR0cFJlcXVlc3RcIixcIm1veGllL2ltYWdlL0ltYWdlXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0V2ZW50c1wiLFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9SZXNpemVyQ2FudmFzXCJdKTtcbn0pKHRoaXMpO1xufSkpOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/plupload/js/moxie.js\n");

/***/ }),

/***/ "./node_modules/plupload/js/plupload.dev.js":
/*!**************************************************!*\
  !*** ./node_modules/plupload/js/plupload.dev.js ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**\n * Plupload - multi-runtime File Uploader\n * v2.3.6\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n *\n * Date: 2017-11-03\n */\n;(function (global, factory) {\n\tvar extract = function() {\n\t\tvar ctx = {};\n\t\tfactory.apply(ctx, arguments);\n\t\treturn ctx.plupload;\n\t};\n\t\n\tif (true) {\n\t\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./moxie */ \"./node_modules/plupload/js/moxie.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (extract),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t} else {}\n}(this || window, function(moxie) {\n/**\n * Plupload.js\n *\n * Copyright 2013, Moxiecode Systems AB\n * Released under GPL License.\n *\n * License: http://www.plupload.com/license\n * Contributing: http://www.plupload.com/contributing\n */\n\n;(function(exports, o, undef) {\n\nvar delay = window.setTimeout;\nvar fileFilters = {};\nvar u = o.core.utils;\nvar Runtime = o.runtime.Runtime;\n\n// convert plupload features to caps acceptable by mOxie\nfunction normalizeCaps(settings) {\n\tvar features = settings.required_features, caps = {};\n\n\tfunction resolve(feature, value, strict) {\n\t\t// Feature notation is deprecated, use caps (this thing here is required for backward compatibility)\n\t\tvar map = {\n\t\t\tchunks: 'slice_blob',\n\t\t\tjpgresize: 'send_binary_string',\n\t\t\tpngresize: 'send_binary_string',\n\t\t\tprogress: 'report_upload_progress',\n\t\t\tmulti_selection: 'select_multiple',\n\t\t\tdragdrop: 'drag_and_drop',\n\t\t\tdrop_element: 'drag_and_drop',\n\t\t\theaders: 'send_custom_headers',\n\t\t\turlstream_upload: 'send_binary_string',\n\t\t\tcanSendBinary: 'send_binary',\n\t\t\ttriggerDialog: 'summon_file_dialog'\n\t\t};\n\n\t\tif (map[feature]) {\n\t\t\tcaps[map[feature]] = value;\n\t\t} else if (!strict) {\n\t\t\tcaps[feature] = value;\n\t\t}\n\t}\n\n\tif (typeof(features) === 'string') {\n\t\tplupload.each(features.split(/\\s*,\\s*/), function(feature) {\n\t\t\tresolve(feature, true);\n\t\t});\n\t} else if (typeof(features) === 'object') {\n\t\tplupload.each(features, function(value, feature) {\n\t\t\tresolve(feature, value);\n\t\t});\n\t} else if (features === true) {\n\t\t// check settings for required features\n\t\tif (settings.chunk_size && settings.chunk_size > 0) {\n\t\t\tcaps.slice_blob = true;\n\t\t}\n\n\t\tif (!plupload.isEmptyObj(settings.resize) || settings.multipart === false) {\n\t\t\tcaps.send_binary_string = true;\n\t\t}\n\n\t\tif (settings.http_method) {\n            caps.use_http_method = settings.http_method;\n        }\n\n\t\tplupload.each(settings, function(value, feature) {\n\t\t\tresolve(feature, !!value, true); // strict check\n\t\t});\n\t}\n\n\treturn caps;\n}\n\n/**\n * @module plupload\n * @static\n */\nvar plupload = {\n\t/**\n\t * Plupload version will be replaced on build.\n\t *\n\t * @property VERSION\n\t * @for Plupload\n\t * @static\n\t * @final\n\t */\n\tVERSION : '2.3.6',\n\n\t/**\n\t * The state of the queue before it has started and after it has finished\n\t *\n\t * @property STOPPED\n\t * @static\n\t * @final\n\t */\n\tSTOPPED : 1,\n\n\t/**\n\t * Upload process is running\n\t *\n\t * @property STARTED\n\t * @static\n\t * @final\n\t */\n\tSTARTED : 2,\n\n\t/**\n\t * File is queued for upload\n\t *\n\t * @property QUEUED\n\t * @static\n\t * @final\n\t */\n\tQUEUED : 1,\n\n\t/**\n\t * File is being uploaded\n\t *\n\t * @property UPLOADING\n\t * @static\n\t * @final\n\t */\n\tUPLOADING : 2,\n\n\t/**\n\t * File has failed to be uploaded\n\t *\n\t * @property FAILED\n\t * @static\n\t * @final\n\t */\n\tFAILED : 4,\n\n\t/**\n\t * File has been uploaded successfully\n\t *\n\t * @property DONE\n\t * @static\n\t * @final\n\t */\n\tDONE : 5,\n\n\t// Error constants used by the Error event\n\n\t/**\n\t * Generic error for example if an exception is thrown inside Silverlight.\n\t *\n\t * @property GENERIC_ERROR\n\t * @static\n\t * @final\n\t */\n\tGENERIC_ERROR : -100,\n\n\t/**\n\t * HTTP transport error. For example if the server produces a HTTP status other than 200.\n\t *\n\t * @property HTTP_ERROR\n\t * @static\n\t * @final\n\t */\n\tHTTP_ERROR : -200,\n\n\t/**\n\t * Generic I/O error. For example if it wasn't possible to open the file stream on local machine.\n\t *\n\t * @property IO_ERROR\n\t * @static\n\t * @final\n\t */\n\tIO_ERROR : -300,\n\n\t/**\n\t * @property SECURITY_ERROR\n\t * @static\n\t * @final\n\t */\n\tSECURITY_ERROR : -400,\n\n\t/**\n\t * Initialization error. Will be triggered if no runtime was initialized.\n\t *\n\t * @property INIT_ERROR\n\t * @static\n\t * @final\n\t */\n\tINIT_ERROR : -500,\n\n\t/**\n\t * File size error. If the user selects a file that is too large or is empty it will be blocked and\n\t * an error of this type will be triggered.\n\t *\n\t * @property FILE_SIZE_ERROR\n\t * @static\n\t * @final\n\t */\n\tFILE_SIZE_ERROR : -600,\n\n\t/**\n\t * File extension error. If the user selects a file that isn't valid according to the filters setting.\n\t *\n\t * @property FILE_EXTENSION_ERROR\n\t * @static\n\t * @final\n\t */\n\tFILE_EXTENSION_ERROR : -601,\n\n\t/**\n\t * Duplicate file error. If prevent_duplicates is set to true and user selects the same file again.\n\t *\n\t * @property FILE_DUPLICATE_ERROR\n\t * @static\n\t * @final\n\t */\n\tFILE_DUPLICATE_ERROR : -602,\n\n\t/**\n\t * Runtime will try to detect if image is proper one. Otherwise will throw this error.\n\t *\n\t * @property IMAGE_FORMAT_ERROR\n\t * @static\n\t * @final\n\t */\n\tIMAGE_FORMAT_ERROR : -700,\n\n\t/**\n\t * While working on files runtime may run out of memory and will throw this error.\n\t *\n\t * @since 2.1.2\n\t * @property MEMORY_ERROR\n\t * @static\n\t * @final\n\t */\n\tMEMORY_ERROR : -701,\n\n\t/**\n\t * Each runtime has an upper limit on a dimension of the image it can handle. If bigger, will throw this error.\n\t *\n\t * @property IMAGE_DIMENSIONS_ERROR\n\t * @static\n\t * @final\n\t */\n\tIMAGE_DIMENSIONS_ERROR : -702,\n\n\t/**\n\t * Expose whole moxie (#1469).\n\t *\n\t * @property moxie\n\t * @type Object\n\t * @final\n\t */\n\tmoxie: o,\n\n\t/**\n\t * Mime type lookup table.\n\t *\n\t * @property mimeTypes\n\t * @type Object\n\t * @final\n\t */\n\tmimeTypes : u.Mime.mimes,\n\n\t/**\n\t * In some cases sniffing is the only way around :(\n\t */\n\tua: u.Env,\n\n\t/**\n\t * Gets the true type of the built-in object (better version of typeof).\n\t * @credits Angus Croll (http://javascriptweblog.wordpress.com/)\n\t *\n\t * @method typeOf\n\t * @static\n\t * @param {Object} o Object to check.\n\t * @return {String} Object [[Class]]\n\t */\n\ttypeOf: u.Basic.typeOf,\n\n\t/**\n\t * Extends the specified object with another object.\n\t *\n\t * @method extend\n\t * @static\n\t * @param {Object} target Object to extend.\n\t * @param {Object..} obj Multiple objects to extend with.\n\t * @return {Object} Same as target, the extended object.\n\t */\n\textend : u.Basic.extend,\n\n\t/**\n\t * Generates an unique ID. This is 99.99% unique since it takes the current time and 5 random numbers.\n\t * The only way a user would be able to get the same ID is if the two persons at the same exact millisecond manages\n\t * to get 5 the same random numbers between 0-65535 it also uses a counter so each call will be guaranteed to be page unique.\n\t * It's more probable for the earth to be hit with an asteriod. You can also if you want to be 100% sure set the plupload.guidPrefix property\n\t * to an user unique key.\n\t *\n\t * @method guid\n\t * @static\n\t * @return {String} Virtually unique id.\n\t */\n\tguid : u.Basic.guid,\n\n\t/**\n\t * Get array of DOM Elements by their ids.\n\t *\n\t * @method get\n\t * @param {String} id Identifier of the DOM Element\n\t * @return {Array}\n\t*/\n\tgetAll : function get(ids) {\n\t\tvar els = [], el;\n\n\t\tif (plupload.typeOf(ids) !== 'array') {\n\t\t\tids = [ids];\n\t\t}\n\n\t\tvar i = ids.length;\n\t\twhile (i--) {\n\t\t\tel = plupload.get(ids[i]);\n\t\t\tif (el) {\n\t\t\t\tels.push(el);\n\t\t\t}\n\t\t}\n\n\t\treturn els.length ? els : null;\n\t},\n\n\t/**\n\tGet DOM element by id\n\n\t@method get\n\t@param {String} id Identifier of the DOM Element\n\t@return {Node}\n\t*/\n\tget: u.Dom.get,\n\n\t/**\n\t * Executes the callback function for each item in array/object. If you return false in the\n\t * callback it will break the loop.\n\t *\n\t * @method each\n\t * @static\n\t * @param {Object} obj Object to iterate.\n\t * @param {function} callback Callback function to execute for each item.\n\t */\n\teach : u.Basic.each,\n\n\t/**\n\t * Returns the absolute x, y position of an Element. The position will be returned in a object with x, y fields.\n\t *\n\t * @method getPos\n\t * @static\n\t * @param {Element} node HTML element or element id to get x, y position from.\n\t * @param {Element} root Optional root element to stop calculations at.\n\t * @return {object} Absolute position of the specified element object with x, y fields.\n\t */\n\tgetPos : u.Dom.getPos,\n\n\t/**\n\t * Returns the size of the specified node in pixels.\n\t *\n\t * @method getSize\n\t * @static\n\t * @param {Node} node Node to get the size of.\n\t * @return {Object} Object with a w and h property.\n\t */\n\tgetSize : u.Dom.getSize,\n\n\t/**\n\t * Encodes the specified string.\n\t *\n\t * @method xmlEncode\n\t * @static\n\t * @param {String} s String to encode.\n\t * @return {String} Encoded string.\n\t */\n\txmlEncode : function(str) {\n\t\tvar xmlEncodeChars = {'<' : 'lt', '>' : 'gt', '&' : 'amp', '\"' : 'quot', '\\'' : '#39'}, xmlEncodeRegExp = /[<>&\\\"\\']/g;\n\n\t\treturn str ? ('' + str).replace(xmlEncodeRegExp, function(chr) {\n\t\t\treturn xmlEncodeChars[chr] ? '&' + xmlEncodeChars[chr] + ';' : chr;\n\t\t}) : str;\n\t},\n\n\t/**\n\t * Forces anything into an array.\n\t *\n\t * @method toArray\n\t * @static\n\t * @param {Object} obj Object with length field.\n\t * @return {Array} Array object containing all items.\n\t */\n\ttoArray : u.Basic.toArray,\n\n\t/**\n\t * Find an element in array and return its index if present, otherwise return -1.\n\t *\n\t * @method inArray\n\t * @static\n\t * @param {mixed} needle Element to find\n\t * @param {Array} array\n\t * @return {Int} Index of the element, or -1 if not found\n\t */\n\tinArray : u.Basic.inArray,\n\n\t/**\n\tRecieve an array of functions (usually async) to call in sequence, each  function\n\treceives a callback as first argument that it should call, when it completes. Finally,\n\tafter everything is complete, main callback is called. Passing truthy value to the\n\tcallback as a first argument will interrupt the sequence and invoke main callback\n\timmediately.\n\n\t@method inSeries\n\t@static\n\t@param {Array} queue Array of functions to call in sequence\n\t@param {Function} cb Main callback that is called in the end, or in case of error\n\t*/\n\tinSeries: u.Basic.inSeries,\n\n\t/**\n\t * Extends the language pack object with new items.\n\t *\n\t * @method addI18n\n\t * @static\n\t * @param {Object} pack Language pack items to add.\n\t * @return {Object} Extended language pack object.\n\t */\n\taddI18n : o.core.I18n.addI18n,\n\n\t/**\n\t * Translates the specified string by checking for the english string in the language pack lookup.\n\t *\n\t * @method translate\n\t * @static\n\t * @param {String} str String to look for.\n\t * @return {String} Translated string or the input string if it wasn't found.\n\t */\n\ttranslate : o.core.I18n.translate,\n\n\t/**\n\t * Pseudo sprintf implementation - simple way to replace tokens with specified values.\n\t *\n\t * @param {String} str String with tokens\n\t * @return {String} String with replaced tokens\n\t */\n\tsprintf : u.Basic.sprintf,\n\n\t/**\n\t * Checks if object is empty.\n\t *\n\t * @method isEmptyObj\n\t * @static\n\t * @param {Object} obj Object to check.\n\t * @return {Boolean}\n\t */\n\tisEmptyObj : u.Basic.isEmptyObj,\n\n\t/**\n\t * Checks if specified DOM element has specified class.\n\t *\n\t * @method hasClass\n\t * @static\n\t * @param {Object} obj DOM element like object to add handler to.\n\t * @param {String} name Class name\n\t */\n\thasClass : u.Dom.hasClass,\n\n\t/**\n\t * Adds specified className to specified DOM element.\n\t *\n\t * @method addClass\n\t * @static\n\t * @param {Object} obj DOM element like object to add handler to.\n\t * @param {String} name Class name\n\t */\n\taddClass : u.Dom.addClass,\n\n\t/**\n\t * Removes specified className from specified DOM element.\n\t *\n\t * @method removeClass\n\t * @static\n\t * @param {Object} obj DOM element like object to add handler to.\n\t * @param {String} name Class name\n\t */\n\tremoveClass : u.Dom.removeClass,\n\n\t/**\n\t * Returns a given computed style of a DOM element.\n\t *\n\t * @method getStyle\n\t * @static\n\t * @param {Object} obj DOM element like object.\n\t * @param {String} name Style you want to get from the DOM element\n\t */\n\tgetStyle : u.Dom.getStyle,\n\n\t/**\n\t * Adds an event handler to the specified object and store reference to the handler\n\t * in objects internal Plupload registry (@see removeEvent).\n\t *\n\t * @method addEvent\n\t * @static\n\t * @param {Object} obj DOM element like object to add handler to.\n\t * @param {String} name Name to add event listener to.\n\t * @param {Function} callback Function to call when event occurs.\n\t * @param {String} (optional) key that might be used to add specifity to the event record.\n\t */\n\taddEvent : u.Events.addEvent,\n\n\t/**\n\t * Remove event handler from the specified object. If third argument (callback)\n\t * is not specified remove all events with the specified name.\n\t *\n\t * @method removeEvent\n\t * @static\n\t * @param {Object} obj DOM element to remove event listener(s) from.\n\t * @param {String} name Name of event listener to remove.\n\t * @param {Function|String} (optional) might be a callback or unique key to match.\n\t */\n\tremoveEvent: u.Events.removeEvent,\n\n\t/**\n\t * Remove all kind of events from the specified object\n\t *\n\t * @method removeAllEvents\n\t * @static\n\t * @param {Object} obj DOM element to remove event listeners from.\n\t * @param {String} (optional) unique key to match, when removing events.\n\t */\n\tremoveAllEvents: u.Events.removeAllEvents,\n\n\t/**\n\t * Cleans the specified name from national characters (diacritics). The result will be a name with only a-z, 0-9 and _.\n\t *\n\t * @method cleanName\n\t * @static\n\t * @param {String} s String to clean up.\n\t * @return {String} Cleaned string.\n\t */\n\tcleanName : function(name) {\n\t\tvar i, lookup;\n\n\t\t// Replace diacritics\n\t\tlookup = [\n\t\t\t/[\\300-\\306]/g, 'A', /[\\340-\\346]/g, 'a',\n\t\t\t/\\307/g, 'C', /\\347/g, 'c',\n\t\t\t/[\\310-\\313]/g, 'E', /[\\350-\\353]/g, 'e',\n\t\t\t/[\\314-\\317]/g, 'I', /[\\354-\\357]/g, 'i',\n\t\t\t/\\321/g, 'N', /\\361/g, 'n',\n\t\t\t/[\\322-\\330]/g, 'O', /[\\362-\\370]/g, 'o',\n\t\t\t/[\\331-\\334]/g, 'U', /[\\371-\\374]/g, 'u'\n\t\t];\n\n\t\tfor (i = 0; i < lookup.length; i += 2) {\n\t\t\tname = name.replace(lookup[i], lookup[i + 1]);\n\t\t}\n\n\t\t// Replace whitespace\n\t\tname = name.replace(/\\s+/g, '_');\n\n\t\t// Remove anything else\n\t\tname = name.replace(/[^a-z0-9_\\-\\.]+/gi, '');\n\n\t\treturn name;\n\t},\n\n\t/**\n\t * Builds a full url out of a base URL and an object with items to append as query string items.\n\t *\n\t * @method buildUrl\n\t * @static\n\t * @param {String} url Base URL to append query string items to.\n\t * @param {Object} items Name/value object to serialize as a querystring.\n\t * @return {String} String with url + serialized query string items.\n\t */\n\tbuildUrl: function(url, items) {\n\t\tvar query = '';\n\n\t\tplupload.each(items, function(value, name) {\n\t\t\tquery += (query ? '&' : '') + encodeURIComponent(name) + '=' + encodeURIComponent(value);\n\t\t});\n\n\t\tif (query) {\n\t\t\turl += (url.indexOf('?') > 0 ? '&' : '?') + query;\n\t\t}\n\n\t\treturn url;\n\t},\n\n\t/**\n\t * Formats the specified number as a size string for example 1024 becomes 1 KB.\n\t *\n\t * @method formatSize\n\t * @static\n\t * @param {Number} size Size to format as string.\n\t * @return {String} Formatted size string.\n\t */\n\tformatSize : function(size) {\n\n\t\tif (size === undef || /\\D/.test(size)) {\n\t\t\treturn plupload.translate('N/A');\n\t\t}\n\n\t\tfunction round(num, precision) {\n\t\t\treturn Math.round(num * Math.pow(10, precision)) / Math.pow(10, precision);\n\t\t}\n\n\t\tvar boundary = Math.pow(1024, 4);\n\n\t\t// TB\n\t\tif (size > boundary) {\n\t\t\treturn round(size / boundary, 1) + \" \" + plupload.translate('tb');\n\t\t}\n\n\t\t// GB\n\t\tif (size > (boundary/=1024)) {\n\t\t\treturn round(size / boundary, 1) + \" \" + plupload.translate('gb');\n\t\t}\n\n\t\t// MB\n\t\tif (size > (boundary/=1024)) {\n\t\t\treturn round(size / boundary, 1) + \" \" + plupload.translate('mb');\n\t\t}\n\n\t\t// KB\n\t\tif (size > 1024) {\n\t\t\treturn Math.round(size / 1024) + \" \" + plupload.translate('kb');\n\t\t}\n\n\t\treturn size + \" \" + plupload.translate('b');\n\t},\n\n\n\t/**\n\t * Parses the specified size string into a byte value. For example 10kb becomes 10240.\n\t *\n\t * @method parseSize\n\t * @static\n\t * @param {String|Number} size String to parse or number to just pass through.\n\t * @return {Number} Size in bytes.\n\t */\n\tparseSize : u.Basic.parseSizeStr,\n\n\n\t/**\n\t * A way to predict what runtime will be choosen in the current environment with the\n\t * specified settings.\n\t *\n\t * @method predictRuntime\n\t * @static\n\t * @param {Object|String} config Plupload settings to check\n\t * @param {String} [runtimes] Comma-separated list of runtimes to check against\n\t * @return {String} Type of compatible runtime\n\t */\n\tpredictRuntime : function(config, runtimes) {\n\t\tvar up, runtime;\n\n\t\tup = new plupload.Uploader(config);\n\t\truntime = Runtime.thatCan(up.getOption().required_features, runtimes || config.runtimes);\n\t\tup.destroy();\n\t\treturn runtime;\n\t},\n\n\t/**\n\t * Registers a filter that will be executed for each file added to the queue.\n\t * If callback returns false, file will not be added.\n\t *\n\t * Callback receives two arguments: a value for the filter as it was specified in settings.filters\n\t * and a file to be filtered. Callback is executed in the context of uploader instance.\n\t *\n\t * @method addFileFilter\n\t * @static\n\t * @param {String} name Name of the filter by which it can be referenced in settings.filters\n\t * @param {String} cb Callback - the actual routine that every added file must pass\n\t */\n\taddFileFilter: function(name, cb) {\n\t\tfileFilters[name] = cb;\n\t}\n};\n\n\nplupload.addFileFilter('mime_types', function(filters, file, cb) {\n\tif (filters.length && !filters.regexp.test(file.name)) {\n\t\tthis.trigger('Error', {\n\t\t\tcode : plupload.FILE_EXTENSION_ERROR,\n\t\t\tmessage : plupload.translate('File extension error.'),\n\t\t\tfile : file\n\t\t});\n\t\tcb(false);\n\t} else {\n\t\tcb(true);\n\t}\n});\n\n\nplupload.addFileFilter('max_file_size', function(maxSize, file, cb) {\n\tvar undef;\n\n\tmaxSize = plupload.parseSize(maxSize);\n\n\t// Invalid file size\n\tif (file.size !== undef && maxSize && file.size > maxSize) {\n\t\tthis.trigger('Error', {\n\t\t\tcode : plupload.FILE_SIZE_ERROR,\n\t\t\tmessage : plupload.translate('File size error.'),\n\t\t\tfile : file\n\t\t});\n\t\tcb(false);\n\t} else {\n\t\tcb(true);\n\t}\n});\n\n\nplupload.addFileFilter('prevent_duplicates', function(value, file, cb) {\n\tif (value) {\n\t\tvar ii = this.files.length;\n\t\twhile (ii--) {\n\t\t\t// Compare by name and size (size might be 0 or undefined, but still equivalent for both)\n\t\t\tif (file.name === this.files[ii].name && file.size === this.files[ii].size) {\n\t\t\t\tthis.trigger('Error', {\n\t\t\t\t\tcode : plupload.FILE_DUPLICATE_ERROR,\n\t\t\t\t\tmessage : plupload.translate('Duplicate file error.'),\n\t\t\t\t\tfile : file\n\t\t\t\t});\n\t\t\t\tcb(false);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\tcb(true);\n});\n\nplupload.addFileFilter('prevent_empty', function(value, file, cb) {\n\tif (value && !file.size && file.size !== undef) {\n\t\tthis.trigger('Error', {\n\t\t\tcode : plupload.FILE_SIZE_ERROR,\n\t\t\tmessage : plupload.translate('File size error.'),\n\t\t\tfile : file\n\t\t});\n\t\tcb(false);\n\t} else {\n\t\tcb(true);\n\t}\n});\n\n\n/**\n@class Uploader\n@constructor\n\n@param {Object} settings For detailed information about each option check documentation.\n\t@param {String|DOMElement} settings.browse_button id of the DOM element or DOM element itself to use as file dialog trigger.\n\t@param {Number|String} [settings.chunk_size=0] Chunk size in bytes to slice the file into. Shorcuts with b, kb, mb, gb, tb suffixes also supported. `e.g. 204800 or \"204800b\" or \"200kb\"`. By default - disabled.\n\t@param {String|DOMElement} [settings.container] id of the DOM element or DOM element itself that will be used to wrap uploader structures. Defaults to immediate parent of the `browse_button` element.\n\t@param {String|DOMElement} [settings.drop_element] id of the DOM element or DOM element itself to use as a drop zone for Drag-n-Drop.\n\t@param {String} [settings.file_data_name=\"file\"] Name for the file field in Multipart formated message.\n\t@param {Object} [settings.filters={}] Set of file type filters.\n\t\t@param {String|Number} [settings.filters.max_file_size=0] Maximum file size that the user can pick, in bytes. Optionally supports b, kb, mb, gb, tb suffixes. `e.g. \"10mb\" or \"1gb\"`. By default - not set. Dispatches `plupload.FILE_SIZE_ERROR`.\n\t\t@param {Array} [settings.filters.mime_types=[]] List of file types to accept, each one defined by title and list of extensions. `e.g. {title : \"Image files\", extensions : \"jpg,jpeg,gif,png\"}`. Dispatches `plupload.FILE_EXTENSION_ERROR`\n\t\t@param {Boolean} [settings.filters.prevent_duplicates=false] Do not let duplicates into the queue. Dispatches `plupload.FILE_DUPLICATE_ERROR`.\n\t\t@param {Boolean} [settings.filters.prevent_empty=true] Do not let empty files into the queue (IE10 is known to hang for example when trying to upload such). Dispatches `plupload.FILE_SIZE_ERROR`.\n\t@param {String} [settings.flash_swf_url] URL of the Flash swf.\n\t@param {Object} [settings.headers] Custom headers to send with the upload. Hash of name/value pairs.\n\t@param {String} [settings.http_method=\"POST\"] HTTP method to use during upload (only PUT or POST allowed).\n\t@param {Number} [settings.max_retries=0] How many times to retry the chunk or file, before triggering Error event.\n\t@param {Boolean} [settings.multipart=true] Whether to send file and additional parameters as Multipart formated message.\n\t@param {Object} [settings.multipart_params] Hash of key/value pairs to send with every file upload.\n\t@param {Boolean} [settings.multi_selection=true] Enable ability to select multiple files at once in file dialog.\n\t@param {String|Object} [settings.required_features] Either comma-separated list or hash of required features that chosen runtime should absolutely possess.\n\t@param {Object} [settings.resize] Enable resizng of images on client-side. Applies to `image/jpeg` and `image/png` only. `e.g. {width : 200, height : 200, quality : 90, crop: true}`\n\t\t@param {Number} [settings.resize.width] If image is bigger, it will be resized.\n\t\t@param {Number} [settings.resize.height] If image is bigger, it will be resized.\n\t\t@param {Number} [settings.resize.quality=90] Compression quality for jpegs (1-100).\n\t\t@param {Boolean} [settings.resize.crop=false] Whether to crop images to exact dimensions. By default they will be resized proportionally.\n\t@param {String} [settings.runtimes=\"html5,flash,silverlight,html4\"] Comma separated list of runtimes, that Plupload will try in turn, moving to the next if previous fails.\n\t@param {String} [settings.silverlight_xap_url] URL of the Silverlight xap.\n\t@param {Boolean} [settings.send_chunk_number=true] Whether to send chunks and chunk numbers, or total and offset bytes.\n\t@param {Boolean} [settings.send_file_name=true] Whether to send file name as additional argument - 'name' (required for chunked uploads and some other cases where file name cannot be sent via normal ways).\n\t@param {String} settings.url URL of the server-side upload handler.\n\t@param {Boolean} [settings.unique_names=false] If true will generate unique filenames for uploaded files.\n\n*/\nplupload.Uploader = function(options) {\n\t/**\n\tFires when the current RunTime has been initialized.\n\n\t@event Init\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t */\n\n\t/**\n\tFires after the init event incase you need to perform actions there.\n\n\t@event PostInit\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t */\n\n\t/**\n\tFires when the option is changed in via uploader.setOption().\n\n\t@event OptionChanged\n\t@since 2.1\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {String} name Name of the option that was changed\n\t@param {Mixed} value New value for the specified option\n\t@param {Mixed} oldValue Previous value of the option\n\t */\n\n\t/**\n\tFires when the silverlight/flash or other shim needs to move.\n\n\t@event Refresh\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t */\n\n\t/**\n\tFires when the overall state is being changed for the upload queue.\n\n\t@event StateChanged\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t */\n\n\t/**\n\tFires when browse_button is clicked and browse dialog shows.\n\n\t@event Browse\n\t@since 2.1.2\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t */\n\n\t/**\n\tFires for every filtered file before it is added to the queue.\n\n\t@event FileFiltered\n\t@since 2.1\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {plupload.File} file Another file that has to be added to the queue.\n\t */\n\n\t/**\n\tFires when the file queue is changed. In other words when files are added/removed to the files array of the uploader instance.\n\n\t@event QueueChanged\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t */\n\n\t/**\n\tFires after files were filtered and added to the queue.\n\n\t@event FilesAdded\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {Array} files Array of file objects that were added to queue by the user.\n\t */\n\n\t/**\n\tFires when file is removed from the queue.\n\n\t@event FilesRemoved\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {Array} files Array of files that got removed.\n\t */\n\n\t/**\n\tFires just before a file is uploaded. Can be used to cancel the upload for the specified file\n\tby returning false from the handler.\n\n\t@event BeforeUpload\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {plupload.File} file File to be uploaded.\n\t */\n\n\t/**\n\tFires when a file is to be uploaded by the runtime.\n\n\t@event UploadFile\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {plupload.File} file File to be uploaded.\n\t */\n\n\t/**\n\tFires while a file is being uploaded. Use this event to update the current file upload progress.\n\n\t@event UploadProgress\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {plupload.File} file File that is currently being uploaded.\n\t */\n\n\t/**\n\t* Fires just before a chunk is uploaded. This event enables you to override settings\n\t* on the uploader instance before the chunk is uploaded.\n\t*\n\t* @event BeforeChunkUpload\n\t* @param {plupload.Uploader} uploader Uploader instance sending the event.\n\t* @param {plupload.File} file File to be uploaded.\n\t* @param {Object} args POST params to be sent.\n\t* @param {Blob} chunkBlob Current blob.\n\t* @param {offset} offset Current offset.\n\t*/\n\n\t/**\n\tFires when file chunk is uploaded.\n\n\t@event ChunkUploaded\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {plupload.File} file File that the chunk was uploaded for.\n\t@param {Object} result Object with response properties.\n\t\t@param {Number} result.offset The amount of bytes the server has received so far, including this chunk.\n\t\t@param {Number} result.total The size of the file.\n\t\t@param {String} result.response The response body sent by the server.\n\t\t@param {Number} result.status The HTTP status code sent by the server.\n\t\t@param {String} result.responseHeaders All the response headers as a single string.\n\t */\n\n\t/**\n\tFires when a file is successfully uploaded.\n\n\t@event FileUploaded\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {plupload.File} file File that was uploaded.\n\t@param {Object} result Object with response properties.\n\t\t@param {String} result.response The response body sent by the server.\n\t\t@param {Number} result.status The HTTP status code sent by the server.\n\t\t@param {String} result.responseHeaders All the response headers as a single string.\n\t */\n\n\t/**\n\tFires when all files in a queue are uploaded.\n\n\t@event UploadComplete\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {Array} files Array of file objects that was added to queue/selected by the user.\n\t */\n\n\t/**\n\tFires when a error occurs.\n\n\t@event Error\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t@param {Object} error Contains code, message and sometimes file and other details.\n\t\t@param {Number} error.code The plupload error code.\n\t\t@param {String} error.message Description of the error (uses i18n).\n\t */\n\n\t/**\n\tFires when destroy method is called.\n\n\t@event Destroy\n\t@param {plupload.Uploader} uploader Uploader instance sending the event.\n\t */\n\tvar uid = plupload.guid()\n\t, settings\n\t, files = []\n\t, preferred_caps = {}\n\t, fileInputs = []\n\t, fileDrops = []\n\t, startTime\n\t, total\n\t, disabled = false\n\t, xhr\n\t;\n\n\n\t// Private methods\n\tfunction uploadNext() {\n\t\tvar file, count = 0, i;\n\n\t\tif (this.state == plupload.STARTED) {\n\t\t\t// Find first QUEUED file\n\t\t\tfor (i = 0; i < files.length; i++) {\n\t\t\t\tif (!file && files[i].status == plupload.QUEUED) {\n\t\t\t\t\tfile = files[i];\n\t\t\t\t\tif (this.trigger(\"BeforeUpload\", file)) {\n\t\t\t\t\t\tfile.status = plupload.UPLOADING;\n\t\t\t\t\t\tthis.trigger(\"UploadFile\", file);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// All files are DONE or FAILED\n\t\t\tif (count == files.length) {\n\t\t\t\tif (this.state !== plupload.STOPPED) {\n\t\t\t\t\tthis.state = plupload.STOPPED;\n\t\t\t\t\tthis.trigger(\"StateChanged\");\n\t\t\t\t}\n\t\t\t\tthis.trigger(\"UploadComplete\", files);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction calcFile(file) {\n\t\tfile.percent = file.size > 0 ? Math.ceil(file.loaded / file.size * 100) : 100;\n\t\tcalc();\n\t}\n\n\n\tfunction calc() {\n\t\tvar i, file;\n\t\tvar loaded;\n\t\tvar loadedDuringCurrentSession = 0;\n\n\t\t// Reset stats\n\t\ttotal.reset();\n\n\t\t// Check status, size, loaded etc on all files\n\t\tfor (i = 0; i < files.length; i++) {\n\t\t\tfile = files[i];\n\n\t\t\tif (file.size !== undef) {\n\t\t\t\t// We calculate totals based on original file size\n\t\t\t\ttotal.size += file.origSize;\n\n\t\t\t\t// Since we cannot predict file size after resize, we do opposite and\n\t\t\t\t// interpolate loaded amount to match magnitude of total\n\t\t\t\tloaded = file.loaded * file.origSize / file.size;\n\n\t\t\t\tif (!file.completeTimestamp || file.completeTimestamp > startTime) {\n\t\t\t\t\tloadedDuringCurrentSession += loaded;\n\t\t\t\t}\n\n\t\t\t\ttotal.loaded += loaded;\n\t\t\t} else {\n\t\t\t\ttotal.size = undef;\n\t\t\t}\n\n\t\t\tif (file.status == plupload.DONE) {\n\t\t\t\ttotal.uploaded++;\n\t\t\t} else if (file.status == plupload.FAILED) {\n\t\t\t\ttotal.failed++;\n\t\t\t} else {\n\t\t\t\ttotal.queued++;\n\t\t\t}\n\t\t}\n\n\t\t// If we couldn't calculate a total file size then use the number of files to calc percent\n\t\tif (total.size === undef) {\n\t\t\ttotal.percent = files.length > 0 ? Math.ceil(total.uploaded / files.length * 100) : 0;\n\t\t} else {\n\t\t\ttotal.bytesPerSec = Math.ceil(loadedDuringCurrentSession / ((+new Date() - startTime || 1) / 1000.0));\n\t\t\ttotal.percent = total.size > 0 ? Math.ceil(total.loaded / total.size * 100) : 0;\n\t\t}\n\t}\n\n\n\tfunction getRUID() {\n\t\tvar ctrl = fileInputs[0] || fileDrops[0];\n\t\tif (ctrl) {\n\t\t\treturn ctrl.getRuntime().uid;\n\t\t}\n\t\treturn false;\n\t}\n\n\n\tfunction bindEventListeners() {\n\t\tthis.bind('FilesAdded FilesRemoved', function(up) {\n\t\t\tup.trigger('QueueChanged');\n\t\t\tup.refresh();\n\t\t});\n\n\t\tthis.bind('CancelUpload', onCancelUpload);\n\n\t\tthis.bind('BeforeUpload', onBeforeUpload);\n\n\t\tthis.bind('UploadFile', onUploadFile);\n\n\t\tthis.bind('UploadProgress', onUploadProgress);\n\n\t\tthis.bind('StateChanged', onStateChanged);\n\n\t\tthis.bind('QueueChanged', calc);\n\n\t\tthis.bind('Error', onError);\n\n\t\tthis.bind('FileUploaded', onFileUploaded);\n\n\t\tthis.bind('Destroy', onDestroy);\n\t}\n\n\n\tfunction initControls(settings, cb) {\n\t\tvar self = this, inited = 0, queue = [];\n\n\t\t// common settings\n\t\tvar options = {\n\t\t\truntime_order: settings.runtimes,\n\t\t\trequired_caps: settings.required_features,\n\t\t\tpreferred_caps: preferred_caps,\n\t\t\tswf_url: settings.flash_swf_url,\n\t\t\txap_url: settings.silverlight_xap_url\n\t\t};\n\n\t\t// add runtime specific options if any\n\t\tplupload.each(settings.runtimes.split(/\\s*,\\s*/), function(runtime) {\n\t\t\tif (settings[runtime]) {\n\t\t\t\toptions[runtime] = settings[runtime];\n\t\t\t}\n\t\t});\n\n\t\t// initialize file pickers - there can be many\n\t\tif (settings.browse_button) {\n\t\t\tplupload.each(settings.browse_button, function(el) {\n\t\t\t\tqueue.push(function(cb) {\n\t\t\t\t\tvar fileInput = new o.file.FileInput(plupload.extend({}, options, {\n\t\t\t\t\t\taccept: settings.filters.mime_types,\n\t\t\t\t\t\tname: settings.file_data_name,\n\t\t\t\t\t\tmultiple: settings.multi_selection,\n\t\t\t\t\t\tcontainer: settings.container,\n\t\t\t\t\t\tbrowse_button: el\n\t\t\t\t\t}));\n\n\t\t\t\t\tfileInput.onready = function() {\n\t\t\t\t\t\tvar info = Runtime.getInfo(this.ruid);\n\n\t\t\t\t\t\t// for backward compatibility\n\t\t\t\t\t\tplupload.extend(self.features, {\n\t\t\t\t\t\t\tchunks: info.can('slice_blob'),\n\t\t\t\t\t\t\tmultipart: info.can('send_multipart'),\n\t\t\t\t\t\t\tmulti_selection: info.can('select_multiple')\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tinited++;\n\t\t\t\t\t\tfileInputs.push(this);\n\t\t\t\t\t\tcb();\n\t\t\t\t\t};\n\n\t\t\t\t\tfileInput.onchange = function() {\n\t\t\t\t\t\tself.addFile(this.files);\n\t\t\t\t\t};\n\n\t\t\t\t\tfileInput.bind('mouseenter mouseleave mousedown mouseup', function(e) {\n\t\t\t\t\t\tif (!disabled) {\n\t\t\t\t\t\t\tif (settings.browse_button_hover) {\n\t\t\t\t\t\t\t\tif ('mouseenter' === e.type) {\n\t\t\t\t\t\t\t\t\tplupload.addClass(el, settings.browse_button_hover);\n\t\t\t\t\t\t\t\t} else if ('mouseleave' === e.type) {\n\t\t\t\t\t\t\t\t\tplupload.removeClass(el, settings.browse_button_hover);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (settings.browse_button_active) {\n\t\t\t\t\t\t\t\tif ('mousedown' === e.type) {\n\t\t\t\t\t\t\t\t\tplupload.addClass(el, settings.browse_button_active);\n\t\t\t\t\t\t\t\t} else if ('mouseup' === e.type) {\n\t\t\t\t\t\t\t\t\tplupload.removeClass(el, settings.browse_button_active);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tfileInput.bind('mousedown', function() {\n\t\t\t\t\t\tself.trigger('Browse');\n\t\t\t\t\t});\n\n\t\t\t\t\tfileInput.bind('error runtimeerror', function() {\n\t\t\t\t\t\tfileInput = null;\n\t\t\t\t\t\tcb();\n\t\t\t\t\t});\n\n\t\t\t\t\tfileInput.init();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t// initialize drop zones\n\t\tif (settings.drop_element) {\n\t\t\tplupload.each(settings.drop_element, function(el) {\n\t\t\t\tqueue.push(function(cb) {\n\t\t\t\t\tvar fileDrop = new o.file.FileDrop(plupload.extend({}, options, {\n\t\t\t\t\t\tdrop_zone: el\n\t\t\t\t\t}));\n\n\t\t\t\t\tfileDrop.onready = function() {\n\t\t\t\t\t\tvar info = Runtime.getInfo(this.ruid);\n\n\t\t\t\t\t\t// for backward compatibility\n\t\t\t\t\t\tplupload.extend(self.features, {\n\t\t\t\t\t\t\tchunks: info.can('slice_blob'),\n\t\t\t\t\t\t\tmultipart: info.can('send_multipart'),\n\t\t\t\t\t\t\tdragdrop: info.can('drag_and_drop')\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tinited++;\n\t\t\t\t\t\tfileDrops.push(this);\n\t\t\t\t\t\tcb();\n\t\t\t\t\t};\n\n\t\t\t\t\tfileDrop.ondrop = function() {\n\t\t\t\t\t\tself.addFile(this.files);\n\t\t\t\t\t};\n\n\t\t\t\t\tfileDrop.bind('error runtimeerror', function() {\n\t\t\t\t\t\tfileDrop = null;\n\t\t\t\t\t\tcb();\n\t\t\t\t\t});\n\n\t\t\t\t\tfileDrop.init();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\n\t\tplupload.inSeries(queue, function() {\n\t\t\tif (typeof(cb) === 'function') {\n\t\t\t\tcb(inited);\n\t\t\t}\n\t\t});\n\t}\n\n\n\tfunction resizeImage(blob, params, runtimeOptions, cb) {\n\t\tvar img = new o.image.Image();\n\n\t\ttry {\n\t\t\timg.onload = function() {\n\t\t\t\t// no manipulation required if...\n\t\t\t\tif (params.width > this.width &&\n\t\t\t\t\tparams.height > this.height &&\n\t\t\t\t\tparams.quality === undef &&\n\t\t\t\t\tparams.preserve_headers &&\n\t\t\t\t\t!params.crop\n\t\t\t\t) {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t\tcb(blob);\n\t\t\t\t} else {\n\t\t\t\t\t// otherwise downsize\n\t\t\t\t\timg.downsize(params.width, params.height, params.crop, params.preserve_headers);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\timg.onresize = function() {\n\t\t\t\tvar resizedBlob = this.getAsBlob(blob.type, params.quality);\n\t\t\t\tthis.destroy();\n\t\t\t\tcb(resizedBlob);\n\t\t\t};\n\n\t\t\timg.bind('error runtimeerror', function() {\n\t\t\t\tthis.destroy();\n\t\t\t\tcb(blob);\n\t\t\t});\n\n\t\t\timg.load(blob, runtimeOptions);\n\t\t} catch(ex) {\n\t\t\tcb(blob);\n\t\t}\n\t}\n\n\n\tfunction setOption(option, value, init) {\n\t\tvar self = this, reinitRequired = false;\n\n\t\tfunction _setOption(option, value, init) {\n\t\t\tvar oldValue = settings[option];\n\n\t\t\tswitch (option) {\n\t\t\t\tcase 'max_file_size':\n\t\t\t\t\tif (option === 'max_file_size') {\n\t\t\t\t\t\tsettings.max_file_size = settings.filters.max_file_size = value;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'chunk_size':\n\t\t\t\t\tif (value = plupload.parseSize(value)) {\n\t\t\t\t\t\tsettings[option] = value;\n\t\t\t\t\t\tsettings.send_file_name = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'multipart':\n\t\t\t\t\tsettings[option] = value;\n\t\t\t\t\tif (!value) {\n\t\t\t\t\t\tsettings.send_file_name = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'http_method':\n\t\t\t\t\tsettings[option] = value.toUpperCase() === 'PUT' ? 'PUT' : 'POST';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'unique_names':\n\t\t\t\t\tsettings[option] = value;\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tsettings.send_file_name = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'filters':\n\t\t\t\t\t// for sake of backward compatibility\n\t\t\t\t\tif (plupload.typeOf(value) === 'array') {\n\t\t\t\t\t\tvalue = {\n\t\t\t\t\t\t\tmime_types: value\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (init) {\n\t\t\t\t\t\tplupload.extend(settings.filters, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsettings.filters = value;\n\t\t\t\t\t}\n\n\t\t\t\t\t// if file format filters are being updated, regenerate the matching expressions\n\t\t\t\t\tif (value.mime_types) {\n\t\t\t\t\t\tif (plupload.typeOf(value.mime_types) === 'string') {\n\t\t\t\t\t\t\tvalue.mime_types = o.core.utils.Mime.mimes2extList(value.mime_types);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvalue.mime_types.regexp = (function(filters) {\n\t\t\t\t\t\t\tvar extensionsRegExp = [];\n\n\t\t\t\t\t\t\tplupload.each(filters, function(filter) {\n\t\t\t\t\t\t\t\tplupload.each(filter.extensions.split(/,/), function(ext) {\n\t\t\t\t\t\t\t\t\tif (/^\\s*\\*\\s*$/.test(ext)) {\n\t\t\t\t\t\t\t\t\t\textensionsRegExp.push('\\\\.*');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\textensionsRegExp.push('\\\\.' + ext.replace(new RegExp('[' + ('/^$.*+?|()[]{}\\\\'.replace(/./g, '\\\\$&')) + ']', 'g'), '\\\\$&'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn new RegExp('(' + extensionsRegExp.join('|') + ')$', 'i');\n\t\t\t\t\t\t}(value.mime_types));\n\n\t\t\t\t\t\tsettings.filters.mime_types = value.mime_types;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'resize':\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tsettings.resize = plupload.extend({\n\t\t\t\t\t\t\tpreserve_headers: true,\n\t\t\t\t\t\t\tcrop: false\n\t\t\t\t\t\t}, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsettings.resize = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'prevent_duplicates':\n\t\t\t\t\tsettings.prevent_duplicates = settings.filters.prevent_duplicates = !!value;\n\t\t\t\t\tbreak;\n\n\t\t\t\t// options that require reinitialisation\n\t\t\t\tcase 'container':\n\t\t\t\tcase 'browse_button':\n\t\t\t\tcase 'drop_element':\n\t\t\t\t\t\tvalue = 'container' === option\n\t\t\t\t\t\t\t? plupload.get(value)\n\t\t\t\t\t\t\t: plupload.getAll(value)\n\t\t\t\t\t\t\t;\n\n\t\t\t\tcase 'runtimes':\n\t\t\t\tcase 'multi_selection':\n\t\t\t\tcase 'flash_swf_url':\n\t\t\t\tcase 'silverlight_xap_url':\n\t\t\t\t\tsettings[option] = value;\n\t\t\t\t\tif (!init) {\n\t\t\t\t\t\treinitRequired = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tsettings[option] = value;\n\t\t\t}\n\n\t\t\tif (!init) {\n\t\t\t\tself.trigger('OptionChanged', option, value, oldValue);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof(option) === 'object') {\n\t\t\tplupload.each(option, function(value, option) {\n\t\t\t\t_setOption(option, value, init);\n\t\t\t});\n\t\t} else {\n\t\t\t_setOption(option, value, init);\n\t\t}\n\n\t\tif (init) {\n\t\t\t// Normalize the list of required capabilities\n\t\t\tsettings.required_features = normalizeCaps(plupload.extend({}, settings));\n\n\t\t\t// Come up with the list of capabilities that can affect default mode in a multi-mode runtimes\n\t\t\tpreferred_caps = normalizeCaps(plupload.extend({}, settings, {\n\t\t\t\trequired_features: true\n\t\t\t}));\n\t\t} else if (reinitRequired) {\n\t\t\tself.trigger('Destroy');\n\n\t\t\tinitControls.call(self, settings, function(inited) {\n\t\t\t\tif (inited) {\n\t\t\t\t\tself.runtime = Runtime.getInfo(getRUID()).type;\n\t\t\t\t\tself.trigger('Init', { runtime: self.runtime });\n\t\t\t\t\tself.trigger('PostInit');\n\t\t\t\t} else {\n\t\t\t\t\tself.trigger('Error', {\n\t\t\t\t\t\tcode : plupload.INIT_ERROR,\n\t\t\t\t\t\tmessage : plupload.translate('Init error.')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\n\t// Internal event handlers\n\tfunction onBeforeUpload(up, file) {\n\t\t// Generate unique target filenames\n\t\tif (up.settings.unique_names) {\n\t\t\tvar matches = file.name.match(/\\.([^.]+)$/), ext = \"part\";\n\t\t\tif (matches) {\n\t\t\t\text = matches[1];\n\t\t\t}\n\t\t\tfile.target_name = file.id + '.' + ext;\n\t\t}\n\t}\n\n\n\tfunction onUploadFile(up, file) {\n\t\tvar url = up.settings.url;\n\t\tvar chunkSize = up.settings.chunk_size;\n\t\tvar retries = up.settings.max_retries;\n\t\tvar features = up.features;\n\t\tvar offset = 0;\n\t\tvar blob;\n\n\t\tvar runtimeOptions = {\n\t\t\truntime_order: up.settings.runtimes,\n\t\t\trequired_caps: up.settings.required_features,\n\t\t\tpreferred_caps: preferred_caps,\n\t\t\tswf_url: up.settings.flash_swf_url,\n\t\t\txap_url: up.settings.silverlight_xap_url\n\t\t};\n\n\t\t// make sure we start at a predictable offset\n\t\tif (file.loaded) {\n\t\t\toffset = file.loaded = chunkSize ? chunkSize * Math.floor(file.loaded / chunkSize) : 0;\n\t\t}\n\n\t\tfunction handleError() {\n\t\t\tif (retries-- > 0) {\n\t\t\t\tdelay(uploadNextChunk, 1000);\n\t\t\t} else {\n\t\t\t\tfile.loaded = offset; // reset all progress\n\n\t\t\t\tup.trigger('Error', {\n\t\t\t\t\tcode : plupload.HTTP_ERROR,\n\t\t\t\t\tmessage : plupload.translate('HTTP Error.'),\n\t\t\t\t\tfile : file,\n\t\t\t\t\tresponse : xhr.responseText,\n\t\t\t\t\tstatus : xhr.status,\n\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders()\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction uploadNextChunk() {\n\t\t\tvar chunkBlob, args = {}, curChunkSize;\n\n\t\t\t// make sure that file wasn't cancelled and upload is not stopped in general\n\t\t\tif (file.status !== plupload.UPLOADING || up.state === plupload.STOPPED) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// send additional 'name' parameter only if required\n\t\t\tif (up.settings.send_file_name) {\n\t\t\t\targs.name = file.target_name || file.name;\n\t\t\t}\n\n\t\t\tif (chunkSize && features.chunks && blob.size > chunkSize) { // blob will be of type string if it was loaded in memory\n\t\t\t\tcurChunkSize = Math.min(chunkSize, blob.size - offset);\n\t\t\t\tchunkBlob = blob.slice(offset, offset + curChunkSize);\n\t\t\t} else {\n\t\t\t\tcurChunkSize = blob.size;\n\t\t\t\tchunkBlob = blob;\n\t\t\t}\n\n\t\t\t// If chunking is enabled add corresponding args, no matter if file is bigger than chunk or smaller\n\t\t\tif (chunkSize && features.chunks) {\n\t\t\t\t// Setup query string arguments\n\t\t\t\tif (up.settings.send_chunk_number) {\n\t\t\t\t\targs.chunk = Math.ceil(offset / chunkSize);\n\t\t\t\t\targs.chunks = Math.ceil(blob.size / chunkSize);\n\t\t\t\t} else { // keep support for experimental chunk format, just in case\n\t\t\t\t\targs.offset = offset;\n\t\t\t\t\targs.total = blob.size;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (up.trigger('BeforeChunkUpload', file, args, chunkBlob, offset)) {\n\t\t\t\tuploadChunk(args, chunkBlob, curChunkSize);\n\t\t\t}\n\t\t}\n\n\t\tfunction uploadChunk(args, chunkBlob, curChunkSize) {\n\t\t\tvar formData;\n\n\t\t\txhr = new o.xhr.XMLHttpRequest();\n\n\t\t\t// Do we have upload progress support\n\t\t\tif (xhr.upload) {\n\t\t\t\txhr.upload.onprogress = function(e) {\n\t\t\t\t\tfile.loaded = Math.min(file.size, offset + e.loaded);\n\t\t\t\t\tup.trigger('UploadProgress', file);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\txhr.onload = function() {\n\t\t\t\t// check if upload made itself through\n\t\t\t\tif (xhr.status < 200 || xhr.status >= 400) {\n\t\t\t\t\thandleError();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tretries = up.settings.max_retries; // reset the counter\n\n\t\t\t\t// Handle chunk response\n\t\t\t\tif (curChunkSize < blob.size) {\n\t\t\t\t\tchunkBlob.destroy();\n\n\t\t\t\t\toffset += curChunkSize;\n\t\t\t\t\tfile.loaded = Math.min(offset, blob.size);\n\n\t\t\t\t\tup.trigger('ChunkUploaded', file, {\n\t\t\t\t\t\toffset : file.loaded,\n\t\t\t\t\t\ttotal : blob.size,\n\t\t\t\t\t\tresponse : xhr.responseText,\n\t\t\t\t\t\tstatus : xhr.status,\n\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders()\n\t\t\t\t\t});\n\n\t\t\t\t\t// stock Android browser doesn't fire upload progress events, but in chunking mode we can fake them\n\t\t\t\t\tif (plupload.ua.browser === 'Android Browser') {\n\t\t\t\t\t\t// doesn't harm in general, but is not required anywhere else\n\t\t\t\t\t\tup.trigger('UploadProgress', file);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfile.loaded = file.size;\n\t\t\t\t}\n\n\t\t\t\tchunkBlob = formData = null; // Free memory\n\n\t\t\t\t// Check if file is uploaded\n\t\t\t\tif (!offset || offset >= blob.size) {\n\t\t\t\t\t// If file was modified, destory the copy\n\t\t\t\t\tif (file.size != file.origSize) {\n\t\t\t\t\t\tblob.destroy();\n\t\t\t\t\t\tblob = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tup.trigger('UploadProgress', file);\n\n\t\t\t\t\tfile.status = plupload.DONE;\n\t\t\t\t\tfile.completeTimestamp = +new Date();\n\n\t\t\t\t\tup.trigger('FileUploaded', file, {\n\t\t\t\t\t\tresponse : xhr.responseText,\n\t\t\t\t\t\tstatus : xhr.status,\n\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders()\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// Still chunks left\n\t\t\t\t\tdelay(uploadNextChunk, 1); // run detached, otherwise event handlers interfere\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onerror = function() {\n\t\t\t\thandleError();\n\t\t\t};\n\n\t\t\txhr.onloadend = function() {\n\t\t\t\tthis.destroy();\n\t\t\t};\n\n\t\t\t// Build multipart request\n\t\t\tif (up.settings.multipart && features.multipart) {\n\t\t\t\txhr.open(up.settings.http_method, url, true);\n\n\t\t\t\t// Set custom headers\n\t\t\t\tplupload.each(up.settings.headers, function(value, name) {\n\t\t\t\t\txhr.setRequestHeader(name, value);\n\t\t\t\t});\n\n\t\t\t\tformData = new o.xhr.FormData();\n\n\t\t\t\t// Add multipart params\n\t\t\t\tplupload.each(plupload.extend(args, up.settings.multipart_params), function(value, name) {\n\t\t\t\t\tformData.append(name, value);\n\t\t\t\t});\n\n\t\t\t\t// Add file and send it\n\t\t\t\tformData.append(up.settings.file_data_name, chunkBlob);\n\t\t\t\txhr.send(formData, runtimeOptions);\n\t\t\t} else {\n\t\t\t\t// if no multipart, send as binary stream\n\t\t\t\turl = plupload.buildUrl(up.settings.url, plupload.extend(args, up.settings.multipart_params));\n\n\t\t\t\txhr.open(up.settings.http_method, url, true);\n\n\t\t\t\t// Set custom headers\n\t\t\t\tplupload.each(up.settings.headers, function(value, name) {\n\t\t\t\t\txhr.setRequestHeader(name, value);\n\t\t\t\t});\n\n\t\t\t\t// do not set Content-Type, if it was defined previously (see #1203)\n\t\t\t\tif (!xhr.hasRequestHeader('Content-Type')) {\n\t\t\t\t\txhr.setRequestHeader('Content-Type', 'application/octet-stream'); // Binary stream header\n\t\t\t\t}\n\n\t\t\t\txhr.send(chunkBlob, runtimeOptions);\n\t\t\t}\n\t\t}\n\n\n\t\tblob = file.getSource();\n\n\t\t// Start uploading chunks\n\t\tif (!plupload.isEmptyObj(up.settings.resize) && plupload.inArray(blob.type, ['image/jpeg', 'image/png']) !== -1) {\n\t\t\t// Resize if required\n\t\t\tresizeImage(blob, up.settings.resize, runtimeOptions, function(resizedBlob) {\n\t\t\t\tblob = resizedBlob;\n\t\t\t\tfile.size = resizedBlob.size;\n\t\t\t\tuploadNextChunk();\n\t\t\t});\n\t\t} else {\n\t\t\tuploadNextChunk();\n\t\t}\n\t}\n\n\n\tfunction onUploadProgress(up, file) {\n\t\tcalcFile(file);\n\t}\n\n\n\tfunction onStateChanged(up) {\n\t\tif (up.state == plupload.STARTED) {\n\t\t\t// Get start time to calculate bps\n\t\t\tstartTime = (+new Date());\n\t\t} else if (up.state == plupload.STOPPED) {\n\t\t\t// Reset currently uploading files\n\t\t\tfor (var i = up.files.length - 1; i >= 0; i--) {\n\t\t\t\tif (up.files[i].status == plupload.UPLOADING) {\n\t\t\t\t\tup.files[i].status = plupload.QUEUED;\n\t\t\t\t\tcalc();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction onCancelUpload() {\n\t\tif (xhr) {\n\t\t\txhr.abort();\n\t\t}\n\t}\n\n\n\tfunction onFileUploaded(up) {\n\t\tcalc();\n\n\t\t// Upload next file but detach it from the error event\n\t\t// since other custom listeners might want to stop the queue\n\t\tdelay(function() {\n\t\t\tuploadNext.call(up);\n\t\t}, 1);\n\t}\n\n\n\tfunction onError(up, err) {\n\t\tif (err.code === plupload.INIT_ERROR) {\n\t\t\tup.destroy();\n\t\t}\n\t\t// Set failed status if an error occured on a file\n\t\telse if (err.code === plupload.HTTP_ERROR) {\n\t\t\terr.file.status = plupload.FAILED;\n\t\t\terr.file.completeTimestamp = +new Date();\n\t\t\tcalcFile(err.file);\n\n\t\t\t// Upload next file but detach it from the error event\n\t\t\t// since other custom listeners might want to stop the queue\n\t\t\tif (up.state == plupload.STARTED) { // upload in progress\n\t\t\t\tup.trigger('CancelUpload');\n\t\t\t\tdelay(function() {\n\t\t\t\t\tuploadNext.call(up);\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction onDestroy(up) {\n\t\tup.stop();\n\n\t\t// Purge the queue\n\t\tplupload.each(files, function(file) {\n\t\t\tfile.destroy();\n\t\t});\n\t\tfiles = [];\n\n\t\tif (fileInputs.length) {\n\t\t\tplupload.each(fileInputs, function(fileInput) {\n\t\t\t\tfileInput.destroy();\n\t\t\t});\n\t\t\tfileInputs = [];\n\t\t}\n\n\t\tif (fileDrops.length) {\n\t\t\tplupload.each(fileDrops, function(fileDrop) {\n\t\t\t\tfileDrop.destroy();\n\t\t\t});\n\t\t\tfileDrops = [];\n\t\t}\n\n\t\tpreferred_caps = {};\n\t\tdisabled = false;\n\t\tstartTime = xhr = null;\n\t\ttotal.reset();\n\t}\n\n\n\t// Default settings\n\tsettings = {\n\t\tchunk_size: 0,\n\t\tfile_data_name: 'file',\n\t\tfilters: {\n\t\t\tmime_types: [],\n\t\t\tmax_file_size: 0,\n\t\t\tprevent_duplicates: false,\n\t\t\tprevent_empty: true\n\t\t},\n\t\tflash_swf_url: 'js/Moxie.swf',\n\t\thttp_method: 'POST',\n\t\tmax_retries: 0,\n\t\tmultipart: true,\n\t\tmulti_selection: true,\n\t\tresize: false,\n\t\truntimes: Runtime.order,\n\t\tsend_file_name: true,\n\t\tsend_chunk_number: true,\n\t\tsilverlight_xap_url: 'js/Moxie.xap'\n\t};\n\n\n\tsetOption.call(this, options, null, true);\n\n\t// Inital total state\n\ttotal = new plupload.QueueProgress();\n\n\t// Add public methods\n\tplupload.extend(this, {\n\n\t\t/**\n\t\t * Unique id for the Uploader instance.\n\t\t *\n\t\t * @property id\n\t\t * @type String\n\t\t */\n\t\tid : uid,\n\t\tuid : uid, // mOxie uses this to differentiate between event targets\n\n\t\t/**\n\t\t * Current state of the total uploading progress. This one can either be plupload.STARTED or plupload.STOPPED.\n\t\t * These states are controlled by the stop/start methods. The default value is STOPPED.\n\t\t *\n\t\t * @property state\n\t\t * @type Number\n\t\t */\n\t\tstate : plupload.STOPPED,\n\n\t\t/**\n\t\t * Map of features that are available for the uploader runtime. Features will be filled\n\t\t * before the init event is called, these features can then be used to alter the UI for the end user.\n\t\t * Some of the current features that might be in this map is: dragdrop, chunks, jpgresize, pngresize.\n\t\t *\n\t\t * @property features\n\t\t * @type Object\n\t\t */\n\t\tfeatures : {},\n\n\t\t/**\n\t\t * Current runtime name.\n\t\t *\n\t\t * @property runtime\n\t\t * @type String\n\t\t */\n\t\truntime : null,\n\n\t\t/**\n\t\t * Current upload queue, an array of File instances.\n\t\t *\n\t\t * @property files\n\t\t * @type Array\n\t\t * @see plupload.File\n\t\t */\n\t\tfiles : files,\n\n\t\t/**\n\t\t * Object with name/value settings.\n\t\t *\n\t\t * @property settings\n\t\t * @type Object\n\t\t */\n\t\tsettings : settings,\n\n\t\t/**\n\t\t * Total progess information. How many files has been uploaded, total percent etc.\n\t\t *\n\t\t * @property total\n\t\t * @type plupload.QueueProgress\n\t\t */\n\t\ttotal : total,\n\n\n\t\t/**\n\t\t * Initializes the Uploader instance and adds internal event listeners.\n\t\t *\n\t\t * @method init\n\t\t */\n\t\tinit : function() {\n\t\t\tvar self = this, opt, preinitOpt, err;\n\n\t\t\tpreinitOpt = self.getOption('preinit');\n\t\t\tif (typeof(preinitOpt) == \"function\") {\n\t\t\t\tpreinitOpt(self);\n\t\t\t} else {\n\t\t\t\tplupload.each(preinitOpt, function(func, name) {\n\t\t\t\t\tself.bind(name, func);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tbindEventListeners.call(self);\n\n\t\t\t// Check for required options\n\t\t\tplupload.each(['container', 'browse_button', 'drop_element'], function(el) {\n\t\t\t\tif (self.getOption(el) === null) {\n\t\t\t\t\terr = {\n\t\t\t\t\t\tcode : plupload.INIT_ERROR,\n\t\t\t\t\t\tmessage : plupload.sprintf(plupload.translate(\"%s specified, but cannot be found.\"), el)\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (err) {\n\t\t\t\treturn self.trigger('Error', err);\n\t\t\t}\n\n\n\t\t\tif (!settings.browse_button && !settings.drop_element) {\n\t\t\t\treturn self.trigger('Error', {\n\t\t\t\t\tcode : plupload.INIT_ERROR,\n\t\t\t\t\tmessage : plupload.translate(\"You must specify either browse_button or drop_element.\")\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\tinitControls.call(self, settings, function(inited) {\n\t\t\t\tvar initOpt = self.getOption('init');\n\t\t\t\tif (typeof(initOpt) == \"function\") {\n\t\t\t\t\tinitOpt(self);\n\t\t\t\t} else {\n\t\t\t\t\tplupload.each(initOpt, function(func, name) {\n\t\t\t\t\t\tself.bind(name, func);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (inited) {\n\t\t\t\t\tself.runtime = Runtime.getInfo(getRUID()).type;\n\t\t\t\t\tself.trigger('Init', { runtime: self.runtime });\n\t\t\t\t\tself.trigger('PostInit');\n\t\t\t\t} else {\n\t\t\t\t\tself.trigger('Error', {\n\t\t\t\t\t\tcode : plupload.INIT_ERROR,\n\t\t\t\t\t\tmessage : plupload.translate('Init error.')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Set the value for the specified option(s).\n\t\t *\n\t\t * @method setOption\n\t\t * @since 2.1\n\t\t * @param {String|Object} option Name of the option to change or the set of key/value pairs\n\t\t * @param {Mixed} [value] Value for the option (is ignored, if first argument is object)\n\t\t */\n\t\tsetOption: function(option, value) {\n\t\t\tsetOption.call(this, option, value, !this.runtime); // until runtime not set we do not need to reinitialize\n\t\t},\n\n\t\t/**\n\t\t * Get the value for the specified option or the whole configuration, if not specified.\n\t\t *\n\t\t * @method getOption\n\t\t * @since 2.1\n\t\t * @param {String} [option] Name of the option to get\n\t\t * @return {Mixed} Value for the option or the whole set\n\t\t */\n\t\tgetOption: function(option) {\n\t\t\tif (!option) {\n\t\t\t\treturn settings;\n\t\t\t}\n\t\t\treturn settings[option];\n\t\t},\n\n\t\t/**\n\t\t * Refreshes the upload instance by dispatching out a refresh event to all runtimes.\n\t\t * This would for example reposition flash/silverlight shims on the page.\n\t\t *\n\t\t * @method refresh\n\t\t */\n\t\trefresh : function() {\n\t\t\tif (fileInputs.length) {\n\t\t\t\tplupload.each(fileInputs, function(fileInput) {\n\t\t\t\t\tfileInput.trigger('Refresh');\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.trigger('Refresh');\n\t\t},\n\n\t\t/**\n\t\t * Starts uploading the queued files.\n\t\t *\n\t\t * @method start\n\t\t */\n\t\tstart : function() {\n\t\t\tif (this.state != plupload.STARTED) {\n\t\t\t\tthis.state = plupload.STARTED;\n\t\t\t\tthis.trigger('StateChanged');\n\n\t\t\t\tuploadNext.call(this);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Stops the upload of the queued files.\n\t\t *\n\t\t * @method stop\n\t\t */\n\t\tstop : function() {\n\t\t\tif (this.state != plupload.STOPPED) {\n\t\t\t\tthis.state = plupload.STOPPED;\n\t\t\t\tthis.trigger('StateChanged');\n\t\t\t\tthis.trigger('CancelUpload');\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Disables/enables browse button on request.\n\t\t *\n\t\t * @method disableBrowse\n\t\t * @param {Boolean} disable Whether to disable or enable (default: true)\n\t\t */\n\t\tdisableBrowse : function() {\n\t\t\tdisabled = arguments[0] !== undef ? arguments[0] : true;\n\n\t\t\tif (fileInputs.length) {\n\t\t\t\tplupload.each(fileInputs, function(fileInput) {\n\t\t\t\t\tfileInput.disable(disabled);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.trigger('DisableBrowse', disabled);\n\t\t},\n\n\t\t/**\n\t\t * Returns the specified file object by id.\n\t\t *\n\t\t * @method getFile\n\t\t * @param {String} id File id to look for.\n\t\t * @return {plupload.File} File object or undefined if it wasn't found;\n\t\t */\n\t\tgetFile : function(id) {\n\t\t\tvar i;\n\t\t\tfor (i = files.length - 1; i >= 0; i--) {\n\t\t\t\tif (files[i].id === id) {\n\t\t\t\t\treturn files[i];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Adds file to the queue programmatically. Can be native file, instance of Plupload.File,\n\t\t * instance of mOxie.File, input[type=\"file\"] element, or array of these. Fires FilesAdded,\n\t\t * if any files were added to the queue. Otherwise nothing happens.\n\t\t *\n\t\t * @method addFile\n\t\t * @since 2.0\n\t\t * @param {plupload.File|mOxie.File|File|Node|Array} file File or files to add to the queue.\n\t\t * @param {String} [fileName] If specified, will be used as a name for the file\n\t\t */\n\t\taddFile : function(file, fileName) {\n\t\t\tvar self = this\n\t\t\t, queue = []\n\t\t\t, filesAdded = []\n\t\t\t, ruid\n\t\t\t;\n\n\t\t\tfunction filterFile(file, cb) {\n\t\t\t\tvar queue = [];\n\t\t\t\tplupload.each(self.settings.filters, function(rule, name) {\n\t\t\t\t\tif (fileFilters[name]) {\n\t\t\t\t\t\tqueue.push(function(cb) {\n\t\t\t\t\t\t\tfileFilters[name].call(self, rule, file, function(res) {\n\t\t\t\t\t\t\t\tcb(!res);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tplupload.inSeries(queue, cb);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @method resolveFile\n\t\t\t * @private\n\t\t\t * @param {moxie.file.File|moxie.file.Blob|plupload.File|File|Blob|input[type=\"file\"]} file\n\t\t\t */\n\t\t\tfunction resolveFile(file) {\n\t\t\t\tvar type = plupload.typeOf(file);\n\n\t\t\t\t// moxie.file.File\n\t\t\t\tif (file instanceof o.file.File) {\n\t\t\t\t\tif (!file.ruid && !file.isDetached()) {\n\t\t\t\t\t\tif (!ruid) { // weird case\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfile.ruid = ruid;\n\t\t\t\t\t\tfile.connectRuntime(ruid);\n\t\t\t\t\t}\n\t\t\t\t\tresolveFile(new plupload.File(file));\n\t\t\t\t}\n\t\t\t\t// moxie.file.Blob\n\t\t\t\telse if (file instanceof o.file.Blob) {\n\t\t\t\t\tresolveFile(file.getSource());\n\t\t\t\t\tfile.destroy();\n\t\t\t\t}\n\t\t\t\t// plupload.File - final step for other branches\n\t\t\t\telse if (file instanceof plupload.File) {\n\t\t\t\t\tif (fileName) {\n\t\t\t\t\t\tfile.name = fileName;\n\t\t\t\t\t}\n\n\t\t\t\t\tqueue.push(function(cb) {\n\t\t\t\t\t\t// run through the internal and user-defined filters, if any\n\t\t\t\t\t\tfilterFile(file, function(err) {\n\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t// make files available for the filters by updating the main queue directly\n\t\t\t\t\t\t\t\tfiles.push(file);\n\t\t\t\t\t\t\t\t// collect the files that will be passed to FilesAdded event\n\t\t\t\t\t\t\t\tfilesAdded.push(file);\n\n\t\t\t\t\t\t\t\tself.trigger(\"FileFiltered\", file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelay(cb, 1); // do not build up recursions or eventually we might hit the limits\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// native File or blob\n\t\t\t\telse if (plupload.inArray(type, ['file', 'blob']) !== -1) {\n\t\t\t\t\tresolveFile(new o.file.File(null, file));\n\t\t\t\t}\n\t\t\t\t// input[type=\"file\"]\n\t\t\t\telse if (type === 'node' && plupload.typeOf(file.files) === 'filelist') {\n\t\t\t\t\t// if we are dealing with input[type=\"file\"]\n\t\t\t\t\tplupload.each(file.files, resolveFile);\n\t\t\t\t}\n\t\t\t\t// mixed array of any supported types (see above)\n\t\t\t\telse if (type === 'array') {\n\t\t\t\t\tfileName = null; // should never happen, but unset anyway to avoid funny situations\n\t\t\t\t\tplupload.each(file, resolveFile);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\truid = getRUID();\n\n\t\t\tresolveFile(file);\n\n\t\t\tif (queue.length) {\n\t\t\t\tplupload.inSeries(queue, function() {\n\t\t\t\t\t// if any files left after filtration, trigger FilesAdded\n\t\t\t\t\tif (filesAdded.length) {\n\t\t\t\t\t\tself.trigger(\"FilesAdded\", filesAdded);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Removes a specific file.\n\t\t *\n\t\t * @method removeFile\n\t\t * @param {plupload.File|String} file File to remove from queue.\n\t\t */\n\t\tremoveFile : function(file) {\n\t\t\tvar id = typeof(file) === 'string' ? file : file.id;\n\n\t\t\tfor (var i = files.length - 1; i >= 0; i--) {\n\t\t\t\tif (files[i].id === id) {\n\t\t\t\t\treturn this.splice(i, 1)[0];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Removes part of the queue and returns the files removed. This will also trigger the\n\t\t * FilesRemoved and QueueChanged events.\n\t\t *\n\t\t * @method splice\n\t\t * @param {Number} [start=0] Start index to remove from.\n\t\t * @param {Number} [length] Number of files to remove (defaults to number of files in the queue).\n\t\t * @return {Array} Array of files that was removed.\n\t\t */\n\t\tsplice : function(start, length) {\n\t\t\t// Splice and trigger events\n\t\t\tvar removed = files.splice(start === undef ? 0 : start, length === undef ? files.length : length);\n\n\t\t\t// if upload is in progress we need to stop it and restart after files are removed\n\t\t\tvar restartRequired = false;\n\t\t\tif (this.state == plupload.STARTED) { // upload in progress\n\t\t\t\tplupload.each(removed, function(file) {\n\t\t\t\t\tif (file.status === plupload.UPLOADING) {\n\t\t\t\t\t\trestartRequired = true; // do not restart, unless file that is being removed is uploading\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (restartRequired) {\n\t\t\t\t\tthis.stop();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.trigger(\"FilesRemoved\", removed);\n\n\t\t\t// Dispose any resources allocated by those files\n\t\t\tplupload.each(removed, function(file) {\n\t\t\t\tfile.destroy();\n\t\t\t});\n\n\t\t\tif (restartRequired) {\n\t\t\t\tthis.start();\n\t\t\t}\n\n\t\t\treturn removed;\n\t\t},\n\n\t\t/**\n\t\tDispatches the specified event name and its arguments to all listeners.\n\n\t\t@method trigger\n\t\t@param {String} name Event name to fire.\n\t\t@param {Object..} Multiple arguments to pass along to the listener functions.\n\t\t*/\n\n\t\t// override the parent method to match Plupload-like event logic\n\t\tdispatchEvent: function(type) {\n\t\t\tvar list, args, result;\n\n\t\t\ttype = type.toLowerCase();\n\n\t\t\tlist = this.hasEventListener(type);\n\n\t\t\tif (list) {\n\t\t\t\t// sort event list by priority\n\t\t\t\tlist.sort(function(a, b) { return b.priority - a.priority; });\n\n\t\t\t\t// first argument should be current plupload.Uploader instance\n\t\t\t\targs = [].slice.call(arguments);\n\t\t\t\targs.shift();\n\t\t\t\targs.unshift(this);\n\n\t\t\t\tfor (var i = 0; i < list.length; i++) {\n\t\t\t\t\t// Fire event, break chain if false is returned\n\t\t\t\t\tif (list[i].fn.apply(list[i].scope, args) === false) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\tCheck whether uploader has any listeners to the specified event.\n\n\t\t@method hasEventListener\n\t\t@param {String} name Event name to check for.\n\t\t*/\n\n\n\t\t/**\n\t\tAdds an event listener by name.\n\n\t\t@method bind\n\t\t@param {String} name Event name to listen for.\n\t\t@param {function} fn Function to call ones the event gets fired.\n\t\t@param {Object} [scope] Optional scope to execute the specified function in.\n\t\t@param {Number} [priority=0] Priority of the event handler - handlers with higher priorities will be called first\n\t\t*/\n\t\tbind: function(name, fn, scope, priority) {\n\t\t\t// adapt moxie EventTarget style to Plupload-like\n\t\t\tplupload.Uploader.prototype.bind.call(this, name, fn, priority, scope);\n\t\t},\n\n\t\t/**\n\t\tRemoves the specified event listener.\n\n\t\t@method unbind\n\t\t@param {String} name Name of event to remove.\n\t\t@param {function} fn Function to remove from listener.\n\t\t*/\n\n\t\t/**\n\t\tRemoves all event listeners.\n\n\t\t@method unbindAll\n\t\t*/\n\n\n\t\t/**\n\t\t * Destroys Plupload instance and cleans after itself.\n\t\t *\n\t\t * @method destroy\n\t\t */\n\t\tdestroy : function() {\n\t\t\tthis.trigger('Destroy');\n\t\t\tsettings = total = null; // purge these exclusively\n\t\t\tthis.unbindAll();\n\t\t}\n\t});\n};\n\nplupload.Uploader.prototype = o.core.EventTarget.instance;\n\n/**\n * Constructs a new file instance.\n *\n * @class File\n * @constructor\n *\n * @param {Object} file Object containing file properties\n * @param {String} file.name Name of the file.\n * @param {Number} file.size File size.\n */\nplupload.File = (function() {\n\tvar filepool = {};\n\n\tfunction PluploadFile(file) {\n\n\t\tplupload.extend(this, {\n\n\t\t\t/**\n\t\t\t * File id this is a globally unique id for the specific file.\n\t\t\t *\n\t\t\t * @property id\n\t\t\t * @type String\n\t\t\t */\n\t\t\tid: plupload.guid(),\n\n\t\t\t/**\n\t\t\t * File name for example \"myfile.gif\".\n\t\t\t *\n\t\t\t * @property name\n\t\t\t * @type String\n\t\t\t */\n\t\t\tname: file.name || file.fileName,\n\n\t\t\t/**\n\t\t\t * File type, `e.g image/jpeg`\n\t\t\t *\n\t\t\t * @property type\n\t\t\t * @type String\n\t\t\t */\n\t\t\ttype: file.type || '',\n\n\t\t\t/**\n\t\t\t * Relative path to the file inside a directory\n\t\t\t *\n\t\t\t * @property relativePath\n\t\t\t * @type String\n\t\t\t * @default ''\n\t\t\t */\n\t\t\trelativePath: file.relativePath || '',\n\n\t\t\t/**\n\t\t\t * File size in bytes (may change after client-side manupilation).\n\t\t\t *\n\t\t\t * @property size\n\t\t\t * @type Number\n\t\t\t */\n\t\t\tsize: file.fileSize || file.size,\n\n\t\t\t/**\n\t\t\t * Original file size in bytes.\n\t\t\t *\n\t\t\t * @property origSize\n\t\t\t * @type Number\n\t\t\t */\n\t\t\torigSize: file.fileSize || file.size,\n\n\t\t\t/**\n\t\t\t * Number of bytes uploaded of the files total size.\n\t\t\t *\n\t\t\t * @property loaded\n\t\t\t * @type Number\n\t\t\t */\n\t\t\tloaded: 0,\n\n\t\t\t/**\n\t\t\t * Number of percentage uploaded of the file.\n\t\t\t *\n\t\t\t * @property percent\n\t\t\t * @type Number\n\t\t\t */\n\t\t\tpercent: 0,\n\n\t\t\t/**\n\t\t\t * Status constant matching the plupload states QUEUED, UPLOADING, FAILED, DONE.\n\t\t\t *\n\t\t\t * @property status\n\t\t\t * @type Number\n\t\t\t * @see plupload\n\t\t\t */\n\t\t\tstatus: plupload.QUEUED,\n\n\t\t\t/**\n\t\t\t * Date of last modification.\n\t\t\t *\n\t\t\t * @property lastModifiedDate\n\t\t\t * @type {String}\n\t\t\t */\n\t\t\tlastModifiedDate: file.lastModifiedDate || (new Date()).toLocaleString(), // Thu Aug 23 2012 19:40:00 GMT+0400 (GET)\n\n\n\t\t\t/**\n\t\t\t * Set when file becomes plupload.DONE or plupload.FAILED. Is used to calculate proper plupload.QueueProgress.bytesPerSec.\n\t\t\t * @private\n\t\t\t * @property completeTimestamp\n\t\t\t * @type {Number}\n\t\t\t */\n\t\t\tcompleteTimestamp: 0,\n\n\t\t\t/**\n\t\t\t * Returns native window.File object, when it's available.\n\t\t\t *\n\t\t\t * @method getNative\n\t\t\t * @return {window.File} or null, if plupload.File is of different origin\n\t\t\t */\n\t\t\tgetNative: function() {\n\t\t\t\tvar file = this.getSource().getSource();\n\t\t\t\treturn plupload.inArray(plupload.typeOf(file), ['blob', 'file']) !== -1 ? file : null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns mOxie.File - unified wrapper object that can be used across runtimes.\n\t\t\t *\n\t\t\t * @method getSource\n\t\t\t * @return {mOxie.File} or null\n\t\t\t */\n\t\t\tgetSource: function() {\n\t\t\t\tif (!filepool[this.id]) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn filepool[this.id];\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Destroys plupload.File object.\n\t\t\t *\n\t\t\t * @method destroy\n\t\t\t */\n\t\t\tdestroy: function() {\n\t\t\t\tvar src = this.getSource();\n\t\t\t\tif (src) {\n\t\t\t\t\tsrc.destroy();\n\t\t\t\t\tdelete filepool[this.id];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfilepool[this.id] = file;\n\t}\n\n\treturn PluploadFile;\n}());\n\n\n/**\n * Constructs a queue progress.\n *\n * @class QueueProgress\n * @constructor\n */\n plupload.QueueProgress = function() {\n\tvar self = this; // Setup alias for self to reduce code size when it's compressed\n\n\t/**\n\t * Total queue file size.\n\t *\n\t * @property size\n\t * @type Number\n\t */\n\tself.size = 0;\n\n\t/**\n\t * Total bytes uploaded.\n\t *\n\t * @property loaded\n\t * @type Number\n\t */\n\tself.loaded = 0;\n\n\t/**\n\t * Number of files uploaded.\n\t *\n\t * @property uploaded\n\t * @type Number\n\t */\n\tself.uploaded = 0;\n\n\t/**\n\t * Number of files failed to upload.\n\t *\n\t * @property failed\n\t * @type Number\n\t */\n\tself.failed = 0;\n\n\t/**\n\t * Number of files yet to be uploaded.\n\t *\n\t * @property queued\n\t * @type Number\n\t */\n\tself.queued = 0;\n\n\t/**\n\t * Total percent of the uploaded bytes.\n\t *\n\t * @property percent\n\t * @type Number\n\t */\n\tself.percent = 0;\n\n\t/**\n\t * Bytes uploaded per second.\n\t *\n\t * @property bytesPerSec\n\t * @type Number\n\t */\n\tself.bytesPerSec = 0;\n\n\t/**\n\t * Resets the progress to its initial values.\n\t *\n\t * @method reset\n\t */\n\tself.reset = function() {\n\t\tself.size = self.loaded = self.uploaded = self.failed = self.queued = self.percent = self.bytesPerSec = 0;\n\t};\n};\n\nexports.plupload = plupload;\n\n}(this, moxie));\n\n}));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcGx1cGxvYWQvanMvcGx1cGxvYWQuZGV2LmpzPzJmNGUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsS0FBSyxJQUEwQztBQUMvQyxFQUFFLGlDQUFtQixDQUFDLHlFQUFTLENBQUMsb0NBQUUsT0FBTztBQUFBO0FBQUE7QUFBQSxvR0FBQztBQUMxQyxFQUFFLE1BQU0sRUFJTjtBQUNGLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1DQUFtQztBQUNuQyxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxPQUFPO0FBQ25CLGFBQWEsT0FBTztBQUNwQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLE9BQU87QUFDbkIsWUFBWSxTQUFTO0FBQ3JCLGFBQWEsT0FBTztBQUNwQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQjtBQUNBOztBQUVBO0FB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QUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07O0FBRU47QUFDQTtBQUNBLE1BQU07O0FBRU47QUFDQTtBQUNBO0FBQ0EsTUFBTTs7QUFFTjtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQ7QUFDMUQ7QUFDQSxNQUFNOztBQUVOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07O0FBRU47QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YscUZBQXFGO0FBQ3JGO0FBQ0EsU0FBUztBQUNULFFBQVE7O0FB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O0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBLDJCQUEyQix3QkFBd0I7QUFDbkQ7QUFDQSxLQUFL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O0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsV0FBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBLENBQUM7OztBQUdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsQ0FBQzs7QUFFRCxDQUFDIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL3BsdXBsb2FkL2pzL3BsdXBsb2FkLmRldi5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUGx1cGxvYWQgLSBtdWx0aS1ydW50aW1lIEZpbGUgVXBsb2FkZXJcbiAqIHYyLjMuNlxuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqXG4gKiBEYXRlOiAyMDE3LTExLTAzXG4gKi9cbjsoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR2YXIgZXh0cmFjdCA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBjdHggPSB7fTtcblx0XHRmYWN0b3J5LmFwcGx5KGN0eCwgYXJndW1lbnRzKTtcblx0XHRyZXR1cm4gY3R4LnBsdXBsb2FkO1xuXHR9O1xuXHRcblx0aWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG5cdFx0ZGVmaW5lKFwicGx1cGxvYWRcIiwgWycuL21veGllJ10sIGV4dHJhY3QpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGV4dHJhY3QocmVxdWlyZSgnLi9tb3hpZScpKTtcblx0fSBlbHNlIHtcblx0XHRnbG9iYWwucGx1cGxvYWQgPSBleHRyYWN0KGdsb2JhbC5tb3hpZSk7XG5cdH1cbn0odGhpcyB8fCB3aW5kb3csIGZ1bmN0aW9uKG1veGllKSB7XG4vKipcbiAqIFBsdXBsb2FkLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbjsoZnVuY3Rpb24oZXhwb3J0cywgbywgdW5kZWYpIHtcblxudmFyIGRlbGF5ID0gd2luZG93LnNldFRpbWVvdXQ7XG52YXIgZmlsZUZpbHRlcnMgPSB7fTtcbnZhciB1ID0gby5jb3JlLnV0aWxzO1xudmFyIFJ1bnRpbWUgPSBvLnJ1bnRpbWUuUnVudGltZTtcblxuLy8gY29udmVydCBwbHVwbG9hZCBmZWF0dXJlcyB0byBjYXBzIGFjY2VwdGFibGUgYnkgbU94aWVcbmZ1bmN0aW9uIG5vcm1hbGl6ZUNhcHMoc2V0dGluZ3MpIHtcblx0dmFyIGZlYXR1cmVzID0gc2V0dGluZ3MucmVxdWlyZWRfZmVhdHVyZXMsIGNhcHMgPSB7fTtcblxuXHRmdW5jdGlvbiByZXNvbHZlKGZlYXR1cmUsIHZhbHVlLCBzdHJpY3QpIHtcblx0XHQvLyBGZWF0dXJlIG5vdGF0aW9uIGlzIGRlcHJlY2F0ZWQsIHVzZSBjYXBzICh0aGlzIHRoaW5nIGhlcmUgaXMgcmVxdWlyZWQgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXG5cdFx0dmFyIG1hcCA9IHtcblx0XHRcdGNodW5rczogJ3NsaWNlX2Jsb2InLFxuXHRcdFx0anBncmVzaXplOiAnc2VuZF9iaW5hcnlfc3RyaW5nJyxcblx0XHRcdHBuZ3Jlc2l6ZTogJ3NlbmRfYmluYXJ5X3N0cmluZycsXG5cdFx0XHRwcm9ncmVzczogJ3JlcG9ydF91cGxvYWRfcHJvZ3Jlc3MnLFxuXHRcdFx0bXVsdGlfc2VsZWN0aW9uOiAnc2VsZWN0X211bHRpcGxlJyxcblx0XHRcdGRyYWdkcm9wOiAnZHJhZ19hbmRfZHJvcCcsXG5cdFx0XHRkcm9wX2VsZW1lbnQ6ICdkcmFnX2FuZF9kcm9wJyxcblx0XHRcdGhlYWRlcnM6ICdzZW5kX2N1c3RvbV9oZWFkZXJzJyxcblx0XHRcdHVybHN0cmVhbV91cGxvYWQ6ICdzZW5kX2JpbmFyeV9zdHJpbmcnLFxuXHRcdFx0Y2FuU2VuZEJpbmFyeTogJ3NlbmRfYmluYXJ5Jyxcblx0XHRcdHRyaWdnZXJEaWFsb2c6ICdzdW1tb25fZmlsZV9kaWFsb2cnXG5cdFx0fTtcblxuXHRcdGlmIChtYXBbZmVhdHVyZV0pIHtcblx0XHRcdGNhcHNbbWFwW2ZlYXR1cmVdXSA9IHZhbHVlO1xuXHRcdH0gZWxzZSBpZiAoIXN0cmljdCkge1xuXHRcdFx0Y2Fwc1tmZWF0dXJlXSA9IHZhbHVlO1xuXHRcdH1cblx0fVxuXG5cdGlmICh0eXBlb2YoZmVhdHVyZXMpID09PSAnc3RyaW5nJykge1xuXHRcdHBsdXBsb2FkLmVhY2goZmVhdHVyZXMuc3BsaXQoL1xccyosXFxzKi8pLCBmdW5jdGlvbihmZWF0dXJlKSB7XG5cdFx0XHRyZXNvbHZlKGZlYXR1cmUsIHRydWUpO1xuXHRcdH0pO1xuXHR9IGVsc2UgaWYgKHR5cGVvZihmZWF0dXJlcykgPT09ICdvYmplY3QnKSB7XG5cdFx0cGx1cGxvYWQuZWFjaChmZWF0dXJlcywgZnVuY3Rpb24odmFsdWUsIGZlYXR1cmUpIHtcblx0XHRcdHJlc29sdmUoZmVhdHVyZSwgdmFsdWUpO1xuXHRcdH0pO1xuXHR9IGVsc2UgaWYgKGZlYXR1cmVzID09PSB0cnVlKSB7XG5cdFx0Ly8gY2hlY2sgc2V0dGluZ3MgZm9yIHJlcXVpcmVkIGZlYXR1cmVzXG5cdFx0aWYgKHNldHRpbmdzLmNodW5rX3NpemUgJiYgc2V0dGluZ3MuY2h1bmtfc2l6ZSA+IDApIHtcblx0XHRcdGNhcHMuc2xpY2VfYmxvYiA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKCFwbHVwbG9hZC5pc0VtcHR5T2JqKHNldHRpbmdzLnJlc2l6ZSkgfHwgc2V0dGluZ3MubXVsdGlwYXJ0ID09PSBmYWxzZSkge1xuXHRcdFx0Y2Fwcy5zZW5kX2JpbmFyeV9zdHJpbmcgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmIChzZXR0aW5ncy5odHRwX21ldGhvZCkge1xuICAgICAgICAgICAgY2Fwcy51c2VfaHR0cF9tZXRob2QgPSBzZXR0aW5ncy5odHRwX21ldGhvZDtcbiAgICAgICAgfVxuXG5cdFx0cGx1cGxvYWQuZWFjaChzZXR0aW5ncywgZnVuY3Rpb24odmFsdWUsIGZlYXR1cmUpIHtcblx0XHRcdHJlc29sdmUoZmVhdHVyZSwgISF2YWx1ZSwgdHJ1ZSk7IC8vIHN0cmljdCBjaGVja1xuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuIGNhcHM7XG59XG5cbi8qKlxuICogQG1vZHVsZSBwbHVwbG9hZFxuICogQHN0YXRpY1xuICovXG52YXIgcGx1cGxvYWQgPSB7XG5cdC8qKlxuXHQgKiBQbHVwbG9hZCB2ZXJzaW9uIHdpbGwgYmUgcmVwbGFjZWQgb24gYnVpbGQuXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSBWRVJTSU9OXG5cdCAqIEBmb3IgUGx1cGxvYWRcblx0ICogQHN0YXRpY1xuXHQgKiBAZmluYWxcblx0ICovXG5cdFZFUlNJT04gOiAnMi4zLjYnLFxuXG5cdC8qKlxuXHQgKiBUaGUgc3RhdGUgb2YgdGhlIHF1ZXVlIGJlZm9yZSBpdCBoYXMgc3RhcnRlZCBhbmQgYWZ0ZXIgaXQgaGFzIGZpbmlzaGVkXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSBTVE9QUEVEXG5cdCAqIEBzdGF0aWNcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRTVE9QUEVEIDogMSxcblxuXHQvKipcblx0ICogVXBsb2FkIHByb2Nlc3MgaXMgcnVubmluZ1xuXHQgKlxuXHQgKiBAcHJvcGVydHkgU1RBUlRFRFxuXHQgKiBAc3RhdGljXG5cdCAqIEBmaW5hbFxuXHQgKi9cblx0U1RBUlRFRCA6IDIsXG5cblx0LyoqXG5cdCAqIEZpbGUgaXMgcXVldWVkIGZvciB1cGxvYWRcblx0ICpcblx0ICogQHByb3BlcnR5IFFVRVVFRFxuXHQgKiBAc3RhdGljXG5cdCAqIEBmaW5hbFxuXHQgKi9cblx0UVVFVUVEIDogMSxcblxuXHQvKipcblx0ICogRmlsZSBpcyBiZWluZyB1cGxvYWRlZFxuXHQgKlxuXHQgKiBAcHJvcGVydHkgVVBMT0FESU5HXG5cdCAqIEBzdGF0aWNcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRVUExPQURJTkcgOiAyLFxuXG5cdC8qKlxuXHQgKiBGaWxlIGhhcyBmYWlsZWQgdG8gYmUgdXBsb2FkZWRcblx0ICpcblx0ICogQHByb3BlcnR5IEZBSUxFRFxuXHQgKiBAc3RhdGljXG5cdCAqIEBmaW5hbFxuXHQgKi9cblx0RkFJTEVEIDogNCxcblxuXHQvKipcblx0ICogRmlsZSBoYXMgYmVlbiB1cGxvYWRlZCBzdWNjZXNzZnVsbHlcblx0ICpcblx0ICogQHByb3BlcnR5IERPTkVcblx0ICogQHN0YXRpY1xuXHQgKiBAZmluYWxcblx0ICovXG5cdERPTkUgOiA1LFxuXG5cdC8vIEVycm9yIGNvbnN0YW50cyB1c2VkIGJ5IHRoZSBFcnJvciBldmVudFxuXG5cdC8qKlxuXHQgKiBHZW5lcmljIGVycm9yIGZvciBleGFtcGxlIGlmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gaW5zaWRlIFNpbHZlcmxpZ2h0LlxuXHQgKlxuXHQgKiBAcHJvcGVydHkgR0VORVJJQ19FUlJPUlxuXHQgKiBAc3RhdGljXG5cdCAqIEBmaW5hbFxuXHQgKi9cblx0R0VORVJJQ19FUlJPUiA6IC0xMDAsXG5cblx0LyoqXG5cdCAqIEhUVFAgdHJhbnNwb3J0IGVycm9yLiBGb3IgZXhhbXBsZSBpZiB0aGUgc2VydmVyIHByb2R1Y2VzIGEgSFRUUCBzdGF0dXMgb3RoZXIgdGhhbiAyMDAuXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSBIVFRQX0VSUk9SXG5cdCAqIEBzdGF0aWNcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRIVFRQX0VSUk9SIDogLTIwMCxcblxuXHQvKipcblx0ICogR2VuZXJpYyBJL08gZXJyb3IuIEZvciBleGFtcGxlIGlmIGl0IHdhc24ndCBwb3NzaWJsZSB0byBvcGVuIHRoZSBmaWxlIHN0cmVhbSBvbiBsb2NhbCBtYWNoaW5lLlxuXHQgKlxuXHQgKiBAcHJvcGVydHkgSU9fRVJST1Jcblx0ICogQHN0YXRpY1xuXHQgKiBAZmluYWxcblx0ICovXG5cdElPX0VSUk9SIDogLTMwMCxcblxuXHQvKipcblx0ICogQHByb3BlcnR5IFNFQ1VSSVRZX0VSUk9SXG5cdCAqIEBzdGF0aWNcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRTRUNVUklUWV9FUlJPUiA6IC00MDAsXG5cblx0LyoqXG5cdCAqIEluaXRpYWxpemF0aW9uIGVycm9yLiBXaWxsIGJlIHRyaWdnZXJlZCBpZiBubyBydW50aW1lIHdhcyBpbml0aWFsaXplZC5cblx0ICpcblx0ICogQHByb3BlcnR5IElOSVRfRVJST1Jcblx0ICogQHN0YXRpY1xuXHQgKiBAZmluYWxcblx0ICovXG5cdElOSVRfRVJST1IgOiAtNTAwLFxuXG5cdC8qKlxuXHQgKiBGaWxlIHNpemUgZXJyb3IuIElmIHRoZSB1c2VyIHNlbGVjdHMgYSBmaWxlIHRoYXQgaXMgdG9vIGxhcmdlIG9yIGlzIGVtcHR5IGl0IHdpbGwgYmUgYmxvY2tlZCBhbmRcblx0ICogYW4gZXJyb3Igb2YgdGhpcyB0eXBlIHdpbGwgYmUgdHJpZ2dlcmVkLlxuXHQgKlxuXHQgKiBAcHJvcGVydHkgRklMRV9TSVpFX0VSUk9SXG5cdCAqIEBzdGF0aWNcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRGSUxFX1NJWkVfRVJST1IgOiAtNjAwLFxuXG5cdC8qKlxuXHQgKiBGaWxlIGV4dGVuc2lvbiBlcnJvci4gSWYgdGhlIHVzZXIgc2VsZWN0cyBhIGZpbGUgdGhhdCBpc24ndCB2YWxpZCBhY2NvcmRpbmcgdG8gdGhlIGZpbHRlcnMgc2V0dGluZy5cblx0ICpcblx0ICogQHByb3BlcnR5IEZJTEVfRVhURU5TSU9OX0VSUk9SXG5cdCAqIEBzdGF0aWNcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRGSUxFX0VYVEVOU0lPTl9FUlJPUiA6IC02MDEsXG5cblx0LyoqXG5cdCAqIER1cGxpY2F0ZSBmaWxlIGVycm9yLiBJZiBwcmV2ZW50X2R1cGxpY2F0ZXMgaXMgc2V0IHRvIHRydWUgYW5kIHVzZXIgc2VsZWN0cyB0aGUgc2FtZSBmaWxlIGFnYWluLlxuXHQgKlxuXHQgKiBAcHJvcGVydHkgRklMRV9EVVBMSUNBVEVfRVJST1Jcblx0ICogQHN0YXRpY1xuXHQgKiBAZmluYWxcblx0ICovXG5cdEZJTEVfRFVQTElDQVRFX0VSUk9SIDogLTYwMixcblxuXHQvKipcblx0ICogUnVudGltZSB3aWxsIHRyeSB0byBkZXRlY3QgaWYgaW1hZ2UgaXMgcHJvcGVyIG9uZS4gT3RoZXJ3aXNlIHdpbGwgdGhyb3cgdGhpcyBlcnJvci5cblx0ICpcblx0ICogQHByb3BlcnR5IElNQUdFX0ZPUk1BVF9FUlJPUlxuXHQgKiBAc3RhdGljXG5cdCAqIEBmaW5hbFxuXHQgKi9cblx0SU1BR0VfRk9STUFUX0VSUk9SIDogLTcwMCxcblxuXHQvKipcblx0ICogV2hpbGUgd29ya2luZyBvbiBmaWxlcyBydW50aW1lIG1heSBydW4gb3V0IG9mIG1lbW9yeSBhbmQgd2lsbCB0aHJvdyB0aGlzIGVycm9yLlxuXHQgKlxuXHQgKiBAc2luY2UgMi4xLjJcblx0ICogQHByb3BlcnR5IE1FTU9SWV9FUlJPUlxuXHQgKiBAc3RhdGljXG5cdCAqIEBmaW5hbFxuXHQgKi9cblx0TUVNT1JZX0VSUk9SIDogLTcwMSxcblxuXHQvKipcblx0ICogRWFjaCBydW50aW1lIGhhcyBhbiB1cHBlciBsaW1pdCBvbiBhIGRpbWVuc2lvbiBvZiB0aGUgaW1hZ2UgaXQgY2FuIGhhbmRsZS4gSWYgYmlnZ2VyLCB3aWxsIHRocm93IHRoaXMgZXJyb3IuXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSBJTUFHRV9ESU1FTlNJT05TX0VSUk9SXG5cdCAqIEBzdGF0aWNcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRJTUFHRV9ESU1FTlNJT05TX0VSUk9SIDogLTcwMixcblxuXHQvKipcblx0ICogRXhwb3NlIHdob2xlIG1veGllICgjMTQ2OSkuXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSBtb3hpZVxuXHQgKiBAdHlwZSBPYmplY3Rcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRtb3hpZTogbyxcblxuXHQvKipcblx0ICogTWltZSB0eXBlIGxvb2t1cCB0YWJsZS5cblx0ICpcblx0ICogQHByb3BlcnR5IG1pbWVUeXBlc1xuXHQgKiBAdHlwZSBPYmplY3Rcblx0ICogQGZpbmFsXG5cdCAqL1xuXHRtaW1lVHlwZXMgOiB1Lk1pbWUubWltZXMsXG5cblx0LyoqXG5cdCAqIEluIHNvbWUgY2FzZXMgc25pZmZpbmcgaXMgdGhlIG9ubHkgd2F5IGFyb3VuZCA6KFxuXHQgKi9cblx0dWE6IHUuRW52LFxuXG5cdC8qKlxuXHQgKiBHZXRzIHRoZSB0cnVlIHR5cGUgb2YgdGhlIGJ1aWx0LWluIG9iamVjdCAoYmV0dGVyIHZlcnNpb24gb2YgdHlwZW9mKS5cblx0ICogQGNyZWRpdHMgQW5ndXMgQ3JvbGwgKGh0dHA6Ly9qYXZhc2NyaXB0d2VibG9nLndvcmRwcmVzcy5jb20vKVxuXHQgKlxuXHQgKiBAbWV0aG9kIHR5cGVPZlxuXHQgKiBAc3RhdGljXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBvIE9iamVjdCB0byBjaGVjay5cblx0ICogQHJldHVybiB7U3RyaW5nfSBPYmplY3QgW1tDbGFzc11dXG5cdCAqL1xuXHR0eXBlT2Y6IHUuQmFzaWMudHlwZU9mLFxuXG5cdC8qKlxuXHQgKiBFeHRlbmRzIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHdpdGggYW5vdGhlciBvYmplY3QuXG5cdCAqXG5cdCAqIEBtZXRob2QgZXh0ZW5kXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtPYmplY3R9IHRhcmdldCBPYmplY3QgdG8gZXh0ZW5kLlxuXHQgKiBAcGFyYW0ge09iamVjdC4ufSBvYmogTXVsdGlwbGUgb2JqZWN0cyB0byBleHRlbmQgd2l0aC5cblx0ICogQHJldHVybiB7T2JqZWN0fSBTYW1lIGFzIHRhcmdldCwgdGhlIGV4dGVuZGVkIG9iamVjdC5cblx0ICovXG5cdGV4dGVuZCA6IHUuQmFzaWMuZXh0ZW5kLFxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYW4gdW5pcXVlIElELiBUaGlzIGlzIDk5Ljk5JSB1bmlxdWUgc2luY2UgaXQgdGFrZXMgdGhlIGN1cnJlbnQgdGltZSBhbmQgNSByYW5kb20gbnVtYmVycy5cblx0ICogVGhlIG9ubHkgd2F5IGEgdXNlciB3b3VsZCBiZSBhYmxlIHRvIGdldCB0aGUgc2FtZSBJRCBpcyBpZiB0aGUgdHdvIHBlcnNvbnMgYXQgdGhlIHNhbWUgZXhhY3QgbWlsbGlzZWNvbmQgbWFuYWdlc1xuXHQgKiB0byBnZXQgNSB0aGUgc2FtZSByYW5kb20gbnVtYmVycyBiZXR3ZWVuIDAtNjU1MzUgaXQgYWxzbyB1c2VzIGEgY291bnRlciBzbyBlYWNoIGNhbGwgd2lsbCBiZSBndWFyYW50ZWVkIHRvIGJlIHBhZ2UgdW5pcXVlLlxuXHQgKiBJdCdzIG1vcmUgcHJvYmFibGUgZm9yIHRoZSBlYXJ0aCB0byBiZSBoaXQgd2l0aCBhbiBhc3RlcmlvZC4gWW91IGNhbiBhbHNvIGlmIHlvdSB3YW50IHRvIGJlIDEwMCUgc3VyZSBzZXQgdGhlIHBsdXBsb2FkLmd1aWRQcmVmaXggcHJvcGVydHlcblx0ICogdG8gYW4gdXNlciB1bmlxdWUga2V5LlxuXHQgKlxuXHQgKiBAbWV0aG9kIGd1aWRcblx0ICogQHN0YXRpY1xuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IFZpcnR1YWxseSB1bmlxdWUgaWQuXG5cdCAqL1xuXHRndWlkIDogdS5CYXNpYy5ndWlkLFxuXG5cdC8qKlxuXHQgKiBHZXQgYXJyYXkgb2YgRE9NIEVsZW1lbnRzIGJ5IHRoZWlyIGlkcy5cblx0ICpcblx0ICogQG1ldGhvZCBnZXRcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlkIElkZW50aWZpZXIgb2YgdGhlIERPTSBFbGVtZW50XG5cdCAqIEByZXR1cm4ge0FycmF5fVxuXHQqL1xuXHRnZXRBbGwgOiBmdW5jdGlvbiBnZXQoaWRzKSB7XG5cdFx0dmFyIGVscyA9IFtdLCBlbDtcblxuXHRcdGlmIChwbHVwbG9hZC50eXBlT2YoaWRzKSAhPT0gJ2FycmF5Jykge1xuXHRcdFx0aWRzID0gW2lkc107XG5cdFx0fVxuXG5cdFx0dmFyIGkgPSBpZHMubGVuZ3RoO1xuXHRcdHdoaWxlIChpLS0pIHtcblx0XHRcdGVsID0gcGx1cGxvYWQuZ2V0KGlkc1tpXSk7XG5cdFx0XHRpZiAoZWwpIHtcblx0XHRcdFx0ZWxzLnB1c2goZWwpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBlbHMubGVuZ3RoID8gZWxzIDogbnVsbDtcblx0fSxcblxuXHQvKipcblx0R2V0IERPTSBlbGVtZW50IGJ5IGlkXG5cblx0QG1ldGhvZCBnZXRcblx0QHBhcmFtIHtTdHJpbmd9IGlkIElkZW50aWZpZXIgb2YgdGhlIERPTSBFbGVtZW50XG5cdEByZXR1cm4ge05vZGV9XG5cdCovXG5cdGdldDogdS5Eb20uZ2V0LFxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlcyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gZm9yIGVhY2ggaXRlbSBpbiBhcnJheS9vYmplY3QuIElmIHlvdSByZXR1cm4gZmFsc2UgaW4gdGhlXG5cdCAqIGNhbGxiYWNrIGl0IHdpbGwgYnJlYWsgdGhlIGxvb3AuXG5cdCAqXG5cdCAqIEBtZXRob2QgZWFjaFxuXHQgKiBAc3RhdGljXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBvYmogT2JqZWN0IHRvIGl0ZXJhdGUuXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgZm9yIGVhY2ggaXRlbS5cblx0ICovXG5cdGVhY2ggOiB1LkJhc2ljLmVhY2gsXG5cblx0LyoqXG5cdCAqIFJldHVybnMgdGhlIGFic29sdXRlIHgsIHkgcG9zaXRpb24gb2YgYW4gRWxlbWVudC4gVGhlIHBvc2l0aW9uIHdpbGwgYmUgcmV0dXJuZWQgaW4gYSBvYmplY3Qgd2l0aCB4LCB5IGZpZWxkcy5cblx0ICpcblx0ICogQG1ldGhvZCBnZXRQb3Ncblx0ICogQHN0YXRpY1xuXHQgKiBAcGFyYW0ge0VsZW1lbnR9IG5vZGUgSFRNTCBlbGVtZW50IG9yIGVsZW1lbnQgaWQgdG8gZ2V0IHgsIHkgcG9zaXRpb24gZnJvbS5cblx0ICogQHBhcmFtIHtFbGVtZW50fSByb290IE9wdGlvbmFsIHJvb3QgZWxlbWVudCB0byBzdG9wIGNhbGN1bGF0aW9ucyBhdC5cblx0ICogQHJldHVybiB7b2JqZWN0fSBBYnNvbHV0ZSBwb3NpdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgb2JqZWN0IHdpdGggeCwgeSBmaWVsZHMuXG5cdCAqL1xuXHRnZXRQb3MgOiB1LkRvbS5nZXRQb3MsXG5cblx0LyoqXG5cdCAqIFJldHVybnMgdGhlIHNpemUgb2YgdGhlIHNwZWNpZmllZCBub2RlIGluIHBpeGVscy5cblx0ICpcblx0ICogQG1ldGhvZCBnZXRTaXplXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtOb2RlfSBub2RlIE5vZGUgdG8gZ2V0IHRoZSBzaXplIG9mLlxuXHQgKiBAcmV0dXJuIHtPYmplY3R9IE9iamVjdCB3aXRoIGEgdyBhbmQgaCBwcm9wZXJ0eS5cblx0ICovXG5cdGdldFNpemUgOiB1LkRvbS5nZXRTaXplLFxuXG5cdC8qKlxuXHQgKiBFbmNvZGVzIHRoZSBzcGVjaWZpZWQgc3RyaW5nLlxuXHQgKlxuXHQgKiBAbWV0aG9kIHhtbEVuY29kZVxuXHQgKiBAc3RhdGljXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzIFN0cmluZyB0byBlbmNvZGUuXG5cdCAqIEByZXR1cm4ge1N0cmluZ30gRW5jb2RlZCBzdHJpbmcuXG5cdCAqL1xuXHR4bWxFbmNvZGUgOiBmdW5jdGlvbihzdHIpIHtcblx0XHR2YXIgeG1sRW5jb2RlQ2hhcnMgPSB7JzwnIDogJ2x0JywgJz4nIDogJ2d0JywgJyYnIDogJ2FtcCcsICdcIicgOiAncXVvdCcsICdcXCcnIDogJyMzOSd9LCB4bWxFbmNvZGVSZWdFeHAgPSAvWzw+JlxcXCJcXCddL2c7XG5cblx0XHRyZXR1cm4gc3RyID8gKCcnICsgc3RyKS5yZXBsYWNlKHhtbEVuY29kZVJlZ0V4cCwgZnVuY3Rpb24oY2hyKSB7XG5cdFx0XHRyZXR1cm4geG1sRW5jb2RlQ2hhcnNbY2hyXSA/ICcmJyArIHhtbEVuY29kZUNoYXJzW2Nocl0gKyAnOycgOiBjaHI7XG5cdFx0fSkgOiBzdHI7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEZvcmNlcyBhbnl0aGluZyBpbnRvIGFuIGFycmF5LlxuXHQgKlxuXHQgKiBAbWV0aG9kIHRvQXJyYXlcblx0ICogQHN0YXRpY1xuXHQgKiBAcGFyYW0ge09iamVjdH0gb2JqIE9iamVjdCB3aXRoIGxlbmd0aCBmaWVsZC5cblx0ICogQHJldHVybiB7QXJyYXl9IEFycmF5IG9iamVjdCBjb250YWluaW5nIGFsbCBpdGVtcy5cblx0ICovXG5cdHRvQXJyYXkgOiB1LkJhc2ljLnRvQXJyYXksXG5cblx0LyoqXG5cdCAqIEZpbmQgYW4gZWxlbWVudCBpbiBhcnJheSBhbmQgcmV0dXJuIGl0cyBpbmRleCBpZiBwcmVzZW50LCBvdGhlcndpc2UgcmV0dXJuIC0xLlxuXHQgKlxuXHQgKiBAbWV0aG9kIGluQXJyYXlcblx0ICogQHN0YXRpY1xuXHQgKiBAcGFyYW0ge21peGVkfSBuZWVkbGUgRWxlbWVudCB0byBmaW5kXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGFycmF5XG5cdCAqIEByZXR1cm4ge0ludH0gSW5kZXggb2YgdGhlIGVsZW1lbnQsIG9yIC0xIGlmIG5vdCBmb3VuZFxuXHQgKi9cblx0aW5BcnJheSA6IHUuQmFzaWMuaW5BcnJheSxcblxuXHQvKipcblx0UmVjaWV2ZSBhbiBhcnJheSBvZiBmdW5jdGlvbnMgKHVzdWFsbHkgYXN5bmMpIHRvIGNhbGwgaW4gc2VxdWVuY2UsIGVhY2ggIGZ1bmN0aW9uXG5cdHJlY2VpdmVzIGEgY2FsbGJhY2sgYXMgZmlyc3QgYXJndW1lbnQgdGhhdCBpdCBzaG91bGQgY2FsbCwgd2hlbiBpdCBjb21wbGV0ZXMuIEZpbmFsbHksXG5cdGFmdGVyIGV2ZXJ5dGhpbmcgaXMgY29tcGxldGUsIG1haW4gY2FsbGJhY2sgaXMgY2FsbGVkLiBQYXNzaW5nIHRydXRoeSB2YWx1ZSB0byB0aGVcblx0Y2FsbGJhY2sgYXMgYSBmaXJzdCBhcmd1bWVudCB3aWxsIGludGVycnVwdCB0aGUgc2VxdWVuY2UgYW5kIGludm9rZSBtYWluIGNhbGxiYWNrXG5cdGltbWVkaWF0ZWx5LlxuXG5cdEBtZXRob2QgaW5TZXJpZXNcblx0QHN0YXRpY1xuXHRAcGFyYW0ge0FycmF5fSBxdWV1ZSBBcnJheSBvZiBmdW5jdGlvbnMgdG8gY2FsbCBpbiBzZXF1ZW5jZVxuXHRAcGFyYW0ge0Z1bmN0aW9ufSBjYiBNYWluIGNhbGxiYWNrIHRoYXQgaXMgY2FsbGVkIGluIHRoZSBlbmQsIG9yIGluIGNhc2Ugb2YgZXJyb3Jcblx0Ki9cblx0aW5TZXJpZXM6IHUuQmFzaWMuaW5TZXJpZXMsXG5cblx0LyoqXG5cdCAqIEV4dGVuZHMgdGhlIGxhbmd1YWdlIHBhY2sgb2JqZWN0IHdpdGggbmV3IGl0ZW1zLlxuXHQgKlxuXHQgKiBAbWV0aG9kIGFkZEkxOG5cblx0ICogQHN0YXRpY1xuXHQgKiBAcGFyYW0ge09iamVjdH0gcGFjayBMYW5ndWFnZSBwYWNrIGl0ZW1zIHRvIGFkZC5cblx0ICogQHJldHVybiB7T2JqZWN0fSBFeHRlbmRlZCBsYW5ndWFnZSBwYWNrIG9iamVjdC5cblx0ICovXG5cdGFkZEkxOG4gOiBvLmNvcmUuSTE4bi5hZGRJMThuLFxuXG5cdC8qKlxuXHQgKiBUcmFuc2xhdGVzIHRoZSBzcGVjaWZpZWQgc3RyaW5nIGJ5IGNoZWNraW5nIGZvciB0aGUgZW5nbGlzaCBzdHJpbmcgaW4gdGhlIGxhbmd1YWdlIHBhY2sgbG9va3VwLlxuXHQgKlxuXHQgKiBAbWV0aG9kIHRyYW5zbGF0ZVxuXHQgKiBAc3RhdGljXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgU3RyaW5nIHRvIGxvb2sgZm9yLlxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IFRyYW5zbGF0ZWQgc3RyaW5nIG9yIHRoZSBpbnB1dCBzdHJpbmcgaWYgaXQgd2Fzbid0IGZvdW5kLlxuXHQgKi9cblx0dHJhbnNsYXRlIDogby5jb3JlLkkxOG4udHJhbnNsYXRlLFxuXG5cdC8qKlxuXHQgKiBQc2V1ZG8gc3ByaW50ZiBpbXBsZW1lbnRhdGlvbiAtIHNpbXBsZSB3YXkgdG8gcmVwbGFjZSB0b2tlbnMgd2l0aCBzcGVjaWZpZWQgdmFsdWVzLlxuXHQgKlxuXHQgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB3aXRoIHRva2Vuc1xuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IFN0cmluZyB3aXRoIHJlcGxhY2VkIHRva2Vuc1xuXHQgKi9cblx0c3ByaW50ZiA6IHUuQmFzaWMuc3ByaW50ZixcblxuXHQvKipcblx0ICogQ2hlY2tzIGlmIG9iamVjdCBpcyBlbXB0eS5cblx0ICpcblx0ICogQG1ldGhvZCBpc0VtcHR5T2JqXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiBPYmplY3QgdG8gY2hlY2suXG5cdCAqIEByZXR1cm4ge0Jvb2xlYW59XG5cdCAqL1xuXHRpc0VtcHR5T2JqIDogdS5CYXNpYy5pc0VtcHR5T2JqLFxuXG5cdC8qKlxuXHQgKiBDaGVja3MgaWYgc3BlY2lmaWVkIERPTSBlbGVtZW50IGhhcyBzcGVjaWZpZWQgY2xhc3MuXG5cdCAqXG5cdCAqIEBtZXRob2QgaGFzQ2xhc3Ncblx0ICogQHN0YXRpY1xuXHQgKiBAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IGxpa2Ugb2JqZWN0IHRvIGFkZCBoYW5kbGVyIHRvLlxuXHQgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBDbGFzcyBuYW1lXG5cdCAqL1xuXHRoYXNDbGFzcyA6IHUuRG9tLmhhc0NsYXNzLFxuXG5cdC8qKlxuXHQgKiBBZGRzIHNwZWNpZmllZCBjbGFzc05hbWUgdG8gc3BlY2lmaWVkIERPTSBlbGVtZW50LlxuXHQgKlxuXHQgKiBAbWV0aG9kIGFkZENsYXNzXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0ICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgQ2xhc3MgbmFtZVxuXHQgKi9cblx0YWRkQ2xhc3MgOiB1LkRvbS5hZGRDbGFzcyxcblxuXHQvKipcblx0ICogUmVtb3ZlcyBzcGVjaWZpZWQgY2xhc3NOYW1lIGZyb20gc3BlY2lmaWVkIERPTSBlbGVtZW50LlxuXHQgKlxuXHQgKiBAbWV0aG9kIHJlbW92ZUNsYXNzXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0ICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgQ2xhc3MgbmFtZVxuXHQgKi9cblx0cmVtb3ZlQ2xhc3MgOiB1LkRvbS5yZW1vdmVDbGFzcyxcblxuXHQvKipcblx0ICogUmV0dXJucyBhIGdpdmVuIGNvbXB1dGVkIHN0eWxlIG9mIGEgRE9NIGVsZW1lbnQuXG5cdCAqXG5cdCAqIEBtZXRob2QgZ2V0U3R5bGVcblx0ICogQHN0YXRpY1xuXHQgKiBAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IGxpa2Ugb2JqZWN0LlxuXHQgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBTdHlsZSB5b3Ugd2FudCB0byBnZXQgZnJvbSB0aGUgRE9NIGVsZW1lbnRcblx0ICovXG5cdGdldFN0eWxlIDogdS5Eb20uZ2V0U3R5bGUsXG5cblx0LyoqXG5cdCAqIEFkZHMgYW4gZXZlbnQgaGFuZGxlciB0byB0aGUgc3BlY2lmaWVkIG9iamVjdCBhbmQgc3RvcmUgcmVmZXJlbmNlIHRvIHRoZSBoYW5kbGVyXG5cdCAqIGluIG9iamVjdHMgaW50ZXJuYWwgUGx1cGxvYWQgcmVnaXN0cnkgKEBzZWUgcmVtb3ZlRXZlbnQpLlxuXHQgKlxuXHQgKiBAbWV0aG9kIGFkZEV2ZW50XG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0ICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSB0byBhZGQgZXZlbnQgbGlzdGVuZXIgdG8uXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBldmVudCBvY2N1cnMuXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSAob3B0aW9uYWwpIGtleSB0aGF0IG1pZ2h0IGJlIHVzZWQgdG8gYWRkIHNwZWNpZml0eSB0byB0aGUgZXZlbnQgcmVjb3JkLlxuXHQgKi9cblx0YWRkRXZlbnQgOiB1LkV2ZW50cy5hZGRFdmVudCxcblxuXHQvKipcblx0ICogUmVtb3ZlIGV2ZW50IGhhbmRsZXIgZnJvbSB0aGUgc3BlY2lmaWVkIG9iamVjdC4gSWYgdGhpcmQgYXJndW1lbnQgKGNhbGxiYWNrKVxuXHQgKiBpcyBub3Qgc3BlY2lmaWVkIHJlbW92ZSBhbGwgZXZlbnRzIHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLlxuXHQgKlxuXHQgKiBAbWV0aG9kIHJlbW92ZUV2ZW50XG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCB0byByZW1vdmUgZXZlbnQgbGlzdGVuZXIocykgZnJvbS5cblx0ICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBvZiBldmVudCBsaXN0ZW5lciB0byByZW1vdmUuXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSAob3B0aW9uYWwpIG1pZ2h0IGJlIGEgY2FsbGJhY2sgb3IgdW5pcXVlIGtleSB0byBtYXRjaC5cblx0ICovXG5cdHJlbW92ZUV2ZW50OiB1LkV2ZW50cy5yZW1vdmVFdmVudCxcblxuXHQvKipcblx0ICogUmVtb3ZlIGFsbCBraW5kIG9mIGV2ZW50cyBmcm9tIHRoZSBzcGVjaWZpZWQgb2JqZWN0XG5cdCAqXG5cdCAqIEBtZXRob2QgcmVtb3ZlQWxsRXZlbnRzXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCB0byByZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZyb20uXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSAob3B0aW9uYWwpIHVuaXF1ZSBrZXkgdG8gbWF0Y2gsIHdoZW4gcmVtb3ZpbmcgZXZlbnRzLlxuXHQgKi9cblx0cmVtb3ZlQWxsRXZlbnRzOiB1LkV2ZW50cy5yZW1vdmVBbGxFdmVudHMsXG5cblx0LyoqXG5cdCAqIENsZWFucyB0aGUgc3BlY2lmaWVkIG5hbWUgZnJvbSBuYXRpb25hbCBjaGFyYWN0ZXJzIChkaWFjcml0aWNzKS4gVGhlIHJlc3VsdCB3aWxsIGJlIGEgbmFtZSB3aXRoIG9ubHkgYS16LCAwLTkgYW5kIF8uXG5cdCAqXG5cdCAqIEBtZXRob2QgY2xlYW5OYW1lXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtTdHJpbmd9IHMgU3RyaW5nIHRvIGNsZWFuIHVwLlxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IENsZWFuZWQgc3RyaW5nLlxuXHQgKi9cblx0Y2xlYW5OYW1lIDogZnVuY3Rpb24obmFtZSkge1xuXHRcdHZhciBpLCBsb29rdXA7XG5cblx0XHQvLyBSZXBsYWNlIGRpYWNyaXRpY3Ncblx0XHRsb29rdXAgPSBbXG5cdFx0XHQvW1xcMzAwLVxcMzA2XS9nLCAnQScsIC9bXFwzNDAtXFwzNDZdL2csICdhJyxcblx0XHRcdC9cXDMwNy9nLCAnQycsIC9cXDM0Ny9nLCAnYycsXG5cdFx0XHQvW1xcMzEwLVxcMzEzXS9nLCAnRScsIC9bXFwzNTAtXFwzNTNdL2csICdlJyxcblx0XHRcdC9bXFwzMTQtXFwzMTddL2csICdJJywgL1tcXDM1NC1cXDM1N10vZywgJ2knLFxuXHRcdFx0L1xcMzIxL2csICdOJywgL1xcMzYxL2csICduJyxcblx0XHRcdC9bXFwzMjItXFwzMzBdL2csICdPJywgL1tcXDM2Mi1cXDM3MF0vZywgJ28nLFxuXHRcdFx0L1tcXDMzMS1cXDMzNF0vZywgJ1UnLCAvW1xcMzcxLVxcMzc0XS9nLCAndSdcblx0XHRdO1xuXG5cdFx0Zm9yIChpID0gMDsgaSA8IGxvb2t1cC5sZW5ndGg7IGkgKz0gMikge1xuXHRcdFx0bmFtZSA9IG5hbWUucmVwbGFjZShsb29rdXBbaV0sIGxvb2t1cFtpICsgMV0pO1xuXHRcdH1cblxuXHRcdC8vIFJlcGxhY2Ugd2hpdGVzcGFjZVxuXHRcdG5hbWUgPSBuYW1lLnJlcGxhY2UoL1xccysvZywgJ18nKTtcblxuXHRcdC8vIFJlbW92ZSBhbnl0aGluZyBlbHNlXG5cdFx0bmFtZSA9IG5hbWUucmVwbGFjZSgvW15hLXowLTlfXFwtXFwuXSsvZ2ksICcnKTtcblxuXHRcdHJldHVybiBuYW1lO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBCdWlsZHMgYSBmdWxsIHVybCBvdXQgb2YgYSBiYXNlIFVSTCBhbmQgYW4gb2JqZWN0IHdpdGggaXRlbXMgdG8gYXBwZW5kIGFzIHF1ZXJ5IHN0cmluZyBpdGVtcy5cblx0ICpcblx0ICogQG1ldGhvZCBidWlsZFVybFxuXHQgKiBAc3RhdGljXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgQmFzZSBVUkwgdG8gYXBwZW5kIHF1ZXJ5IHN0cmluZyBpdGVtcyB0by5cblx0ICogQHBhcmFtIHtPYmplY3R9IGl0ZW1zIE5hbWUvdmFsdWUgb2JqZWN0IHRvIHNlcmlhbGl6ZSBhcyBhIHF1ZXJ5c3RyaW5nLlxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IFN0cmluZyB3aXRoIHVybCArIHNlcmlhbGl6ZWQgcXVlcnkgc3RyaW5nIGl0ZW1zLlxuXHQgKi9cblx0YnVpbGRVcmw6IGZ1bmN0aW9uKHVybCwgaXRlbXMpIHtcblx0XHR2YXIgcXVlcnkgPSAnJztcblxuXHRcdHBsdXBsb2FkLmVhY2goaXRlbXMsIGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG5cdFx0XHRxdWVyeSArPSAocXVlcnkgPyAnJicgOiAnJykgKyBlbmNvZGVVUklDb21wb25lbnQobmFtZSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpO1xuXHRcdH0pO1xuXG5cdFx0aWYgKHF1ZXJ5KSB7XG5cdFx0XHR1cmwgKz0gKHVybC5pbmRleE9mKCc/JykgPiAwID8gJyYnIDogJz8nKSArIHF1ZXJ5O1xuXHRcdH1cblxuXHRcdHJldHVybiB1cmw7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEZvcm1hdHMgdGhlIHNwZWNpZmllZCBudW1iZXIgYXMgYSBzaXplIHN0cmluZyBmb3IgZXhhbXBsZSAxMDI0IGJlY29tZXMgMSBLQi5cblx0ICpcblx0ICogQG1ldGhvZCBmb3JtYXRTaXplXG5cdCAqIEBzdGF0aWNcblx0ICogQHBhcmFtIHtOdW1iZXJ9IHNpemUgU2l6ZSB0byBmb3JtYXQgYXMgc3RyaW5nLlxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IEZvcm1hdHRlZCBzaXplIHN0cmluZy5cblx0ICovXG5cdGZvcm1hdFNpemUgOiBmdW5jdGlvbihzaXplKSB7XG5cblx0XHRpZiAoc2l6ZSA9PT0gdW5kZWYgfHwgL1xcRC8udGVzdChzaXplKSkge1xuXHRcdFx0cmV0dXJuIHBsdXBsb2FkLnRyYW5zbGF0ZSgnTi9BJyk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcm91bmQobnVtLCBwcmVjaXNpb24pIHtcblx0XHRcdHJldHVybiBNYXRoLnJvdW5kKG51bSAqIE1hdGgucG93KDEwLCBwcmVjaXNpb24pKSAvIE1hdGgucG93KDEwLCBwcmVjaXNpb24pO1xuXHRcdH1cblxuXHRcdHZhciBib3VuZGFyeSA9IE1hdGgucG93KDEwMjQsIDQpO1xuXG5cdFx0Ly8gVEJcblx0XHRpZiAoc2l6ZSA+IGJvdW5kYXJ5KSB7XG5cdFx0XHRyZXR1cm4gcm91bmQoc2l6ZSAvIGJvdW5kYXJ5LCAxKSArIFwiIFwiICsgcGx1cGxvYWQudHJhbnNsYXRlKCd0YicpO1xuXHRcdH1cblxuXHRcdC8vIEdCXG5cdFx0aWYgKHNpemUgPiAoYm91bmRhcnkvPTEwMjQpKSB7XG5cdFx0XHRyZXR1cm4gcm91bmQoc2l6ZSAvIGJvdW5kYXJ5LCAxKSArIFwiIFwiICsgcGx1cGxvYWQudHJhbnNsYXRlKCdnYicpO1xuXHRcdH1cblxuXHRcdC8vIE1CXG5cdFx0aWYgKHNpemUgPiAoYm91bmRhcnkvPTEwMjQpKSB7XG5cdFx0XHRyZXR1cm4gcm91bmQoc2l6ZSAvIGJvdW5kYXJ5LCAxKSArIFwiIFwiICsgcGx1cGxvYWQudHJhbnNsYXRlKCdtYicpO1xuXHRcdH1cblxuXHRcdC8vIEtCXG5cdFx0aWYgKHNpemUgPiAxMDI0KSB7XG5cdFx0XHRyZXR1cm4gTWF0aC5yb3VuZChzaXplIC8gMTAyNCkgKyBcIiBcIiArIHBsdXBsb2FkLnRyYW5zbGF0ZSgna2InKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gc2l6ZSArIFwiIFwiICsgcGx1cGxvYWQudHJhbnNsYXRlKCdiJyk7XG5cdH0sXG5cblxuXHQvKipcblx0ICogUGFyc2VzIHRoZSBzcGVjaWZpZWQgc2l6ZSBzdHJpbmcgaW50byBhIGJ5dGUgdmFsdWUuIEZvciBleGFtcGxlIDEwa2IgYmVjb21lcyAxMDI0MC5cblx0ICpcblx0ICogQG1ldGhvZCBwYXJzZVNpemVcblx0ICogQHN0YXRpY1xuXHQgKiBAcGFyYW0ge1N0cmluZ3xOdW1iZXJ9IHNpemUgU3RyaW5nIHRvIHBhcnNlIG9yIG51bWJlciB0byBqdXN0IHBhc3MgdGhyb3VnaC5cblx0ICogQHJldHVybiB7TnVtYmVyfSBTaXplIGluIGJ5dGVzLlxuXHQgKi9cblx0cGFyc2VTaXplIDogdS5CYXNpYy5wYXJzZVNpemVTdHIsXG5cblxuXHQvKipcblx0ICogQSB3YXkgdG8gcHJlZGljdCB3aGF0IHJ1bnRpbWUgd2lsbCBiZSBjaG9vc2VuIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50IHdpdGggdGhlXG5cdCAqIHNwZWNpZmllZCBzZXR0aW5ncy5cblx0ICpcblx0ICogQG1ldGhvZCBwcmVkaWN0UnVudGltZVxuXHQgKiBAc3RhdGljXG5cdCAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gY29uZmlnIFBsdXBsb2FkIHNldHRpbmdzIHRvIGNoZWNrXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBbcnVudGltZXNdIENvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHJ1bnRpbWVzIHRvIGNoZWNrIGFnYWluc3Rcblx0ICogQHJldHVybiB7U3RyaW5nfSBUeXBlIG9mIGNvbXBhdGlibGUgcnVudGltZVxuXHQgKi9cblx0cHJlZGljdFJ1bnRpbWUgOiBmdW5jdGlvbihjb25maWcsIHJ1bnRpbWVzKSB7XG5cdFx0dmFyIHVwLCBydW50aW1lO1xuXG5cdFx0dXAgPSBuZXcgcGx1cGxvYWQuVXBsb2FkZXIoY29uZmlnKTtcblx0XHRydW50aW1lID0gUnVudGltZS50aGF0Q2FuKHVwLmdldE9wdGlvbigpLnJlcXVpcmVkX2ZlYXR1cmVzLCBydW50aW1lcyB8fCBjb25maWcucnVudGltZXMpO1xuXHRcdHVwLmRlc3Ryb3koKTtcblx0XHRyZXR1cm4gcnVudGltZTtcblx0fSxcblxuXHQvKipcblx0ICogUmVnaXN0ZXJzIGEgZmlsdGVyIHRoYXQgd2lsbCBiZSBleGVjdXRlZCBmb3IgZWFjaCBmaWxlIGFkZGVkIHRvIHRoZSBxdWV1ZS5cblx0ICogSWYgY2FsbGJhY2sgcmV0dXJucyBmYWxzZSwgZmlsZSB3aWxsIG5vdCBiZSBhZGRlZC5cblx0ICpcblx0ICogQ2FsbGJhY2sgcmVjZWl2ZXMgdHdvIGFyZ3VtZW50czogYSB2YWx1ZSBmb3IgdGhlIGZpbHRlciBhcyBpdCB3YXMgc3BlY2lmaWVkIGluIHNldHRpbmdzLmZpbHRlcnNcblx0ICogYW5kIGEgZmlsZSB0byBiZSBmaWx0ZXJlZC4gQ2FsbGJhY2sgaXMgZXhlY3V0ZWQgaW4gdGhlIGNvbnRleHQgb2YgdXBsb2FkZXIgaW5zdGFuY2UuXG5cdCAqXG5cdCAqIEBtZXRob2QgYWRkRmlsZUZpbHRlclxuXHQgKiBAc3RhdGljXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIE5hbWUgb2YgdGhlIGZpbHRlciBieSB3aGljaCBpdCBjYW4gYmUgcmVmZXJlbmNlZCBpbiBzZXR0aW5ncy5maWx0ZXJzXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBjYiBDYWxsYmFjayAtIHRoZSBhY3R1YWwgcm91dGluZSB0aGF0IGV2ZXJ5IGFkZGVkIGZpbGUgbXVzdCBwYXNzXG5cdCAqL1xuXHRhZGRGaWxlRmlsdGVyOiBmdW5jdGlvbihuYW1lLCBjYikge1xuXHRcdGZpbGVGaWx0ZXJzW25hbWVdID0gY2I7XG5cdH1cbn07XG5cblxucGx1cGxvYWQuYWRkRmlsZUZpbHRlcignbWltZV90eXBlcycsIGZ1bmN0aW9uKGZpbHRlcnMsIGZpbGUsIGNiKSB7XG5cdGlmIChmaWx0ZXJzLmxlbmd0aCAmJiAhZmlsdGVycy5yZWdleHAudGVzdChmaWxlLm5hbWUpKSB7XG5cdFx0dGhpcy50cmlnZ2VyKCdFcnJvcicsIHtcblx0XHRcdGNvZGUgOiBwbHVwbG9hZC5GSUxFX0VYVEVOU0lPTl9FUlJPUixcblx0XHRcdG1lc3NhZ2UgOiBwbHVwbG9hZC50cmFuc2xhdGUoJ0ZpbGUgZXh0ZW5zaW9uIGVycm9yLicpLFxuXHRcdFx0ZmlsZSA6IGZpbGVcblx0XHR9KTtcblx0XHRjYihmYWxzZSk7XG5cdH0gZWxzZSB7XG5cdFx0Y2IodHJ1ZSk7XG5cdH1cbn0pO1xuXG5cbnBsdXBsb2FkLmFkZEZpbGVGaWx0ZXIoJ21heF9maWxlX3NpemUnLCBmdW5jdGlvbihtYXhTaXplLCBmaWxlLCBjYikge1xuXHR2YXIgdW5kZWY7XG5cblx0bWF4U2l6ZSA9IHBsdXBsb2FkLnBhcnNlU2l6ZShtYXhTaXplKTtcblxuXHQvLyBJbnZhbGlkIGZpbGUgc2l6ZVxuXHRpZiAoZmlsZS5zaXplICE9PSB1bmRlZiAmJiBtYXhTaXplICYmIGZpbGUuc2l6ZSA+IG1heFNpemUpIHtcblx0XHR0aGlzLnRyaWdnZXIoJ0Vycm9yJywge1xuXHRcdFx0Y29kZSA6IHBsdXBsb2FkLkZJTEVfU0laRV9FUlJPUixcblx0XHRcdG1lc3NhZ2UgOiBwbHVwbG9hZC50cmFuc2xhdGUoJ0ZpbGUgc2l6ZSBlcnJvci4nKSxcblx0XHRcdGZpbGUgOiBmaWxlXG5cdFx0fSk7XG5cdFx0Y2IoZmFsc2UpO1xuXHR9IGVsc2Uge1xuXHRcdGNiKHRydWUpO1xuXHR9XG59KTtcblxuXG5wbHVwbG9hZC5hZGRGaWxlRmlsdGVyKCdwcmV2ZW50X2R1cGxpY2F0ZXMnLCBmdW5jdGlvbih2YWx1ZSwgZmlsZSwgY2IpIHtcblx0aWYgKHZhbHVlKSB7XG5cdFx0dmFyIGlpID0gdGhpcy5maWxlcy5sZW5ndGg7XG5cdFx0d2hpbGUgKGlpLS0pIHtcblx0XHRcdC8vIENvbXBhcmUgYnkgbmFtZSBhbmQgc2l6ZSAoc2l6ZSBtaWdodCBiZSAwIG9yIHVuZGVmaW5lZCwgYnV0IHN0aWxsIGVxdWl2YWxlbnQgZm9yIGJvdGgpXG5cdFx0XHRpZiAoZmlsZS5uYW1lID09PSB0aGlzLmZpbGVzW2lpXS5uYW1lICYmIGZpbGUuc2l6ZSA9PT0gdGhpcy5maWxlc1tpaV0uc2l6ZSkge1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoJ0Vycm9yJywge1xuXHRcdFx0XHRcdGNvZGUgOiBwbHVwbG9hZC5GSUxFX0RVUExJQ0FURV9FUlJPUixcblx0XHRcdFx0XHRtZXNzYWdlIDogcGx1cGxvYWQudHJhbnNsYXRlKCdEdXBsaWNhdGUgZmlsZSBlcnJvci4nKSxcblx0XHRcdFx0XHRmaWxlIDogZmlsZVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0Y2IoZmFsc2UpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGNiKHRydWUpO1xufSk7XG5cbnBsdXBsb2FkLmFkZEZpbGVGaWx0ZXIoJ3ByZXZlbnRfZW1wdHknLCBmdW5jdGlvbih2YWx1ZSwgZmlsZSwgY2IpIHtcblx0aWYgKHZhbHVlICYmICFmaWxlLnNpemUgJiYgZmlsZS5zaXplICE9PSB1bmRlZikge1xuXHRcdHRoaXMudHJpZ2dlcignRXJyb3InLCB7XG5cdFx0XHRjb2RlIDogcGx1cGxvYWQuRklMRV9TSVpFX0VSUk9SLFxuXHRcdFx0bWVzc2FnZSA6IHBsdXBsb2FkLnRyYW5zbGF0ZSgnRmlsZSBzaXplIGVycm9yLicpLFxuXHRcdFx0ZmlsZSA6IGZpbGVcblx0XHR9KTtcblx0XHRjYihmYWxzZSk7XG5cdH0gZWxzZSB7XG5cdFx0Y2IodHJ1ZSk7XG5cdH1cbn0pO1xuXG5cbi8qKlxuQGNsYXNzIFVwbG9hZGVyXG5AY29uc3RydWN0b3JcblxuQHBhcmFtIHtPYmplY3R9IHNldHRpbmdzIEZvciBkZXRhaWxlZCBpbmZvcm1hdGlvbiBhYm91dCBlYWNoIG9wdGlvbiBjaGVjayBkb2N1bWVudGF0aW9uLlxuXHRAcGFyYW0ge1N0cmluZ3xET01FbGVtZW50fSBzZXR0aW5ncy5icm93c2VfYnV0dG9uIGlkIG9mIHRoZSBET00gZWxlbWVudCBvciBET00gZWxlbWVudCBpdHNlbGYgdG8gdXNlIGFzIGZpbGUgZGlhbG9nIHRyaWdnZXIuXG5cdEBwYXJhbSB7TnVtYmVyfFN0cmluZ30gW3NldHRpbmdzLmNodW5rX3NpemU9MF0gQ2h1bmsgc2l6ZSBpbiBieXRlcyB0byBzbGljZSB0aGUgZmlsZSBpbnRvLiBTaG9yY3V0cyB3aXRoIGIsIGtiLCBtYiwgZ2IsIHRiIHN1ZmZpeGVzIGFsc28gc3VwcG9ydGVkLiBgZS5nLiAyMDQ4MDAgb3IgXCIyMDQ4MDBiXCIgb3IgXCIyMDBrYlwiYC4gQnkgZGVmYXVsdCAtIGRpc2FibGVkLlxuXHRAcGFyYW0ge1N0cmluZ3xET01FbGVtZW50fSBbc2V0dGluZ3MuY29udGFpbmVyXSBpZCBvZiB0aGUgRE9NIGVsZW1lbnQgb3IgRE9NIGVsZW1lbnQgaXRzZWxmIHRoYXQgd2lsbCBiZSB1c2VkIHRvIHdyYXAgdXBsb2FkZXIgc3RydWN0dXJlcy4gRGVmYXVsdHMgdG8gaW1tZWRpYXRlIHBhcmVudCBvZiB0aGUgYGJyb3dzZV9idXR0b25gIGVsZW1lbnQuXG5cdEBwYXJhbSB7U3RyaW5nfERPTUVsZW1lbnR9IFtzZXR0aW5ncy5kcm9wX2VsZW1lbnRdIGlkIG9mIHRoZSBET00gZWxlbWVudCBvciBET00gZWxlbWVudCBpdHNlbGYgdG8gdXNlIGFzIGEgZHJvcCB6b25lIGZvciBEcmFnLW4tRHJvcC5cblx0QHBhcmFtIHtTdHJpbmd9IFtzZXR0aW5ncy5maWxlX2RhdGFfbmFtZT1cImZpbGVcIl0gTmFtZSBmb3IgdGhlIGZpbGUgZmllbGQgaW4gTXVsdGlwYXJ0IGZvcm1hdGVkIG1lc3NhZ2UuXG5cdEBwYXJhbSB7T2JqZWN0fSBbc2V0dGluZ3MuZmlsdGVycz17fV0gU2V0IG9mIGZpbGUgdHlwZSBmaWx0ZXJzLlxuXHRcdEBwYXJhbSB7U3RyaW5nfE51bWJlcn0gW3NldHRpbmdzLmZpbHRlcnMubWF4X2ZpbGVfc2l6ZT0wXSBNYXhpbXVtIGZpbGUgc2l6ZSB0aGF0IHRoZSB1c2VyIGNhbiBwaWNrLCBpbiBieXRlcy4gT3B0aW9uYWxseSBzdXBwb3J0cyBiLCBrYiwgbWIsIGdiLCB0YiBzdWZmaXhlcy4gYGUuZy4gXCIxMG1iXCIgb3IgXCIxZ2JcImAuIEJ5IGRlZmF1bHQgLSBub3Qgc2V0LiBEaXNwYXRjaGVzIGBwbHVwbG9hZC5GSUxFX1NJWkVfRVJST1JgLlxuXHRcdEBwYXJhbSB7QXJyYXl9IFtzZXR0aW5ncy5maWx0ZXJzLm1pbWVfdHlwZXM9W11dIExpc3Qgb2YgZmlsZSB0eXBlcyB0byBhY2NlcHQsIGVhY2ggb25lIGRlZmluZWQgYnkgdGl0bGUgYW5kIGxpc3Qgb2YgZXh0ZW5zaW9ucy4gYGUuZy4ge3RpdGxlIDogXCJJbWFnZSBmaWxlc1wiLCBleHRlbnNpb25zIDogXCJqcGcsanBlZyxnaWYscG5nXCJ9YC4gRGlzcGF0Y2hlcyBgcGx1cGxvYWQuRklMRV9FWFRFTlNJT05fRVJST1JgXG5cdFx0QHBhcmFtIHtCb29sZWFufSBbc2V0dGluZ3MuZmlsdGVycy5wcmV2ZW50X2R1cGxpY2F0ZXM9ZmFsc2VdIERvIG5vdCBsZXQgZHVwbGljYXRlcyBpbnRvIHRoZSBxdWV1ZS4gRGlzcGF0Y2hlcyBgcGx1cGxvYWQuRklMRV9EVVBMSUNBVEVfRVJST1JgLlxuXHRcdEBwYXJhbSB7Qm9vbGVhbn0gW3NldHRpbmdzLmZpbHRlcnMucHJldmVudF9lbXB0eT10cnVlXSBEbyBub3QgbGV0IGVtcHR5IGZpbGVzIGludG8gdGhlIHF1ZXVlIChJRTEwIGlzIGtub3duIHRvIGhhbmcgZm9yIGV4YW1wbGUgd2hlbiB0cnlpbmcgdG8gdXBsb2FkIHN1Y2gpLiBEaXNwYXRjaGVzIGBwbHVwbG9hZC5GSUxFX1NJWkVfRVJST1JgLlxuXHRAcGFyYW0ge1N0cmluZ30gW3NldHRpbmdzLmZsYXNoX3N3Zl91cmxdIFVSTCBvZiB0aGUgRmxhc2ggc3dmLlxuXHRAcGFyYW0ge09iamVjdH0gW3NldHRpbmdzLmhlYWRlcnNdIEN1c3RvbSBoZWFkZXJzIHRvIHNlbmQgd2l0aCB0aGUgdXBsb2FkLiBIYXNoIG9mIG5hbWUvdmFsdWUgcGFpcnMuXG5cdEBwYXJhbSB7U3RyaW5nfSBbc2V0dGluZ3MuaHR0cF9tZXRob2Q9XCJQT1NUXCJdIEhUVFAgbWV0aG9kIHRvIHVzZSBkdXJpbmcgdXBsb2FkIChvbmx5IFBVVCBvciBQT1NUIGFsbG93ZWQpLlxuXHRAcGFyYW0ge051bWJlcn0gW3NldHRpbmdzLm1heF9yZXRyaWVzPTBdIEhvdyBtYW55IHRpbWVzIHRvIHJldHJ5IHRoZSBjaHVuayBvciBmaWxlLCBiZWZvcmUgdHJpZ2dlcmluZyBFcnJvciBldmVudC5cblx0QHBhcmFtIHtCb29sZWFufSBbc2V0dGluZ3MubXVsdGlwYXJ0PXRydWVdIFdoZXRoZXIgdG8gc2VuZCBmaWxlIGFuZCBhZGRpdGlvbmFsIHBhcmFtZXRlcnMgYXMgTXVsdGlwYXJ0IGZvcm1hdGVkIG1lc3NhZ2UuXG5cdEBwYXJhbSB7T2JqZWN0fSBbc2V0dGluZ3MubXVsdGlwYXJ0X3BhcmFtc10gSGFzaCBvZiBrZXkvdmFsdWUgcGFpcnMgdG8gc2VuZCB3aXRoIGV2ZXJ5IGZpbGUgdXBsb2FkLlxuXHRAcGFyYW0ge0Jvb2xlYW59IFtzZXR0aW5ncy5tdWx0aV9zZWxlY3Rpb249dHJ1ZV0gRW5hYmxlIGFiaWxpdHkgdG8gc2VsZWN0IG11bHRpcGxlIGZpbGVzIGF0IG9uY2UgaW4gZmlsZSBkaWFsb2cuXG5cdEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gW3NldHRpbmdzLnJlcXVpcmVkX2ZlYXR1cmVzXSBFaXRoZXIgY29tbWEtc2VwYXJhdGVkIGxpc3Qgb3IgaGFzaCBvZiByZXF1aXJlZCBmZWF0dXJlcyB0aGF0IGNob3NlbiBydW50aW1lIHNob3VsZCBhYnNvbHV0ZWx5IHBvc3Nlc3MuXG5cdEBwYXJhbSB7T2JqZWN0fSBbc2V0dGluZ3MucmVzaXplXSBFbmFibGUgcmVzaXpuZyBvZiBpbWFnZXMgb24gY2xpZW50LXNpZGUuIEFwcGxpZXMgdG8gYGltYWdlL2pwZWdgIGFuZCBgaW1hZ2UvcG5nYCBvbmx5LiBgZS5nLiB7d2lkdGggOiAyMDAsIGhlaWdodCA6IDIwMCwgcXVhbGl0eSA6IDkwLCBjcm9wOiB0cnVlfWBcblx0XHRAcGFyYW0ge051bWJlcn0gW3NldHRpbmdzLnJlc2l6ZS53aWR0aF0gSWYgaW1hZ2UgaXMgYmlnZ2VyLCBpdCB3aWxsIGJlIHJlc2l6ZWQuXG5cdFx0QHBhcmFtIHtOdW1iZXJ9IFtzZXR0aW5ncy5yZXNpemUuaGVpZ2h0XSBJZiBpbWFnZSBpcyBiaWdnZXIsIGl0IHdpbGwgYmUgcmVzaXplZC5cblx0XHRAcGFyYW0ge051bWJlcn0gW3NldHRpbmdzLnJlc2l6ZS5xdWFsaXR5PTkwXSBDb21wcmVzc2lvbiBxdWFsaXR5IGZvciBqcGVncyAoMS0xMDApLlxuXHRcdEBwYXJhbSB7Qm9vbGVhbn0gW3NldHRpbmdzLnJlc2l6ZS5jcm9wPWZhbHNlXSBXaGV0aGVyIHRvIGNyb3AgaW1hZ2VzIHRvIGV4YWN0IGRpbWVuc2lvbnMuIEJ5IGRlZmF1bHQgdGhleSB3aWxsIGJlIHJlc2l6ZWQgcHJvcG9ydGlvbmFsbHkuXG5cdEBwYXJhbSB7U3RyaW5nfSBbc2V0dGluZ3MucnVudGltZXM9XCJodG1sNSxmbGFzaCxzaWx2ZXJsaWdodCxodG1sNFwiXSBDb21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBydW50aW1lcywgdGhhdCBQbHVwbG9hZCB3aWxsIHRyeSBpbiB0dXJuLCBtb3ZpbmcgdG8gdGhlIG5leHQgaWYgcHJldmlvdXMgZmFpbHMuXG5cdEBwYXJhbSB7U3RyaW5nfSBbc2V0dGluZ3Muc2lsdmVybGlnaHRfeGFwX3VybF0gVVJMIG9mIHRoZSBTaWx2ZXJsaWdodCB4YXAuXG5cdEBwYXJhbSB7Qm9vbGVhbn0gW3NldHRpbmdzLnNlbmRfY2h1bmtfbnVtYmVyPXRydWVdIFdoZXRoZXIgdG8gc2VuZCBjaHVua3MgYW5kIGNodW5rIG51bWJlcnMsIG9yIHRvdGFsIGFuZCBvZmZzZXQgYnl0ZXMuXG5cdEBwYXJhbSB7Qm9vbGVhbn0gW3NldHRpbmdzLnNlbmRfZmlsZV9uYW1lPXRydWVdIFdoZXRoZXIgdG8gc2VuZCBmaWxlIG5hbWUgYXMgYWRkaXRpb25hbCBhcmd1bWVudCAtICduYW1lJyAocmVxdWlyZWQgZm9yIGNodW5rZWQgdXBsb2FkcyBhbmQgc29tZSBvdGhlciBjYXNlcyB3aGVyZSBmaWxlIG5hbWUgY2Fubm90IGJlIHNlbnQgdmlhIG5vcm1hbCB3YXlzKS5cblx0QHBhcmFtIHtTdHJpbmd9IHNldHRpbmdzLnVybCBVUkwgb2YgdGhlIHNlcnZlci1zaWRlIHVwbG9hZCBoYW5kbGVyLlxuXHRAcGFyYW0ge0Jvb2xlYW59IFtzZXR0aW5ncy51bmlxdWVfbmFtZXM9ZmFsc2VdIElmIHRydWUgd2lsbCBnZW5lcmF0ZSB1bmlxdWUgZmlsZW5hbWVzIGZvciB1cGxvYWRlZCBmaWxlcy5cblxuKi9cbnBsdXBsb2FkLlVwbG9hZGVyID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHQvKipcblx0RmlyZXMgd2hlbiB0aGUgY3VycmVudCBSdW5UaW1lIGhhcyBiZWVuIGluaXRpYWxpemVkLlxuXG5cdEBldmVudCBJbml0XG5cdEBwYXJhbSB7cGx1cGxvYWQuVXBsb2FkZXJ9IHVwbG9hZGVyIFVwbG9hZGVyIGluc3RhbmNlIHNlbmRpbmcgdGhlIGV2ZW50LlxuXHQgKi9cblxuXHQvKipcblx0RmlyZXMgYWZ0ZXIgdGhlIGluaXQgZXZlbnQgaW5jYXNlIHlvdSBuZWVkIHRvIHBlcmZvcm0gYWN0aW9ucyB0aGVyZS5cblxuXHRAZXZlbnQgUG9zdEluaXRcblx0QHBhcmFtIHtwbHVwbG9hZC5VcGxvYWRlcn0gdXBsb2FkZXIgVXBsb2FkZXIgaW5zdGFuY2Ugc2VuZGluZyB0aGUgZXZlbnQuXG5cdCAqL1xuXG5cdC8qKlxuXHRGaXJlcyB3aGVuIHRoZSBvcHRpb24gaXMgY2hhbmdlZCBpbiB2aWEgdXBsb2FkZXIuc2V0T3B0aW9uKCkuXG5cblx0QGV2ZW50IE9wdGlvbkNoYW5nZWRcblx0QHNpbmNlIDIuMVxuXHRAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgb3B0aW9uIHRoYXQgd2FzIGNoYW5nZWRcblx0QHBhcmFtIHtNaXhlZH0gdmFsdWUgTmV3IHZhbHVlIGZvciB0aGUgc3BlY2lmaWVkIG9wdGlvblxuXHRAcGFyYW0ge01peGVkfSBvbGRWYWx1ZSBQcmV2aW91cyB2YWx1ZSBvZiB0aGUgb3B0aW9uXG5cdCAqL1xuXG5cdC8qKlxuXHRGaXJlcyB3aGVuIHRoZSBzaWx2ZXJsaWdodC9mbGFzaCBvciBvdGhlciBzaGltIG5lZWRzIHRvIG1vdmUuXG5cblx0QGV2ZW50IFJlZnJlc2hcblx0QHBhcmFtIHtwbHVwbG9hZC5VcGxvYWRlcn0gdXBsb2FkZXIgVXBsb2FkZXIgaW5zdGFuY2Ugc2VuZGluZyB0aGUgZXZlbnQuXG5cdCAqL1xuXG5cdC8qKlxuXHRGaXJlcyB3aGVuIHRoZSBvdmVyYWxsIHN0YXRlIGlzIGJlaW5nIGNoYW5nZWQgZm9yIHRoZSB1cGxvYWQgcXVldWUuXG5cblx0QGV2ZW50IFN0YXRlQ2hhbmdlZFxuXHRAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0ICovXG5cblx0LyoqXG5cdEZpcmVzIHdoZW4gYnJvd3NlX2J1dHRvbiBpcyBjbGlja2VkIGFuZCBicm93c2UgZGlhbG9nIHNob3dzLlxuXG5cdEBldmVudCBCcm93c2Vcblx0QHNpbmNlIDIuMS4yXG5cdEBwYXJhbSB7cGx1cGxvYWQuVXBsb2FkZXJ9IHVwbG9hZGVyIFVwbG9hZGVyIGluc3RhbmNlIHNlbmRpbmcgdGhlIGV2ZW50LlxuXHQgKi9cblxuXHQvKipcblx0RmlyZXMgZm9yIGV2ZXJ5IGZpbHRlcmVkIGZpbGUgYmVmb3JlIGl0IGlzIGFkZGVkIHRvIHRoZSBxdWV1ZS5cblxuXHRAZXZlbnQgRmlsZUZpbHRlcmVkXG5cdEBzaW5jZSAyLjFcblx0QHBhcmFtIHtwbHVwbG9hZC5VcGxvYWRlcn0gdXBsb2FkZXIgVXBsb2FkZXIgaW5zdGFuY2Ugc2VuZGluZyB0aGUgZXZlbnQuXG5cdEBwYXJhbSB7cGx1cGxvYWQuRmlsZX0gZmlsZSBBbm90aGVyIGZpbGUgdGhhdCBoYXMgdG8gYmUgYWRkZWQgdG8gdGhlIHF1ZXVlLlxuXHQgKi9cblxuXHQvKipcblx0RmlyZXMgd2hlbiB0aGUgZmlsZSBxdWV1ZSBpcyBjaGFuZ2VkLiBJbiBvdGhlciB3b3JkcyB3aGVuIGZpbGVzIGFyZSBhZGRlZC9yZW1vdmVkIHRvIHRoZSBmaWxlcyBhcnJheSBvZiB0aGUgdXBsb2FkZXIgaW5zdGFuY2UuXG5cblx0QGV2ZW50IFF1ZXVlQ2hhbmdlZFxuXHRAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0ICovXG5cblx0LyoqXG5cdEZpcmVzIGFmdGVyIGZpbGVzIHdlcmUgZmlsdGVyZWQgYW5kIGFkZGVkIHRvIHRoZSBxdWV1ZS5cblxuXHRAZXZlbnQgRmlsZXNBZGRlZFxuXHRAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0QHBhcmFtIHtBcnJheX0gZmlsZXMgQXJyYXkgb2YgZmlsZSBvYmplY3RzIHRoYXQgd2VyZSBhZGRlZCB0byBxdWV1ZSBieSB0aGUgdXNlci5cblx0ICovXG5cblx0LyoqXG5cdEZpcmVzIHdoZW4gZmlsZSBpcyByZW1vdmVkIGZyb20gdGhlIHF1ZXVlLlxuXG5cdEBldmVudCBGaWxlc1JlbW92ZWRcblx0QHBhcmFtIHtwbHVwbG9hZC5VcGxvYWRlcn0gdXBsb2FkZXIgVXBsb2FkZXIgaW5zdGFuY2Ugc2VuZGluZyB0aGUgZXZlbnQuXG5cdEBwYXJhbSB7QXJyYXl9IGZpbGVzIEFycmF5IG9mIGZpbGVzIHRoYXQgZ290IHJlbW92ZWQuXG5cdCAqL1xuXG5cdC8qKlxuXHRGaXJlcyBqdXN0IGJlZm9yZSBhIGZpbGUgaXMgdXBsb2FkZWQuIENhbiBiZSB1c2VkIHRvIGNhbmNlbCB0aGUgdXBsb2FkIGZvciB0aGUgc3BlY2lmaWVkIGZpbGVcblx0YnkgcmV0dXJuaW5nIGZhbHNlIGZyb20gdGhlIGhhbmRsZXIuXG5cblx0QGV2ZW50IEJlZm9yZVVwbG9hZFxuXHRAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0QHBhcmFtIHtwbHVwbG9hZC5GaWxlfSBmaWxlIEZpbGUgdG8gYmUgdXBsb2FkZWQuXG5cdCAqL1xuXG5cdC8qKlxuXHRGaXJlcyB3aGVuIGEgZmlsZSBpcyB0byBiZSB1cGxvYWRlZCBieSB0aGUgcnVudGltZS5cblxuXHRAZXZlbnQgVXBsb2FkRmlsZVxuXHRAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0QHBhcmFtIHtwbHVwbG9hZC5GaWxlfSBmaWxlIEZpbGUgdG8gYmUgdXBsb2FkZWQuXG5cdCAqL1xuXG5cdC8qKlxuXHRGaXJlcyB3aGlsZSBhIGZpbGUgaXMgYmVpbmcgdXBsb2FkZWQuIFVzZSB0aGlzIGV2ZW50IHRvIHVwZGF0ZSB0aGUgY3VycmVudCBmaWxlIHVwbG9hZCBwcm9ncmVzcy5cblxuXHRAZXZlbnQgVXBsb2FkUHJvZ3Jlc3Ncblx0QHBhcmFtIHtwbHVwbG9hZC5VcGxvYWRlcn0gdXBsb2FkZXIgVXBsb2FkZXIgaW5zdGFuY2Ugc2VuZGluZyB0aGUgZXZlbnQuXG5cdEBwYXJhbSB7cGx1cGxvYWQuRmlsZX0gZmlsZSBGaWxlIHRoYXQgaXMgY3VycmVudGx5IGJlaW5nIHVwbG9hZGVkLlxuXHQgKi9cblxuXHQvKipcblx0KiBGaXJlcyBqdXN0IGJlZm9yZSBhIGNodW5rIGlzIHVwbG9hZGVkLiBUaGlzIGV2ZW50IGVuYWJsZXMgeW91IHRvIG92ZXJyaWRlIHNldHRpbmdzXG5cdCogb24gdGhlIHVwbG9hZGVyIGluc3RhbmNlIGJlZm9yZSB0aGUgY2h1bmsgaXMgdXBsb2FkZWQuXG5cdCpcblx0KiBAZXZlbnQgQmVmb3JlQ2h1bmtVcGxvYWRcblx0KiBAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0KiBAcGFyYW0ge3BsdXBsb2FkLkZpbGV9IGZpbGUgRmlsZSB0byBiZSB1cGxvYWRlZC5cblx0KiBAcGFyYW0ge09iamVjdH0gYXJncyBQT1NUIHBhcmFtcyB0byBiZSBzZW50LlxuXHQqIEBwYXJhbSB7QmxvYn0gY2h1bmtCbG9iIEN1cnJlbnQgYmxvYi5cblx0KiBAcGFyYW0ge29mZnNldH0gb2Zmc2V0IEN1cnJlbnQgb2Zmc2V0LlxuXHQqL1xuXG5cdC8qKlxuXHRGaXJlcyB3aGVuIGZpbGUgY2h1bmsgaXMgdXBsb2FkZWQuXG5cblx0QGV2ZW50IENodW5rVXBsb2FkZWRcblx0QHBhcmFtIHtwbHVwbG9hZC5VcGxvYWRlcn0gdXBsb2FkZXIgVXBsb2FkZXIgaW5zdGFuY2Ugc2VuZGluZyB0aGUgZXZlbnQuXG5cdEBwYXJhbSB7cGx1cGxvYWQuRmlsZX0gZmlsZSBGaWxlIHRoYXQgdGhlIGNodW5rIHdhcyB1cGxvYWRlZCBmb3IuXG5cdEBwYXJhbSB7T2JqZWN0fSByZXN1bHQgT2JqZWN0IHdpdGggcmVzcG9uc2UgcHJvcGVydGllcy5cblx0XHRAcGFyYW0ge051bWJlcn0gcmVzdWx0Lm9mZnNldCBUaGUgYW1vdW50IG9mIGJ5dGVzIHRoZSBzZXJ2ZXIgaGFzIHJlY2VpdmVkIHNvIGZhciwgaW5jbHVkaW5nIHRoaXMgY2h1bmsuXG5cdFx0QHBhcmFtIHtOdW1iZXJ9IHJlc3VsdC50b3RhbCBUaGUgc2l6ZSBvZiB0aGUgZmlsZS5cblx0XHRAcGFyYW0ge1N0cmluZ30gcmVzdWx0LnJlc3BvbnNlIFRoZSByZXNwb25zZSBib2R5IHNlbnQgYnkgdGhlIHNlcnZlci5cblx0XHRAcGFyYW0ge051bWJlcn0gcmVzdWx0LnN0YXR1cyBUaGUgSFRUUCBzdGF0dXMgY29kZSBzZW50IGJ5IHRoZSBzZXJ2ZXIuXG5cdFx0QHBhcmFtIHtTdHJpbmd9IHJlc3VsdC5yZXNwb25zZUhlYWRlcnMgQWxsIHRoZSByZXNwb25zZSBoZWFkZXJzIGFzIGEgc2luZ2xlIHN0cmluZy5cblx0ICovXG5cblx0LyoqXG5cdEZpcmVzIHdoZW4gYSBmaWxlIGlzIHN1Y2Nlc3NmdWxseSB1cGxvYWRlZC5cblxuXHRAZXZlbnQgRmlsZVVwbG9hZGVkXG5cdEBwYXJhbSB7cGx1cGxvYWQuVXBsb2FkZXJ9IHVwbG9hZGVyIFVwbG9hZGVyIGluc3RhbmNlIHNlbmRpbmcgdGhlIGV2ZW50LlxuXHRAcGFyYW0ge3BsdXBsb2FkLkZpbGV9IGZpbGUgRmlsZSB0aGF0IHdhcyB1cGxvYWRlZC5cblx0QHBhcmFtIHtPYmplY3R9IHJlc3VsdCBPYmplY3Qgd2l0aCByZXNwb25zZSBwcm9wZXJ0aWVzLlxuXHRcdEBwYXJhbSB7U3RyaW5nfSByZXN1bHQucmVzcG9uc2UgVGhlIHJlc3BvbnNlIGJvZHkgc2VudCBieSB0aGUgc2VydmVyLlxuXHRcdEBwYXJhbSB7TnVtYmVyfSByZXN1bHQuc3RhdHVzIFRoZSBIVFRQIHN0YXR1cyBjb2RlIHNlbnQgYnkgdGhlIHNlcnZlci5cblx0XHRAcGFyYW0ge1N0cmluZ30gcmVzdWx0LnJlc3BvbnNlSGVhZGVycyBBbGwgdGhlIHJlc3BvbnNlIGhlYWRlcnMgYXMgYSBzaW5nbGUgc3RyaW5nLlxuXHQgKi9cblxuXHQvKipcblx0RmlyZXMgd2hlbiBhbGwgZmlsZXMgaW4gYSBxdWV1ZSBhcmUgdXBsb2FkZWQuXG5cblx0QGV2ZW50IFVwbG9hZENvbXBsZXRlXG5cdEBwYXJhbSB7cGx1cGxvYWQuVXBsb2FkZXJ9IHVwbG9hZGVyIFVwbG9hZGVyIGluc3RhbmNlIHNlbmRpbmcgdGhlIGV2ZW50LlxuXHRAcGFyYW0ge0FycmF5fSBmaWxlcyBBcnJheSBvZiBmaWxlIG9iamVjdHMgdGhhdCB3YXMgYWRkZWQgdG8gcXVldWUvc2VsZWN0ZWQgYnkgdGhlIHVzZXIuXG5cdCAqL1xuXG5cdC8qKlxuXHRGaXJlcyB3aGVuIGEgZXJyb3Igb2NjdXJzLlxuXG5cdEBldmVudCBFcnJvclxuXHRAcGFyYW0ge3BsdXBsb2FkLlVwbG9hZGVyfSB1cGxvYWRlciBVcGxvYWRlciBpbnN0YW5jZSBzZW5kaW5nIHRoZSBldmVudC5cblx0QHBhcmFtIHtPYmplY3R9IGVycm9yIENvbnRhaW5zIGNvZGUsIG1lc3NhZ2UgYW5kIHNvbWV0aW1lcyBmaWxlIGFuZCBvdGhlciBkZXRhaWxzLlxuXHRcdEBwYXJhbSB7TnVtYmVyfSBlcnJvci5jb2RlIFRoZSBwbHVwbG9hZCBlcnJvciBjb2RlLlxuXHRcdEBwYXJhbSB7U3RyaW5nfSBlcnJvci5tZXNzYWdlIERlc2NyaXB0aW9uIG9mIHRoZSBlcnJvciAodXNlcyBpMThuKS5cblx0ICovXG5cblx0LyoqXG5cdEZpcmVzIHdoZW4gZGVzdHJveSBtZXRob2QgaXMgY2FsbGVkLlxuXG5cdEBldmVudCBEZXN0cm95XG5cdEBwYXJhbSB7cGx1cGxvYWQuVXBsb2FkZXJ9IHVwbG9hZGVyIFVwbG9hZGVyIGluc3RhbmNlIHNlbmRpbmcgdGhlIGV2ZW50LlxuXHQgKi9cblx0dmFyIHVpZCA9IHBsdXBsb2FkLmd1aWQoKVxuXHQsIHNldHRpbmdzXG5cdCwgZmlsZXMgPSBbXVxuXHQsIHByZWZlcnJlZF9jYXBzID0ge31cblx0LCBmaWxlSW5wdXRzID0gW11cblx0LCBmaWxlRHJvcHMgPSBbXVxuXHQsIHN0YXJ0VGltZVxuXHQsIHRvdGFsXG5cdCwgZGlzYWJsZWQgPSBmYWxzZVxuXHQsIHhoclxuXHQ7XG5cblxuXHQvLyBQcml2YXRlIG1ldGhvZHNcblx0ZnVuY3Rpb24gdXBsb2FkTmV4dCgpIHtcblx0XHR2YXIgZmlsZSwgY291bnQgPSAwLCBpO1xuXG5cdFx0aWYgKHRoaXMuc3RhdGUgPT0gcGx1cGxvYWQuU1RBUlRFRCkge1xuXHRcdFx0Ly8gRmluZCBmaXJzdCBRVUVVRUQgZmlsZVxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmICghZmlsZSAmJiBmaWxlc1tpXS5zdGF0dXMgPT0gcGx1cGxvYWQuUVVFVUVEKSB7XG5cdFx0XHRcdFx0ZmlsZSA9IGZpbGVzW2ldO1xuXHRcdFx0XHRcdGlmICh0aGlzLnRyaWdnZXIoXCJCZWZvcmVVcGxvYWRcIiwgZmlsZSkpIHtcblx0XHRcdFx0XHRcdGZpbGUuc3RhdHVzID0gcGx1cGxvYWQuVVBMT0FESU5HO1xuXHRcdFx0XHRcdFx0dGhpcy50cmlnZ2VyKFwiVXBsb2FkRmlsZVwiLCBmaWxlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y291bnQrKztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBBbGwgZmlsZXMgYXJlIERPTkUgb3IgRkFJTEVEXG5cdFx0XHRpZiAoY291bnQgPT0gZmlsZXMubGVuZ3RoKSB7XG5cdFx0XHRcdGlmICh0aGlzLnN0YXRlICE9PSBwbHVwbG9hZC5TVE9QUEVEKSB7XG5cdFx0XHRcdFx0dGhpcy5zdGF0ZSA9IHBsdXBsb2FkLlNUT1BQRUQ7XG5cdFx0XHRcdFx0dGhpcy50cmlnZ2VyKFwiU3RhdGVDaGFuZ2VkXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMudHJpZ2dlcihcIlVwbG9hZENvbXBsZXRlXCIsIGZpbGVzKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXG5cdGZ1bmN0aW9uIGNhbGNGaWxlKGZpbGUpIHtcblx0XHRmaWxlLnBlcmNlbnQgPSBmaWxlLnNpemUgPiAwID8gTWF0aC5jZWlsKGZpbGUubG9hZGVkIC8gZmlsZS5zaXplICogMTAwKSA6IDEwMDtcblx0XHRjYWxjKCk7XG5cdH1cblxuXG5cdGZ1bmN0aW9uIGNhbGMoKSB7XG5cdFx0dmFyIGksIGZpbGU7XG5cdFx0dmFyIGxvYWRlZDtcblx0XHR2YXIgbG9hZGVkRHVyaW5nQ3VycmVudFNlc3Npb24gPSAwO1xuXG5cdFx0Ly8gUmVzZXQgc3RhdHNcblx0XHR0b3RhbC5yZXNldCgpO1xuXG5cdFx0Ly8gQ2hlY2sgc3RhdHVzLCBzaXplLCBsb2FkZWQgZXRjIG9uIGFsbCBmaWxlc1xuXHRcdGZvciAoaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0ZmlsZSA9IGZpbGVzW2ldO1xuXG5cdFx0XHRpZiAoZmlsZS5zaXplICE9PSB1bmRlZikge1xuXHRcdFx0XHQvLyBXZSBjYWxjdWxhdGUgdG90YWxzIGJhc2VkIG9uIG9yaWdpbmFsIGZpbGUgc2l6ZVxuXHRcdFx0XHR0b3RhbC5zaXplICs9IGZpbGUub3JpZ1NpemU7XG5cblx0XHRcdFx0Ly8gU2luY2Ugd2UgY2Fubm90IHByZWRpY3QgZmlsZSBzaXplIGFmdGVyIHJlc2l6ZSwgd2UgZG8gb3Bwb3NpdGUgYW5kXG5cdFx0XHRcdC8vIGludGVycG9sYXRlIGxvYWRlZCBhbW91bnQgdG8gbWF0Y2ggbWFnbml0dWRlIG9mIHRvdGFsXG5cdFx0XHRcdGxvYWRlZCA9IGZpbGUubG9hZGVkICogZmlsZS5vcmlnU2l6ZSAvIGZpbGUuc2l6ZTtcblxuXHRcdFx0XHRpZiAoIWZpbGUuY29tcGxldGVUaW1lc3RhbXAgfHwgZmlsZS5jb21wbGV0ZVRpbWVzdGFtcCA+IHN0YXJ0VGltZSkge1xuXHRcdFx0XHRcdGxvYWRlZER1cmluZ0N1cnJlbnRTZXNzaW9uICs9IGxvYWRlZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRvdGFsLmxvYWRlZCArPSBsb2FkZWQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0b3RhbC5zaXplID0gdW5kZWY7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChmaWxlLnN0YXR1cyA9PSBwbHVwbG9hZC5ET05FKSB7XG5cdFx0XHRcdHRvdGFsLnVwbG9hZGVkKys7XG5cdFx0XHR9IGVsc2UgaWYgKGZpbGUuc3RhdHVzID09IHBsdXBsb2FkLkZBSUxFRCkge1xuXHRcdFx0XHR0b3RhbC5mYWlsZWQrKztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRvdGFsLnF1ZXVlZCsrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIHdlIGNvdWxkbid0IGNhbGN1bGF0ZSBhIHRvdGFsIGZpbGUgc2l6ZSB0aGVuIHVzZSB0aGUgbnVtYmVyIG9mIGZpbGVzIHRvIGNhbGMgcGVyY2VudFxuXHRcdGlmICh0b3RhbC5zaXplID09PSB1bmRlZikge1xuXHRcdFx0dG90YWwucGVyY2VudCA9IGZpbGVzLmxlbmd0aCA+IDAgPyBNYXRoLmNlaWwodG90YWwudXBsb2FkZWQgLyBmaWxlcy5sZW5ndGggKiAxMDApIDogMDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dG90YWwuYnl0ZXNQZXJTZWMgPSBNYXRoLmNlaWwobG9hZGVkRHVyaW5nQ3VycmVudFNlc3Npb24gLyAoKCtuZXcgRGF0ZSgpIC0gc3RhcnRUaW1lIHx8IDEpIC8gMTAwMC4wKSk7XG5cdFx0XHR0b3RhbC5wZXJjZW50ID0gdG90YWwuc2l6ZSA+IDAgPyBNYXRoLmNlaWwodG90YWwubG9hZGVkIC8gdG90YWwuc2l6ZSAqIDEwMCkgOiAwO1xuXHRcdH1cblx0fVxuXG5cblx0ZnVuY3Rpb24gZ2V0UlVJRCgpIHtcblx0XHR2YXIgY3RybCA9IGZpbGVJbnB1dHNbMF0gfHwgZmlsZURyb3BzWzBdO1xuXHRcdGlmIChjdHJsKSB7XG5cdFx0XHRyZXR1cm4gY3RybC5nZXRSdW50aW1lKCkudWlkO1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXG5cdGZ1bmN0aW9uIGJpbmRFdmVudExpc3RlbmVycygpIHtcblx0XHR0aGlzLmJpbmQoJ0ZpbGVzQWRkZWQgRmlsZXNSZW1vdmVkJywgZnVuY3Rpb24odXApIHtcblx0XHRcdHVwLnRyaWdnZXIoJ1F1ZXVlQ2hhbmdlZCcpO1xuXHRcdFx0dXAucmVmcmVzaCgpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5iaW5kKCdDYW5jZWxVcGxvYWQnLCBvbkNhbmNlbFVwbG9hZCk7XG5cblx0XHR0aGlzLmJpbmQoJ0JlZm9yZVVwbG9hZCcsIG9uQmVmb3JlVXBsb2FkKTtcblxuXHRcdHRoaXMuYmluZCgnVXBsb2FkRmlsZScsIG9uVXBsb2FkRmlsZSk7XG5cblx0XHR0aGlzLmJpbmQoJ1VwbG9hZFByb2dyZXNzJywgb25VcGxvYWRQcm9ncmVzcyk7XG5cblx0XHR0aGlzLmJpbmQoJ1N0YXRlQ2hhbmdlZCcsIG9uU3RhdGVDaGFuZ2VkKTtcblxuXHRcdHRoaXMuYmluZCgnUXVldWVDaGFuZ2VkJywgY2FsYyk7XG5cblx0XHR0aGlzLmJpbmQoJ0Vycm9yJywgb25FcnJvcik7XG5cblx0XHR0aGlzLmJpbmQoJ0ZpbGVVcGxvYWRlZCcsIG9uRmlsZVVwbG9hZGVkKTtcblxuXHRcdHRoaXMuYmluZCgnRGVzdHJveScsIG9uRGVzdHJveSk7XG5cdH1cblxuXG5cdGZ1bmN0aW9uIGluaXRDb250cm9scyhzZXR0aW5ncywgY2IpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXMsIGluaXRlZCA9IDAsIHF1ZXVlID0gW107XG5cblx0XHQvLyBjb21tb24gc2V0dGluZ3Ncblx0XHR2YXIgb3B0aW9ucyA9IHtcblx0XHRcdHJ1bnRpbWVfb3JkZXI6IHNldHRpbmdzLnJ1bnRpbWVzLFxuXHRcdFx0cmVxdWlyZWRfY2Fwczogc2V0dGluZ3MucmVxdWlyZWRfZmVhdHVyZXMsXG5cdFx0XHRwcmVmZXJyZWRfY2FwczogcHJlZmVycmVkX2NhcHMsXG5cdFx0XHRzd2ZfdXJsOiBzZXR0aW5ncy5mbGFzaF9zd2ZfdXJsLFxuXHRcdFx0eGFwX3VybDogc2V0dGluZ3Muc2lsdmVybGlnaHRfeGFwX3VybFxuXHRcdH07XG5cblx0XHQvLyBhZGQgcnVudGltZSBzcGVjaWZpYyBvcHRpb25zIGlmIGFueVxuXHRcdHBsdXBsb2FkLmVhY2goc2V0dGluZ3MucnVudGltZXMuc3BsaXQoL1xccyosXFxzKi8pLCBmdW5jdGlvbihydW50aW1lKSB7XG5cdFx0XHRpZiAoc2V0dGluZ3NbcnVudGltZV0pIHtcblx0XHRcdFx0b3B0aW9uc1tydW50aW1lXSA9IHNldHRpbmdzW3J1bnRpbWVdO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gaW5pdGlhbGl6ZSBmaWxlIHBpY2tlcnMgLSB0aGVyZSBjYW4gYmUgbWFueVxuXHRcdGlmIChzZXR0aW5ncy5icm93c2VfYnV0dG9uKSB7XG5cdFx0XHRwbHVwbG9hZC5lYWNoKHNldHRpbmdzLmJyb3dzZV9idXR0b24sIGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdHF1ZXVlLnB1c2goZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0XHR2YXIgZmlsZUlucHV0ID0gbmV3IG8uZmlsZS5GaWxlSW5wdXQocGx1cGxvYWQuZXh0ZW5kKHt9LCBvcHRpb25zLCB7XG5cdFx0XHRcdFx0XHRhY2NlcHQ6IHNldHRpbmdzLmZpbHRlcnMubWltZV90eXBlcyxcblx0XHRcdFx0XHRcdG5hbWU6IHNldHRpbmdzLmZpbGVfZGF0YV9uYW1lLFxuXHRcdFx0XHRcdFx0bXVsdGlwbGU6IHNldHRpbmdzLm11bHRpX3NlbGVjdGlvbixcblx0XHRcdFx0XHRcdGNvbnRhaW5lcjogc2V0dGluZ3MuY29udGFpbmVyLFxuXHRcdFx0XHRcdFx0YnJvd3NlX2J1dHRvbjogZWxcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdFx0XHRmaWxlSW5wdXQub25yZWFkeSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0dmFyIGluZm8gPSBSdW50aW1lLmdldEluZm8odGhpcy5ydWlkKTtcblxuXHRcdFx0XHRcdFx0Ly8gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblx0XHRcdFx0XHRcdHBsdXBsb2FkLmV4dGVuZChzZWxmLmZlYXR1cmVzLCB7XG5cdFx0XHRcdFx0XHRcdGNodW5rczogaW5mby5jYW4oJ3NsaWNlX2Jsb2InKSxcblx0XHRcdFx0XHRcdFx0bXVsdGlwYXJ0OiBpbmZvLmNhbignc2VuZF9tdWx0aXBhcnQnKSxcblx0XHRcdFx0XHRcdFx0bXVsdGlfc2VsZWN0aW9uOiBpbmZvLmNhbignc2VsZWN0X211bHRpcGxlJylcblx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRpbml0ZWQrKztcblx0XHRcdFx0XHRcdGZpbGVJbnB1dHMucHVzaCh0aGlzKTtcblx0XHRcdFx0XHRcdGNiKCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGZpbGVJbnB1dC5vbmNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0c2VsZi5hZGRGaWxlKHRoaXMuZmlsZXMpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRmaWxlSW5wdXQuYmluZCgnbW91c2VlbnRlciBtb3VzZWxlYXZlIG1vdXNlZG93biBtb3VzZXVwJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0aWYgKCFkaXNhYmxlZCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoc2V0dGluZ3MuYnJvd3NlX2J1dHRvbl9ob3Zlcikge1xuXHRcdFx0XHRcdFx0XHRcdGlmICgnbW91c2VlbnRlcicgPT09IGUudHlwZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0cGx1cGxvYWQuYWRkQ2xhc3MoZWwsIHNldHRpbmdzLmJyb3dzZV9idXR0b25faG92ZXIpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoJ21vdXNlbGVhdmUnID09PSBlLnR5cGUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHBsdXBsb2FkLnJlbW92ZUNsYXNzKGVsLCBzZXR0aW5ncy5icm93c2VfYnV0dG9uX2hvdmVyKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpZiAoc2V0dGluZ3MuYnJvd3NlX2J1dHRvbl9hY3RpdmUpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoJ21vdXNlZG93bicgPT09IGUudHlwZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0cGx1cGxvYWQuYWRkQ2xhc3MoZWwsIHNldHRpbmdzLmJyb3dzZV9idXR0b25fYWN0aXZlKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCdtb3VzZXVwJyA9PT0gZS50eXBlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRwbHVwbG9hZC5yZW1vdmVDbGFzcyhlbCwgc2V0dGluZ3MuYnJvd3NlX2J1dHRvbl9hY3RpdmUpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0ZmlsZUlucHV0LmJpbmQoJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0c2VsZi50cmlnZ2VyKCdCcm93c2UnKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGZpbGVJbnB1dC5iaW5kKCdlcnJvciBydW50aW1lZXJyb3InLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGZpbGVJbnB1dCA9IG51bGw7XG5cdFx0XHRcdFx0XHRjYigpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0ZmlsZUlucHV0LmluaXQoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvLyBpbml0aWFsaXplIGRyb3Agem9uZXNcblx0XHRpZiAoc2V0dGluZ3MuZHJvcF9lbGVtZW50KSB7XG5cdFx0XHRwbHVwbG9hZC5lYWNoKHNldHRpbmdzLmRyb3BfZWxlbWVudCwgZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0cXVldWUucHVzaChmdW5jdGlvbihjYikge1xuXHRcdFx0XHRcdHZhciBmaWxlRHJvcCA9IG5ldyBvLmZpbGUuRmlsZURyb3AocGx1cGxvYWQuZXh0ZW5kKHt9LCBvcHRpb25zLCB7XG5cdFx0XHRcdFx0XHRkcm9wX3pvbmU6IGVsXG5cdFx0XHRcdFx0fSkpO1xuXG5cdFx0XHRcdFx0ZmlsZURyb3Aub25yZWFkeSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0dmFyIGluZm8gPSBSdW50aW1lLmdldEluZm8odGhpcy5ydWlkKTtcblxuXHRcdFx0XHRcdFx0Ly8gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblx0XHRcdFx0XHRcdHBsdXBsb2FkLmV4dGVuZChzZWxmLmZlYXR1cmVzLCB7XG5cdFx0XHRcdFx0XHRcdGNodW5rczogaW5mby5jYW4oJ3NsaWNlX2Jsb2InKSxcblx0XHRcdFx0XHRcdFx0bXVsdGlwYXJ0OiBpbmZvLmNhbignc2VuZF9tdWx0aXBhcnQnKSxcblx0XHRcdFx0XHRcdFx0ZHJhZ2Ryb3A6IGluZm8uY2FuKCdkcmFnX2FuZF9kcm9wJylcblx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRpbml0ZWQrKztcblx0XHRcdFx0XHRcdGZpbGVEcm9wcy5wdXNoKHRoaXMpO1xuXHRcdFx0XHRcdFx0Y2IoKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0ZmlsZURyb3Aub25kcm9wID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRzZWxmLmFkZEZpbGUodGhpcy5maWxlcyk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGZpbGVEcm9wLmJpbmQoJ2Vycm9yIHJ1bnRpbWVlcnJvcicsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0ZmlsZURyb3AgPSBudWxsO1xuXHRcdFx0XHRcdFx0Y2IoKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGZpbGVEcm9wLmluaXQoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblxuXHRcdHBsdXBsb2FkLmluU2VyaWVzKHF1ZXVlLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0eXBlb2YoY2IpID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdGNiKGluaXRlZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXG5cdGZ1bmN0aW9uIHJlc2l6ZUltYWdlKGJsb2IsIHBhcmFtcywgcnVudGltZU9wdGlvbnMsIGNiKSB7XG5cdFx0dmFyIGltZyA9IG5ldyBvLmltYWdlLkltYWdlKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0aW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBubyBtYW5pcHVsYXRpb24gcmVxdWlyZWQgaWYuLi5cblx0XHRcdFx0aWYgKHBhcmFtcy53aWR0aCA+IHRoaXMud2lkdGggJiZcblx0XHRcdFx0XHRwYXJhbXMuaGVpZ2h0ID4gdGhpcy5oZWlnaHQgJiZcblx0XHRcdFx0XHRwYXJhbXMucXVhbGl0eSA9PT0gdW5kZWYgJiZcblx0XHRcdFx0XHRwYXJhbXMucHJlc2VydmVfaGVhZGVycyAmJlxuXHRcdFx0XHRcdCFwYXJhbXMuY3JvcFxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRjYihibG9iKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBvdGhlcndpc2UgZG93bnNpemVcblx0XHRcdFx0XHRpbWcuZG93bnNpemUocGFyYW1zLndpZHRoLCBwYXJhbXMuaGVpZ2h0LCBwYXJhbXMuY3JvcCwgcGFyYW1zLnByZXNlcnZlX2hlYWRlcnMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHRpbWcub25yZXNpemUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHJlc2l6ZWRCbG9iID0gdGhpcy5nZXRBc0Jsb2IoYmxvYi50eXBlLCBwYXJhbXMucXVhbGl0eSk7XG5cdFx0XHRcdHRoaXMuZGVzdHJveSgpO1xuXHRcdFx0XHRjYihyZXNpemVkQmxvYik7XG5cdFx0XHR9O1xuXG5cdFx0XHRpbWcuYmluZCgnZXJyb3IgcnVudGltZWVycm9yJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuZGVzdHJveSgpO1xuXHRcdFx0XHRjYihibG9iKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpbWcubG9hZChibG9iLCBydW50aW1lT3B0aW9ucyk7XG5cdFx0fSBjYXRjaChleCkge1xuXHRcdFx0Y2IoYmxvYik7XG5cdFx0fVxuXHR9XG5cblxuXHRmdW5jdGlvbiBzZXRPcHRpb24ob3B0aW9uLCB2YWx1ZSwgaW5pdCkge1xuXHRcdHZhciBzZWxmID0gdGhpcywgcmVpbml0UmVxdWlyZWQgPSBmYWxzZTtcblxuXHRcdGZ1bmN0aW9uIF9zZXRPcHRpb24ob3B0aW9uLCB2YWx1ZSwgaW5pdCkge1xuXHRcdFx0dmFyIG9sZFZhbHVlID0gc2V0dGluZ3Nbb3B0aW9uXTtcblxuXHRcdFx0c3dpdGNoIChvcHRpb24pIHtcblx0XHRcdFx0Y2FzZSAnbWF4X2ZpbGVfc2l6ZSc6XG5cdFx0XHRcdFx0aWYgKG9wdGlvbiA9PT0gJ21heF9maWxlX3NpemUnKSB7XG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5tYXhfZmlsZV9zaXplID0gc2V0dGluZ3MuZmlsdGVycy5tYXhfZmlsZV9zaXplID0gdmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ2NodW5rX3NpemUnOlxuXHRcdFx0XHRcdGlmICh2YWx1ZSA9IHBsdXBsb2FkLnBhcnNlU2l6ZSh2YWx1ZSkpIHtcblx0XHRcdFx0XHRcdHNldHRpbmdzW29wdGlvbl0gPSB2YWx1ZTtcblx0XHRcdFx0XHRcdHNldHRpbmdzLnNlbmRfZmlsZV9uYW1lID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAnbXVsdGlwYXJ0Jzpcblx0XHRcdFx0XHRzZXR0aW5nc1tvcHRpb25dID0gdmFsdWU7XG5cdFx0XHRcdFx0aWYgKCF2YWx1ZSkge1xuXHRcdFx0XHRcdFx0c2V0dGluZ3Muc2VuZF9maWxlX25hbWUgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdodHRwX21ldGhvZCc6XG5cdFx0XHRcdFx0c2V0dGluZ3Nbb3B0aW9uXSA9IHZhbHVlLnRvVXBwZXJDYXNlKCkgPT09ICdQVVQnID8gJ1BVVCcgOiAnUE9TVCc7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAndW5pcXVlX25hbWVzJzpcblx0XHRcdFx0XHRzZXR0aW5nc1tvcHRpb25dID0gdmFsdWU7XG5cdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5zZW5kX2ZpbGVfbmFtZSA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ2ZpbHRlcnMnOlxuXHRcdFx0XHRcdC8vIGZvciBzYWtlIG9mIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblx0XHRcdFx0XHRpZiAocGx1cGxvYWQudHlwZU9mKHZhbHVlKSA9PT0gJ2FycmF5Jykge1xuXHRcdFx0XHRcdFx0dmFsdWUgPSB7XG5cdFx0XHRcdFx0XHRcdG1pbWVfdHlwZXM6IHZhbHVlXG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChpbml0KSB7XG5cdFx0XHRcdFx0XHRwbHVwbG9hZC5leHRlbmQoc2V0dGluZ3MuZmlsdGVycywgdmFsdWUpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5maWx0ZXJzID0gdmFsdWU7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gaWYgZmlsZSBmb3JtYXQgZmlsdGVycyBhcmUgYmVpbmcgdXBkYXRlZCwgcmVnZW5lcmF0ZSB0aGUgbWF0Y2hpbmcgZXhwcmVzc2lvbnNcblx0XHRcdFx0XHRpZiAodmFsdWUubWltZV90eXBlcykge1xuXHRcdFx0XHRcdFx0aWYgKHBsdXBsb2FkLnR5cGVPZih2YWx1ZS5taW1lX3R5cGVzKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdFx0dmFsdWUubWltZV90eXBlcyA9IG8uY29yZS51dGlscy5NaW1lLm1pbWVzMmV4dExpc3QodmFsdWUubWltZV90eXBlcyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhbHVlLm1pbWVfdHlwZXMucmVnZXhwID0gKGZ1bmN0aW9uKGZpbHRlcnMpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGV4dGVuc2lvbnNSZWdFeHAgPSBbXTtcblxuXHRcdFx0XHRcdFx0XHRwbHVwbG9hZC5lYWNoKGZpbHRlcnMsIGZ1bmN0aW9uKGZpbHRlcikge1xuXHRcdFx0XHRcdFx0XHRcdHBsdXBsb2FkLmVhY2goZmlsdGVyLmV4dGVuc2lvbnMuc3BsaXQoLywvKSwgZnVuY3Rpb24oZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoL15cXHMqXFwqXFxzKiQvLnRlc3QoZXh0KSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRleHRlbnNpb25zUmVnRXhwLnB1c2goJ1xcXFwuKicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZXh0ZW5zaW9uc1JlZ0V4cC5wdXNoKCdcXFxcLicgKyBleHQucmVwbGFjZShuZXcgUmVnRXhwKCdbJyArICgnL14kLiorP3woKVtde31cXFxcJy5yZXBsYWNlKC8uL2csICdcXFxcJCYnKSkgKyAnXScsICdnJyksICdcXFxcJCYnKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdHJldHVybiBuZXcgUmVnRXhwKCcoJyArIGV4dGVuc2lvbnNSZWdFeHAuam9pbignfCcpICsgJykkJywgJ2knKTtcblx0XHRcdFx0XHRcdH0odmFsdWUubWltZV90eXBlcykpO1xuXG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5maWx0ZXJzLm1pbWVfdHlwZXMgPSB2YWx1ZS5taW1lX3R5cGVzO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdyZXNpemUnOlxuXHRcdFx0XHRcdGlmICh2YWx1ZSkge1xuXHRcdFx0XHRcdFx0c2V0dGluZ3MucmVzaXplID0gcGx1cGxvYWQuZXh0ZW5kKHtcblx0XHRcdFx0XHRcdFx0cHJlc2VydmVfaGVhZGVyczogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0Y3JvcDogZmFsc2Vcblx0XHRcdFx0XHRcdH0sIHZhbHVlKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0c2V0dGluZ3MucmVzaXplID0gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ3ByZXZlbnRfZHVwbGljYXRlcyc6XG5cdFx0XHRcdFx0c2V0dGluZ3MucHJldmVudF9kdXBsaWNhdGVzID0gc2V0dGluZ3MuZmlsdGVycy5wcmV2ZW50X2R1cGxpY2F0ZXMgPSAhIXZhbHVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdC8vIG9wdGlvbnMgdGhhdCByZXF1aXJlIHJlaW5pdGlhbGlzYXRpb25cblx0XHRcdFx0Y2FzZSAnY29udGFpbmVyJzpcblx0XHRcdFx0Y2FzZSAnYnJvd3NlX2J1dHRvbic6XG5cdFx0XHRcdGNhc2UgJ2Ryb3BfZWxlbWVudCc6XG5cdFx0XHRcdFx0XHR2YWx1ZSA9ICdjb250YWluZXInID09PSBvcHRpb25cblx0XHRcdFx0XHRcdFx0PyBwbHVwbG9hZC5nZXQodmFsdWUpXG5cdFx0XHRcdFx0XHRcdDogcGx1cGxvYWQuZ2V0QWxsKHZhbHVlKVxuXHRcdFx0XHRcdFx0XHQ7XG5cblx0XHRcdFx0Y2FzZSAncnVudGltZXMnOlxuXHRcdFx0XHRjYXNlICdtdWx0aV9zZWxlY3Rpb24nOlxuXHRcdFx0XHRjYXNlICdmbGFzaF9zd2ZfdXJsJzpcblx0XHRcdFx0Y2FzZSAnc2lsdmVybGlnaHRfeGFwX3VybCc6XG5cdFx0XHRcdFx0c2V0dGluZ3Nbb3B0aW9uXSA9IHZhbHVlO1xuXHRcdFx0XHRcdGlmICghaW5pdCkge1xuXHRcdFx0XHRcdFx0cmVpbml0UmVxdWlyZWQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHNldHRpbmdzW29wdGlvbl0gPSB2YWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFpbml0KSB7XG5cdFx0XHRcdHNlbGYudHJpZ2dlcignT3B0aW9uQ2hhbmdlZCcsIG9wdGlvbiwgdmFsdWUsIG9sZFZhbHVlKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAodHlwZW9mKG9wdGlvbikgPT09ICdvYmplY3QnKSB7XG5cdFx0XHRwbHVwbG9hZC5lYWNoKG9wdGlvbiwgZnVuY3Rpb24odmFsdWUsIG9wdGlvbikge1xuXHRcdFx0XHRfc2V0T3B0aW9uKG9wdGlvbiwgdmFsdWUsIGluaXQpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdF9zZXRPcHRpb24ob3B0aW9uLCB2YWx1ZSwgaW5pdCk7XG5cdFx0fVxuXG5cdFx0aWYgKGluaXQpIHtcblx0XHRcdC8vIE5vcm1hbGl6ZSB0aGUgbGlzdCBvZiByZXF1aXJlZCBjYXBhYmlsaXRpZXNcblx0XHRcdHNldHRpbmdzLnJlcXVpcmVkX2ZlYXR1cmVzID0gbm9ybWFsaXplQ2FwcyhwbHVwbG9hZC5leHRlbmQoe30sIHNldHRpbmdzKSk7XG5cblx0XHRcdC8vIENvbWUgdXAgd2l0aCB0aGUgbGlzdCBvZiBjYXBhYmlsaXRpZXMgdGhhdCBjYW4gYWZmZWN0IGRlZmF1bHQgbW9kZSBpbiBhIG11bHRpLW1vZGUgcnVudGltZXNcblx0XHRcdHByZWZlcnJlZF9jYXBzID0gbm9ybWFsaXplQ2FwcyhwbHVwbG9hZC5leHRlbmQoe30sIHNldHRpbmdzLCB7XG5cdFx0XHRcdHJlcXVpcmVkX2ZlYXR1cmVzOiB0cnVlXG5cdFx0XHR9KSk7XG5cdFx0fSBlbHNlIGlmIChyZWluaXRSZXF1aXJlZCkge1xuXHRcdFx0c2VsZi50cmlnZ2VyKCdEZXN0cm95Jyk7XG5cblx0XHRcdGluaXRDb250cm9scy5jYWxsKHNlbGYsIHNldHRpbmdzLCBmdW5jdGlvbihpbml0ZWQpIHtcblx0XHRcdFx0aWYgKGluaXRlZCkge1xuXHRcdFx0XHRcdHNlbGYucnVudGltZSA9IFJ1bnRpbWUuZ2V0SW5mbyhnZXRSVUlEKCkpLnR5cGU7XG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyKCdJbml0JywgeyBydW50aW1lOiBzZWxmLnJ1bnRpbWUgfSk7XG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyKCdQb3N0SW5pdCcpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlbGYudHJpZ2dlcignRXJyb3InLCB7XG5cdFx0XHRcdFx0XHRjb2RlIDogcGx1cGxvYWQuSU5JVF9FUlJPUixcblx0XHRcdFx0XHRcdG1lc3NhZ2UgOiBwbHVwbG9hZC50cmFuc2xhdGUoJ0luaXQgZXJyb3IuJylcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblxuXHQvLyBJbnRlcm5hbCBldmVudCBoYW5kbGVyc1xuXHRmdW5jdGlvbiBvbkJlZm9yZVVwbG9hZCh1cCwgZmlsZSkge1xuXHRcdC8vIEdlbmVyYXRlIHVuaXF1ZSB0YXJnZXQgZmlsZW5hbWVzXG5cdFx0aWYgKHVwLnNldHRpbmdzLnVuaXF1ZV9uYW1lcykge1xuXHRcdFx0dmFyIG1hdGNoZXMgPSBmaWxlLm5hbWUubWF0Y2goL1xcLihbXi5dKykkLyksIGV4dCA9IFwicGFydFwiO1xuXHRcdFx0aWYgKG1hdGNoZXMpIHtcblx0XHRcdFx0ZXh0ID0gbWF0Y2hlc1sxXTtcblx0XHRcdH1cblx0XHRcdGZpbGUudGFyZ2V0X25hbWUgPSBmaWxlLmlkICsgJy4nICsgZXh0O1xuXHRcdH1cblx0fVxuXG5cblx0ZnVuY3Rpb24gb25VcGxvYWRGaWxlKHVwLCBmaWxlKSB7XG5cdFx0dmFyIHVybCA9IHVwLnNldHRpbmdzLnVybDtcblx0XHR2YXIgY2h1bmtTaXplID0gdXAuc2V0dGluZ3MuY2h1bmtfc2l6ZTtcblx0XHR2YXIgcmV0cmllcyA9IHVwLnNldHRpbmdzLm1heF9yZXRyaWVzO1xuXHRcdHZhciBmZWF0dXJlcyA9IHVwLmZlYXR1cmVzO1xuXHRcdHZhciBvZmZzZXQgPSAwO1xuXHRcdHZhciBibG9iO1xuXG5cdFx0dmFyIHJ1bnRpbWVPcHRpb25zID0ge1xuXHRcdFx0cnVudGltZV9vcmRlcjogdXAuc2V0dGluZ3MucnVudGltZXMsXG5cdFx0XHRyZXF1aXJlZF9jYXBzOiB1cC5zZXR0aW5ncy5yZXF1aXJlZF9mZWF0dXJlcyxcblx0XHRcdHByZWZlcnJlZF9jYXBzOiBwcmVmZXJyZWRfY2Fwcyxcblx0XHRcdHN3Zl91cmw6IHVwLnNldHRpbmdzLmZsYXNoX3N3Zl91cmwsXG5cdFx0XHR4YXBfdXJsOiB1cC5zZXR0aW5ncy5zaWx2ZXJsaWdodF94YXBfdXJsXG5cdFx0fTtcblxuXHRcdC8vIG1ha2Ugc3VyZSB3ZSBzdGFydCBhdCBhIHByZWRpY3RhYmxlIG9mZnNldFxuXHRcdGlmIChmaWxlLmxvYWRlZCkge1xuXHRcdFx0b2Zmc2V0ID0gZmlsZS5sb2FkZWQgPSBjaHVua1NpemUgPyBjaHVua1NpemUgKiBNYXRoLmZsb29yKGZpbGUubG9hZGVkIC8gY2h1bmtTaXplKSA6IDA7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gaGFuZGxlRXJyb3IoKSB7XG5cdFx0XHRpZiAocmV0cmllcy0tID4gMCkge1xuXHRcdFx0XHRkZWxheSh1cGxvYWROZXh0Q2h1bmssIDEwMDApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZmlsZS5sb2FkZWQgPSBvZmZzZXQ7IC8vIHJlc2V0IGFsbCBwcm9ncmVzc1xuXG5cdFx0XHRcdHVwLnRyaWdnZXIoJ0Vycm9yJywge1xuXHRcdFx0XHRcdGNvZGUgOiBwbHVwbG9hZC5IVFRQX0VSUk9SLFxuXHRcdFx0XHRcdG1lc3NhZ2UgOiBwbHVwbG9hZC50cmFuc2xhdGUoJ0hUVFAgRXJyb3IuJyksXG5cdFx0XHRcdFx0ZmlsZSA6IGZpbGUsXG5cdFx0XHRcdFx0cmVzcG9uc2UgOiB4aHIucmVzcG9uc2VUZXh0LFxuXHRcdFx0XHRcdHN0YXR1cyA6IHhoci5zdGF0dXMsXG5cdFx0XHRcdFx0cmVzcG9uc2VIZWFkZXJzOiB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKClcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gdXBsb2FkTmV4dENodW5rKCkge1xuXHRcdFx0dmFyIGNodW5rQmxvYiwgYXJncyA9IHt9LCBjdXJDaHVua1NpemU7XG5cblx0XHRcdC8vIG1ha2Ugc3VyZSB0aGF0IGZpbGUgd2Fzbid0IGNhbmNlbGxlZCBhbmQgdXBsb2FkIGlzIG5vdCBzdG9wcGVkIGluIGdlbmVyYWxcblx0XHRcdGlmIChmaWxlLnN0YXR1cyAhPT0gcGx1cGxvYWQuVVBMT0FESU5HIHx8IHVwLnN0YXRlID09PSBwbHVwbG9hZC5TVE9QUEVEKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gc2VuZCBhZGRpdGlvbmFsICduYW1lJyBwYXJhbWV0ZXIgb25seSBpZiByZXF1aXJlZFxuXHRcdFx0aWYgKHVwLnNldHRpbmdzLnNlbmRfZmlsZV9uYW1lKSB7XG5cdFx0XHRcdGFyZ3MubmFtZSA9IGZpbGUudGFyZ2V0X25hbWUgfHwgZmlsZS5uYW1lO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoY2h1bmtTaXplICYmIGZlYXR1cmVzLmNodW5rcyAmJiBibG9iLnNpemUgPiBjaHVua1NpemUpIHsgLy8gYmxvYiB3aWxsIGJlIG9mIHR5cGUgc3RyaW5nIGlmIGl0IHdhcyBsb2FkZWQgaW4gbWVtb3J5XG5cdFx0XHRcdGN1ckNodW5rU2l6ZSA9IE1hdGgubWluKGNodW5rU2l6ZSwgYmxvYi5zaXplIC0gb2Zmc2V0KTtcblx0XHRcdFx0Y2h1bmtCbG9iID0gYmxvYi5zbGljZShvZmZzZXQsIG9mZnNldCArIGN1ckNodW5rU2l6ZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjdXJDaHVua1NpemUgPSBibG9iLnNpemU7XG5cdFx0XHRcdGNodW5rQmxvYiA9IGJsb2I7XG5cdFx0XHR9XG5cblx0XHRcdC8vIElmIGNodW5raW5nIGlzIGVuYWJsZWQgYWRkIGNvcnJlc3BvbmRpbmcgYXJncywgbm8gbWF0dGVyIGlmIGZpbGUgaXMgYmlnZ2VyIHRoYW4gY2h1bmsgb3Igc21hbGxlclxuXHRcdFx0aWYgKGNodW5rU2l6ZSAmJiBmZWF0dXJlcy5jaHVua3MpIHtcblx0XHRcdFx0Ly8gU2V0dXAgcXVlcnkgc3RyaW5nIGFyZ3VtZW50c1xuXHRcdFx0XHRpZiAodXAuc2V0dGluZ3Muc2VuZF9jaHVua19udW1iZXIpIHtcblx0XHRcdFx0XHRhcmdzLmNodW5rID0gTWF0aC5jZWlsKG9mZnNldCAvIGNodW5rU2l6ZSk7XG5cdFx0XHRcdFx0YXJncy5jaHVua3MgPSBNYXRoLmNlaWwoYmxvYi5zaXplIC8gY2h1bmtTaXplKTtcblx0XHRcdFx0fSBlbHNlIHsgLy8ga2VlcCBzdXBwb3J0IGZvciBleHBlcmltZW50YWwgY2h1bmsgZm9ybWF0LCBqdXN0IGluIGNhc2Vcblx0XHRcdFx0XHRhcmdzLm9mZnNldCA9IG9mZnNldDtcblx0XHRcdFx0XHRhcmdzLnRvdGFsID0gYmxvYi5zaXplO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICh1cC50cmlnZ2VyKCdCZWZvcmVDaHVua1VwbG9hZCcsIGZpbGUsIGFyZ3MsIGNodW5rQmxvYiwgb2Zmc2V0KSkge1xuXHRcdFx0XHR1cGxvYWRDaHVuayhhcmdzLCBjaHVua0Jsb2IsIGN1ckNodW5rU2l6ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gdXBsb2FkQ2h1bmsoYXJncywgY2h1bmtCbG9iLCBjdXJDaHVua1NpemUpIHtcblx0XHRcdHZhciBmb3JtRGF0YTtcblxuXHRcdFx0eGhyID0gbmV3IG8ueGhyLlhNTEh0dHBSZXF1ZXN0KCk7XG5cblx0XHRcdC8vIERvIHdlIGhhdmUgdXBsb2FkIHByb2dyZXNzIHN1cHBvcnRcblx0XHRcdGlmICh4aHIudXBsb2FkKSB7XG5cdFx0XHRcdHhoci51cGxvYWQub25wcm9ncmVzcyA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRmaWxlLmxvYWRlZCA9IE1hdGgubWluKGZpbGUuc2l6ZSwgb2Zmc2V0ICsgZS5sb2FkZWQpO1xuXHRcdFx0XHRcdHVwLnRyaWdnZXIoJ1VwbG9hZFByb2dyZXNzJywgZmlsZSk7XG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gY2hlY2sgaWYgdXBsb2FkIG1hZGUgaXRzZWxmIHRocm91Z2hcblx0XHRcdFx0aWYgKHhoci5zdGF0dXMgPCAyMDAgfHwgeGhyLnN0YXR1cyA+PSA0MDApIHtcblx0XHRcdFx0XHRoYW5kbGVFcnJvcigpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHJpZXMgPSB1cC5zZXR0aW5ncy5tYXhfcmV0cmllczsgLy8gcmVzZXQgdGhlIGNvdW50ZXJcblxuXHRcdFx0XHQvLyBIYW5kbGUgY2h1bmsgcmVzcG9uc2Vcblx0XHRcdFx0aWYgKGN1ckNodW5rU2l6ZSA8IGJsb2Iuc2l6ZSkge1xuXHRcdFx0XHRcdGNodW5rQmxvYi5kZXN0cm95KCk7XG5cblx0XHRcdFx0XHRvZmZzZXQgKz0gY3VyQ2h1bmtTaXplO1xuXHRcdFx0XHRcdGZpbGUubG9hZGVkID0gTWF0aC5taW4ob2Zmc2V0LCBibG9iLnNpemUpO1xuXG5cdFx0XHRcdFx0dXAudHJpZ2dlcignQ2h1bmtVcGxvYWRlZCcsIGZpbGUsIHtcblx0XHRcdFx0XHRcdG9mZnNldCA6IGZpbGUubG9hZGVkLFxuXHRcdFx0XHRcdFx0dG90YWwgOiBibG9iLnNpemUsXG5cdFx0XHRcdFx0XHRyZXNwb25zZSA6IHhoci5yZXNwb25zZVRleHQsXG5cdFx0XHRcdFx0XHRzdGF0dXMgOiB4aHIuc3RhdHVzLFxuXHRcdFx0XHRcdFx0cmVzcG9uc2VIZWFkZXJzOiB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKClcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdC8vIHN0b2NrIEFuZHJvaWQgYnJvd3NlciBkb2Vzbid0IGZpcmUgdXBsb2FkIHByb2dyZXNzIGV2ZW50cywgYnV0IGluIGNodW5raW5nIG1vZGUgd2UgY2FuIGZha2UgdGhlbVxuXHRcdFx0XHRcdGlmIChwbHVwbG9hZC51YS5icm93c2VyID09PSAnQW5kcm9pZCBCcm93c2VyJykge1xuXHRcdFx0XHRcdFx0Ly8gZG9lc24ndCBoYXJtIGluIGdlbmVyYWwsIGJ1dCBpcyBub3QgcmVxdWlyZWQgYW55d2hlcmUgZWxzZVxuXHRcdFx0XHRcdFx0dXAudHJpZ2dlcignVXBsb2FkUHJvZ3Jlc3MnLCBmaWxlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZmlsZS5sb2FkZWQgPSBmaWxlLnNpemU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjaHVua0Jsb2IgPSBmb3JtRGF0YSA9IG51bGw7IC8vIEZyZWUgbWVtb3J5XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgZmlsZSBpcyB1cGxvYWRlZFxuXHRcdFx0XHRpZiAoIW9mZnNldCB8fCBvZmZzZXQgPj0gYmxvYi5zaXplKSB7XG5cdFx0XHRcdFx0Ly8gSWYgZmlsZSB3YXMgbW9kaWZpZWQsIGRlc3RvcnkgdGhlIGNvcHlcblx0XHRcdFx0XHRpZiAoZmlsZS5zaXplICE9IGZpbGUub3JpZ1NpemUpIHtcblx0XHRcdFx0XHRcdGJsb2IuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0YmxvYiA9IG51bGw7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dXAudHJpZ2dlcignVXBsb2FkUHJvZ3Jlc3MnLCBmaWxlKTtcblxuXHRcdFx0XHRcdGZpbGUuc3RhdHVzID0gcGx1cGxvYWQuRE9ORTtcblx0XHRcdFx0XHRmaWxlLmNvbXBsZXRlVGltZXN0YW1wID0gK25ldyBEYXRlKCk7XG5cblx0XHRcdFx0XHR1cC50cmlnZ2VyKCdGaWxlVXBsb2FkZWQnLCBmaWxlLCB7XG5cdFx0XHRcdFx0XHRyZXNwb25zZSA6IHhoci5yZXNwb25zZVRleHQsXG5cdFx0XHRcdFx0XHRzdGF0dXMgOiB4aHIuc3RhdHVzLFxuXHRcdFx0XHRcdFx0cmVzcG9uc2VIZWFkZXJzOiB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKClcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBTdGlsbCBjaHVua3MgbGVmdFxuXHRcdFx0XHRcdGRlbGF5KHVwbG9hZE5leHRDaHVuaywgMSk7IC8vIHJ1biBkZXRhY2hlZCwgb3RoZXJ3aXNlIGV2ZW50IGhhbmRsZXJzIGludGVyZmVyZVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHR4aHIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRoYW5kbGVFcnJvcigpO1xuXHRcdFx0fTtcblxuXHRcdFx0eGhyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHRcdH07XG5cblx0XHRcdC8vIEJ1aWxkIG11bHRpcGFydCByZXF1ZXN0XG5cdFx0XHRpZiAodXAuc2V0dGluZ3MubXVsdGlwYXJ0ICYmIGZlYXR1cmVzLm11bHRpcGFydCkge1xuXHRcdFx0XHR4aHIub3Blbih1cC5zZXR0aW5ncy5odHRwX21ldGhvZCwgdXJsLCB0cnVlKTtcblxuXHRcdFx0XHQvLyBTZXQgY3VzdG9tIGhlYWRlcnNcblx0XHRcdFx0cGx1cGxvYWQuZWFjaCh1cC5zZXR0aW5ncy5oZWFkZXJzLCBmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuXHRcdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Zm9ybURhdGEgPSBuZXcgby54aHIuRm9ybURhdGEoKTtcblxuXHRcdFx0XHQvLyBBZGQgbXVsdGlwYXJ0IHBhcmFtc1xuXHRcdFx0XHRwbHVwbG9hZC5lYWNoKHBsdXBsb2FkLmV4dGVuZChhcmdzLCB1cC5zZXR0aW5ncy5tdWx0aXBhcnRfcGFyYW1zKSwgZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcblx0XHRcdFx0XHRmb3JtRGF0YS5hcHBlbmQobmFtZSwgdmFsdWUpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBBZGQgZmlsZSBhbmQgc2VuZCBpdFxuXHRcdFx0XHRmb3JtRGF0YS5hcHBlbmQodXAuc2V0dGluZ3MuZmlsZV9kYXRhX25hbWUsIGNodW5rQmxvYik7XG5cdFx0XHRcdHhoci5zZW5kKGZvcm1EYXRhLCBydW50aW1lT3B0aW9ucyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBpZiBubyBtdWx0aXBhcnQsIHNlbmQgYXMgYmluYXJ5IHN0cmVhbVxuXHRcdFx0XHR1cmwgPSBwbHVwbG9hZC5idWlsZFVybCh1cC5zZXR0aW5ncy51cmwsIHBsdXBsb2FkLmV4dGVuZChhcmdzLCB1cC5zZXR0aW5ncy5tdWx0aXBhcnRfcGFyYW1zKSk7XG5cblx0XHRcdFx0eGhyLm9wZW4odXAuc2V0dGluZ3MuaHR0cF9tZXRob2QsIHVybCwgdHJ1ZSk7XG5cblx0XHRcdFx0Ly8gU2V0IGN1c3RvbSBoZWFkZXJzXG5cdFx0XHRcdHBsdXBsb2FkLmVhY2godXAuc2V0dGluZ3MuaGVhZGVycywgZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcblx0XHRcdFx0XHR4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIGRvIG5vdCBzZXQgQ29udGVudC1UeXBlLCBpZiBpdCB3YXMgZGVmaW5lZCBwcmV2aW91c2x5IChzZWUgIzEyMDMpXG5cdFx0XHRcdGlmICgheGhyLmhhc1JlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScpKSB7XG5cdFx0XHRcdFx0eGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nKTsgLy8gQmluYXJ5IHN0cmVhbSBoZWFkZXJcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHhoci5zZW5kKGNodW5rQmxvYiwgcnVudGltZU9wdGlvbnMpO1xuXHRcdFx0fVxuXHRcdH1cblxuXG5cdFx0YmxvYiA9IGZpbGUuZ2V0U291cmNlKCk7XG5cblx0XHQvLyBTdGFydCB1cGxvYWRpbmcgY2h1bmtzXG5cdFx0aWYgKCFwbHVwbG9hZC5pc0VtcHR5T2JqKHVwLnNldHRpbmdzLnJlc2l6ZSkgJiYgcGx1cGxvYWQuaW5BcnJheShibG9iLnR5cGUsIFsnaW1hZ2UvanBlZycsICdpbWFnZS9wbmcnXSkgIT09IC0xKSB7XG5cdFx0XHQvLyBSZXNpemUgaWYgcmVxdWlyZWRcblx0XHRcdHJlc2l6ZUltYWdlKGJsb2IsIHVwLnNldHRpbmdzLnJlc2l6ZSwgcnVudGltZU9wdGlvbnMsIGZ1bmN0aW9uKHJlc2l6ZWRCbG9iKSB7XG5cdFx0XHRcdGJsb2IgPSByZXNpemVkQmxvYjtcblx0XHRcdFx0ZmlsZS5zaXplID0gcmVzaXplZEJsb2Iuc2l6ZTtcblx0XHRcdFx0dXBsb2FkTmV4dENodW5rKCk7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dXBsb2FkTmV4dENodW5rKCk7XG5cdFx0fVxuXHR9XG5cblxuXHRmdW5jdGlvbiBvblVwbG9hZFByb2dyZXNzKHVwLCBmaWxlKSB7XG5cdFx0Y2FsY0ZpbGUoZmlsZSk7XG5cdH1cblxuXG5cdGZ1bmN0aW9uIG9uU3RhdGVDaGFuZ2VkKHVwKSB7XG5cdFx0aWYgKHVwLnN0YXRlID09IHBsdXBsb2FkLlNUQVJURUQpIHtcblx0XHRcdC8vIEdldCBzdGFydCB0aW1lIHRvIGNhbGN1bGF0ZSBicHNcblx0XHRcdHN0YXJ0VGltZSA9ICgrbmV3IERhdGUoKSk7XG5cdFx0fSBlbHNlIGlmICh1cC5zdGF0ZSA9PSBwbHVwbG9hZC5TVE9QUEVEKSB7XG5cdFx0XHQvLyBSZXNldCBjdXJyZW50bHkgdXBsb2FkaW5nIGZpbGVzXG5cdFx0XHRmb3IgKHZhciBpID0gdXAuZmlsZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0aWYgKHVwLmZpbGVzW2ldLnN0YXR1cyA9PSBwbHVwbG9hZC5VUExPQURJTkcpIHtcblx0XHRcdFx0XHR1cC5maWxlc1tpXS5zdGF0dXMgPSBwbHVwbG9hZC5RVUVVRUQ7XG5cdFx0XHRcdFx0Y2FsYygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblxuXHRmdW5jdGlvbiBvbkNhbmNlbFVwbG9hZCgpIHtcblx0XHRpZiAoeGhyKSB7XG5cdFx0XHR4aHIuYWJvcnQoKTtcblx0XHR9XG5cdH1cblxuXG5cdGZ1bmN0aW9uIG9uRmlsZVVwbG9hZGVkKHVwKSB7XG5cdFx0Y2FsYygpO1xuXG5cdFx0Ly8gVXBsb2FkIG5leHQgZmlsZSBidXQgZGV0YWNoIGl0IGZyb20gdGhlIGVycm9yIGV2ZW50XG5cdFx0Ly8gc2luY2Ugb3RoZXIgY3VzdG9tIGxpc3RlbmVycyBtaWdodCB3YW50IHRvIHN0b3AgdGhlIHF1ZXVlXG5cdFx0ZGVsYXkoZnVuY3Rpb24oKSB7XG5cdFx0XHR1cGxvYWROZXh0LmNhbGwodXApO1xuXHRcdH0sIDEpO1xuXHR9XG5cblxuXHRmdW5jdGlvbiBvbkVycm9yKHVwLCBlcnIpIHtcblx0XHRpZiAoZXJyLmNvZGUgPT09IHBsdXBsb2FkLklOSVRfRVJST1IpIHtcblx0XHRcdHVwLmRlc3Ryb3koKTtcblx0XHR9XG5cdFx0Ly8gU2V0IGZhaWxlZCBzdGF0dXMgaWYgYW4gZXJyb3Igb2NjdXJlZCBvbiBhIGZpbGVcblx0XHRlbHNlIGlmIChlcnIuY29kZSA9PT0gcGx1cGxvYWQuSFRUUF9FUlJPUikge1xuXHRcdFx0ZXJyLmZpbGUuc3RhdHVzID0gcGx1cGxvYWQuRkFJTEVEO1xuXHRcdFx0ZXJyLmZpbGUuY29tcGxldGVUaW1lc3RhbXAgPSArbmV3IERhdGUoKTtcblx0XHRcdGNhbGNGaWxlKGVyci5maWxlKTtcblxuXHRcdFx0Ly8gVXBsb2FkIG5leHQgZmlsZSBidXQgZGV0YWNoIGl0IGZyb20gdGhlIGVycm9yIGV2ZW50XG5cdFx0XHQvLyBzaW5jZSBvdGhlciBjdXN0b20gbGlzdGVuZXJzIG1pZ2h0IHdhbnQgdG8gc3RvcCB0aGUgcXVldWVcblx0XHRcdGlmICh1cC5zdGF0ZSA9PSBwbHVwbG9hZC5TVEFSVEVEKSB7IC8vIHVwbG9hZCBpbiBwcm9ncmVzc1xuXHRcdFx0XHR1cC50cmlnZ2VyKCdDYW5jZWxVcGxvYWQnKTtcblx0XHRcdFx0ZGVsYXkoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dXBsb2FkTmV4dC5jYWxsKHVwKTtcblx0XHRcdFx0fSwgMSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblxuXHRmdW5jdGlvbiBvbkRlc3Ryb3kodXApIHtcblx0XHR1cC5zdG9wKCk7XG5cblx0XHQvLyBQdXJnZSB0aGUgcXVldWVcblx0XHRwbHVwbG9hZC5lYWNoKGZpbGVzLCBmdW5jdGlvbihmaWxlKSB7XG5cdFx0XHRmaWxlLmRlc3Ryb3koKTtcblx0XHR9KTtcblx0XHRmaWxlcyA9IFtdO1xuXG5cdFx0aWYgKGZpbGVJbnB1dHMubGVuZ3RoKSB7XG5cdFx0XHRwbHVwbG9hZC5lYWNoKGZpbGVJbnB1dHMsIGZ1bmN0aW9uKGZpbGVJbnB1dCkge1xuXHRcdFx0XHRmaWxlSW5wdXQuZGVzdHJveSgpO1xuXHRcdFx0fSk7XG5cdFx0XHRmaWxlSW5wdXRzID0gW107XG5cdFx0fVxuXG5cdFx0aWYgKGZpbGVEcm9wcy5sZW5ndGgpIHtcblx0XHRcdHBsdXBsb2FkLmVhY2goZmlsZURyb3BzLCBmdW5jdGlvbihmaWxlRHJvcCkge1xuXHRcdFx0XHRmaWxlRHJvcC5kZXN0cm95KCk7XG5cdFx0XHR9KTtcblx0XHRcdGZpbGVEcm9wcyA9IFtdO1xuXHRcdH1cblxuXHRcdHByZWZlcnJlZF9jYXBzID0ge307XG5cdFx0ZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRzdGFydFRpbWUgPSB4aHIgPSBudWxsO1xuXHRcdHRvdGFsLnJlc2V0KCk7XG5cdH1cblxuXG5cdC8vIERlZmF1bHQgc2V0dGluZ3Ncblx0c2V0dGluZ3MgPSB7XG5cdFx0Y2h1bmtfc2l6ZTogMCxcblx0XHRmaWxlX2RhdGFfbmFtZTogJ2ZpbGUnLFxuXHRcdGZpbHRlcnM6IHtcblx0XHRcdG1pbWVfdHlwZXM6IFtdLFxuXHRcdFx0bWF4X2ZpbGVfc2l6ZTogMCxcblx0XHRcdHByZXZlbnRfZHVwbGljYXRlczogZmFsc2UsXG5cdFx0XHRwcmV2ZW50X2VtcHR5OiB0cnVlXG5cdFx0fSxcblx0XHRmbGFzaF9zd2ZfdXJsOiAnanMvTW94aWUuc3dmJyxcblx0XHRodHRwX21ldGhvZDogJ1BPU1QnLFxuXHRcdG1heF9yZXRyaWVzOiAwLFxuXHRcdG11bHRpcGFydDogdHJ1ZSxcblx0XHRtdWx0aV9zZWxlY3Rpb246IHRydWUsXG5cdFx0cmVzaXplOiBmYWxzZSxcblx0XHRydW50aW1lczogUnVudGltZS5vcmRlcixcblx0XHRzZW5kX2ZpbGVfbmFtZTogdHJ1ZSxcblx0XHRzZW5kX2NodW5rX251bWJlcjogdHJ1ZSxcblx0XHRzaWx2ZXJsaWdodF94YXBfdXJsOiAnanMvTW94aWUueGFwJ1xuXHR9O1xuXG5cblx0c2V0T3B0aW9uLmNhbGwodGhpcywgb3B0aW9ucywgbnVsbCwgdHJ1ZSk7XG5cblx0Ly8gSW5pdGFsIHRvdGFsIHN0YXRlXG5cdHRvdGFsID0gbmV3IHBsdXBsb2FkLlF1ZXVlUHJvZ3Jlc3MoKTtcblxuXHQvLyBBZGQgcHVibGljIG1ldGhvZHNcblx0cGx1cGxvYWQuZXh0ZW5kKHRoaXMsIHtcblxuXHRcdC8qKlxuXHRcdCAqIFVuaXF1ZSBpZCBmb3IgdGhlIFVwbG9hZGVyIGluc3RhbmNlLlxuXHRcdCAqXG5cdFx0ICogQHByb3BlcnR5IGlkXG5cdFx0ICogQHR5cGUgU3RyaW5nXG5cdFx0ICovXG5cdFx0aWQgOiB1aWQsXG5cdFx0dWlkIDogdWlkLCAvLyBtT3hpZSB1c2VzIHRoaXMgdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIGV2ZW50IHRhcmdldHNcblxuXHRcdC8qKlxuXHRcdCAqIEN1cnJlbnQgc3RhdGUgb2YgdGhlIHRvdGFsIHVwbG9hZGluZyBwcm9ncmVzcy4gVGhpcyBvbmUgY2FuIGVpdGhlciBiZSBwbHVwbG9hZC5TVEFSVEVEIG9yIHBsdXBsb2FkLlNUT1BQRUQuXG5cdFx0ICogVGhlc2Ugc3RhdGVzIGFyZSBjb250cm9sbGVkIGJ5IHRoZSBzdG9wL3N0YXJ0IG1ldGhvZHMuIFRoZSBkZWZhdWx0IHZhbHVlIGlzIFNUT1BQRUQuXG5cdFx0ICpcblx0XHQgKiBAcHJvcGVydHkgc3RhdGVcblx0XHQgKiBAdHlwZSBOdW1iZXJcblx0XHQgKi9cblx0XHRzdGF0ZSA6IHBsdXBsb2FkLlNUT1BQRUQsXG5cblx0XHQvKipcblx0XHQgKiBNYXAgb2YgZmVhdHVyZXMgdGhhdCBhcmUgYXZhaWxhYmxlIGZvciB0aGUgdXBsb2FkZXIgcnVudGltZS4gRmVhdHVyZXMgd2lsbCBiZSBmaWxsZWRcblx0XHQgKiBiZWZvcmUgdGhlIGluaXQgZXZlbnQgaXMgY2FsbGVkLCB0aGVzZSBmZWF0dXJlcyBjYW4gdGhlbiBiZSB1c2VkIHRvIGFsdGVyIHRoZSBVSSBmb3IgdGhlIGVuZCB1c2VyLlxuXHRcdCAqIFNvbWUgb2YgdGhlIGN1cnJlbnQgZmVhdHVyZXMgdGhhdCBtaWdodCBiZSBpbiB0aGlzIG1hcCBpczogZHJhZ2Ryb3AsIGNodW5rcywganBncmVzaXplLCBwbmdyZXNpemUuXG5cdFx0ICpcblx0XHQgKiBAcHJvcGVydHkgZmVhdHVyZXNcblx0XHQgKiBAdHlwZSBPYmplY3Rcblx0XHQgKi9cblx0XHRmZWF0dXJlcyA6IHt9LFxuXG5cdFx0LyoqXG5cdFx0ICogQ3VycmVudCBydW50aW1lIG5hbWUuXG5cdFx0ICpcblx0XHQgKiBAcHJvcGVydHkgcnVudGltZVxuXHRcdCAqIEB0eXBlIFN0cmluZ1xuXHRcdCAqL1xuXHRcdHJ1bnRpbWUgOiBudWxsLFxuXG5cdFx0LyoqXG5cdFx0ICogQ3VycmVudCB1cGxvYWQgcXVldWUsIGFuIGFycmF5IG9mIEZpbGUgaW5zdGFuY2VzLlxuXHRcdCAqXG5cdFx0ICogQHByb3BlcnR5IGZpbGVzXG5cdFx0ICogQHR5cGUgQXJyYXlcblx0XHQgKiBAc2VlIHBsdXBsb2FkLkZpbGVcblx0XHQgKi9cblx0XHRmaWxlcyA6IGZpbGVzLFxuXG5cdFx0LyoqXG5cdFx0ICogT2JqZWN0IHdpdGggbmFtZS92YWx1ZSBzZXR0aW5ncy5cblx0XHQgKlxuXHRcdCAqIEBwcm9wZXJ0eSBzZXR0aW5nc1xuXHRcdCAqIEB0eXBlIE9iamVjdFxuXHRcdCAqL1xuXHRcdHNldHRpbmdzIDogc2V0dGluZ3MsXG5cblx0XHQvKipcblx0XHQgKiBUb3RhbCBwcm9nZXNzIGluZm9ybWF0aW9uLiBIb3cgbWFueSBmaWxlcyBoYXMgYmVlbiB1cGxvYWRlZCwgdG90YWwgcGVyY2VudCBldGMuXG5cdFx0ICpcblx0XHQgKiBAcHJvcGVydHkgdG90YWxcblx0XHQgKiBAdHlwZSBwbHVwbG9hZC5RdWV1ZVByb2dyZXNzXG5cdFx0ICovXG5cdFx0dG90YWwgOiB0b3RhbCxcblxuXG5cdFx0LyoqXG5cdFx0ICogSW5pdGlhbGl6ZXMgdGhlIFVwbG9hZGVyIGluc3RhbmNlIGFuZCBhZGRzIGludGVybmFsIGV2ZW50IGxpc3RlbmVycy5cblx0XHQgKlxuXHRcdCAqIEBtZXRob2QgaW5pdFxuXHRcdCAqL1xuXHRcdGluaXQgOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcywgb3B0LCBwcmVpbml0T3B0LCBlcnI7XG5cblx0XHRcdHByZWluaXRPcHQgPSBzZWxmLmdldE9wdGlvbigncHJlaW5pdCcpO1xuXHRcdFx0aWYgKHR5cGVvZihwcmVpbml0T3B0KSA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0cHJlaW5pdE9wdChzZWxmKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdXBsb2FkLmVhY2gocHJlaW5pdE9wdCwgZnVuY3Rpb24oZnVuYywgbmFtZSkge1xuXHRcdFx0XHRcdHNlbGYuYmluZChuYW1lLCBmdW5jKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGJpbmRFdmVudExpc3RlbmVycy5jYWxsKHNlbGYpO1xuXG5cdFx0XHQvLyBDaGVjayBmb3IgcmVxdWlyZWQgb3B0aW9uc1xuXHRcdFx0cGx1cGxvYWQuZWFjaChbJ2NvbnRhaW5lcicsICdicm93c2VfYnV0dG9uJywgJ2Ryb3BfZWxlbWVudCddLCBmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRpZiAoc2VsZi5nZXRPcHRpb24oZWwpID09PSBudWxsKSB7XG5cdFx0XHRcdFx0ZXJyID0ge1xuXHRcdFx0XHRcdFx0Y29kZSA6IHBsdXBsb2FkLklOSVRfRVJST1IsXG5cdFx0XHRcdFx0XHRtZXNzYWdlIDogcGx1cGxvYWQuc3ByaW50ZihwbHVwbG9hZC50cmFuc2xhdGUoXCIlcyBzcGVjaWZpZWQsIGJ1dCBjYW5ub3QgYmUgZm91bmQuXCIpLCBlbClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKGVycikge1xuXHRcdFx0XHRyZXR1cm4gc2VsZi50cmlnZ2VyKCdFcnJvcicsIGVycik7XG5cdFx0XHR9XG5cblxuXHRcdFx0aWYgKCFzZXR0aW5ncy5icm93c2VfYnV0dG9uICYmICFzZXR0aW5ncy5kcm9wX2VsZW1lbnQpIHtcblx0XHRcdFx0cmV0dXJuIHNlbGYudHJpZ2dlcignRXJyb3InLCB7XG5cdFx0XHRcdFx0Y29kZSA6IHBsdXBsb2FkLklOSVRfRVJST1IsXG5cdFx0XHRcdFx0bWVzc2FnZSA6IHBsdXBsb2FkLnRyYW5zbGF0ZShcIllvdSBtdXN0IHNwZWNpZnkgZWl0aGVyIGJyb3dzZV9idXR0b24gb3IgZHJvcF9lbGVtZW50LlwiKVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXG5cdFx0XHRpbml0Q29udHJvbHMuY2FsbChzZWxmLCBzZXR0aW5ncywgZnVuY3Rpb24oaW5pdGVkKSB7XG5cdFx0XHRcdHZhciBpbml0T3B0ID0gc2VsZi5nZXRPcHRpb24oJ2luaXQnKTtcblx0XHRcdFx0aWYgKHR5cGVvZihpbml0T3B0KSA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0XHRpbml0T3B0KHNlbGYpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBsdXBsb2FkLmVhY2goaW5pdE9wdCwgZnVuY3Rpb24oZnVuYywgbmFtZSkge1xuXHRcdFx0XHRcdFx0c2VsZi5iaW5kKG5hbWUsIGZ1bmMpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGluaXRlZCkge1xuXHRcdFx0XHRcdHNlbGYucnVudGltZSA9IFJ1bnRpbWUuZ2V0SW5mbyhnZXRSVUlEKCkpLnR5cGU7XG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyKCdJbml0JywgeyBydW50aW1lOiBzZWxmLnJ1bnRpbWUgfSk7XG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyKCdQb3N0SW5pdCcpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlbGYudHJpZ2dlcignRXJyb3InLCB7XG5cdFx0XHRcdFx0XHRjb2RlIDogcGx1cGxvYWQuSU5JVF9FUlJPUixcblx0XHRcdFx0XHRcdG1lc3NhZ2UgOiBwbHVwbG9hZC50cmFuc2xhdGUoJ0luaXQgZXJyb3IuJylcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFNldCB0aGUgdmFsdWUgZm9yIHRoZSBzcGVjaWZpZWQgb3B0aW9uKHMpLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCBzZXRPcHRpb25cblx0XHQgKiBAc2luY2UgMi4xXG5cdFx0ICogQHBhcmFtIHtTdHJpbmd8T2JqZWN0fSBvcHRpb24gTmFtZSBvZiB0aGUgb3B0aW9uIHRvIGNoYW5nZSBvciB0aGUgc2V0IG9mIGtleS92YWx1ZSBwYWlyc1xuXHRcdCAqIEBwYXJhbSB7TWl4ZWR9IFt2YWx1ZV0gVmFsdWUgZm9yIHRoZSBvcHRpb24gKGlzIGlnbm9yZWQsIGlmIGZpcnN0IGFyZ3VtZW50IGlzIG9iamVjdClcblx0XHQgKi9cblx0XHRzZXRPcHRpb246IGZ1bmN0aW9uKG9wdGlvbiwgdmFsdWUpIHtcblx0XHRcdHNldE9wdGlvbi5jYWxsKHRoaXMsIG9wdGlvbiwgdmFsdWUsICF0aGlzLnJ1bnRpbWUpOyAvLyB1bnRpbCBydW50aW1lIG5vdCBzZXQgd2UgZG8gbm90IG5lZWQgdG8gcmVpbml0aWFsaXplXG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIEdldCB0aGUgdmFsdWUgZm9yIHRoZSBzcGVjaWZpZWQgb3B0aW9uIG9yIHRoZSB3aG9sZSBjb25maWd1cmF0aW9uLCBpZiBub3Qgc3BlY2lmaWVkLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCBnZXRPcHRpb25cblx0XHQgKiBAc2luY2UgMi4xXG5cdFx0ICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25dIE5hbWUgb2YgdGhlIG9wdGlvbiB0byBnZXRcblx0XHQgKiBAcmV0dXJuIHtNaXhlZH0gVmFsdWUgZm9yIHRoZSBvcHRpb24gb3IgdGhlIHdob2xlIHNldFxuXHRcdCAqL1xuXHRcdGdldE9wdGlvbjogZnVuY3Rpb24ob3B0aW9uKSB7XG5cdFx0XHRpZiAoIW9wdGlvbikge1xuXHRcdFx0XHRyZXR1cm4gc2V0dGluZ3M7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gc2V0dGluZ3Nbb3B0aW9uXTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogUmVmcmVzaGVzIHRoZSB1cGxvYWQgaW5zdGFuY2UgYnkgZGlzcGF0Y2hpbmcgb3V0IGEgcmVmcmVzaCBldmVudCB0byBhbGwgcnVudGltZXMuXG5cdFx0ICogVGhpcyB3b3VsZCBmb3IgZXhhbXBsZSByZXBvc2l0aW9uIGZsYXNoL3NpbHZlcmxpZ2h0IHNoaW1zIG9uIHRoZSBwYWdlLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCByZWZyZXNoXG5cdFx0ICovXG5cdFx0cmVmcmVzaCA6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKGZpbGVJbnB1dHMubGVuZ3RoKSB7XG5cdFx0XHRcdHBsdXBsb2FkLmVhY2goZmlsZUlucHV0cywgZnVuY3Rpb24oZmlsZUlucHV0KSB7XG5cdFx0XHRcdFx0ZmlsZUlucHV0LnRyaWdnZXIoJ1JlZnJlc2gnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnRyaWdnZXIoJ1JlZnJlc2gnKTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogU3RhcnRzIHVwbG9hZGluZyB0aGUgcXVldWVkIGZpbGVzLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCBzdGFydFxuXHRcdCAqL1xuXHRcdHN0YXJ0IDogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAodGhpcy5zdGF0ZSAhPSBwbHVwbG9hZC5TVEFSVEVEKSB7XG5cdFx0XHRcdHRoaXMuc3RhdGUgPSBwbHVwbG9hZC5TVEFSVEVEO1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoJ1N0YXRlQ2hhbmdlZCcpO1xuXG5cdFx0XHRcdHVwbG9hZE5leHQuY2FsbCh0aGlzKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogU3RvcHMgdGhlIHVwbG9hZCBvZiB0aGUgcXVldWVkIGZpbGVzLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCBzdG9wXG5cdFx0ICovXG5cdFx0c3RvcCA6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKHRoaXMuc3RhdGUgIT0gcGx1cGxvYWQuU1RPUFBFRCkge1xuXHRcdFx0XHR0aGlzLnN0YXRlID0gcGx1cGxvYWQuU1RPUFBFRDtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdTdGF0ZUNoYW5nZWQnKTtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdDYW5jZWxVcGxvYWQnKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cblx0XHQvKipcblx0XHQgKiBEaXNhYmxlcy9lbmFibGVzIGJyb3dzZSBidXR0b24gb24gcmVxdWVzdC5cblx0XHQgKlxuXHRcdCAqIEBtZXRob2QgZGlzYWJsZUJyb3dzZVxuXHRcdCAqIEBwYXJhbSB7Qm9vbGVhbn0gZGlzYWJsZSBXaGV0aGVyIHRvIGRpc2FibGUgb3IgZW5hYmxlIChkZWZhdWx0OiB0cnVlKVxuXHRcdCAqL1xuXHRcdGRpc2FibGVCcm93c2UgOiBmdW5jdGlvbigpIHtcblx0XHRcdGRpc2FibGVkID0gYXJndW1lbnRzWzBdICE9PSB1bmRlZiA/IGFyZ3VtZW50c1swXSA6IHRydWU7XG5cblx0XHRcdGlmIChmaWxlSW5wdXRzLmxlbmd0aCkge1xuXHRcdFx0XHRwbHVwbG9hZC5lYWNoKGZpbGVJbnB1dHMsIGZ1bmN0aW9uKGZpbGVJbnB1dCkge1xuXHRcdFx0XHRcdGZpbGVJbnB1dC5kaXNhYmxlKGRpc2FibGVkKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMudHJpZ2dlcignRGlzYWJsZUJyb3dzZScsIGRpc2FibGVkKTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogUmV0dXJucyB0aGUgc3BlY2lmaWVkIGZpbGUgb2JqZWN0IGJ5IGlkLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCBnZXRGaWxlXG5cdFx0ICogQHBhcmFtIHtTdHJpbmd9IGlkIEZpbGUgaWQgdG8gbG9vayBmb3IuXG5cdFx0ICogQHJldHVybiB7cGx1cGxvYWQuRmlsZX0gRmlsZSBvYmplY3Qgb3IgdW5kZWZpbmVkIGlmIGl0IHdhc24ndCBmb3VuZDtcblx0XHQgKi9cblx0XHRnZXRGaWxlIDogZnVuY3Rpb24oaWQpIHtcblx0XHRcdHZhciBpO1xuXHRcdFx0Zm9yIChpID0gZmlsZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0aWYgKGZpbGVzW2ldLmlkID09PSBpZCkge1xuXHRcdFx0XHRcdHJldHVybiBmaWxlc1tpXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBBZGRzIGZpbGUgdG8gdGhlIHF1ZXVlIHByb2dyYW1tYXRpY2FsbHkuIENhbiBiZSBuYXRpdmUgZmlsZSwgaW5zdGFuY2Ugb2YgUGx1cGxvYWQuRmlsZSxcblx0XHQgKiBpbnN0YW5jZSBvZiBtT3hpZS5GaWxlLCBpbnB1dFt0eXBlPVwiZmlsZVwiXSBlbGVtZW50LCBvciBhcnJheSBvZiB0aGVzZS4gRmlyZXMgRmlsZXNBZGRlZCxcblx0XHQgKiBpZiBhbnkgZmlsZXMgd2VyZSBhZGRlZCB0byB0aGUgcXVldWUuIE90aGVyd2lzZSBub3RoaW5nIGhhcHBlbnMuXG5cdFx0ICpcblx0XHQgKiBAbWV0aG9kIGFkZEZpbGVcblx0XHQgKiBAc2luY2UgMi4wXG5cdFx0ICogQHBhcmFtIHtwbHVwbG9hZC5GaWxlfG1PeGllLkZpbGV8RmlsZXxOb2RlfEFycmF5fSBmaWxlIEZpbGUgb3IgZmlsZXMgdG8gYWRkIHRvIHRoZSBxdWV1ZS5cblx0XHQgKiBAcGFyYW0ge1N0cmluZ30gW2ZpbGVOYW1lXSBJZiBzcGVjaWZpZWQsIHdpbGwgYmUgdXNlZCBhcyBhIG5hbWUgZm9yIHRoZSBmaWxlXG5cdFx0ICovXG5cdFx0YWRkRmlsZSA6IGZ1bmN0aW9uKGZpbGUsIGZpbGVOYW1lKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXNcblx0XHRcdCwgcXVldWUgPSBbXVxuXHRcdFx0LCBmaWxlc0FkZGVkID0gW11cblx0XHRcdCwgcnVpZFxuXHRcdFx0O1xuXG5cdFx0XHRmdW5jdGlvbiBmaWx0ZXJGaWxlKGZpbGUsIGNiKSB7XG5cdFx0XHRcdHZhciBxdWV1ZSA9IFtdO1xuXHRcdFx0XHRwbHVwbG9hZC5lYWNoKHNlbGYuc2V0dGluZ3MuZmlsdGVycywgZnVuY3Rpb24ocnVsZSwgbmFtZSkge1xuXHRcdFx0XHRcdGlmIChmaWxlRmlsdGVyc1tuYW1lXSkge1xuXHRcdFx0XHRcdFx0cXVldWUucHVzaChmdW5jdGlvbihjYikge1xuXHRcdFx0XHRcdFx0XHRmaWxlRmlsdGVyc1tuYW1lXS5jYWxsKHNlbGYsIHJ1bGUsIGZpbGUsIGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHRcdFx0XHRcdGNiKCFyZXMpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdHBsdXBsb2FkLmluU2VyaWVzKHF1ZXVlLCBjYik7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQG1ldGhvZCByZXNvbHZlRmlsZVxuXHRcdFx0ICogQHByaXZhdGVcblx0XHRcdCAqIEBwYXJhbSB7bW94aWUuZmlsZS5GaWxlfG1veGllLmZpbGUuQmxvYnxwbHVwbG9hZC5GaWxlfEZpbGV8QmxvYnxpbnB1dFt0eXBlPVwiZmlsZVwiXX0gZmlsZVxuXHRcdFx0ICovXG5cdFx0XHRmdW5jdGlvbiByZXNvbHZlRmlsZShmaWxlKSB7XG5cdFx0XHRcdHZhciB0eXBlID0gcGx1cGxvYWQudHlwZU9mKGZpbGUpO1xuXG5cdFx0XHRcdC8vIG1veGllLmZpbGUuRmlsZVxuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIG8uZmlsZS5GaWxlKSB7XG5cdFx0XHRcdFx0aWYgKCFmaWxlLnJ1aWQgJiYgIWZpbGUuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdFx0XHRpZiAoIXJ1aWQpIHsgLy8gd2VpcmQgY2FzZVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRmaWxlLnJ1aWQgPSBydWlkO1xuXHRcdFx0XHRcdFx0ZmlsZS5jb25uZWN0UnVudGltZShydWlkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmVzb2x2ZUZpbGUobmV3IHBsdXBsb2FkLkZpbGUoZmlsZSkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIG1veGllLmZpbGUuQmxvYlxuXHRcdFx0XHRlbHNlIGlmIChmaWxlIGluc3RhbmNlb2Ygby5maWxlLkJsb2IpIHtcblx0XHRcdFx0XHRyZXNvbHZlRmlsZShmaWxlLmdldFNvdXJjZSgpKTtcblx0XHRcdFx0XHRmaWxlLmRlc3Ryb3koKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBwbHVwbG9hZC5GaWxlIC0gZmluYWwgc3RlcCBmb3Igb3RoZXIgYnJhbmNoZXNcblx0XHRcdFx0ZWxzZSBpZiAoZmlsZSBpbnN0YW5jZW9mIHBsdXBsb2FkLkZpbGUpIHtcblx0XHRcdFx0XHRpZiAoZmlsZU5hbWUpIHtcblx0XHRcdFx0XHRcdGZpbGUubmFtZSA9IGZpbGVOYW1lO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHF1ZXVlLnB1c2goZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0XHRcdC8vIHJ1biB0aHJvdWdoIHRoZSBpbnRlcm5hbCBhbmQgdXNlci1kZWZpbmVkIGZpbHRlcnMsIGlmIGFueVxuXHRcdFx0XHRcdFx0ZmlsdGVyRmlsZShmaWxlLCBmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdFx0aWYgKCFlcnIpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBtYWtlIGZpbGVzIGF2YWlsYWJsZSBmb3IgdGhlIGZpbHRlcnMgYnkgdXBkYXRpbmcgdGhlIG1haW4gcXVldWUgZGlyZWN0bHlcblx0XHRcdFx0XHRcdFx0XHRmaWxlcy5wdXNoKGZpbGUpO1xuXHRcdFx0XHRcdFx0XHRcdC8vIGNvbGxlY3QgdGhlIGZpbGVzIHRoYXQgd2lsbCBiZSBwYXNzZWQgdG8gRmlsZXNBZGRlZCBldmVudFxuXHRcdFx0XHRcdFx0XHRcdGZpbGVzQWRkZWQucHVzaChmaWxlKTtcblxuXHRcdFx0XHRcdFx0XHRcdHNlbGYudHJpZ2dlcihcIkZpbGVGaWx0ZXJlZFwiLCBmaWxlKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRkZWxheShjYiwgMSk7IC8vIGRvIG5vdCBidWlsZCB1cCByZWN1cnNpb25zIG9yIGV2ZW50dWFsbHkgd2UgbWlnaHQgaGl0IHRoZSBsaW1pdHNcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIG5hdGl2ZSBGaWxlIG9yIGJsb2Jcblx0XHRcdFx0ZWxzZSBpZiAocGx1cGxvYWQuaW5BcnJheSh0eXBlLCBbJ2ZpbGUnLCAnYmxvYiddKSAhPT0gLTEpIHtcblx0XHRcdFx0XHRyZXNvbHZlRmlsZShuZXcgby5maWxlLkZpbGUobnVsbCwgZmlsZSkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGlucHV0W3R5cGU9XCJmaWxlXCJdXG5cdFx0XHRcdGVsc2UgaWYgKHR5cGUgPT09ICdub2RlJyAmJiBwbHVwbG9hZC50eXBlT2YoZmlsZS5maWxlcykgPT09ICdmaWxlbGlzdCcpIHtcblx0XHRcdFx0XHQvLyBpZiB3ZSBhcmUgZGVhbGluZyB3aXRoIGlucHV0W3R5cGU9XCJmaWxlXCJdXG5cdFx0XHRcdFx0cGx1cGxvYWQuZWFjaChmaWxlLmZpbGVzLCByZXNvbHZlRmlsZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gbWl4ZWQgYXJyYXkgb2YgYW55IHN1cHBvcnRlZCB0eXBlcyAoc2VlIGFib3ZlKVxuXHRcdFx0XHRlbHNlIGlmICh0eXBlID09PSAnYXJyYXknKSB7XG5cdFx0XHRcdFx0ZmlsZU5hbWUgPSBudWxsOyAvLyBzaG91bGQgbmV2ZXIgaGFwcGVuLCBidXQgdW5zZXQgYW55d2F5IHRvIGF2b2lkIGZ1bm55IHNpdHVhdGlvbnNcblx0XHRcdFx0XHRwbHVwbG9hZC5lYWNoKGZpbGUsIHJlc29sdmVGaWxlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRydWlkID0gZ2V0UlVJRCgpO1xuXG5cdFx0XHRyZXNvbHZlRmlsZShmaWxlKTtcblxuXHRcdFx0aWYgKHF1ZXVlLmxlbmd0aCkge1xuXHRcdFx0XHRwbHVwbG9hZC5pblNlcmllcyhxdWV1ZSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly8gaWYgYW55IGZpbGVzIGxlZnQgYWZ0ZXIgZmlsdHJhdGlvbiwgdHJpZ2dlciBGaWxlc0FkZGVkXG5cdFx0XHRcdFx0aWYgKGZpbGVzQWRkZWQubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXIoXCJGaWxlc0FkZGVkXCIsIGZpbGVzQWRkZWQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFJlbW92ZXMgYSBzcGVjaWZpYyBmaWxlLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCByZW1vdmVGaWxlXG5cdFx0ICogQHBhcmFtIHtwbHVwbG9hZC5GaWxlfFN0cmluZ30gZmlsZSBGaWxlIHRvIHJlbW92ZSBmcm9tIHF1ZXVlLlxuXHRcdCAqL1xuXHRcdHJlbW92ZUZpbGUgOiBmdW5jdGlvbihmaWxlKSB7XG5cdFx0XHR2YXIgaWQgPSB0eXBlb2YoZmlsZSkgPT09ICdzdHJpbmcnID8gZmlsZSA6IGZpbGUuaWQ7XG5cblx0XHRcdGZvciAodmFyIGkgPSBmaWxlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0XHRpZiAoZmlsZXNbaV0uaWQgPT09IGlkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuc3BsaWNlKGksIDEpWzBdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFJlbW92ZXMgcGFydCBvZiB0aGUgcXVldWUgYW5kIHJldHVybnMgdGhlIGZpbGVzIHJlbW92ZWQuIFRoaXMgd2lsbCBhbHNvIHRyaWdnZXIgdGhlXG5cdFx0ICogRmlsZXNSZW1vdmVkIGFuZCBRdWV1ZUNoYW5nZWQgZXZlbnRzLlxuXHRcdCAqXG5cdFx0ICogQG1ldGhvZCBzcGxpY2Vcblx0XHQgKiBAcGFyYW0ge051bWJlcn0gW3N0YXJ0PTBdIFN0YXJ0IGluZGV4IHRvIHJlbW92ZSBmcm9tLlxuXHRcdCAqIEBwYXJhbSB7TnVtYmVyfSBbbGVuZ3RoXSBOdW1iZXIgb2YgZmlsZXMgdG8gcmVtb3ZlIChkZWZhdWx0cyB0byBudW1iZXIgb2YgZmlsZXMgaW4gdGhlIHF1ZXVlKS5cblx0XHQgKiBAcmV0dXJuIHtBcnJheX0gQXJyYXkgb2YgZmlsZXMgdGhhdCB3YXMgcmVtb3ZlZC5cblx0XHQgKi9cblx0XHRzcGxpY2UgOiBmdW5jdGlvbihzdGFydCwgbGVuZ3RoKSB7XG5cdFx0XHQvLyBTcGxpY2UgYW5kIHRyaWdnZXIgZXZlbnRzXG5cdFx0XHR2YXIgcmVtb3ZlZCA9IGZpbGVzLnNwbGljZShzdGFydCA9PT0gdW5kZWYgPyAwIDogc3RhcnQsIGxlbmd0aCA9PT0gdW5kZWYgPyBmaWxlcy5sZW5ndGggOiBsZW5ndGgpO1xuXG5cdFx0XHQvLyBpZiB1cGxvYWQgaXMgaW4gcHJvZ3Jlc3Mgd2UgbmVlZCB0byBzdG9wIGl0IGFuZCByZXN0YXJ0IGFmdGVyIGZpbGVzIGFyZSByZW1vdmVkXG5cdFx0XHR2YXIgcmVzdGFydFJlcXVpcmVkID0gZmFsc2U7XG5cdFx0XHRpZiAodGhpcy5zdGF0ZSA9PSBwbHVwbG9hZC5TVEFSVEVEKSB7IC8vIHVwbG9hZCBpbiBwcm9ncmVzc1xuXHRcdFx0XHRwbHVwbG9hZC5lYWNoKHJlbW92ZWQsIGZ1bmN0aW9uKGZpbGUpIHtcblx0XHRcdFx0XHRpZiAoZmlsZS5zdGF0dXMgPT09IHBsdXBsb2FkLlVQTE9BRElORykge1xuXHRcdFx0XHRcdFx0cmVzdGFydFJlcXVpcmVkID0gdHJ1ZTsgLy8gZG8gbm90IHJlc3RhcnQsIHVubGVzcyBmaWxlIHRoYXQgaXMgYmVpbmcgcmVtb3ZlZCBpcyB1cGxvYWRpbmdcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChyZXN0YXJ0UmVxdWlyZWQpIHtcblx0XHRcdFx0XHR0aGlzLnN0b3AoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJGaWxlc1JlbW92ZWRcIiwgcmVtb3ZlZCk7XG5cblx0XHRcdC8vIERpc3Bvc2UgYW55IHJlc291cmNlcyBhbGxvY2F0ZWQgYnkgdGhvc2UgZmlsZXNcblx0XHRcdHBsdXBsb2FkLmVhY2gocmVtb3ZlZCwgZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0XHRmaWxlLmRlc3Ryb3koKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAocmVzdGFydFJlcXVpcmVkKSB7XG5cdFx0XHRcdHRoaXMuc3RhcnQoKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHJlbW92ZWQ7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZXMgdGhlIHNwZWNpZmllZCBldmVudCBuYW1lIGFuZCBpdHMgYXJndW1lbnRzIHRvIGFsbCBsaXN0ZW5lcnMuXG5cblx0XHRAbWV0aG9kIHRyaWdnZXJcblx0XHRAcGFyYW0ge1N0cmluZ30gbmFtZSBFdmVudCBuYW1lIHRvIGZpcmUuXG5cdFx0QHBhcmFtIHtPYmplY3QuLn0gTXVsdGlwbGUgYXJndW1lbnRzIHRvIHBhc3MgYWxvbmcgdG8gdGhlIGxpc3RlbmVyIGZ1bmN0aW9ucy5cblx0XHQqL1xuXG5cdFx0Ly8gb3ZlcnJpZGUgdGhlIHBhcmVudCBtZXRob2QgdG8gbWF0Y2ggUGx1cGxvYWQtbGlrZSBldmVudCBsb2dpY1xuXHRcdGRpc3BhdGNoRXZlbnQ6IGZ1bmN0aW9uKHR5cGUpIHtcblx0XHRcdHZhciBsaXN0LCBhcmdzLCByZXN1bHQ7XG5cblx0XHRcdHR5cGUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdGxpc3QgPSB0aGlzLmhhc0V2ZW50TGlzdGVuZXIodHlwZSk7XG5cblx0XHRcdGlmIChsaXN0KSB7XG5cdFx0XHRcdC8vIHNvcnQgZXZlbnQgbGlzdCBieSBwcmlvcml0eVxuXHRcdFx0XHRsaXN0LnNvcnQoZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYi5wcmlvcml0eSAtIGEucHJpb3JpdHk7IH0pO1xuXG5cdFx0XHRcdC8vIGZpcnN0IGFyZ3VtZW50IHNob3VsZCBiZSBjdXJyZW50IHBsdXBsb2FkLlVwbG9hZGVyIGluc3RhbmNlXG5cdFx0XHRcdGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cdFx0XHRcdGFyZ3Muc2hpZnQoKTtcblx0XHRcdFx0YXJncy51bnNoaWZ0KHRoaXMpO1xuXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdC8vIEZpcmUgZXZlbnQsIGJyZWFrIGNoYWluIGlmIGZhbHNlIGlzIHJldHVybmVkXG5cdFx0XHRcdFx0aWYgKGxpc3RbaV0uZm4uYXBwbHkobGlzdFtpXS5zY29wZSwgYXJncykgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0Q2hlY2sgd2hldGhlciB1cGxvYWRlciBoYXMgYW55IGxpc3RlbmVycyB0byB0aGUgc3BlY2lmaWVkIGV2ZW50LlxuXG5cdFx0QG1ldGhvZCBoYXNFdmVudExpc3RlbmVyXG5cdFx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgRXZlbnQgbmFtZSB0byBjaGVjayBmb3IuXG5cdFx0Ki9cblxuXG5cdFx0LyoqXG5cdFx0QWRkcyBhbiBldmVudCBsaXN0ZW5lciBieSBuYW1lLlxuXG5cdFx0QG1ldGhvZCBiaW5kXG5cdFx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgRXZlbnQgbmFtZSB0byBsaXN0ZW4gZm9yLlxuXHRcdEBwYXJhbSB7ZnVuY3Rpb259IGZuIEZ1bmN0aW9uIHRvIGNhbGwgb25lcyB0aGUgZXZlbnQgZ2V0cyBmaXJlZC5cblx0XHRAcGFyYW0ge09iamVjdH0gW3Njb3BlXSBPcHRpb25hbCBzY29wZSB0byBleGVjdXRlIHRoZSBzcGVjaWZpZWQgZnVuY3Rpb24gaW4uXG5cdFx0QHBhcmFtIHtOdW1iZXJ9IFtwcmlvcml0eT0wXSBQcmlvcml0eSBvZiB0aGUgZXZlbnQgaGFuZGxlciAtIGhhbmRsZXJzIHdpdGggaGlnaGVyIHByaW9yaXRpZXMgd2lsbCBiZSBjYWxsZWQgZmlyc3Rcblx0XHQqL1xuXHRcdGJpbmQ6IGZ1bmN0aW9uKG5hbWUsIGZuLCBzY29wZSwgcHJpb3JpdHkpIHtcblx0XHRcdC8vIGFkYXB0IG1veGllIEV2ZW50VGFyZ2V0IHN0eWxlIHRvIFBsdXBsb2FkLWxpa2Vcblx0XHRcdHBsdXBsb2FkLlVwbG9hZGVyLnByb3RvdHlwZS5iaW5kLmNhbGwodGhpcywgbmFtZSwgZm4sIHByaW9yaXR5LCBzY29wZSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdFJlbW92ZXMgdGhlIHNwZWNpZmllZCBldmVudCBsaXN0ZW5lci5cblxuXHRcdEBtZXRob2QgdW5iaW5kXG5cdFx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBvZiBldmVudCB0byByZW1vdmUuXG5cdFx0QHBhcmFtIHtmdW5jdGlvbn0gZm4gRnVuY3Rpb24gdG8gcmVtb3ZlIGZyb20gbGlzdGVuZXIuXG5cdFx0Ki9cblxuXHRcdC8qKlxuXHRcdFJlbW92ZXMgYWxsIGV2ZW50IGxpc3RlbmVycy5cblxuXHRcdEBtZXRob2QgdW5iaW5kQWxsXG5cdFx0Ki9cblxuXG5cdFx0LyoqXG5cdFx0ICogRGVzdHJveXMgUGx1cGxvYWQgaW5zdGFuY2UgYW5kIGNsZWFucyBhZnRlciBpdHNlbGYuXG5cdFx0ICpcblx0XHQgKiBAbWV0aG9kIGRlc3Ryb3lcblx0XHQgKi9cblx0XHRkZXN0cm95IDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoJ0Rlc3Ryb3knKTtcblx0XHRcdHNldHRpbmdzID0gdG90YWwgPSBudWxsOyAvLyBwdXJnZSB0aGVzZSBleGNsdXNpdmVseVxuXHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHR9XG5cdH0pO1xufTtcblxucGx1cGxvYWQuVXBsb2FkZXIucHJvdG90eXBlID0gby5jb3JlLkV2ZW50VGFyZ2V0Lmluc3RhbmNlO1xuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBuZXcgZmlsZSBpbnN0YW5jZS5cbiAqXG4gKiBAY2xhc3MgRmlsZVxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGZpbGUgT2JqZWN0IGNvbnRhaW5pbmcgZmlsZSBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge1N0cmluZ30gZmlsZS5uYW1lIE5hbWUgb2YgdGhlIGZpbGUuXG4gKiBAcGFyYW0ge051bWJlcn0gZmlsZS5zaXplIEZpbGUgc2l6ZS5cbiAqL1xucGx1cGxvYWQuRmlsZSA9IChmdW5jdGlvbigpIHtcblx0dmFyIGZpbGVwb29sID0ge307XG5cblx0ZnVuY3Rpb24gUGx1cGxvYWRGaWxlKGZpbGUpIHtcblxuXHRcdHBsdXBsb2FkLmV4dGVuZCh0aGlzLCB7XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogRmlsZSBpZCB0aGlzIGlzIGEgZ2xvYmFsbHkgdW5pcXVlIGlkIGZvciB0aGUgc3BlY2lmaWMgZmlsZS5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcHJvcGVydHkgaWRcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xuXHRcdFx0ICovXG5cdFx0XHRpZDogcGx1cGxvYWQuZ3VpZCgpLFxuXG5cdFx0XHQvKipcblx0XHRcdCAqIEZpbGUgbmFtZSBmb3IgZXhhbXBsZSBcIm15ZmlsZS5naWZcIi5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcHJvcGVydHkgbmFtZVxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXG5cdFx0XHQgKi9cblx0XHRcdG5hbWU6IGZpbGUubmFtZSB8fCBmaWxlLmZpbGVOYW1lLFxuXG5cdFx0XHQvKipcblx0XHRcdCAqIEZpbGUgdHlwZSwgYGUuZyBpbWFnZS9qcGVnYFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwcm9wZXJ0eSB0eXBlXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcblx0XHRcdCAqL1xuXHRcdFx0dHlwZTogZmlsZS50eXBlIHx8ICcnLFxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlbGF0aXZlIHBhdGggdG8gdGhlIGZpbGUgaW5zaWRlIGEgZGlyZWN0b3J5XG5cdFx0XHQgKlxuXHRcdFx0ICogQHByb3BlcnR5IHJlbGF0aXZlUGF0aFxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXG5cdFx0XHQgKiBAZGVmYXVsdCAnJ1xuXHRcdFx0ICovXG5cdFx0XHRyZWxhdGl2ZVBhdGg6IGZpbGUucmVsYXRpdmVQYXRoIHx8ICcnLFxuXG5cdFx0XHQvKipcblx0XHRcdCAqIEZpbGUgc2l6ZSBpbiBieXRlcyAobWF5IGNoYW5nZSBhZnRlciBjbGllbnQtc2lkZSBtYW51cGlsYXRpb24pLlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwcm9wZXJ0eSBzaXplXG5cdFx0XHQgKiBAdHlwZSBOdW1iZXJcblx0XHRcdCAqL1xuXHRcdFx0c2l6ZTogZmlsZS5maWxlU2l6ZSB8fCBmaWxlLnNpemUsXG5cblx0XHRcdC8qKlxuXHRcdFx0ICogT3JpZ2luYWwgZmlsZSBzaXplIGluIGJ5dGVzLlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwcm9wZXJ0eSBvcmlnU2l6ZVxuXHRcdFx0ICogQHR5cGUgTnVtYmVyXG5cdFx0XHQgKi9cblx0XHRcdG9yaWdTaXplOiBmaWxlLmZpbGVTaXplIHx8IGZpbGUuc2l6ZSxcblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBOdW1iZXIgb2YgYnl0ZXMgdXBsb2FkZWQgb2YgdGhlIGZpbGVzIHRvdGFsIHNpemUuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHByb3BlcnR5IGxvYWRlZFxuXHRcdFx0ICogQHR5cGUgTnVtYmVyXG5cdFx0XHQgKi9cblx0XHRcdGxvYWRlZDogMCxcblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBOdW1iZXIgb2YgcGVyY2VudGFnZSB1cGxvYWRlZCBvZiB0aGUgZmlsZS5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcHJvcGVydHkgcGVyY2VudFxuXHRcdFx0ICogQHR5cGUgTnVtYmVyXG5cdFx0XHQgKi9cblx0XHRcdHBlcmNlbnQ6IDAsXG5cblx0XHRcdC8qKlxuXHRcdFx0ICogU3RhdHVzIGNvbnN0YW50IG1hdGNoaW5nIHRoZSBwbHVwbG9hZCBzdGF0ZXMgUVVFVUVELCBVUExPQURJTkcsIEZBSUxFRCwgRE9ORS5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcHJvcGVydHkgc3RhdHVzXG5cdFx0XHQgKiBAdHlwZSBOdW1iZXJcblx0XHRcdCAqIEBzZWUgcGx1cGxvYWRcblx0XHRcdCAqL1xuXHRcdFx0c3RhdHVzOiBwbHVwbG9hZC5RVUVVRUQsXG5cblx0XHRcdC8qKlxuXHRcdFx0ICogRGF0ZSBvZiBsYXN0IG1vZGlmaWNhdGlvbi5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcHJvcGVydHkgbGFzdE1vZGlmaWVkRGF0ZVxuXHRcdFx0ICogQHR5cGUge1N0cmluZ31cblx0XHRcdCAqL1xuXHRcdFx0bGFzdE1vZGlmaWVkRGF0ZTogZmlsZS5sYXN0TW9kaWZpZWREYXRlIHx8IChuZXcgRGF0ZSgpKS50b0xvY2FsZVN0cmluZygpLCAvLyBUaHUgQXVnIDIzIDIwMTIgMTk6NDA6MDAgR01UKzA0MDAgKEdFVClcblxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldCB3aGVuIGZpbGUgYmVjb21lcyBwbHVwbG9hZC5ET05FIG9yIHBsdXBsb2FkLkZBSUxFRC4gSXMgdXNlZCB0byBjYWxjdWxhdGUgcHJvcGVyIHBsdXBsb2FkLlF1ZXVlUHJvZ3Jlc3MuYnl0ZXNQZXJTZWMuXG5cdFx0XHQgKiBAcHJpdmF0ZVxuXHRcdFx0ICogQHByb3BlcnR5IGNvbXBsZXRlVGltZXN0YW1wXG5cdFx0XHQgKiBAdHlwZSB7TnVtYmVyfVxuXHRcdFx0ICovXG5cdFx0XHRjb21wbGV0ZVRpbWVzdGFtcDogMCxcblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXR1cm5zIG5hdGl2ZSB3aW5kb3cuRmlsZSBvYmplY3QsIHdoZW4gaXQncyBhdmFpbGFibGUuXG5cdFx0XHQgKlxuXHRcdFx0ICogQG1ldGhvZCBnZXROYXRpdmVcblx0XHRcdCAqIEByZXR1cm4ge3dpbmRvdy5GaWxlfSBvciBudWxsLCBpZiBwbHVwbG9hZC5GaWxlIGlzIG9mIGRpZmZlcmVudCBvcmlnaW5cblx0XHRcdCAqL1xuXHRcdFx0Z2V0TmF0aXZlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGZpbGUgPSB0aGlzLmdldFNvdXJjZSgpLmdldFNvdXJjZSgpO1xuXHRcdFx0XHRyZXR1cm4gcGx1cGxvYWQuaW5BcnJheShwbHVwbG9hZC50eXBlT2YoZmlsZSksIFsnYmxvYicsICdmaWxlJ10pICE9PSAtMSA/IGZpbGUgOiBudWxsO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXR1cm5zIG1PeGllLkZpbGUgLSB1bmlmaWVkIHdyYXBwZXIgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgYWNyb3NzIHJ1bnRpbWVzLlxuXHRcdFx0ICpcblx0XHRcdCAqIEBtZXRob2QgZ2V0U291cmNlXG5cdFx0XHQgKiBAcmV0dXJuIHttT3hpZS5GaWxlfSBvciBudWxsXG5cdFx0XHQgKi9cblx0XHRcdGdldFNvdXJjZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghZmlsZXBvb2xbdGhpcy5pZF0pIHtcblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmlsZXBvb2xbdGhpcy5pZF07XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdCAqIERlc3Ryb3lzIHBsdXBsb2FkLkZpbGUgb2JqZWN0LlxuXHRcdFx0ICpcblx0XHRcdCAqIEBtZXRob2QgZGVzdHJveVxuXHRcdFx0ICovXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHNyYyA9IHRoaXMuZ2V0U291cmNlKCk7XG5cdFx0XHRcdGlmIChzcmMpIHtcblx0XHRcdFx0XHRzcmMuZGVzdHJveSgpO1xuXHRcdFx0XHRcdGRlbGV0ZSBmaWxlcG9vbFt0aGlzLmlkXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZmlsZXBvb2xbdGhpcy5pZF0gPSBmaWxlO1xuXHR9XG5cblx0cmV0dXJuIFBsdXBsb2FkRmlsZTtcbn0oKSk7XG5cblxuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgcXVldWUgcHJvZ3Jlc3MuXG4gKlxuICogQGNsYXNzIFF1ZXVlUHJvZ3Jlc3NcbiAqIEBjb25zdHJ1Y3RvclxuICovXG4gcGx1cGxvYWQuUXVldWVQcm9ncmVzcyA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgc2VsZiA9IHRoaXM7IC8vIFNldHVwIGFsaWFzIGZvciBzZWxmIHRvIHJlZHVjZSBjb2RlIHNpemUgd2hlbiBpdCdzIGNvbXByZXNzZWRcblxuXHQvKipcblx0ICogVG90YWwgcXVldWUgZmlsZSBzaXplLlxuXHQgKlxuXHQgKiBAcHJvcGVydHkgc2l6ZVxuXHQgKiBAdHlwZSBOdW1iZXJcblx0ICovXG5cdHNlbGYuc2l6ZSA9IDA7XG5cblx0LyoqXG5cdCAqIFRvdGFsIGJ5dGVzIHVwbG9hZGVkLlxuXHQgKlxuXHQgKiBAcHJvcGVydHkgbG9hZGVkXG5cdCAqIEB0eXBlIE51bWJlclxuXHQgKi9cblx0c2VsZi5sb2FkZWQgPSAwO1xuXG5cdC8qKlxuXHQgKiBOdW1iZXIgb2YgZmlsZXMgdXBsb2FkZWQuXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSB1cGxvYWRlZFxuXHQgKiBAdHlwZSBOdW1iZXJcblx0ICovXG5cdHNlbGYudXBsb2FkZWQgPSAwO1xuXG5cdC8qKlxuXHQgKiBOdW1iZXIgb2YgZmlsZXMgZmFpbGVkIHRvIHVwbG9hZC5cblx0ICpcblx0ICogQHByb3BlcnR5IGZhaWxlZFxuXHQgKiBAdHlwZSBOdW1iZXJcblx0ICovXG5cdHNlbGYuZmFpbGVkID0gMDtcblxuXHQvKipcblx0ICogTnVtYmVyIG9mIGZpbGVzIHlldCB0byBiZSB1cGxvYWRlZC5cblx0ICpcblx0ICogQHByb3BlcnR5IHF1ZXVlZFxuXHQgKiBAdHlwZSBOdW1iZXJcblx0ICovXG5cdHNlbGYucXVldWVkID0gMDtcblxuXHQvKipcblx0ICogVG90YWwgcGVyY2VudCBvZiB0aGUgdXBsb2FkZWQgYnl0ZXMuXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSBwZXJjZW50XG5cdCAqIEB0eXBlIE51bWJlclxuXHQgKi9cblx0c2VsZi5wZXJjZW50ID0gMDtcblxuXHQvKipcblx0ICogQnl0ZXMgdXBsb2FkZWQgcGVyIHNlY29uZC5cblx0ICpcblx0ICogQHByb3BlcnR5IGJ5dGVzUGVyU2VjXG5cdCAqIEB0eXBlIE51bWJlclxuXHQgKi9cblx0c2VsZi5ieXRlc1BlclNlYyA9IDA7XG5cblx0LyoqXG5cdCAqIFJlc2V0cyB0aGUgcHJvZ3Jlc3MgdG8gaXRzIGluaXRpYWwgdmFsdWVzLlxuXHQgKlxuXHQgKiBAbWV0aG9kIHJlc2V0XG5cdCAqL1xuXHRzZWxmLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG5cdFx0c2VsZi5zaXplID0gc2VsZi5sb2FkZWQgPSBzZWxmLnVwbG9hZGVkID0gc2VsZi5mYWlsZWQgPSBzZWxmLnF1ZXVlZCA9IHNlbGYucGVyY2VudCA9IHNlbGYuYnl0ZXNQZXJTZWMgPSAwO1xuXHR9O1xufTtcblxuZXhwb3J0cy5wbHVwbG9hZCA9IHBsdXBsb2FkO1xuXG59KHRoaXMsIG1veGllKSk7XG5cbn0pKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/plupload/js/plupload.dev.js\n");

/***/ })

}]);