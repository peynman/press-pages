(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{"0gLc":function(e,t,i){"use strict";i.r(t);var n=i("I1Ao"),r=i("1M3H"),l=i.n(r),s=i("Nk9Y"),o=i.n(s),a=i("gzZi"),d=i("Ey0z"),c=i("sK+t"),h={components:{VBtn:a.a,VIcon:d.a,VCard:c.a},mixins:[n.d],name:"vf-paragraph-input",props:{id:String,field:Object,value:{type:String,default:function(){return""}}},data:function(e){return{dialog:!1,markdownEditor:null,mathfieldEditor:null,mathKeyboardVisible:!1,aceEditor:null,aceUpdate:!1,mode:e.field.readonly?"view":"editor"}},computed:{modeIcon:function(){return"editor"===this.mode?"mdi-code-braces":"mdi-eye"}},methods:{toggleVirtualMathKeyboard:function(e){this.mathfieldEditor&&(this.mathfieldEditor.virtualKeyboardVisible!==e&&this.mathfieldEditor.$perform(["toggleVirtualKeyboard"]),this.mathKeyboardVisible=this.mathfieldEditor.virtualKeyboardVisible)},updateMarkdownText:function(){for(var e=this.markdownEditor.render(this.devalue),t=this.$refs.editorView.lastElementChild;t;)this.$refs.editorView.removeChild(t),t=this.$refs.editorView.lastElementChild;this.$refs.editorView.insertAdjacentHTML("beforeend",e),this.aceEditor&&(this.aceUpdate?this.aceUpdate=!1:this.aceEditor.session.setValue(this.devalue))}},watch:{devalue:{deep:!0,handler:function(){this.updateMarkdownText()}}},mounted:function(){var e=this;if(!this.field.readonly){var t=Promise.all([i.e(1),i.e(3)]).then(i.t.bind(null,"8kXO",7));console.log(t),this.aceEditor=t.edit(this.$refs.editorCode,{mode:"ace/mode/markdown",selectionStyle:"text",theme:"ace/theme/eclipse",maxLines:1/0}),this.aceEditor.session.on("change",(function(t){e.aceUpdate=!0,e.$nextTick((function(){e.devalue=e.aceEditor.session.getValue(),e.$emit("input",e.devalue)}))})),this.aceEditor.session.setValue(this.devalue)}this.markdownEditor=new l.a(this.field.markdownProps?this.field.markdownProps:{}),this.markdownEditor.use(o.a,{leftDelimiter:"{",rightDelimiter:"}",allowedAttributes:[]}),this.updateMarkdownText()}},f=i("KHd+"),m=i("ZUTo"),u=i.n(m),g=Object(f.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"vf-input d-flex flex-column flex-grow-1 "+(e.field.class?e.field.class:"")},["view"!==e.mode?i("label",[e._v(e._s(e.field.label))]):e._e(),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.field.readonly,expression:"!field.readonly"}]},[i("v-btn",{attrs:{fab:"",small:"",icon:""},on:{click:function(){e.mode="editor"===e.mode?"view":"editor",e.toggleVirtualMathKeyboard(e.dialog&&"editor"===e.mode)}}},[i("v-icon",{attrs:{small:""}},[e._v(e._s(e.modeIcon))])],1)],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"view"===e.mode||e.field.readonly,expression:"mode === 'view' || field.readonly"}],ref:"editorView",staticClass:"fill-height",staticStyle:{width:"100%"}}),e._v(" "),i("v-card",{directives:[{name:"show",rawName:"v-show",value:"editor"===e.mode&&!e.field.readonly,expression:"mode === 'editor' && !field.readonly"}],staticClass:"fill-hight mx-2",staticStyle:{position:"relative",width:"100%","min-height":"100px",overflow:"scroll"}},[i("div",{ref:"editorCode",style:"position: absolute; width: 100%; left: 0; right: 0; top: 0; bottom: 0; "+(e.field.height?"height: "+e.field.height:"")})])],1)}),[],!1,null,null,null);t.default=g.exports;u()(g,{VBtn:a.a,VCard:c.a,VIcon:d.a})},"7gEF":function(e,t,i){"use strict";const n=i("8Hlo");function r(e){return e.slice(-1)[0]}e.exports=e=>{const t=new RegExp("^ {0,3}[-*_]{3,} ?"+n.escapeRegExp(e.leftDelimiter)+"[^"+n.escapeRegExp(e.rightDelimiter)+"]");return[{name:"fenced code blocks",tests:[{shift:0,block:!0,info:n.hasDelimiters("end",e)}],transform:(t,i)=>{let r=t[i],l=r.info.lastIndexOf(e.leftDelimiter),s=n.getAttrs(r.info,l,e);n.addAttrs(s,r),r.info=n.removeDelimiter(r.info,e)}},{name:"inline nesting 0",tests:[{shift:0,type:"inline",children:[{shift:-1,type:e=>"image"===e||"code_inline"===e},{shift:0,type:"text",content:n.hasDelimiters("start",e)}]}],transform:(t,i,r)=>{let l=t[i].children[r],s=l.content.indexOf(e.rightDelimiter),o=t[i].children[r-1],a=n.getAttrs(l.content,0,e);n.addAttrs(a,o),l.content.length===s+e.rightDelimiter.length?t[i].children.splice(r,1):l.content=l.content.slice(s+e.rightDelimiter.length)}},{name:"tables",tests:[{shift:0,type:"table_close"},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:n.hasDelimiters("only",e)}],transform:(t,i)=>{let r=t[i+2],l=n.getMatchingOpeningToken(t,i),s=n.getAttrs(r.content,0,e);n.addAttrs(s,l),t.splice(i+1,3)}},{name:"inline attributes",tests:[{shift:0,type:"inline",children:[{shift:-1,nesting:-1},{shift:0,type:"text",content:n.hasDelimiters("start",e)}]}],transform:(t,i,r)=>{let l=t[i].children[r],s=l.content,o=n.getAttrs(s,0,e),a=n.getMatchingOpeningToken(t[i].children,r-1);n.addAttrs(o,a),l.content=s.slice(s.indexOf(e.rightDelimiter)+e.rightDelimiter.length)}},{name:"list softbreak",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:n.hasDelimiters("only",e)}]}],transform:(t,i,r)=>{let l=t[i].children[r].content,s=n.getAttrs(l,0,e),o=i-2;for(;t[o-1]&&"ordered_list_open"!==t[o-1].type&&"bullet_list_open"!==t[o-1].type;)o--;n.addAttrs(s,t[o-1]),t[i].children=t[i].children.slice(0,-2)}},{name:"list double softbreak",tests:[{shift:0,type:e=>"bullet_list_close"===e||"ordered_list_close"===e},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:n.hasDelimiters("only",e),children:e=>1===e.length},{shift:3,type:"paragraph_close"}],transform:(t,i)=>{let r=t[i+2].content,l=n.getAttrs(r,0,e),s=n.getMatchingOpeningToken(t,i);n.addAttrs(l,s),t.splice(i+1,3)}},{name:"list item end",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-1,type:"text",content:n.hasDelimiters("end",e)}]}],transform:(t,i,l)=>{let s=t[i].children[l],o=s.content,a=n.getAttrs(o,o.lastIndexOf(e.leftDelimiter),e);n.addAttrs(a,t[i-2]);let d=o.slice(0,o.lastIndexOf(e.leftDelimiter));s.content=" "!==r(d)?d:d.slice(0,-1)}},{name:"\n{.a} softbreak then curly in start",tests:[{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:n.hasDelimiters("only",e)}]}],transform:(t,i,r)=>{let l=t[i].children[r],s=n.getAttrs(l.content,0,e),o=i+1;for(;t[o+1]&&-1===t[o+1].nesting;)o++;let a=n.getMatchingOpeningToken(t,o);n.addAttrs(s,a),t[i].children=t[i].children.slice(0,-2)}},{name:"horizontal rule",tests:[{shift:0,type:"paragraph_open"},{shift:1,type:"inline",children:e=>1===e.length,content:e=>null!==e.match(t)},{shift:2,type:"paragraph_close"}],transform:(t,i)=>{let r=t[i];r.type="hr",r.tag="hr",r.nesting=0;let l=t[i+1].content,s=l.lastIndexOf(e.leftDelimiter);r.attrs=n.getAttrs(l,s,e),r.markup=l,t.splice(i+1,2)}},{name:"end of block",tests:[{shift:0,type:"inline",children:[{position:-1,content:n.hasDelimiters("end",e),type:e=>"code_inline"!==e}]}],transform:(t,i,l)=>{let s=t[i].children[l],o=s.content,a=n.getAttrs(o,o.lastIndexOf(e.leftDelimiter),e),d=i+1;for(;t[d+1]&&-1===t[d+1].nesting;)d++;let c=n.getMatchingOpeningToken(t,d);n.addAttrs(a,c);let h=o.slice(0,o.lastIndexOf(e.leftDelimiter));s.content=" "!==r(h)?h:h.slice(0,-1)}}]}},"8Hlo":function(e,t,i){"use strict";function n(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}t.getAttrs=function(e,t,i){const n=/[^\t\n\f />"'=]/,r=[];let l="",s="",o=!0,a=!1;for(let d=t+i.leftDelimiter.length;d<e.length;d++){if(e.slice(d,d+i.rightDelimiter.length)===i.rightDelimiter){""!==l&&r.push([l,s]);break}let t=e.charAt(d);if("="===t&&o)o=!1;else if("."!==t||""!==l)if("#"!==t||""!==l)if('"'!==t||""!==s)if('"'===t&&a)a=!1;else if(" "!==t||a)o&&-1===t.search(n)||(o?l+=t:s+=t);else{if(""===l)continue;r.push([l,s]),l="",s="",o=!0}else a=!0;else l="id",o=!1;else"."===e.charAt(d+1)?(l="css-module",d+=1):l="class",o=!1}if(i.allowedAttributes&&i.allowedAttributes.length){let e=i.allowedAttributes;return r.filter((function(t){let i=t[0];return e.some((function(e){return i===e||e instanceof RegExp&&e.test(i)}))}))}return r},t.addAttrs=function(e,t){for(let i=0,n=e.length;i<n;++i){let n=e[i][0];"class"===n?t.attrJoin("class",e[i][1]):"css-module"===n?t.attrJoin("css-module",e[i][1]):t.attrPush(e[i])}return t},t.hasDelimiters=function(e,t){if(!e)throw new Error('Parameter `where` not passed. Should be "start", "middle", "end" or "only".');return function(i){let n,r,l,s,o=t.leftDelimiter.length+1+t.rightDelimiter.length;if(!i||"string"!=typeof i||i.length<o)return!1;let a=o-t.rightDelimiter.length;switch(e){case"start":l=i.slice(0,t.leftDelimiter.length),n=l===t.leftDelimiter?0:-1,r=-1===n?-1:i.indexOf(t.rightDelimiter,a),s=i.charAt(r+t.rightDelimiter.length),s&&-1!==t.rightDelimiter.indexOf(s)&&(r=-1);break;case"end":n=i.lastIndexOf(t.leftDelimiter),r=-1===n?-1:i.indexOf(t.rightDelimiter,n+a),r=r===i.length-t.rightDelimiter.length?r:-1;break;case"only":l=i.slice(0,t.leftDelimiter.length),n=l===t.leftDelimiter?0:-1,l=i.slice(i.length-t.rightDelimiter.length),r=l===t.rightDelimiter?i.length-t.rightDelimiter.length:-1}return-1!==n&&-1!==r&&function(e){let i="."===e.charAt(t.leftDelimiter.length),n="#"===e.charAt(t.leftDelimiter.length);return i||n?e.length>=o+1:e.length>=o}(i.substring(n,r+t.rightDelimiter.length))}},t.removeDelimiter=function(e,t){const i=n(t.leftDelimiter),r=n(t.rightDelimiter);let l=new RegExp("[ \\n]?"+i+"[^"+i+r+"]+"+r+"$"),s=e.search(l);return-1!==s?e.slice(0,s):e},t.escapeRegExp=n,t.getMatchingOpeningToken=function(e,t){if("softbreak"===e[t].type)return!1;if(0===e[t].nesting)return e[t];let i=e[t].level,n=e[t].type.replace("_close","_open");for(;t>=0;--t)if(e[t].type===n&&e[t].level===i)return e[t]};let r=/[&<>"]/,l=/[&<>"]/g,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function o(e){return s[e]}t.escapeHtml=function(e){return r.test(e)?e.replace(l,o):e}},Nk9Y:function(e,t,i){"use strict";const n=i("7gEF"),r={leftDelimiter:"{",rightDelimiter:"}",allowedAttributes:[]};function l(e,t,i){let n={match:!1,j:null},r=void 0!==i.shift?t+i.shift:i.position,d=(c=e,(h=r)>=0?c[h]:c[c.length+h]);var c,h;if(void 0===d)return n;for(let e in i)if("shift"!==e&&"position"!==e){if(void 0===d[e])return n;if("children"===e&&s(i.children)){if(0===d.children.length)return n;let e,t=i.children,r=d.children;if(t.every(e=>void 0!==e.position)){if(e=t.every(e=>l(r,e.position,e).match),e){let e=a(t).position;n.j=e>=0?e:r.length+e}}else for(let i=0;i<r.length;i++)if(e=t.every(e=>l(r,i,e).match),e){n.j=i;break}if(!1===e)return n}else switch(typeof i[e]){case"boolean":case"number":case"string":if(d[e]!==i[e])return n;break;case"function":if(!i[e](d[e]))return n;break;case"object":if(o(i[e])){if(!1===i[e].every(t=>t(d[e])))return n;break}default:throw new Error(`Unknown type of pattern test (key: ${e}). Test should be of type boolean, number, string, function or array of functions.`)}}return n.match=!0,n}function s(e){return Array.isArray(e)&&e.length&&e.every(e=>"object"==typeof e)}function o(e){return Array.isArray(e)&&e.length&&e.every(e=>"function"==typeof e)}function a(e){return e.slice(-1)[0]||{}}e.exports=function(e,t){let i=Object.assign({},r);i=Object.assign(i,t);const s=n(i);e.core.ruler.before("linkify","curly_attributes",(function(e){let t=e.tokens;for(let e=0;e<t.length;e++)for(let i=0;i<s.length;i++){let n=s[i],r=null;n.tests.every(i=>{let n=l(t,e,i);return null!==n.j&&(r=n.j),n.match})&&(n.transform(t,e,r),"inline attributes"!==n.name&&"inline nesting 0"!==n.name||i--)}}))}}}]);
//# sourceMappingURL=paragraph.bundle.js.map