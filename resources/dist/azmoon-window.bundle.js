(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+miZ":function(t,e,n){"use strict";n.r(e);var s=n("pnuC"),i=n.n(s),o=n("f0Wu"),a=n.n(o);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d={name:"VfAzmoonInput",props:{field:Object,value:Object,id:String},data:function(){return{dialog:!1,mode:"not_started",answerSheet:!1,loading:!1,details:null,started_at:null,current:null,currentIndex:null,myAnswers:{},azmoonTimeTitle:"",taken:null,takenMom:null,takenShowQ:!1}},computed:{azmoonTitle:function(){var t,e,n;return null!==(t=null===(e=this.field.data.types)||void 0===e||null===(n=e.azmoon)||void 0===n?void 0:n.title)&&void 0!==t?t:field.data.title},questionsCount:function(){var t,e;return null!==(t=null===(e=this.questions)||void 0===e?void 0:e.length)&&void 0!==t?t:0},azmoonTimed:function(){var t,e,n,s;return(null===(t=this.field.data.types)||void 0===t||null===(e=t.azmoon)||void 0===e?void 0:e.max_time)&&parseInt(null===(n=this.field.data.types)||void 0===n||null===(s=n.azmoon)||void 0===s?void 0:s.max_time)>0},azmoonTime:function(){var t,e;return parseInt(null===(t=this.field.data.types)||void 0===t||null===(e=t.azmoon)||void 0===e?void 0:e.max_time)},azmoonTimeString:function(){return this.azmoonTimed?this.azmoonTime.toLocaleString("fa")+" دقیقه ":"بدون زمان"},questions:function(){var t,e,n,s,i,o,a,r;return(null===(t=this.details)||void 0===t||null===(e=t.data)||void 0===e||null===(n=e.types)||void 0===n||null===(s=n.azmoon)||void 0===s?void 0:s.details)?null===(i=this.details)||void 0===i||null===(o=i.data)||void 0===o||null===(a=o.types)||void 0===a||null===(r=a.azmoon)||void 0===r?void 0:r.details.filter((function(t){return t.q_file})):[]},hasHistory:function(){return!(!this.details||!this.details.user_history)},azmoonQuestionTitle:function(){return this.currentIndex?"سوال ".concat(this.currentIndex+1):""},canSeeAnswers:function(){var t,e,n;return null!==(t=null===(e=this.field.data.types)||void 0===e||null===(n=e.azmoon)||void 0===n?void 0:n.can_see_answers)&&void 0!==t&&t},takenTimeString:function(){if(this.taken){var t=this.taken.created_at;return t.includes("+")?(this.takenMom=i()(t,"YYYY/MM/DDTHH:mm:ssZ"),this.takenMom.locale("fa")):(this.takenMom=i()(a.a.utc(t).tz(a.a.tz.guess())),this.takenMom.locale("fa")),"شما آزمون را در تاریخ ".concat(this.takenMom.format("dddd jYYYY/jMM/jDD")," پاسخ داده‌اید")}},percentTitle:function(){return"درصد شما ".concat(this.takenDetails.percent,"٪")},percentNoErrTitle:function(){return"بدون امتیاز منفی ".concat(this.takenDetails.percentNoErr,"٪")},percentDetails:function(){return"".concat(this.takenDetails.correct," پاسخ صحیح و ").concat(this.takenDetails.errors," غلط و ").concat(this.takenDetails.noAnswer," نزده")},takenDetails:function(){var t,e,n,s,i,o,a,r,l=null!==(t=null===(e=this.taken)||void 0===e||null===(n=e.data)||void 0===n||null===(s=n.values)||void 0===s?void 0:s.correct)&&void 0!==t?t:0,c=null!==(i=null===(o=this.taken)||void 0===o||null===(a=o.data)||void 0===a||null===(r=a.values)||void 0===r?void 0:r.errors)&&void 0!==i?i:0,d=this.questions.length,u=l/d*100,v=(3*l-c)/(3*d)*100;return{correct:l.toLocaleString("fa"),errors:c.toLocaleString("fa"),total:d.toLocaleString("fa"),noAnswer:(d-(l+c)).toLocaleString("fa"),percent:v.toFixed(2).toLocaleString("fa"),percentNoErr:u.toFixed(2).toLocaleString("fa")}},canStartAzmoon:function(){var t,e,n;return"after_class"!=(null===(t=this.field.data)||void 0===t||null===(e=t.types)||void 0===e||null===(n=e.azmoon)||void 0===n?void 0:n.type)||this.isEnded},isEnded:function(){var t,e,n,s;return"ended"===(null===(t=this.field.data.types)||void 0===t||null===(e=t.livestream)||void 0===e?void 0:e.status)||"ended"===(null===(n=this.field.data.types)||void 0===n||null===(s=n.ac_meeting)||void 0===s?void 0:s.status)}},methods:{startAzmoon:function(){this.started_at=i()(),this.started_at.locale("fa"),this.mode="started",this.updateAzmoonTimeTitle(),this.startAzmoonTimerUpdate(),this.onGoToQuestion(0)},endAzmoon:function(){var t=this;this.loading=!0;var e=this.$store.state.host;e.webRequest({headers:e.getWebAuthHeaders({}),url:"/api/azmoon/"+this.field.id+"/answer_sheet",method:"POST",data:{answers:l({},this.myAnswers)}}).then((function(e){var n;t.mode="taken",t.taken=e.data,t.myAnswers=null===(n=t.taken.data.values)||void 0===n?void 0:n.answers,t.loading=!1})).catch((function(n){var s,i,o,a;(t.loading=!1,null===(s=n.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)?e.showSnack(null===(o=n.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message):e.showSnack(n.message)}))},startAzmoonTimerUpdate:function(){var t=this;"started"===this.mode&&this.azmoonTime>0&&setTimeout((function(){t.updateAzmoonTimeTitle(),t.startAzmoonTimerUpdate()}),6e4)},onGoToQuestion:function(t){this.currentIndex=t,this.current="/azmoon/"+this.field.id+"/question/"+t,this.answerSheet=!1,"taken"===this.mode&&(this.takenShowQ=!0)},prevQuestion:function(){this.currentIndex>0&&this.onGoToQuestion(this.currentIndex-1)},nextQuestion:function(){this.currentIndex<this.questions.length-1&&this.onGoToQuestion(this.currentIndex+1)},getColorForAnswer:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n){if(this.questions[t].answer==e)return"success";if(0===e)return this.myAnswers[t]?this.myAnswers[t]==this.questions[t].answer?"success":"error":"gray"}return this.myAnswers[t]&&this.myAnswers[t]==e?this.taken?"error":"primary":"gray"},selectAnswer:function(t){var e=this;this.myAnswers[this.currentIndex]==t?this.myAnswers[this.currentIndex]=void 0:this.myAnswers[this.currentIndex]=t,setTimeout((function(){e.currentIndex<e.questions.length-1?e.nextQuestion():e.onGoToQuestion(0)}),1e3),this.$forceUpdate()},updateAzmoonTimeTitle:function(){if(this.azmoonTimed){var t=i()().diff(this.started_at,"minute"),e=this.azmoonTime-t;0===e&&setTimeout((function(){tnis.endAzmoon()}),6e4),this.azmoonTimeTitle="زمان باقی مانده ".concat(e," دقیقه")}}},watch:{dialog:function(){var t=this;this.$store.state.host;if(this.dialog&&!this.details){this.loading=!0;var e=this.$store.state.host;e.webRequest({headers:e.getWebAuthHeaders({}),url:"/api/azmoon/"+this.field.id+"/details",method:"POST"}).then((function(e){var n;(t.details=e.data,t.details.user_history)&&(t.mode="taken",t.taken=t.details.user_history,t.myAnswers=null===(n=t.taken.data.values)||void 0===n?void 0:n.answers);t.loading=!1})).catch((function(n){var s,i,o,a;(t.loading=!1,null===(s=n.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)?e.showSnack(null===(o=n.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message):e.showSnack(n.message)}))}}}},u=n("KHd+"),v=n("ZUTo"),m=n.n(v),h=n("gzZi"),f=n("sK+t"),p=n("zCDB"),g=n("Yq0q"),_=n("FpqX"),w=n("Ey0z"),y=n("rdoz"),b=n("todF"),k=n("iGBT"),x=n("2hOt"),C=n("GADD"),T=n("XSMC"),A=n("NMP6"),S=n("93RO"),z=n("SQoD"),j=n("jjY0"),I=n("D9m0"),O=n("jdmY"),D=n("L6Q5"),V=n("r9mn"),Q=n("cdmR"),q=n("Kn9U"),F=Object(u.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"vf-input "+(t.field.class?t.field.class:"")},[n("v-btn",{staticClass:"no-letter-spacing",attrs:{outlined:"",primary:"",rouned:"",disabled:!t.canStartAzmoon},on:{click:function(e){t.dialog=!0}}},[n("v-icon",{staticClass:"me-2"},[t._v("\n      "+t._s(t.field.icon)+"\n    ")]),t._v(" "+t._s(t.canStartAzmoon?"ورود به صفحه آزمون":"آزمون بعد از اتمام کلاس")+"\n  ")],1),t._v(" "),n("v-dialog",{staticClass:"grey lighten-4",staticStyle:{width:"100%",height:"100%"},attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-system-bar",{attrs:{color:"primary",dark:""}},[t._v("\n      "+t._s(t.azmoonTitle)+"\n      "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{icon:"",small:"",dense:"",disabled:"started"===t.mode},on:{click:function(e){t.dialog=!1}}},[n("v-icon",{attrs:{small:""}},[t._v("\n          mdi-close\n        ")])],1)],1),t._v(" "),n("v-lazy",{staticClass:"pa-2 grey lighten-4 fill-height"},[n("v-sheet",{staticClass:"d-flex flex-column"},[n("v-row",{directives:[{name:"show",rawName:"v-show",value:"not_started"===t.mode,expression:"mode === 'not_started'"}],staticClass:"fill-height",attrs:{"no-gutters":"",justify:"center",align:"center"}},[n("v-col",{attrs:{cols:"12",md:"8"}},[n("v-list",{attrs:{"three-line":""}},[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.azmoonTitle))]),t._v(" "),n("v-progress-linear",{attrs:{absolute:"",bottom:"",active:t.loading,indeterminate:"",color:"primary darken-2"}}),t._v(" "),t.details?n("v-list-item-subtitle",[t._v("شامل "+t._s(t.questionsCount)+" سوال ۴ گزینه ای")]):t._e(),t._v(" "),t.details?n("v-list-item-subtitle",[t._v(t._s(t.azmoonTimeString))]):t._e()],1),t._v(" "),n("v-list-item-action",[n("v-btn",{staticClass:"no-letter-spacing",attrs:{disabled:t.loading||t.hasHistory,outlined:"",color:"primary"},on:{click:t.startAzmoon}},[t._v("شروع آزمون")])],1)],1)],1)],1)],1),t._v(" "),n("v-row",{directives:[{name:"show",rawName:"v-show",value:"taken"===t.mode,expression:"mode === 'taken'"}],staticClass:"fill-height",attrs:{"no-gutters":"",justify:"center",align:"center"}},[n("v-col",{attrs:{cols:"12",md:"8"}},[n("v-list",{attrs:{"three-line":""}},[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.takenTimeString))]),t._v(" "),n("v-progress-linear",{attrs:{absolute:"",bottom:"",active:t.loading,indeterminate:"",color:"primary darken-2"}}),t._v(" "),t.details?n("v-list-item-subtitle",[t._v("شامل "+t._s(t.questionsCount)+" سوال ۴ گزینه ای")]):t._e(),t._v(" "),t.details?n("v-list-item-subtitle",[t._v(t._s(t.azmoonTimeString))]):t._e()],1),t._v(" "),n("v-list-item-action",[n("v-chip",{attrs:{color:"primary"}},[t._v(t._s(t.percentTitle))]),t._v(" "),n("v-chip",{attrs:{color:"success"}},[t._v(t._s(t.percentNoErrTitle))]),t._v(" "),n("v-chip",{attrs:{color:"secondary"}},[t._v(t._s(t.percentDetails))])],1)],1)],1)],1)],1),t._v(" "),n("v-row",{directives:[{name:"show",rawName:"v-show",value:"taken"===t.mode&&t.canSeeAnswers&&!t.takenShowQ,expression:"mode === 'taken' && canSeeAnswers && !takenShowQ"}],staticClass:"fill-height",attrs:{"no-gutters":"",justify:"center",align:"center"}},[n("v-col",{attrs:{cols:"12",md:"8"}},[n("v-list",{attrs:{dense:""}},t._l(t.questions,(function(e,s){return n("v-list-item",{key:t.id+"-question-"+s,on:{click:function(e){return t.onGoToQuestion(s)}}},[n("v-list-item-icon",[n("v-chip",{attrs:{color:t.getColorForAnswer(s,0,!0)}},[t._v(t._s(s+1))])],1),t._v(" "),n("v-list-item-content",[n("div",{staticClass:"d-flex flex-row justify-space-between"},[n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,1,!0)}},[t._v("گزینه ۱")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,2,!0)}},[t._v("گزینه ۲")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,3,!0)}},[t._v("گزینه ۳")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,4,!0)}},[t._v("گزینه ۴")])],1)])],1)})),1)],1)],1),t._v(" "),n("v-toolbar",{directives:[{name:"show",rawName:"v-show",value:"started"===t.mode,expression:"mode === 'started'"}],attrs:{dense:""}},[n("v-toolbar-title",[n("div",{staticClass:"d-flex flex-column"},[n("span",[t._v(t._s(t.azmoonQuestionTitle))]),t._v(" "),n("span",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.azmoonTimeTitle))])])]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{staticClass:"no-letter-spacing me-1",attrs:{disabled:t.loading,outlined:"",small:"",color:"success"},on:{click:function(e){t.answerSheet=!t.answerSheet}}},[t._v("نمایش پاسخنامه")]),t._v(" "),n("v-btn",{staticClass:"no-letter-spacing me-1",attrs:{loading:t.loading,outlined:"",small:"",color:"warning"},on:{click:t.endAzmoon}},[t._v("تحویل پاسخنامه و ثبت پایان آزمون")])],1),t._v(" "),n("v-navigation-drawer",{staticStyle:{"min-width":"400px"},attrs:{fixed:"",temporary:""},model:{value:t.answerSheet,callback:function(e){t.answerSheet=e},expression:"answerSheet"}},[n("v-list",{attrs:{dense:""}},t._l(t.questions,(function(e,s){return n("v-list-item",{key:t.id+"-question-"+s,on:{click:function(e){return t.onGoToQuestion(s)}}},[n("v-list-item-icon",[n("v-chip",[t._v(t._s(s+1))])],1),t._v(" "),n("v-list-item-content",[n("div",{staticClass:"d-flex flex-row justify-space-between"},[n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,1)}},[t._v("گزینه ۱")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,2)}},[t._v("گزینه ۲")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,3)}},[t._v("گزینه ۳")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{depressed:"",small:"",color:t.getColorForAnswer(s,4)}},[t._v("گزینه ۴")])],1)])],1)})),1)],1),t._v(" "),n("v-card",[n("v-row",{directives:[{name:"show",rawName:"v-show",value:"started"===t.mode||t.takenShowQ&&"taken"===t.mode,expression:"mode === 'started' || (takenShowQ && mode === 'taken')"}],staticClass:"fill-height",attrs:{"no-gutters":"",justify:"center",align:"center"}},[n("v-col",{attrs:{cols:"12",md:"12"}},[n("v-card",{staticClass:"fill-width"},["taken"===t.mode?n("v-btn",{attrs:{fab:"",color:"primary"},on:{click:function(e){t.takenShowQ=!1}}},[n("v-icon",[t._v("mdi-close")])],1):t._e(),t._v(" "),t.current?n("v-img",{attrs:{src:t.current,contain:"","min-height":"100px"},scopedSlots:t._u([{key:"placeholder",fn:function(){return[n("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1)]},proxy:!0}],null,!1,3042438443)}):t._e()],1)],1)],1)],1),t._v(" "),n("v-toolbar",{directives:[{name:"show",rawName:"v-show",value:"started"===t.mode,expression:"mode === 'started'"}],staticClass:"fill-wdith",attrs:{disabled:t.loading,dense:""}},[n("v-btn",{attrs:{small:"",outlined:"",disabled:!t.current||0===t.currentIndex},on:{click:t.prevQuestion}},[n("v-icon",[t._v("mdi-chevron-double-right")])],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{small:"",depressed:"",color:t.getColorForAnswer(t.currentIndex,1)},on:{click:function(e){return t.selectAnswer(1)}}},[t._v("گزینه ۱")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{small:"",depressed:"",color:t.getColorForAnswer(t.currentIndex,2)},on:{click:function(e){return t.selectAnswer(2)}}},[t._v("گزینه ۲")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{small:"",depressed:"",color:t.getColorForAnswer(t.currentIndex,3)},on:{click:function(e){return t.selectAnswer(3)}}},[t._v("گزینه ۳")]),t._v(" "),n("v-btn",{staticClass:"mx-1 no-letter-spacing",attrs:{small:"",depressed:"",color:t.getColorForAnswer(t.currentIndex,4)},on:{click:function(e){return t.selectAnswer(4)}}},[t._v("گزینه ۴")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{small:"",outlined:"",disabled:!t.current||t.currentIndex>=this.questions.length-1},on:{click:t.nextQuestion}},[n("v-icon",[t._v("mdi-chevron-double-left")])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=F.exports;m()(F,{VBtn:h.a,VCard:f.a,VChip:p.a,VCol:g.a,VDialog:_.a,VIcon:w.a,VImg:y.a,VLazy:b.a,VList:k.a,VListItem:x.a,VListItemAction:C.a,VListItemContent:T.a,VListItemIcon:A.a,VListItemSubtitle:T.b,VListItemTitle:T.c,VNavigationDrawer:S.a,VProgressCircular:z.a,VProgressLinear:j.a,VRow:I.a,VSheet:O.a,VSpacer:D.a,VSystemBar:V.a,VToolbar:Q.a,VToolbarTitle:q.a})},UFej:function(t,e,n){var s={"./fa":"jfSC","./fa.js":"jfSC"};function i(t){var e=o(t);return n(e)}function o(t){if(!n.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}i.keys=function(){return Object.keys(s)},i.resolve=o,t.exports=i,i.id="UFej"},sfId:function(t,e){function n(t){return 0===i(t).leap}function s(t,e){return e<=6?31:e<=11||n(t)?30:29}function i(t){var e,n,s,i,o,a,r=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178],l=r.length,u=t+621,v=-14,m=r[0];if(t<m||t>=r[l-1])throw new Error("Invalid Jalaali year "+t);for(a=1;a<l&&(n=(e=r[a])-m,!(t<e));a+=1)v=v+8*c(n,33)+c(d(n,33),4),m=e;return v=v+8*c(o=t-m,33)+c(d(o,33)+3,4),4===d(n,33)&&n-o==4&&(v+=1),i=20+v-(c(u,4)-c(3*(c(u,100)+1),4)-150),n-o<6&&(o=o-n+33*c(n+4,33)),-1===(s=d(d(o+1,33)-1,4))&&(s=4),{leap:s,gy:u,march:i}}function o(t,e,n){var s=i(t);return r(s.gy,3,s.march)+31*(e-1)-c(e,7)*(e-7)+n-1}function a(t){var e,n=l(t).gy,s=n-621,o=i(s);if((e=t-r(n,3,o.march))>=0){if(e<=185)return{jy:s,jm:1+c(e,31),jd:d(e,31)+1};e-=186}else s-=1,e+=179,1===o.leap&&(e+=1);return{jy:s,jm:7+c(e,30),jd:d(e,30)+1}}function r(t,e,n){var s=c(1461*(t+c(e-8,6)+100100),4)+c(153*d(e+9,12)+2,5)+n-34840408;return s=s-c(3*c(t+100100+c(e-8,6),100),4)+752}function l(t){var e,n,s,i;return e=(e=4*t+139361631)+4*c(3*c(4*t+183187720,146097),4)-3908,n=5*c(d(e,1461),4)+308,s=c(d(n,153),5)+1,i=d(c(n,153),12)+1,{gy:c(e,1461)-100100+c(8-i,6),gm:i,gd:s}}function c(t,e){return~~(t/e)}function d(t,e){return t-~~(t/e)*e}t.exports={toJalaali:function(t,e,n){"[object Date]"===Object.prototype.toString.call(t)&&(n=t.getDate(),e=t.getMonth()+1,t=t.getFullYear());return a(r(t,e,n))},toGregorian:function(t,e,n){return l(o(t,e,n))},isValidJalaaliDate:function(t,e,n){return t>=-61&&t<=3177&&e>=1&&e<=12&&n>=1&&n<=s(t,e)},isLeapJalaaliYear:n,jalaaliMonthLength:s,jalCal:i,j2d:o,d2j:a,g2d:r,d2g:l}}}]);
//# sourceMappingURL=azmoon-window.bundle.js.map