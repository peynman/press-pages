(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{379:function(e,t,i){"use strict";i.r(t);var o=i(121),l=i(124),s=i.n(l),n=i(148),a={mixins:[o.d],name:"vf-blockly-input",props:{id:String,field:Object,value:[String,Array,Object]},data:function(){return{ignoreChange:!1,windowWidth:0,windowHeight:0}},methods:{onWindowResize:function(e){var t=this.$refs.blockArea,i=t,o=0,l=0;do{o+=i.offsetLeft,l+=i.offsetTop,i=i.offsetParent}while(i);var n=this.$refs.blockEditor;n.style.left=o+"px",n.style.top=l+"px",n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px",s.a.svgResize(this.blockEditor)},refreshSize:function(){this.onWindowResize(null)},updateBlocks:function(){if(this.value&&""!==this.value)try{s.a.Xml.clearWorkspaceAndLoadFromXml(s.a.Xml.textToDom(this.value),this.blockEditor)}catch(e){}},pasteToWorkspace:function(e){var t=s.a.Xml.textToDom(e),i=s.a.Xml.domToBlock(t,this.blockEditor);console.log("domToWorkspace",t,i),s.a.Events.fire(new s.a.Events.Create(i)),this.refreshSize()}},mounted:function(){var e=this,t=this.$refs.blockEditor;if(t){var i=Object(n.a)(s.a,{blocks:this.field.blocks?this.field.blocks:null});if(this.blockEditor=s.a.inject(t,{toolbox:i,zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2}}),this.blockEditor.addChangeListener((function(t){if("click"===t.element&&t.blockId){var i=e.blockEditor.getBlockById(t.blockId),o=s.a.Xml.blockToDom(i);e.$emit("selection",s.a.Xml.domToText(o))}var l=s.a.Xml.workspaceToDom(e.blockEditor);e.devalue=s.a.Xml.domToText(l),e.$emit("input",e.devalue)})),this.value&&""!==this.value)try{s.a.Xml.clearWorkspaceAndLoadFromXml(s.a.Xml.textToDom(this.value),this.blockEditor)}catch(e){}s.a.svgResize(this.blockEditor)}this.$nextTick((function(){window.addEventListener("resize",this.onWindowResize),this.onWindowResize()}))},beforeDestroy:function(){window.removeEventListener("resize",this.onWindowResize)}},c=i(26),r=Object(c.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:"vf-input vf-blockly-input d-flex flex-column "+(this.field.class?this.field.class:"")},[t("label",[this._v(this._s(this.field.label))]),this._v(" "),t("div",{ref:"blockArea",staticClass:"fill-height",staticStyle:{width:"100%","min-height":"500px",height:"100%"}},[t("div",{ref:"blockEditor"})])])}),[],!1,null,null,null);t.default=r.exports}}]);